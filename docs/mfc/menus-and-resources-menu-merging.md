---
title: メニューとリソース:メニューのマージ
ms.date: 11/04/2016
helpviewer_keywords:
- status bars [MFC], OLE document applications
- visual editing [MFC], application menus and resources
- coordinating menu layouts [MFC]
- OLE containers [MFC], menus and resources
- toolbars [MFC], OLE document applications
- merging toolbar and status bar [MFC]
- menus [MFC], OLE document applications
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
ms.openlocfilehash: 1f7af7007e72cb8e01022c81a244fc70ba52a5cc
ms.sourcegitcommit: ecf274bcfe3a977c48745aaa243e5e731f1fdc5f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/04/2019
ms.locfileid: "66504821"
---
# <a name="menus-and-resources-menu-merging"></a>メニューとリソース:メニューのマージ

この記事では、ビジュアル編集を処理し、インプレース アクティブ化正しく OLE ドキュメント アプリケーションに必要な手順を説明します。 インプレース アクティブ化は、(コンポーネント) のアプリケーション コンテナーとサーバーの両方にとっての課題をもたらします。 ユーザーは、(コンテナー ドキュメントのコンテキスト) 内のフレーム ウィンドウに残りますが実際に別のアプリケーション (サーバー) を実行します。 これには、コンテナーとサーバー アプリケーションのリソース間の調整が必要です。

この記事で説明したトピックは次のとおりです。

- [メニューのレイアウト](#_core_menu_layouts)

- [ツールバーとステータス バー](#_core_toolbars_and_status_bars)

##  <a name="_core_menu_layouts"></a> メニューのレイアウト

最初の手順 メニューのレイアウトを調整することです。 コンテナー アプリケーションでは、埋め込みアイテムがインプレース アクティブ化されるときにのみ使用される新しいメニューを作成する必要があります。 少なくとも、このメニューは必要がありますを順番に、次ので構成されます。

1. [ファイル] メニューが、ファイルを開いているときに使用されるものと同じです。 (通常は他のメニュー項目が適用されません次の項目の前にします。)

1. 2 つの連続する区切り記号です。

1. [ウィンドウ] メニュー、ファイルを開いているときに使用されるものと同じです (場合にのみ、MDI アプリケーションでコンテナー アプリケーション)。 一部のアプリケーションでは、その他のなど、メニュー オプション メニューでは、埋め込みアイテムがインプレース アクティブ化されるときに、メニュー上に残りますが、このグループに属するがあります。

    > [!NOTE]
    >  ズームなど、コンテナー ドキュメントの表示に影響するその他のメニューである可能性があります。 このメニュー リソースの 2 つの区切り記号の間にこれらのコンテナーのメニューが表示されます。

サーバー (コンポーネント) アプリケーションは、インプレース アクティブ化用の新しいメニューを作成もする必要があります。 ファイルを開いているときに使用するメニューのようにせずにファイルや、データではなくサーバー ドキュメントの操作ウィンドウのメニュー項目が必要です。 通常、このメニューは、以下の構成します。

1. [編集] メニューのファイルを開いているときに使用されるものと同じです。

1. 区切り記号。

1. オブジェクトの編集など、Scribble のサンプル アプリケーション [ペン] メニューのメニュー。

1. 区切り記号。

1. [ヘルプ] メニュー。

例については、いくつかサンプル インプレース メニューには、コンテナーとサーバーのレイアウトを確認します。 例を明確にするため、各メニュー項目の詳細が削除されました。 コンテナーのインプレース メニューには、次のエントリがあります。

```
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&File C1"
    MENUITEM SEPARATOR
    POPUP "&Zoom C2"
    MENUITEM SEPARATOR
    POPUP "&Options C3"
    POPUP "&Window C3"
END
```

連続する区切り記号は、サーバーのメニューの最初の部分が移動する必要がありますを指定します。 サーバーのインプレース メニューを見てようになりました。

```
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&Edit S1"
    MENUITEM SEPARATOR
    POPUP "&Format S2"
    MENUITEM SEPARATOR
    POPUP "&Help S3"
END
```

区切り記号をここでは、2 番目のコンテナーのメニュー項目のグループが移動する必要がありますを指定します。 このサーバーからオブジェクトがこのコンテナー内でアクティブ化時に、結果として得られるメニュー構造のようになります。

```
BEGIN
    POPUP "&File C1"
    POPUP "&Edit S1"
    POPUP "&Zoom C2"
    POPUP "&Format S2"
    POPUP "&Options C3
    POPUP "&Window C3"
    POPUP "&Help S3"
END
```

ご覧のように、区切り記号の各アプリケーションのメニュー グループに置き換えられました。

インプレース メニューに関連付けられているアクセラレータ テーブルは、サーバー アプリケーションでも指定する必要があります。 コンテナーでは、独自のアクセラレータ テーブルに組み込むことです。

インプレース埋め込みアイテムがアクティブになるフレームワークは、[インプレース] メニューを読み込みます。 インプレース アクティブ化用のメニュー サーバー アプリケーションを要求し、区切り線の位置に挿入します。 これは、メニューの結合です。 コンテナーからファイルとウィンドウの配置に対する操作のためのメニューを表示し、サーバーから、項目に対する操作のためのメニューを表示します。

##  <a name="_core_toolbars_and_status_bars"></a> ツールバーとステータス バー

サーバー アプリケーションは、新しいツールバーを作成し、別のファイルにそのビットマップを格納する必要があります。 アプリケーション ウィザードで生成されたアプリケーションでは、このビットマップは itoolbar ファイルに格納します。BMP です。 新しいツールバーでは、サーバーの項目を通常のツールバーと同じ項目が含まれますが、ファイルとウィンドウのメニュー項目を表すアイコンを削除する必要がありますとがインプレースでアクティブになると、コンテナー アプリケーションのツールバーが置き換えられます。

このツールバーが読み込まれて、 `COleIPFrameWnd`-派生クラスで、アプリケーション ウィザードによって作成します。 ステータス バーは、コンテナーのアプリケーションによって処理されます。 埋め込み先フレーム ウィンドウの実装の詳細については、次を参照してください。[サーバー。サーバーを実装する](../mfc/servers-implementing-a-server.md)します。

## <a name="see-also"></a>関連項目

[メニューとリソース (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[アクティベーション](../mfc/activation-cpp.md)<br/>
[サーバー](../mfc/servers.md)<br/>
[コンテナー](../mfc/containers.md)
