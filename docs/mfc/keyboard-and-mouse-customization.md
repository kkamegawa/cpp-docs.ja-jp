---
title: キーボードとマウスのカスタマイズ
ms.date: 11/19/2018
helpviewer_keywords:
- customizations [MFC], keyboard and mouse (MFC Extensions)
- keyboard and mouse customizations (MFC Extensions)
ms.assetid: 1f789f1b-5f2e-4b11-b974-e3e2a2e49d82
ms.openlocfilehash: 55eaac9d800730f3a01dcdb2eef943eb48d147b1
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62311157"
---
# <a name="keyboard-and-mouse-customization"></a>キーボードとマウスのカスタマイズ

MFC は、キーボードとマウス入力の処理方法をカスタマイズするアプリケーションのユーザーに許可します。 ユーザーは、コマンドをキーボード ショートカットを割り当てることによってキーボード入力をカスタマイズできます。 ユーザーはマウス入力をユーザーがアプリケーションの特定の windows の内側でダブルクリックしたときに実行されるコマンドを選択してカスタマイズもできます。 このトピックでは、アプリケーションの入力をカスタマイズする方法について説明します。

**カスタマイズ** ダイアログ ボックスで、ユーザーは、マウスとキーボードのカスタム コントロールを変更できます。 このダイアログ ボックスを表示するには、ユーザーがポイントを**カスタマイズ**上、**ビュー**メニューとし、数回のクリック**ツールバーとドッキング ウィンドウ**します。 ダイアログ ボックスで、ユーザーがクリックするか、**キーボード** タブまたは**マウス**タブです。

## <a name="keyboard-customization"></a>キーボードのカスタマイズ

次の図は、**キーボード**のタブ、**カスタマイズ** ダイアログ ボックス。

![[カスタマイズ] ダイアログ ボックスの [キーボード] タブ](../mfc/media/mfcnextkeyboardtab.png "カスタマイズ ダイアログ ボックスでは、[キーボード] タブ") <br/>
キーボードのカスタマイズタブ

ユーザーがコマンドに 1 つまたは複数のキーボード ショートカットを割り当てるには、[キーボード] タブを操作します。 タブの左側にある使用可能なコマンドが表示されます。ユーザーは、メニューから使用可能なコマンドを選択できます。 メニュー コマンドのみをキーボード ショートカットと関連付けることができます。 ユーザーが、新しいショートカットを入力した後、**割り当てる**ボタンが有効になります。 ユーザーは、このボタンをクリックすると、アプリケーションは、そのショートカットを選択したコマンドを関連付けます。

現在割り当てられているショートカット キーのすべては、右側の列でリスト ボックスに表示されます。 個々 のショートカット キーを選択します。 削除を行ったりと、アプリケーションのすべてのマッピングをリセットまたはすることができますもできます。

作成する必要がある、アプリケーションでこのカスタマイズをサポートする場合、 [CKeyboardManager](../mfc/reference/ckeyboardmanager-class.md)オブジェクト。 作成する、`CKeyboardManager`オブジェクト、関数を呼び出す[CWinAppEx::InitKeyboardManager](../mfc/reference/cwinappex-class.md#initkeyboardmanager)します。 このメソッドは、作成し、キーボードのマネージャーを初期化します。 を作成する場合、キーボード manager 手動でも呼び出す必要がある`CWinAppEx::InitKeyboardManager`を初期化します。

ウィザードを使用して、アプリケーションを作成する場合、ウィザードは、キーボードのマネージャーを初期化します。 フレームワークは、追加、アプリケーションは、キーボードのマネージャーを初期化した後、**キーボード**タブ、**カスタマイズ**ダイアログ ボックス。

## <a name="mouse-customization"></a>マウスのカスタマイズ

次の図は、**マウス**のタブ、**カスタマイズ** ダイアログ ボックス。

![[カスタマイズ] ダイアログ ボックスの [マウス] タブ](../mfc/media/mfcnextmousetab.png "カスタマイズ ダイアログ ボックスでは、[マウス] タブ") <br/>
マウスのカスタマイズタブ

ユーザーがメニューを割り当てるには、このタブを操作コマンドをマウスのダブルクリック処理します。 ユーザーは、ウィンドウの左側にあるビューを選択し、右側にあるコントロールを使用して、コマンド、ダブルクリック アクションと関連付けます。 ユーザー後がクリックした**閉じる**ユーザーが、ビューの任意の場所をダブルクリックしたときに、アプリケーションが関連付けられているコマンドを実行します。

既定では、ウィザードを使用してアプリケーションを作成するときにマウスのカスタマイズは有効ありません。

#### <a name="to-enable-mouse-customization"></a>マウスのカスタマイズを有効にするには

1. 初期化を[CMouseManager](../mfc/reference/cmousemanager-class.md)オブジェクトを呼び出すことによって[CWinAppEx::InitMouseManager](../mfc/reference/cwinappex-class.md#initmousemanager)します。

1. 使用して、マウスのマネージャーへのポインターを取得[CWinAppEx::GetMouseManager](../mfc/reference/cwinappex-class.md#getmousemanager)します。

1. ビューを使用して、マウスのマネージャーに追加、 [CMouseManager::AddView](../mfc/reference/cmousemanager-class.md#addview)メソッド。 これをマウスのマネージャーに追加するすべてのビューを行います。

フレームワークは、追加、アプリケーションは、マウス マネージャーを初期化した後、**マウス**タブ、**カスタマイズ**ダイアログ ボックス。 すべてのビューを追加しないと場合、タブにアクセス、ハンドルされない例外が発生します。 ビューの一覧を作成した後、**マウス**タブは、ユーザーに使用できます。

マウスのマネージャーに新しいビューを追加すると付けます一意の id。 ウィンドウのマウスのカスタマイズをサポートする場合は、WM_LBUTTONDBLCLICK メッセージと呼び出しを処理する必要があります、 [CWinAppEx::OnViewDoubleClick](../mfc/reference/cwinappex-class.md#onviewdoubleclick)関数。 この関数を呼び出すときに、そのウィンドウの ID パラメーターの 1 つです。 ID 番号とそれらに関連付けられているオブジェクトを追跡するプログラマの役目です。

## <a name="security-concerns"></a>セキュリティに関する注意事項

」の説明に従って[ユーザー定義のツール](../mfc/user-defined-tools.md)ユーザーはツールのユーザー定義の ID をダブルクリック イベントに関連付けることができます。 アプリケーションが関連付けられている ID と一致するユーザー ツールの検索ビューをダブルクリックします。 アプリケーションには、一致するツールが検出されると、ツールを実行します。 アプリケーションでは、一致するツールを見つけられない場合は、ダブルクリックされたビューに ID を持つ WM_COMMAND メッセージを送信します。

カスタマイズした設定は、レジストリに格納されます。 レジストリを編集して、攻撃者は、任意のコマンドを使用して有効なユーザー ツールの ID を置き換えることができます。 ユーザーをダブルクリックすると、ビュー、ビューは、攻撃者が仕掛けたコマンドを処理します。 これにより、予期しないと危険性のある動作が発生する可能性があります。

さらに、このような攻撃は、ユーザー インターフェイスの保護をバイパスすることができます。 たとえば、アプリケーションが印刷を無効になっているとします。 つまり、そのユーザー インターフェイスで、**印刷**メニューおよびボタンは使用できません。 通常これにより、アプリケーション印刷からです。 攻撃者が、レジストリを編集した場合、ユーザー送信印刷コマンド、ビューをダブルクリックして直接使用できるユーザー インターフェイス要素をバイパスします。

この種の攻撃を防ぐには、アプリケーションで実行される前に、コマンドが有効であることを確認するコマンド ハンドラーにコードを追加します。 コマンドが、アプリケーションに送信されることを防ぐために、ユーザー インターフェイスに依存しません。

## <a name="see-also"></a>関連項目

[MFC のカスタマイズ](../mfc/customization-for-mfc.md)<br/>
[CKeyboardManager クラス](../mfc/reference/ckeyboardmanager-class.md)<br/>
[CMouseManager クラス](../mfc/reference/cmousemanager-class.md)<br/>
[カスタマイズによるセキュリティへの影響](../mfc/security-implications-of-customization.md)
