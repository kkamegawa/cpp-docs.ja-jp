---
title: 'チュートリアル: MFC によるリボン アプリケーションの作成'
ms.date: 09/09/2019
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon application (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: 0f81b27d479b15864302b21a467bff9489ba465a
ms.sourcegitcommit: b8c22e6d555cf833510753cba7a368d57e5886db
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/29/2020
ms.locfileid: "76821923"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>チュートリアル: MFC によるリボン アプリケーションの作成

このチュートリアルでは、 **MFC アプリケーションウィザード**を使用して、既定でリボンを持つアプリケーションを作成する方法について説明します。 次に、 **[お気に入り]** リボンパネルを持つ**カスタム**リボンカテゴリを追加して、頻繁に使用するコマンドをパネルに追加することにより、リボンを展開できます。

## <a name="prerequisites"></a>Prerequisites

このチュートリアルでは、**全般的な開発設定**を使用するように Visual Studio を設定していることを前提としています。 別の設定を使用している場合は、次の手順で参照されているユーザーインターフェイス (UI) 要素の一部が表示されないことがあります。

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>リボンを備えた MFC アプリケーションを作成するには

1. **Mfc アプリケーションウィザード**を使用して、リボンを持つ mfc アプリケーションを作成します。 お使いのバージョンの Visual Studio のウィザードを開く方法については[、「チュートリアル: 新しい MFC シェルコントロールの使用](walkthrough-using-the-new-mfc-shell-controls.md)」を参照してください。

1. **MFC アプリケーションウィザード**で、次のオプションを設定します。

    1. **[アプリケーションの種類]** セクションの **[視覚スタイルと色]** で、 **[Office 2007 (Blue theme)]** を選択します。

    1. **[複合ドキュメントのサポート]** セクションで、 **[なし**] が選択されていることを確認します。

    1. **[ドキュメントテンプレートのプロパティ]** セクションの **[ファイル拡張子]** ボックスに、このアプリケーションで作成するドキュメントのファイル名拡張子を入力します。たとえば、「 *mfcrbnapp*」と入力します。

    1. **[データベースのサポート]** セクション (Visual Studio 2015 のみ) で、 **[なし**] が選択されていることを確認します。

    1. **[ユーザーインターフェイス機能]** セクションで、 **[リボンを使用]** する が選択されていることを確認します。

    1. 既定では、 **MFC アプリケーションウィザード**では、複数のドッキングペインのサポートが追加されています。 ただし、このチュートリアルで説明するのはリボンについてのみであるため、アプリケーションからこれらのオプションを削除します。 **[高度な機能**] セクションで、すべてのオプションをオフにします。

1. **[完了]** をクリックして、MFC アプリケーションを作成します。

1. アプリケーションが正常に作成されたことを確認するために、アプリケーションをビルドして実行します。 アプリケーションをビルドするには、 **[ビルド]** メニューの **[ソリューションのビルド]** をクリックします。 アプリケーションが正常にビルドされた場合は、 **[デバッグ]** メニューの **[デバッグ開始]** をクリックしてアプリケーションを実行します。

    ウィザードでは、 **[ホーム]** という名前の1つのリボンカテゴリを持つリボンが自動的に作成されます。 このリボンには、**クリップボード**、**ビュー**、**ウィンドウ**という3つのリボンパネルが含まれています。

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>カテゴリとパネルをリボンに追加するには

1. ウィザードによって作成されたリボンリソースを開くには、 **[表示]** メニューの **[その他のウィンドウ]** をポイントし、 **[リソースビュー]** をクリックします。 **リソースビュー**で、 **[リボン]** をクリックし、 **[IDR_RIBBON]** をダブルクリックします。

1. まず、**ツールボックス**の [**カテゴリ]** をダブルクリックして、カスタムカテゴリをリボンに追加します。

    キャプション**Category1**が作成されたカテゴリ。 既定では、カテゴリにはパネルが 1 つあります。

    **Category1**を右クリックし、 **[プロパティ]** をクリックします。 **[プロパティ]** ウィンドウで、 **[キャプション]** を [*カスタム*] に変更します。

    **[大きい画像]** プロパティと **[小さい画像]** プロパティでは、このカテゴリのリボン要素のアイコンとして使用されるビットマップを指定します。 カスタムのビットマップの作成はこのチュートリアルの対象外であるため、ウィザードで作成されたビットマップをそのまま使用します。 小さいビットマップは 16 × 16 ピクセルです。 小さいイメージの場合は、`IDB_FILESMALL` リソース ID によってアクセスされるビットマップを使用します。 大きいビットマップは 32 × 32 ピクセルです。 大きなイメージの場合は、`IDB_FILELARGE` リソース ID によってアクセスされるビットマップを使用します。

    > [!NOTE]
    > 高解像度 (HDPI: High Dots per Inch) 表示では、HDPI 版のイメージが自動的に使用されます。

1. 次は、パネルをカスタマイズします。 パネルは、互いに論理的に関連する項目をグループ化するために使用されます。 たとえば、このアプリケーションの **[ホーム]** タブで、 **[切り取り]** 、 **[コピー]** 、 **[貼り付け]** の各コマンドがすべて **[クリップボード]** パネルにあります。 パネルをカスタマイズするには、 **[Panel1]** を右クリックし、 **[プロパティ]** をクリックします。 **[プロパティ]** ウィンドウで、 **[キャプション]** を [*お気に入り*] に変更します。

    パネルの**イメージインデックス**を指定できます。 この数値は、リボンパネルが**クイックアクセスツールバー**に追加された場合に表示されるアイコンを指定します。 このアイコンは、リボンパネル自体には表示されません。

1. リボンのカテゴリとパネルが正しく作成されたことを確認するために、リボン コントロールをプレビューします。 **リボンエディターのツールバー**で、[**テスト] リボン**ボタンをクリックします。 リボンには、**カスタム**タブと **[お気に入り]** パネルが表示されます。

### <a name="to-add-elements-to-the-ribbon-panels"></a>リボン パネルに要素を追加するには

1. 前の手順で作成したパネルに要素を追加するには、**ツールボックス**の **[リボンエディター]** セクションから [デザイン] ビューのパネルにコントロールをドラッグします。

1. まず、 **[印刷]** ボタンを追加します。 **[印刷]** ボタンには、既定のプリンターを使用して印刷する**クイック印刷**コマンドを含むサブメニューが表示されます。 このアプリケーションに対して、両方のコマンドが既に定義されています。 これらは、[アプリケーション] メニューにあります。

    **印刷** ボタンを作成するには、ボタン ツールをパネルにドラッグします。

    **[プロパティ]** ウィンドウで、 **ID**プロパティを**ID_FILE_PRINT**に変更します。この値は既に定義されています。 *印刷*する**キャプション**を変更します。 **イメージのインデックス**を*4*に変更します。

    **[クイック印刷]** ボタンを作成するには、[**メニュー項目]** の横にあるプロパティ値列をクリックし、参照ボタン (. **[..]** ) をクリックします。**項目エディター**で、ラベルのない **[追加]** ボタンをクリックして、メニュー項目を作成します。 **[プロパティ]** ウィンドウで、 **[キャプション]** を [*クイック印刷*]、 **[ID]** を*ID_FILE_PRINT_DIRECT*、 **[イメージ]** を [ *5*] に変更します。 Image プロパティは、`IDB_FILESMALL` bitmap リソースの**クイック印刷**アイコンを指定します。

1. ボタンがリボン パネルに追加されたことを確認するには、アプリケーションをビルドして実行します。 アプリケーションをビルドするには、 **[ビルド]** メニューの **[ソリューションのビルド]** をクリックします。 アプリケーションが正常にビルドされた場合は、 **[デバッグ]** メニューの **[デバッグ開始]** をクリックしてアプリケーションを実行します。 リボンの **[カスタム]** タブの **[お気に入り]** パネルにある **[印刷]** ボタンとコンボボックスが表示されます。

## <a name="next-steps"></a>次のステップ

[方法: クイック アクセス ツール バーをカスタマイズする](../mfc/how-to-customize-the-quick-access-toolbar.md)

[方法: アプリケーション ボタンをカスタマイズする](../mfc/how-to-customize-the-application-button.md)

エンドツーエンドのサンプルについては、「[サンプル (MFC Feature Pack)](../overview/visual-cpp-samples.md)」を参照してください。

## <a name="see-also"></a>関連項目

[チュートリアル](../mfc/walkthroughs-mfc.md)<br/>
[サンプル (MFC Feature Pack)](../overview/visual-cpp-samples.md)
