---
title: CWinAppEx クラス
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/06/2020
ms.locfileid: "78869938"
---
# <a name="cwinappex-class"></a>CWinAppEx クラス

`CWinAppEx` は、アプリケーション状態の処理、レジストリへの状態の保存、レジストリからの状態の読み込み、アプリケーションマネージャーの初期化、および同じアプリケーションマネージャーへのリンクの提供を行います。

   詳細については、Visual Studio インストールの**VC\\atlmfc\\src\\mfc**フォルダーにあるソースコードを参照してください。
## <a name="syntax"></a>構文

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|Name|Description|
|----------|-----------------|
|[CWinAppEx:: CWinAppEx](#cwinappex)|`CWinAppEx` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|Name|Description|
|----------|-----------------|
|[CWinAppEx:: CleanState](#cleanstate)|Windows レジストリからアプリケーションに関する情報を削除します。|
|[CWinAppEx:: EnableLoadWindowPlacement](#enableloadwindowplacement)|アプリケーションがメインフレームウィンドウの初期サイズと位置をレジストリから読み込むかどうかを指定します。|
|[CWinAppEx:: EnableTearOffMenus](#enabletearoffmenus)|アプリケーションのティアオフメニューを有効にします。|
|[CWinAppEx:: EnableUserTools](#enableusertools)|ユーザーがアプリケーションでカスタムメニューコマンドを作成できるようにします。|
|[CWinAppEx:: ExitInstance](#exitinstance)|アプリケーションのこのインスタンスを終了するために、`Run` メンバー関数内からフレームワークによって呼び出されます。 ( [CWinApp:: ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance)をオーバーライドします)。|
|[CWinAppEx:: GetBinary](#getbinary)|指定されたレジストリ値に関連付けられているバイナリデータを読み取ります。|
|[CWinAppEx:: GetContextMenuManager](#getcontextmenumanager)|グローバル[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)オブジェクトへのポインターを返します。|
|[CWinAppEx:: GetDataVersion](#getdataversion)||
|[CWinAppEx:: GetDataVersionMajor](#getdataversionmajor)|Windows レジストリに保存されているアプリケーションのメジャーバージョンを返します。|
|[CWinAppEx:: GetDataVersionMinor](#getdataversionminor)|Windows レジストリに保存されているアプリケーションのマイナーバージョンを返します。|
|[CWinAppEx:: GetInt](#getint)|指定された値に関連付けられている数値データをレジストリから読み取ります。|
|[CWinAppEx:: Get Manager](#getkeyboardmanager)|グローバル[Cて manager](../../mfc/reference/ckeyboardmanager-class.md)オブジェクトへのポインターを返します。|
|[CWinAppEx:: GetMouseManager](#getmousemanager)|グローバル[Cmousemanager](../../mfc/reference/cmousemanager-class.md)オブジェクトへのポインターを返します。|
|[CWinAppEx:: GetObject](#getobject)|指定した値に関連付けられている `CObject`派生データをレジストリから読み取ります。|
|[CWinAppEx:: GetRegSectionPath](#getregsectionpath)|レジストリキーのパスを表す文字列を返します。 このパスは、指定された相対パスをアプリケーションパスと連結します。|
|[CWinAppEx:: GetRegistryBase](#getregistrybase)|アプリケーションのレジストリパスを返します。|
|[CWinAppEx:: GetSectionBinary](#getsectionbinary)|レジストリから、指定されたキーと値に関連付けられているバイナリデータを読み取ります。|
|[CWinAppEx:: GetSectionInt](#getsectionint)|指定したキーと値に関連付けられているレジストリから数値データを読み取ります。|
|[CWinAppEx:: GetSectionObject](#getsectionobject)|レジストリから、指定されたキーと値に関連付けられている `CObject` データを読み取ります。|
|[CWinAppEx:: GetSectionString](#getsectionstring)|レジストリから、指定したキーと値に関連付けられている文字列データを読み取ります。|
|[CWinAppEx:: GetShellManager](#getshellmanager)|グローバル[Cshellmanager](../../mfc/reference/cshellmanager-class.md)オブジェクトへのポインターを返します。|
|[CWinAppEx:: GetString](#getstring)|指定した値に関連付けられている文字列データをレジストリから読み取ります。|
|[CWinAppEx:: GetTooltipManager](#gettooltipmanager)|グローバル[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)オブジェクトへのポインターを返します。|
|[CWinAppEx:: Getuserツールマネージャー](#getusertoolsmanager)|グローバル[Cuserツールマネージャー](../../mfc/reference/cusertoolsmanager-class.md)オブジェクトへのポインターを返します。|
|[CWinAppEx:: InitContextMenuManager](#initcontextmenumanager)|`CContextMenuManager` オブジェクトを初期化します。|
|[CWinAppEx:: Init# manager](#initkeyboardmanager)|`CKeyboardManager` オブジェクトを初期化します。|
|[CWinAppEx:: InitMouseManager](#initmousemanager)|`CMouseManager` オブジェクトを初期化します。|
|[CWinAppEx:: InitShellManager](#initshellmanager)|`CShellManager` クラスを初期化します。|
|[CWinAppEx:: InitTooltipManager](#inittooltipmanager)|`CTooltipManager` クラスを初期化します。|
|[CWinAppEx:: IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx:: IsStateExists](#isstateexists)|指定されたキーがレジストリ内に存在するかどうかを示します。|
|[CWinAppEx:: LoadState](#loadstate)|レジストリからアプリケーションの状態を読み込みます。|
|[CWinAppEx:: OnAppContextHelp](#onappcontexthelp)|ユーザーが**カスタマイズ**ダイアログボックスのコンテキストヘルプを要求したときに、フレームワークによって呼び出されます。|
|[CWinAppEx:: OnViewDoubleClick](#onviewdoubleclick)|ユーザーがアプリケーション内の任意の場所をダブルクリックしたときに、ユーザー定義のコマンドを呼び出します。|
|[CWinAppEx:: OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx:: SaveState](#savestate)|アプリケーションフレームワークの状態を Windows レジストリに書き込みます。|
|[CWinAppEx:: SetRegistryBase](#setregistrybase)|既定のレジストリキーのパスを設定します。 このキーは、後続のすべてのレジストリ呼び出しのルートとして機能します。|
|[CWinAppEx:: ShowPopupMenu](#showpopupmenu)|ポップアップメニューを表示します。|
|[CWinAppEx:: WriteBinary](#writebinary)|指定したレジストリ値にバイナリデータを書き込みます。|
|[CWinAppEx:: WriteInt](#writeint)|指定されたレジストリ値に数値データを書き込みます。|
|[CWinAppEx:: WriteObject](#writeobject)|[CObject クラス](../../mfc/reference/cobject-class.md)から派生したデータを、指定したレジストリ値に書き込みます。|
|[CWinAppEx:: WriteSectionBinary](#writesectionbinary)|指定したレジストリキーの値にバイナリデータを書き込みます。|
|[CWinAppEx:: WriteSectionInt](#writesectionint)|指定されたレジストリキーの値に数値データを書き込みます。|
|[CWinAppEx:: WriteSectionObject](#writesectionobject)|`CObject` クラスから派生したデータを、指定したレジストリキーの値に書き込みます。|
|[CWinAppEx:: WriteSectionString](#writesectionstring)|文字列データを、指定したレジストリキーの値に書き込みます。|
|[CWinAppEx:: WriteString](#writestring)|指定したレジストリ値に文字列データを書き込みます。|

### <a name="protected-methods"></a>プロテクト メソッド

|Name|Description|
|----------|-----------------|
|[CWinAppEx:: LoadCustomState](#loadcustomstate)|アプリケーションの状態が読み込まれたときにフレームワークによって呼び出されます。|
|[CWinAppEx:: LoadWindowPlacement](#loadwindowplacement)|アプリケーションのサイズと場所をレジストリから読み込むときに、フレームワークによって呼び出されます。 読み込まれたデータには、アプリケーションが最後に閉じられたときのメインフレームのサイズと位置が含まれます。|
|[CWinAppEx:: OnClosingMainFrame フレーム](#onclosingmainframe)|メインフレームウィンドウが WM_CLOSE を処理しているときに、フレームワークによって呼び出されます。|
|[CWinAppEx::P reLoadState](#preloadstate)|アプリケーション状態が読み込まれる直前に、フレームワークによって呼び出されます。|
|[CWinAppEx::P reSaveState](#presavestate)|アプリケーションの状態が保存される直前に、フレームワークによって呼び出されます。|
|[CWinAppEx:: ReloadWindowPlacement](#reloadwindowplacement)|指定されたウィンドウのサイズと場所をレジストリから再読み込みします。|
|[CWinAppEx:: SaveCustomState](#savecustomstate)|アプリケーション状態をレジストリに書き込むと、フレームワークによって呼び出されます。|
|[CWinAppEx:: StoreWindowPlacement](#storewindowplacement)|メインフレームのサイズと位置をレジストリに書き込むために、フレームワークによって呼び出されます。|

### <a name="data-members"></a>データ メンバー

|Name|Description|
|----------|-----------------|
|[CWinAppEx:: m_bForceImageReset](#m_bforceimagereset)|ツールバーを含むフレームウィンドウが読み込まれたときに、フレームワークがすべてのツールバーイメージをリセットするかどうかを指定します。|

## <a name="remarks"></a>解説

MFC フレームワークによって提供される機能の多くは、`CWinAppEx` クラスによって異なります。 `CWinAppEx` クラスは、次の2つの方法のいずれかでアプリケーションに組み込むことができます。

- メインスレッドで `CWinAppEx` クラスを構築します。

- `CWinAppEx`からメインアプリケーションクラスを派生させます。

アプリケーションに `CWinAppEx` を組み込むと、いずれかのアプリケーションマネージャーを初期化できます。 アプリケーションマネージャーを使用する前に、適切な initialize メソッドを呼び出すことによって、アプリケーションマネージャーを初期化する必要があります。 特定のマネージャーへのポインターを取得するには、関連付けられている get メソッドを呼び出します。 `CWinAppEx` クラスは、 [Cmousemanager クラス](../../mfc/reference/cmousemanager-class.md)、 [CContextMenuManager クラス](../../mfc/reference/ccontextmenumanager-class.md)、 [c manager クラス](../../mfc/reference/ckeyboardmanager-class.md)、 [Ckeyboardmanager manager](../../mfc/reference/cusertoolsmanager-class.md)クラス、および[クラス](../../mfc/reference/cmenutearoffmanager-class.md)を管理します。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>必要条件

**ヘッダー:** afxwinappex

##  <a name="cleanstate"></a>CWinAppEx:: CleanState

アプリケーションに関するすべての情報を Windows レジストリから削除します。

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>パラメーター

*lpszSectionName*<br/>
からレジストリキーのパスを含む文字列。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>解説

このメソッドは、レジストリの特定のセクションからアプリケーションデータをクリアします。 パラメーター *Lpszsectionname*を使用して、セクションをクリアするように指定できます。 *Lpszsectionname*が NULL の場合、このメソッドは `CWinAppEx` オブジェクトに格納されている既定のレジストリパスを使用します。 既定のレジストリパスを取得するには、 [CWinAppEx:: GetRegistryBase](#getregistrybase)を使用します。

##  <a name="cwinappex"></a>CWinAppEx:: CWinAppEx

`CWinAppEx` オブジェクトを構築します。

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>パラメーター

*bResourceSmartUpdate*<br/>
からワークスペースオブジェクトがリソースの更新を検出して処理する必要があるかどうかを指定するブール型パラメーターです。

### <a name="remarks"></a>解説

`CWinAppEx` クラスには初期化メソッドがあり、アプリケーション情報をレジストリに保存および読み込み、グローバルアプリケーション設定を制御するための機能を提供します。 また、 [Cのマネージャークラス](../../mfc/reference/ckeyboardmanager-class.md)や[Ckeyboardmanager manager クラス](../../mfc/reference/cusertoolsmanager-class.md)などのグローバルマネージャーを使用することもできます。 各アプリケーションは、`CWinAppEx` クラスのインスタンスを1つだけ持つことができます。

##  <a name="enableloadwindowplacement"></a>CWinAppEx:: EnableLoadWindowPlacement

アプリケーションがメインフレームウィンドウの初期サイズと位置をレジストリから読み込むかどうかを指定します。

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*bEnable*<br/>
からアプリケーションがメインフレームウィンドウの初期サイズと位置をレジストリから読み込むかどうかを指定します。

### <a name="remarks"></a>解説

既定では、メインフレームのサイズと場所は、他のアプリケーション設定と共にレジストリから読み込まれます。 これは、 [CWinAppEx:: LoadState](#loadstate)中に発生します。 レジストリから最初のウィンドウの配置を読み込む必要がない場合は、 *Benable*を FALSE に設定してこのメソッドを呼び出します。

##  <a name="enabletearoffmenus"></a>CWinAppEx:: EnableTearOffMenus

[CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md)オブジェクトを作成し、初期化します。

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>パラメーター

*lpszRegEntry*<br/>
からレジストリキーのパスを含む文字列。 アプリケーションでは、このレジストリキーを使用して、ティアオフメニューの情報を格納します。

*uiCmdFirst*<br/>
から最初のティアオフメニュー ID。

*uiCmdLast*<br/>
から最後のティアオフメニュー ID。

### <a name="return-value"></a>戻り値

`CMenuTearOffManager` が作成され、正常に初期化された場合は TRUE です。エラーが発生した場合、または `CMenuTearOffManager` が既に存在する場合は FALSE。

### <a name="remarks"></a>解説

アプリケーションでティアオフメニューを有効にするには、この関数を使用します。 `InitInstance`からこの関数を呼び出す必要があります。

##  <a name="enableusertools"></a>CWinAppEx:: EnableUserTools

アプリケーションのキー入力を減らすカスタムメニューコマンドをユーザーが作成できるようにします。 このメソッドは、 [Cuserツールマネージャー](../../mfc/reference/cusertoolsmanager-class.md)オブジェクトを作成します。

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>パラメーター

*uiCmdToolsDummy*<br/>
からフレームワークがユーザーツールメニューのコマンド ID のプレースホルダーとして使用する符号なし整数。

*uiCmdFirst*<br/>
から最初のユーザーツールコマンドのコマンド ID。

*uiCmdLast*<br/>
から最後のユーザーツールコマンドのコマンド ID。

*pToolRTC*<br/>
から`CUserToolsManager` オブジェクトが新しいユーザーツールを作成するために使用するクラス。

*uArgMenuID*<br/>
から引数メニュー ID。

*uInitDirMenuID*<br/>
から初期ツールディレクトリのメニュー ID。

### <a name="return-value"></a>戻り値

メソッドが `CUserToolsManager` オブジェクトを作成および初期化する場合は TRUE。メソッドが失敗した場合、または `CUserToolsManager` オブジェクトが既に存在する場合は FALSE。

### <a name="remarks"></a>解説

ユーザー定義ツールを有効にすると、フレームワークは、カスタマイズ時に拡張可能な動的メニューを自動的にサポートします。 フレームワークによって、各新しい項目が外部コマンドに関連付けられます。 フレームワークは、ユーザーが **[ツール]** メニューから適切な項目を選択すると、これらのコマンドを呼び出します。

ユーザーが新しい項目を追加するたびに、フレームワークによって新しいオブジェクトが作成されます。 新しいオブジェクトのクラス型は、 *Ptoolrtc*によって定義されます。 *Ptoolrtc*クラスの型は、 [cusertool クラス](../../mfc/reference/cusertool-class.md)から派生する必要があります。

ユーザーツールとそれらをアプリケーションに組み込む方法の詳細については、「[ユーザー定義ツール](../../mfc/user-defined-tools.md)」を参照してください。

##  <a name="exitinstance"></a>CWinAppEx:: ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

##  <a name="getbinary"></a>CWinAppEx:: GetBinary

指定されたレジストリキーからバイナリデータを読み取ります。

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリキーの名前を含む文字列。

*ppData*<br/>
入出力メソッドがバイナリデータを格納するバッファーへのポインター。

*pBytes*<br/>
入出力読み取ったバイト数を書き込むためにメソッドが使用する符号なし整数へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、レジストリに書き込まれたバイナリデータを読み取ります。 レジストリにデータを書き込むには、 [CWinAppEx:: WriteBinary](#writebinary)と[CWinAppEx:: WriteSectionBinary](#writesectionbinary)メソッドを使用します。

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getcontextmenumanager"></a>CWinAppEx:: GetContextMenuManager

グローバル[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)オブジェクトへのポインターを返します。

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>戻り値

グローバル `CContextMenuManager` オブジェクトへのポインター。

### <a name="remarks"></a>解説

CContextMenuManager オブジェクトが初期化されていない場合、この関数は、ポインターを返す前に[CWinAppEx:: InitContextMenuManager](#initcontextmenumanager)を呼び出します。

##  <a name="getdataversion"></a>CWinAppEx:: GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

##  <a name="getdataversionmajor"></a>CWinAppEx:: GetDataVersionMajor

[CWinAppEx:: SaveState](#savestate)を呼び出すと、Windows レジストリに保存されているアプリケーションのメジャーバージョンを返します。

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>戻り値

メジャーバージョン番号を含む整数値です。

##  <a name="getdataversionminor"></a>CWinAppEx:: GetDataVersionMinor

[CWinAppEx:: SaveState](#savestate)を呼び出すと、Windows レジストリに保存されているアプリケーションのマイナーバージョンを返します。

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>戻り値

マイナーバージョン番号を含む整数値です。

##  <a name="getint"></a>CWinAppEx:: GetInt

指定されたレジストリキーから整数データを読み取ります。

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリエントリの名前を含む文字列。

*nDefault*<br/>
から指定されたレジストリエントリが存在しない場合に、メソッドが返す既定値。

### <a name="return-value"></a>戻り値

メソッドが正常に実行された場合は、レジストリデータそれ以外の場合は*Ndefault*です。

### <a name="remarks"></a>解説

このメソッドは、レジストリから整数データを読み取ります。 *LpszEntry*で指定されたレジストリキーに関連付けられた整数データがない場合、このメソッドは*ndefault*を返します。 レジストリにデータを書き込むには、 [CWinAppEx:: WriteSectionInt](#writesectionint)メソッドと[CWinAppEx:: writeint](#writeint)メソッドを使用します。

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getkeyboardmanager"></a>CWinAppEx:: Get Manager

グローバル[Cて manager](../../mfc/reference/ckeyboardmanager-class.md)オブジェクトへのポインターを返します。

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>戻り値

グローバル `CKeyboardManager` オブジェクトへのポインター。

### <a name="remarks"></a>解説

キーボードマネージャーが初期化されていない場合、この関数はポインターを返す前に[CWinAppEx:: Initkeyboard manager](#initkeyboardmanager)を呼び出します。

##  <a name="getmousemanager"></a>CWinAppEx:: GetMouseManager

グローバル[Cmousemanager](../../mfc/reference/cmousemanager-class.md)オブジェクトへのポインターを返します。

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>戻り値

グローバル `CMouseManager` オブジェクトへのポインター。

### <a name="remarks"></a>解説

マウスマネージャーが初期化されていない場合、この関数はポインターを返す前に[CWinAppEx:: InitMouseManager](#initmousemanager)を呼び出します。

##  <a name="getobject"></a>CWinAppEx:: GetObject

派生データをレジストリ[から読み取ります](../../mfc/reference/cobject-class.md)。

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリエントリの相対パスを含む文字列。

*obj*<br/>
入出力`CObject`への参照。 メソッドは、この参照を使用してレジストリデータを格納します。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>解説

このメソッドは、`CObject`から派生したレジストリからデータを読み取ります。 `CObject` データをレジストリに書き込むには、 [CWinAppEx:: WriteObject](#writeobject)または[CWinAppEx:: WriteSectionObject](#writesectionobject)のいずれかを使用します。

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getregistrybase"></a>CWinAppEx:: GetRegistryBase

アプリケーションの既定のレジストリパスを取得します。

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>戻り値

既定のレジストリの場所のパスを含む文字列。

### <a name="remarks"></a>解説

レジストリにアクセスする[CWinAppEx クラス](../../mfc/reference/cwinappex-class.md)のすべてのメソッドは、既定の場所で開始されます。 このメソッドを使用して、既定のレジストリの場所のパスを取得します。 既定のレジストリの場所を変更するには、 [CWinAppEx:: SetRegistryBase](#setregistrybase)を使用します。

##  <a name="getregsectionpath"></a>CWinAppEx:: GetRegSectionPath

レジストリキーの絶対パスを作成して返します。

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>パラメーター

*szSectionAdd*<br/>
からレジストリキーの相対パスを含む文字列。

### <a name="return-value"></a>戻り値

レジストリキーの絶対パスを格納している `CString`。

### <a name="remarks"></a>解説

このメソッドは、アプリケーションの既定のレジストリの場所に、 *Szsectionadd*の相対パスを追加することによって、レジストリキーの絶対パスを定義します。 既定のレジストリキーを取得するには、 [CWinAppEx:: GetRegistryBase](#getregistrybase)メソッドを使用します。

##  <a name="getsectionbinary"></a>CWinAppEx:: GetSectionBinary

レジストリからバイナリデータを読み取ります。

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの相対パスを含む文字列。

*lpszEntry*<br/>
から読み取る値を格納している文字列。

*ppData*<br/>
入出力メソッドがデータを格納するバッファーへのポインター。

*pBytes*<br/>
入出力符号なし整数へのポインター。 メソッドは、このパラメーターに*Ppdata*のサイズを書き込みます。

### <a name="return-value"></a>戻り値

成功した場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、 [CWinAppEx:: WriteBinary](#writebinary)と[CWinAppEx:: WriteSectionBinary](#writesectionbinary)メソッドを使用して、レジストリに書き込まれたバイナリデータを読み取ります。

*Lpszsubsection セクション*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getsectionint"></a>CWinAppEx:: GetSectionInt

レジストリから整数データを読み取ります。

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの相対パスを含む文字列。

*lpszEntry*<br/>
から読み取る値を格納している文字列。

*nDefault*<br/>
から指定した値が存在しない場合に返す既定値。

### <a name="return-value"></a>戻り値

指定したレジストリ値に格納されている整数データ。データが存在しない場合は、 *Ndefault*です。

### <a name="remarks"></a>解説

[CWinAppEx:: WriteInt](#writeint)と[CWinAppEx:: WriteSectionInt](#writesectionint)メソッドを使用して、整数データをレジストリに書き込みます。

*Lpszsubsection セクション*のパラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getsectionobject"></a>CWinAppEx:: GetSectionObject

[CObject](../../mfc/reference/cobject-class.md)レジストリデータをレジストリから読み取ります。

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの相対パスを含む文字列。

*lpszEntry*<br/>
から読み取る値を格納している文字列。

*obj*<br/>
入出力`CObject`への参照。 このメソッドは、この `CObject` を使用してレジストリデータを格納します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>解説

このメソッドは、レジストリからデータを読み取ります。 読み取られるデータ `CObject` は、データ、または `CObject`から派生したクラスのデータです。 `CObject` データをレジストリに書き込むには、 [CWinAppEx:: WriteObject](#writeobject)または[CWinAppEx:: WriteSectionObject](#writesectionobject)のいずれかを使用します。

*Lpszsubsection セクション*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getsectionstring"></a>CWinAppEx:: GetSectionString

レジストリから文字列データを読み取ります。

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの相対パスを含む文字列。

*lpszEntry*<br/>
から読み取る値を格納している文字列。

*lpszDefault*<br/>
から指定した値が存在しない場合に返す既定値。

### <a name="return-value"></a>戻り値

データが存在する場合は、指定したレジストリ値に格納されている文字列データ。それ以外の場合は、 *Lpszdefault*です。

### <a name="remarks"></a>解説

このメソッドは、レジストリに書き込まれた文字列データを読み取ります。 [CWinAppEx:: WriteString](#writestring)と[CWinAppEx:: WriteSectionString](#writesectionstring)を使用して、文字列データをレジストリに書き込みます。

*Lpszsubsection セクション*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="getshellmanager"></a>CWinAppEx:: GetShellManager

グローバル[Cshellmanager](../../mfc/reference/cshellmanager-class.md)オブジェクトへのポインターを返します。

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>戻り値

グローバル `CShellManager` オブジェクトへのポインター。

### <a name="remarks"></a>解説

`CShellManager` オブジェクトが初期化されていない場合、この関数はポインターを返す前に[CWinAppEx:: InitShellManager](#initshellmanager)を呼び出します。

##  <a name="getstring"></a>CWinAppEx:: GetString

指定されたレジストリキーから文字列データを読み取ります。

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリキーの名前を含む文字列

*lpzDefault*<br/>
から指定されたレジストリエントリが存在しない場合に、メソッドが返す既定値。

### <a name="return-value"></a>戻り値

成功した場合はレジストリに格納されている文字列データ。*Lpszdefault*それ以外の場合は。

### <a name="remarks"></a>解説

このメソッドは、レジストリに書き込まれた文字列データを読み取ります。 レジストリにデータを書き込むには、 [CWinAppEx:: WriteString](#writestring)メソッドまたは[CWinAppEx:: WriteSectionString](#writesectionstring)メソッドを使用します。

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="gettooltipmanager"></a>CWinAppEx:: GetTooltipManager

グローバル[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)オブジェクトへのポインターを返します。

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>戻り値

グローバル `CTooltipManager` オブジェクトへのポインター。

### <a name="remarks"></a>解説

`CTooltipManager` オブジェクトが初期化されていない場合、この関数はポインターを返す前に[CWinAppEx:: InitTooltipManager](#inittooltipmanager)を呼び出します。

##  <a name="getusertoolsmanager"></a>CWinAppEx:: Getuserツールマネージャー

グローバル[Cuserツールマネージャー](../../mfc/reference/cusertoolsmanager-class.md)オブジェクトへのポインターを返します。

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>戻り値

グローバル `CUserToolsManager` オブジェクトへのポインター。アプリケーションでユーザーツールの管理が有効になっていない場合は NULL になります。

### <a name="remarks"></a>解説

`CUserToolsManager` オブジェクトへのポインターを取得する前に、 [CWinAppEx:: EnableUserTools](#enableusertools)を呼び出してマネージャーを初期化する必要があります。

##  <a name="initcontextmenumanager"></a>CWinAppEx:: InitContextMenuManager

[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)オブジェクトを初期化します。

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>戻り値

メソッドが CContextMenuManager オブジェクトを作成する場合は0以外の。`CContextMenuManager` オブジェクトが既に存在する場合は0。

### <a name="remarks"></a>解説

[CWinAppEx:: GetContextMenuManager](#getcontextmenumanager)を呼び出すと、そのメソッドの既定の実装では `InitContextMenuManager`が呼び出されます。

アプリケーションにコンテキストメニューマネージャーが既に存在し、`InitContextMenuManager`を呼び出すと、アプリケーションで[アサート](diagnostic-services.md#assert)エラーが発生します。 したがって、`CContextMenuManager` オブジェクトを直接作成する場合は、`InitContextMenuManager` を呼び出さないでください。 カスタム `CContextMenuManager`を使用しない場合は、`GetContextMenuManager` を使用して `CContextMenuManager` オブジェクトを作成する必要があります。

##  <a name="initkeyboardmanager"></a>CWinAppEx:: Init# manager

[Cの管理者](../../mfc/reference/ckeyboardmanager-class.md)オブジェクトを初期化します。

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>戻り値

メソッドが `CKeyboardManager` オブジェクトを作成する場合は0以外の。`CKeyboardManager` オブジェクトが既に存在する場合は0。

### <a name="remarks"></a>解説

[CWinAppEx:: Get manager](#getkeyboardmanager)を呼び出すと、そのメソッドの既定の実装では `InitKeyboardManager`が呼び出されます。

アプリケーションに既にキーボードマネージャーがあり、`InitKeyboardManager`を呼び出すと、アプリケーションで[アサート](diagnostic-services.md#assert)エラーが発生します。 したがって、`CKeyboardManager` オブジェクトを直接作成する場合は、`InitKeyboardManager` を呼び出さないでください。 カスタム `CKeyboardManager`を使用しない場合は、`GetKeyboardManager` を使用して `CKeyboardManager` オブジェクトを作成する必要があります。

##  <a name="initmousemanager"></a>CWinAppEx:: InitMouseManager

[Cmousemanager](../../mfc/reference/cmousemanager-class.md)オブジェクトを初期化します。

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>戻り値

メソッドが `CMouseManager` オブジェクトを作成する場合は0以外の。`CMouseManager` オブジェクトが既に存在する場合は0。

### <a name="remarks"></a>解説

[CWinAppEx:: GetMouseManager](#getmousemanager)を呼び出すと、そのメソッドの既定の実装では `InitMouseManager`が呼び出されます。

アプリケーションに既にマウスマネージャーがあり、`InitMouseManager`を呼び出すと、アプリケーションで[アサート](diagnostic-services.md#assert)エラーが発生します。 したがって、`CMouseManager` オブジェクトを直接作成する場合は、`InitMouseManager` を呼び出さないでください。 カスタム `CMouseManager`を使用しない場合は、`GetMouseManager` を使用して `CMouseManager` オブジェクトを作成する必要があります。

##  <a name="initshellmanager"></a>CWinAppEx:: InitShellManager

[Cshellmanager](../../mfc/reference/cshellmanager-class.md)オブジェクトを初期化します。

```
BOOL InitShellManager();
```

### <a name="return-value"></a>戻り値

メソッドが `CShellManager` オブジェクトを作成する場合は0以外の。`CShellManager` オブジェクトが既に存在する場合は0。

### <a name="remarks"></a>解説

[CWinAppEx:: GetShellManager](#getshellmanager)を呼び出すと、そのメソッドの既定の実装では `InitShellManager`が呼び出されます。

アプリケーションに既にシェルマネージャーがあり、`InitShellManager`を呼び出すと、アプリケーションで[アサート](diagnostic-services.md#assert)エラーが発生します。 したがって、`CShellManager` オブジェクトを直接作成する場合は、`InitShellManager` を呼び出さないでください。 カスタム `CShellManager`を使用しない場合は、`GetShellManager` を使用して `CShellManager` オブジェクトを作成します。

##  <a name="inittooltipmanager"></a>CWinAppEx:: InitTooltipManager

[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)オブジェクトを初期化します。

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>戻り値

メソッドが `CTooltipManager` オブジェクトを作成する場合は0以外の。`CTooltipManager` オブジェクトが既に存在する場合は0。

### <a name="remarks"></a>解説

[CWinAppEx:: GetTooltipManager](#gettooltipmanager)を呼び出すと、そのメソッドの既定の実装では `InitTooltipManager`が呼び出されます。

アプリケーションに既にツールヒントマネージャーがあり、`InitTooltipManager`を呼び出すと、アプリケーションで[アサート](diagnostic-services.md#assert)エラーが発生します。 したがって、`CTooltipManager` オブジェクトを直接作成する場合は、`InitTooltipManager` を呼び出さないでください。 カスタム `CTooltipManager`を使用しない場合は、`GetTooltipManager` を使用して `CTooltipManager` オブジェクトを作成する必要があります。

##  <a name="isresourcesmartupdate"></a>CWinAppEx:: IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

##  <a name="isstateexists"></a>CWinAppEx:: IsStateExists

指定されたキーがレジストリ内に存在するかどうかを示します。

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>パラメーター

*lpszSectionName*<br/>
からレジストリキーのパスを含む文字列。

### <a name="return-value"></a>戻り値

キーがレジストリ内にある場合は0以外の値。それ以外の場合は0です。

##  <a name="loadcustomstate"></a>CWinAppEx:: LoadCustomState

フレームワークは、レジストリからアプリケーションの状態を読み込んだ後に、このメソッドを呼び出します。

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>解説

アプリケーションがレジストリから状態を読み込んだ後に処理を実行する場合は、このメソッドをオーバーライドします。 既定では、このメソッドは何も行いません。

レジストリからカスタム状態情報を読み込むには、まず[CWinAppEx:: SaveCustomState](#savecustomstate)を使用して情報を保存する必要があります。

##  <a name="loadstate"></a>CWinAppEx:: LoadState

Windows レジストリからアプリケーションの状態を読み取ります。

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>パラメーター

*pFrame*<br/>
からフレームウィンドウオブジェクトへのポインター。 メソッドは、レジストリ内の状態情報をこのフレームウィンドウに適用します。

*lpszSectionName*<br/>
からレジストリキーの相対パスを含む文字列。

*Pフレーム Impl*<br/>
から`CFrameImpl` オブジェクトへのポインター。 メソッドは、レジストリ内の状態情報をこのフレームウィンドウに適用します。

### <a name="return-value"></a>戻り値

成功した場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>解説

このメソッドは、アプリケーションの状態とフレームウィンドウの状態情報を読み込みます。 フレームウィンドウに読み込まれた情報が、指定されたフレームウィンドウに適用されます。 フレームウィンドウを指定しない場合は、アプリケーションの状態情報のみが読み込まれます。 アプリケーション情報には、 [Cmousemanager クラス](../../mfc/reference/cmousemanager-class.md)、 [CContextMenuManager クラス、c](../../mfc/reference/ccontextmenumanager-class.md) [Manager](../../mfc/reference/ckeyboardmanager-class.md)クラス、 [ckeyboardmanager manager](../../mfc/reference/cusertoolsmanager-class.md)クラスの状態が含まれます。

`CFrameImpl::OnLoadFrame` の既定の実装では `LoadState`が呼び出されます。

*Lpszsectionname*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="loadwindowplacement"></a>CWinAppEx:: LoadWindowPlacement

メインフレームウィンドウのサイズと位置をレジストリから読み込むときに、フレームワークによって呼び出されます。

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>パラメーター

*rectNormalPosition*<br/>
入出力メインフレームウィンドウが復元された位置にあるときの、その座標を含む四角形。

*nFlags*<br/>
入出力最小化されたウィンドウの位置と、最小化されたウィンドウと復元されたウィンドウとの間でオペレーティングシステムがどのように切り替わるかを制御するフラグ。

*nShowCmd*<br/>
入出力ウィンドウの表示状態を指定する整数。 使用可能な値の詳細については、「 [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)」を参照してください。

### <a name="return-value"></a>戻り値

成功した場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>解説

既定では、アプリケーションの起動時に、メインフレームウィンドウの前の位置と状態が MFC によって自動的に読み込まれます。 この情報をレジストリに格納する方法の詳細については、「 [CWinAppEx:: StoreWindowPlacement](#storewindowplacement)」を参照してください。

メインフレームウィンドウに関する追加情報を読み込む場合は、このメソッドをオーバーライドします。

##  <a name="m_bforceimagereset"></a>CWinAppEx:: m_bForceImageReset

ツールバーを含むフレームウィンドウを再読み込みするときに、フレームワークがすべてのツールバーイメージをリセットするかどうかを指定します。

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>解説

`m_bForceImageReset` データメンバーは保護された変数です。

##  <a name="onappcontexthelp"></a>CWinAppEx:: OnAppContextHelp

フレームワークは、ユーザーが**カスタマイズ**ダイアログボックスのコンテキストヘルプを要求したときに、このメソッドを呼び出します。

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>パラメーター

*pWndControl*<br/>
からユーザーがコンテキストヘルプを呼び出したウィンドウオブジェクトへのポインター。

*dwHelpIDArray[]*<br/>
から予約済みの値。

### <a name="remarks"></a>解説

このメソッドは、現在、将来使用するために予約されています。 既定の実装では、何も実行されず、現在フレームワークによって呼び出されていません。

##  <a name="onclosingmainframe"></a>CWinAppEx:: OnClosingMainFrame フレーム

フレームワークは、フレームウィンドウが WM_CLOSE を処理しているときに、このメソッドを呼び出します。

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>パラメーター

*Pフレーム Impl*<br/>
から`CFrameImpl` オブジェクトへのポインター。

### <a name="remarks"></a>解説

このメソッドの既定の実装では、 *Pフレーム impl*の状態が保存されます。

##  <a name="onviewdoubleclick"></a>CWinAppEx:: OnViewDoubleClick

ビュー内の任意の場所をダブルクリックすると、ビューに関連付けられているユーザー定義コマンドを呼び出します。

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
から[CView クラス](../../mfc/reference/cview-class.md)から派生したオブジェクトへのポインター。

*iViewId*<br/>
からビュー ID。

### <a name="return-value"></a>戻り値

フレームワークがコマンドを検出した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

マウスのカスタム動作をサポートするには、WM_LBUTTONDBLCLK メッセージを処理するときに、この関数を呼び出す必要があります。 このメソッドは、 *iViewId*によって提供されるビュー ID に関連付けられたコマンドを実行します。 マウスのカスタム動作の詳細については、「[キーボードおよびマウスのカスタマイズ](../../mfc/keyboard-and-mouse-customization.md)」を参照してください。

##  <a name="onworkspaceidle"></a>CWinAppEx:: OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>パラメーター

から*CWnd&#38;*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>解説

##  <a name="preloadstate"></a>CWinAppEx::P reLoadState

フレームワークは、レジストリからアプリケーションの状態を読み込む直前に、このメソッドを呼び出します。

```
virtual void PreLoadState();
```

### <a name="remarks"></a>解説

フレームワークがアプリケーションの状態を読み込む直前に処理を実行する場合は、このメソッドをオーバーライドします。

##  <a name="presavestate"></a>CWinAppEx::P reSaveState

フレームワークは、アプリケーションの状態を保存する直前にこのメソッドを呼び出します。

```
virtual void PreSaveState();
```

### <a name="remarks"></a>解説

フレームワークがアプリケーションの状態を保存する直前に処理を実行する場合は、このメソッドをオーバーライドします。

##  <a name="reloadwindowplacement"></a>CWinAppEx:: ReloadWindowPlacement

レジストリからウィンドウのサイズと場所を再読み込みします。

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>パラメーター

*pFrame*<br/>
からフレームウィンドウへのポインター。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は0以外の。読み込みが失敗した場合、または読み込むデータが存在しない場合は0。

### <a name="remarks"></a>解説

ウィンドウのサイズと場所をレジストリに書き込むには、関数[CWinAppEx:: StoreWindowPlacement](#storewindowplacement)を使用します。

##  <a name="savecustomstate"></a>CWinAppEx:: SaveCustomState

フレームワークは、アプリケーションの状態をレジストリに保存した後に、このメソッドを呼び出します。

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>解説

アプリケーションが状態をレジストリに保存した後に処理を実行する場合は、このメソッドをオーバーライドします。 既定では、このメソッドは何も行いません。

##  <a name="savestate"></a>CWinAppEx:: SaveState

アプリケーションの状態を Windows レジストリに書き込みます。

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>パラメーター

*lpszSectionName*<br/>
からレジストリキーの相対パスを含む文字列。

*Pフレーム Impl*<br/>
から`CFrameImpl` オブジェクトへのポインター。 このフレームは、Windows レジストリに保存されます。

*pFrame*<br/>
からフレームウィンドウオブジェクトへのポインター。 このフレームは、Windows レジストリに保存されます。

### <a name="return-value"></a>戻り値

成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、指定されたフレームウィンドウのアプリケーションの状態と状態情報を保存します。 フレームウィンドウを指定しない場合、メソッドはアプリケーションの状態のみを保存します。 アプリケーション情報には、 [Cmousemanager クラス](../../mfc/reference/cmousemanager-class.md)、 [CContextMenuManager クラス、c](../../mfc/reference/ccontextmenumanager-class.md) [Manager](../../mfc/reference/ckeyboardmanager-class.md)クラス、 [ckeyboardmanager manager](../../mfc/reference/cusertoolsmanager-class.md)クラスの状態が含まれます。

*Lpszsectionname*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

##  <a name="setregistrybase"></a>CWinAppEx:: SetRegistryBase

アプリケーションの既定のレジストリパスを設定します。

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>パラメーター

*lpszSectionName*<br/>
からレジストリキーのパスを含む文字列。

### <a name="return-value"></a>戻り値

既定のレジストリの場所のパスを含む文字列。

### <a name="remarks"></a>解説

レジストリにアクセスする[CWinAppEx クラス](../../mfc/reference/cwinappex-class.md)のすべてのメソッドは、既定の場所で開始されます。 この既定のレジストリの場所を変更するには、この方法を使用します。 既定のレジストリの場所を取得するには、 [CWinAppEx:: GetRegistryBase](#getregistrybase)を使用します。

##  <a name="showpopupmenu"></a>CWinAppEx:: ShowPopupMenu

ポップアップメニューを表示します。

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

*uiMenuResId*<br/>
からメニューリソース ID。

*視点*<br/>
からメニューの位置を画面座標で指定する[CPoint](../../atl-mfc-shared/reference/cpoint-class.md) 。

*pWnd*<br/>
からポップアップメニューを所有しているウィンドウへのポインター。

### <a name="return-value"></a>戻り値

ポップアップメニューが正常に表示された場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>解説

このメソッドは、 *uiMenuResId*に関連付けられているメニューを表示します。

ポップアップメニューをサポートするには、 [CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)オブジェクトが必要です。 `CContextMenuManager` オブジェクトを初期化していない場合、`ShowPopupMenu` は失敗します。

##  <a name="storewindowplacement"></a>CWinAppEx:: StoreWindowPlacement

メインフレームウィンドウのサイズと位置をレジストリに書き込むために、フレームワークによって呼び出されます。

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>パラメーター

*nFlags*<br/>
から最小化されたウィンドウの位置と、最小化されたウィンドウと復元されたウィンドウとの間でオペレーティングシステムがどのように切り替わるかを制御するフラグ。

*nShowCmd*<br/>
からウィンドウの表示状態を指定する整数。 使用可能な値の詳細については、「 [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)」を参照してください。

*rectNormalPosition*<br/>
からメインフレームウィンドウが復元された状態にあるときの、その座標を含む四角形。

### <a name="return-value"></a>戻り値

成功した場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>解説

既定では、メインフレームウィンドウの位置と状態は、MFC によってアプリケーションが終了する前に自動的に保存されます。 この情報は、アプリケーションの既定のレジストリの場所にある WindowPlacement キーの下の Windows レジストリに格納されます。 アプリケーションの既定のレジストリの場所の詳細については、「 [CWinAppEx:: GetRegistryBase](#getregistrybase)」を参照してください。

メインフレームウィンドウに関する追加情報を格納する場合は、このメソッドをオーバーライドします。

##  <a name="writebinary"></a>CWinAppEx:: WriteBinary

バイナリデータをレジストリに書き込みます。

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリキーの名前を含む文字列。

*pData*<br/>
から格納するデータ。

*nBytes*<br/>
から*PData*のサイズ (バイト単位)。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LpszEntry*によって指定されたキーが存在しない場合は、このメソッドによって作成されます。

##  <a name="writeint"></a>CWinAppEx:: WriteInt

数値データをレジストリに書き込みます。

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリキーの名前を含む文字列。

*N 値*<br/>
から格納するデータ。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LpszEntry*によって指定されたキーが存在しない場合は、このメソッドによって作成されます。

##  <a name="writeobject"></a>CWinAppEx:: WriteObject

[CObject クラス](../../mfc/reference/cobject-class.md)から派生したデータをレジストリに書き込みます。

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
から設定する値を格納している文字列。

*obj*<br/>
からメソッドが格納する `CObject` データへの参照。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

このメソッドは、既定のレジストリキーの下にある指定された値に*obj*データを書き込みます。 現在のレジストリキーを確認するには、 [CWinAppEx:: GetRegistryBase](#getregistrybase)を使用します。

##  <a name="writesectionbinary"></a>CWinAppEx:: WriteSectionBinary

バイナリデータをレジストリの値に書き込みます。

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの名前を含む文字列

*lpszEntry*<br/>
から設定する値を格納している文字列。

*pData*<br/>
からレジストリに書き込むデータ。

*nBytes*<br/>
から*PData*のサイズ (バイト単位)。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*Lpszsubsection セクション*のパラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LpszEntry*によって指定されたキーが存在しない場合は、このメソッドによって作成されます。

##  <a name="writesectionint"></a>CWinAppEx:: WriteSectionInt

数値データをレジストリに書き込みます。

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの相対パスを含む文字列。

*lpszEntry*<br/>
から設定する値を格納している文字列。

*N 値*<br/>
からレジストリに書き込むデータ。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*Lpszsubsection セクション*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーに追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LpszEntry*によって指定されたキーが存在しない場合は、このメソッドによって作成されます。

##  <a name="writesectionobject"></a>CWinAppEx:: WriteSectionObject

[CObject クラス](../../mfc/reference/cobject-class.md)から派生したデータを特定のレジストリ値に書き込みます。

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの名前を含む文字列。

*lpszEntry*<br/>
から設定する値の名前を含む文字列。

*obj*<br/>
から格納するデータ。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*Lpszsubsection セクション*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LpszEntry*によって指定された値が*lpszsubsection セクション*で指定されたレジストリキーの下に存在しない場合、このメソッドはその値を作成します。

##  <a name="writesectionstring"></a>CWinAppEx:: WriteSectionString

文字列データをレジストリの値に書き込みます。

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>パラメーター

*lpszSubSection セクション*<br/>
からレジストリキーの名前を含む文字列。

*lpszEntry*<br/>
から設定する値を格納している文字列。

*lpszValue*<br/>
からレジストリに書き込む文字列データ。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*Lpszsubsection セクション*パラメーターは、レジストリエントリの絶対パスではありません。 これは、アプリケーションの既定のレジストリキーの末尾に追加される相対パスです。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LpszEntry*によって指定された値が*lpszsubsection セクション*の下に存在しない場合は、このメソッドによって作成されます。

##  <a name="writestring"></a>CWinAppEx:: WriteString

文字列データをレジストリに書き込みます。

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>パラメーター

*lpszEntry*<br/>
からレジストリキーの名前を含む文字列。

*lpszValue*<br/>
から格納するデータ。

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>解説

*LpszEntry*パラメーターは、アプリケーションの既定のレジストリキーの下にあるレジストリエントリの名前です。 既定のレジストリキーを取得または設定するには、メソッド[CWinAppEx:: getregistrybase](#getregistrybase)と[CWinAppEx:: setregistrybase](#setregistrybase)をそれぞれ使用します。

*LspzEntry*によって指定されたキーが存在しない場合は、このメソッドによって作成されます。

## <a name="see-also"></a>参照

[階層図](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[CWinApp クラス](../../mfc/reference/cwinapp-class.md)<br/>
[CMouseManager クラス](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager クラス](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[CKeyboardManager クラス](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[CUserToolsManager クラス](../../mfc/reference/cusertoolsmanager-class.md)
