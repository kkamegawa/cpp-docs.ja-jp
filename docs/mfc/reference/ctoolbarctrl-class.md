---
title: CToolBarCtrl クラス
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 6f15280943fce39bae4eebfb537f9a61d256d2e8
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69502288"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl クラス

Windows ツール バー コモン コントロールの機能が用意されています。

## <a name="syntax"></a>構文

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CToolBarCtrl:: CToolBarCtrl](#ctoolbarctrl)|`CToolBarCtrl` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CToolBarCtrl:: AddBitmap](#addbitmap)|1つまたは複数のビットマップボタンイメージを、ツールバーコントロールに使用できるボタンイメージの一覧に追加します。|
|[CToolBarCtrl:: AddButtons](#addbuttons)|ツールバーコントロールに1つ以上のボタンを追加します。|
|[CToolBarCtrl::AddString](#addstring)|リソース ID として渡された新しい文字列を、ツールバーの文字列の内部リストに追加します。|
|[CToolBarCtrl:: AddStrings](#addstrings)|Null で区切られた文字列のバッファーへのポインターとして渡される新しい文字列を、ツールバーの文字列の内部リストに追加します。|
|[CToolBarCtrl:: AutoSize](#autosize)|ツールバーコントロールのサイズを変更します。|
|[CToolBarCtrl:: ChangeBitmap](#changebitmap)|現在のツールバーコントロールのボタンのビットマップを変更します。|
|[CToolBarCtrl:: CheckButton](#checkbutton)|ツールバーコントロールの特定のボタンをオンまたはオフにします。|
|[CToolBarCtrl:: CommandToIndex](#commandtoindex)|指定したコマンド識別子に関連付けられているボタンの0から始まるインデックスを取得します。|
|[CToolBarCtrl:: Create](#create)|ツールバーコントロールを作成し、 `CToolBarCtrl`オブジェクトにアタッチします。|
|[CToolBarCtrl:: CreateEx](#createex)|指定した Windows 拡張スタイルを使用して toolbar コントロールを作成し`CToolBarCtrl` 、オブジェクトに添付します。|
|[CToolBarCtrl:: Customize](#customize)|[ツールバーのカスタマイズ] ダイアログボックスを表示します。|
|[CToolBarCtrl::D eleteButton](#deletebutton)|ツールバーコントロールからボタンを削除します。|
|[CToolBarCtrl:: EnableButton](#enablebutton)|ツールバーコントロールの指定したボタンを有効または無効にします。|
|[CToolBarCtrl:: GetAnchorHighlight](#getanchorhighlight)|ツールバーのアンカーの強調表示の設定を取得します。|
|[CToolBarCtrl:: GetBitmap](#getbitmap)|ツールバーのボタンに関連付けられているビットマップのインデックスを取得します。|
|[CToolBarCtrl:: GetBitmapFlags](#getbitmapflags)|ツールバーのビットマップに関連付けられているフラグを取得します。|
|[CToolBarCtrl:: GetButton](#getbutton)|ツールバーコントロールの指定したボタンに関する情報を取得します。|
|[CToolBarCtrl:: GetButtonCount](#getbuttoncount)|ツールバーコントロールに現在存在するボタンの数を取得します。|
|[CToolBarCtrl:: GetButtonInfo](#getbuttoninfo)|ツールバーのボタンの情報を取得します。|
|[CToolBarCtrl:: GetButtonSize](#getbuttonsize)|ツールバーボタンの現在の幅と高さをピクセル単位で取得します。|
|[CToolBarCtrl:: GetColorScheme](#getcolorscheme)|現在のツールバーコントロールの配色を取得します。|
|[CToolBarCtrl:: GetDisabledImageList](#getdisabledimagelist)|ツールバーコントロールが無効なボタンを表示するために使用するイメージリストを取得します。|
|[CToolBarCtrl:: GetDropTarget](#getdroptarget)|ツールバーコントロールの[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)インターフェイスを取得します。|
|[CToolBarCtrl:: GetExtendedStyle](#getextendedstyle)|ツールバーコントロールの拡張スタイルを取得します。|
|[CToolBarCtrl:: GetHotImageList](#gethotimagelist)|ツールバーコントロールが "ホット" ボタンを表示するために使用するイメージリストを取得します。 マウスポインターが上にあると、ホットボタンが強調表示されます。|
|[CToolBarCtrl:: GetHotItem](#gethotitem)|ツールバーのホット項目のインデックスを取得します。|
|[CToolBarCtrl:: GetImageList](#getimagelist)|ツールバーコントロールが既定の状態のボタンを表示するために使用するイメージリストを取得します。|
|[CToolBarCtrl:: GetInsertMark](#getinsertmark)|ツールバーの現在の挿入マークを取得します。|
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|ツールバーの挿入マークの描画に使用する色を取得します。|
|[CToolBarCtrl:: GetItemRect](#getitemrect)|ツールバーコントロールのボタンの外接する四角形を取得します。|
|[CToolBarCtrl:: GetMaxSize](#getmaxsize)|ツールバーに表示されているすべてのボタンと区分線の合計サイズを取得します。|
|[CToolBarCtrl:: GetMaxTextRows](#getmaxtextrows)|ツールバーボタンに表示されるテキスト行の最大数を取得します。|
|[CToolBarCtrl:: GetMetrics](#getmetrics)|ツールバーコントロールのメトリックを取得します。|
|[CToolBarCtrl:: GetPadding](#getpadding)|現在のツールバーコントロールの水平方向と垂直方向の余白を取得します。|
|[CToolBarCtrl:: GetPressedImageList](#getpressedimagelist)|現在のツールバーコントロールが押された状態のボタンを表すために使用するイメージリストを取得します。|
|[CToolBarCtrl:: GetRect](#getrect)|指定したツールバーボタンの外接する四角形を取得します。|
|[CToolBarCtrl:: GetRows](#getrows)|ツールバーに現在表示されているボタンの行数を取得します。|
|[CToolBarCtrl:: GetState](#getstate)|ツールバーコントロール内の指定したボタンの状態に関する情報を取得します。このボタンは、有効になっているか、押されているか、チェックされているかなどです。|
|[CToolBarCtrl:: GetString](#getstring)|ツールバーの文字列を取得します。|
|[CToolBarCtrl:: GetStyle](#getstyle)|ツールバーコントロールに現在使用されているスタイルを取得します。|
|[CToolBarCtrl:: GetToolTips ヒント](#gettooltips)|ツールバーコントロールに関連付けられているツールヒントコントロール (存在する場合) のハンドルを取得します。|
|[CToolBarCtrl:: HideButton](#hidebutton)|ツールバーコントロールの指定したボタンを非表示にするか表示します。|
|[CToolBarCtrl:: System.windows.media.visualtreehelper.hittest](#hittest)|ツールバーコントロール内のポイントの位置を決定します。|
|[CToolBarCtrl::Indeterminate](#indeterminate)|ツールバーコントロールの指定したボタンの不確定 (灰色) 状態を設定または解除します。|
|[CToolBarCtrl:: InsertButton](#insertbutton)|ツールバーコントロールにボタンを挿入します。|
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|ツールバーのポイントの挿入マーク情報を取得します。|
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|ツールバーコントロール内の指定したボタンがチェックされているかどうかを示します。|
|[CToolBarCtrl:: IsButtonEnabled](#isbuttonenabled)|ツールバーコントロールの指定したボタンが有効かどうかを示します。|
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|ツールバーコントロール内の指定したボタンが非表示かどうかを示します。|
|[CToolBarCtrl:: IsButtonHighlighted 表示](#isbuttonhighlighted)|ツールバーボタンの強調表示の状態を確認します。|
|[CToolBarCtrl::IsButtonIndeterminate](#isbuttonindeterminate)|ツールバーコントロールの指定したボタンの状態が不確定 (灰色) であるかどうかを示します。|
|[CToolBarCtrl:: IsButtonPressed れました](#isbuttonpressed)|ツールバーコントロール内の指定したボタンが押されたかどうかを示します。|
|[CToolBarCtrl:: LoadImages](#loadimages)|ビットマップをツールバーコントロールのイメージリストに読み込みます。|
|[CToolBarCtrl:: MapAccelerator](#mapaccelerator)|アクセラレータ文字をツールバーボタンにマップします。|
|[CToolBarCtrl:: MarkButton](#markbutton)|ツールバーコントロールの特定のボタンの強調表示の状態を設定します。|
|[CToolBarCtrl:: MoveButton](#movebutton)|あるインデックスから別のインデックスにボタンを移動します。|
|[CToolBarCtrl::P ressButton](#pressbutton)|ツールバーコントロールの指定されたボタンを押すか、または解放します。|
|[CToolBarCtrl:: ReplaceBitmap](#replacebitmap)|現在のツールバーコントロールの既存のビットマップを新しいビットマップに置き換えます。|
|[CToolBarCtrl::RestoreState](#restorestate)|ツールバーコントロールの状態を復元します。|
|[CToolBarCtrl:: SaveState](#savestate)|ツールバーコントロールの状態を保存します。|
|[CToolBarCtrl:: SetAnchorHighlight](#setanchorhighlight)|ツールバーのアンカーの強調表示の設定を設定します。|
|[CToolBarCtrl:: SetBitmapSize](#setbitmapsize)|ツールバーコントロールに追加するビットマップイメージのサイズを設定します。|
|[CToolBarCtrl:: SetButtonInfo](#setbuttoninfo)|ツールバーの既存のボタンの情報を設定します。|
|[CToolBarCtrl:: SetButtonSize](#setbuttonsize)|ツールバーコントロールに追加するボタンのサイズを設定します。|
|[CToolBarCtrl:: SetButtonStructSize](#setbuttonstructsize)|`TBBUTTON`構造体のサイズを指定します。|
|[CToolBarCtrl:: SetButtonWidth](#setbuttonwidth)|ツールバーコントロールのボタンの幅の最小値と最大値を設定します。|
|[CToolBarCtrl:: SetCmdID](#setcmdid)|指定したボタンが押されたときに所有者ウィンドウに送信されるコマンド識別子を設定します。|
|[CToolBarCtrl:: SetColorScheme](#setcolorscheme)|現在のツールバーコントロールの配色を設定します。|
|[CToolBarCtrl:: SetDisabledImageList](#setdisabledimagelist)|ツールバーコントロールが無効にされたボタンを表示するために使用するイメージリストを設定します。|
|[CToolBarCtrl:: SetDrawTextFlags](#setdrawtextflags)|指定した四角形内のテキストを描画するために使用される Win32 関数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)のフラグを設定します。フラグの設定方法に従って書式設定されます。|
|[CToolBarCtrl:: SetExtendedStyle](#setextendedstyle)|ツールバーコントロールの拡張スタイルを設定します。|
|[CToolBarCtrl:: SetHotImageList](#sethotimagelist)|ツールバーコントロールが "ホット" ボタンを表示するために使用するイメージリストを設定します。|
|[CToolBarCtrl:: SetHotItem](#sethotitem)|ツールバーのホット項目を設定します。|
|[CToolBarCtrl:: SetImageList](#setimagelist)|ツールバーが既定の状態のボタンを表示するために使用するイメージリストを設定します。|
|[CToolBarCtrl:: SetIndent](#setindent)|ツールバーコントロールの最初のボタンのインデントを設定します。|
|[CToolBarCtrl:: SetInsertMark](#setinsertmark)|ツールバーの現在の挿入マークを設定します。|
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|ツールバーの挿入マークの描画に使用する色を設定します。|
|[CToolBarCtrl:: SetMaxTextRows](#setmaxtextrows)|ツールバーボタンに表示されるテキスト行の最大数を設定します。|
|[CToolBarCtrl:: SetMetrics](#setmetrics)|ツールバーコントロールのメトリックを設定します。|
|[CToolBarCtrl:: SetOwner](#setowner)|ツールバーコントロールから通知メッセージを受信するウィンドウを設定します。|
|[CToolBarCtrl:: SetPadding](#setpadding)|現在のツールバーコントロールの水平方向と垂直方向の余白を設定します。|
|[CToolBarCtrl:: SetPressedImageList](#setpressedimagelist)|現在のツールバーコントロールが押された状態のボタンを表すために使用するイメージリストを設定します。|
|[CToolBarCtrl:: SetRows](#setrows)|ツールバーに表示されるボタンの行数を設定します。|
|[CToolBarCtrl:: SetState](#setstate)|ツールバーコントロールの指定したボタンの状態を設定します。|
|[CToolBarCtrl:: System.windows.forms.control.setstyle](#setstyle)|ツールバーコントロールのスタイルを設定します。|
|[CToolBarCtrl:: SetToolTips ヒント](#settooltips)|ツールヒントコントロールをツールバーコントロールに関連付けます。|
|[CToolBarCtrl:: SetWindowTheme](#setwindowtheme)|ツールバーコントロールの視覚スタイルを設定します。|

## <a name="remarks"></a>Remarks

このコントロール (および`CToolBarCtrl`クラス) は、windows 95/98 および windows NT バージョン3.51 以降で実行されているプログラムに対してのみ使用できます。

Windows ツールバーコモンコントロールは、1つまたは複数のボタンを含む四角形の子ウィンドウです。 これらのボタンには、ビットマップイメージ、文字列、またはその両方を表示できます。 ユーザーがボタンを選択すると、ツールバーのオーナーウィンドウにコマンドメッセージが送信されます。 通常、ツールバーのボタンは、アプリケーションのメニュー内の項目に対応しています。これにより、ユーザーがアプリケーションのコマンドに直接アクセスできるようになります。

`CToolBarCtrl`オブジェクトにはいくつかの重要な内部データ構造が含まれています。ボタンイメージのビットマップまたはイメージリストのリスト、ボタン`TBBUTTON`のラベル文字列のリスト、およびイメージや文字列を位置、スタイル、状態、およびコマンド ID に関連付ける構造体のリストです。をクリックします。 これらのデータ構造体の各要素は、0から始まるインデックスによって参照されます。 `CToolBarCtrl`オブジェクトを使用する前に、これらのデータ構造を設定する必要があります。 文字列のリストは、ボタンラベルに対してのみ使用できます。ツールバーから文字列を取得することはできません。

`CToolBarCtrl`オブジェクトを使用するには、通常、次の手順を実行します。

1. オブジェクトを`CToolBarCtrl`構築します。

1. [Create](#create)を呼び出して、Windows ツールバーコモンコントロールを作成し、 `CToolBarCtrl`オブジェクトにアタッチします。 スタイルを使用して、ツールバーのスタイルを指定します。たとえば、透明なツールバーの場合は TBSTYLE_TRANSPARENT、ドロップダウンスタイルボタンをサポートするツールバーの場合は TBSTYLE_DROPDOWN です。

1. ツールバーのボタンをどのように表示するかを指定します。

   - ボタンにビットマップイメージを使用するには、 [AddBitmap](#addbitmap)を呼び出して、ボタンのビットマップをツールバーに追加します。

   - イメージリストのボタンに表示されるイメージを使用するには、 [SetImageList](#setimagelist)、 [SetHotImageList](#sethotimagelist)、または[SetDisabledImageList](#setdisabledimagelist)を呼び出してイメージリストを指定します。

   - ボタンに文字列ラベルを使用するには、 [Addstring](#addstring)および/または[addstring](#addstrings)を呼び出して、ツールバーに文字列を追加します。

1. ボタン構造をツールバーに追加するには、 [Addbuttons](#addbuttons)を呼び出します。

1. ではない`CFrameWnd`オーナーウィンドウのツールバーボタンのツールヒントが必要な場合は、「[ツールヒント通知の処理](../../mfc/handling-tool-tip-notifications.md)」で説明されているように、ツールバーの [オーナー] ウィンドウで、TTN_NEEDTEXT メッセージを処理する必要があります。 ツールバーの親ウィンドウがから`CFrameWnd`派生している場合、では、既定のハンドラーが提供されるため`CFrameWnd` 、追加の作業を行わずにツールヒントが表示されます。

1. ユーザーがツールバーをカスタマイズできるようにするには、「[カスタマイズ通知の処理](../../mfc/handling-customization-notifications.md)」の説明に従って、[所有者] ウィンドウでカスタマイズ通知メッセージを処理します。

[SaveState](#savestate)を使用して、ツールバーコントロールの現在の状態をレジストリに保存し、 [restorestate](#restorestate)を使用して、以前にレジストリに格納されていた情報に基づいて状態を復元することができます。 アプリケーションの使用間でツールバーの状態を保存するだけでなく、通常、ユーザーがツールバーのカスタマイズを開始する前に、アプリケーションは状態を保存します。

## <a name="support-for-internet-explorer-version-40-and-later"></a>Internet Explorer バージョン4.0 以降のサポート

Internet Explorer バージョン4.0 以降で導入された機能をサポートするために、MFC では、イメージリストのサポートと、ツールバーコントロールの透明スタイルとフラットスタイルが提供されています。

透過的なツールバーを使用すると、ツールバーの下のクライアントを表示できます。 透明なツールバーを作成するには、TBSTYLE_FLAT と TBSTYLE_TRANSPARENT の両方のスタイルを使用します。 透明なツールバーのホットトラッキング機能つまり、マウスポインターがツールバーのホットなボタンの上に移動すると、ボタンの外観が変化します。 TBSTYLE_FLAT スタイルのみで作成されたツールバーには、透明でないボタンが含まれます。

イメージリストのサポートにより、既定の動作、ホットイメージ、および無効になっているイメージに対する制御の柔軟性が向上します。 [GetImageList](#getimagelist)、 [GetHotImageList](#gethotimagelist)、および[GetDisabledImageList](#getdisabledimagelist)を透明なツールバーと共に使用して、状態に応じてイメージを操作します。

の使用方法`CToolBarCtrl`の詳細については、「 [Controls](../../mfc/controls-mfc.md) and [using CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)」を参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxcmn.h

##  <a name="addbitmap"></a>  CToolBarCtrl::AddBitmap

ツールバーコントロールに格納されているボタンイメージの一覧に、1つまたは複数のボタンイメージを追加します。

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>パラメーター

*nNumButtons*<br/>
ビットマップ内のボタンイメージの数。

*nBitmapID*<br/>
追加するボタンイメージまたはイメージを含むビットマップのリソース識別子。

*pBitmap*<br/>
追加するボタン`CBitmap`イメージまたはイメージを格納しているオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

成功した場合は、最初の新しいイメージの0から始まるインデックス。それ以外の場合は-1。

### <a name="remarks"></a>Remarks

Windows API [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap)を使用して、ビットマップをツールバーに追加する前に色をマップすることができます。 `CBitMap`オブジェクトへのポインターを渡す場合は、ツールバーが破棄されるまでビットマップが破棄されないようにする必要があります。

##  <a name="addbuttons"></a>  CToolBarCtrl::AddButtons

ツールバーコントロールに1つ以上のボタンを追加します。

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>パラメーター

*nNumButtons*<br/>
追加するボタンの数。

*lpButtons*<br/>
追加するボタンに関する`TBBUTTON`情報を格納する構造体の配列のアドレス。 *Nnumbuttons*によって指定されたボタンと同じ数の要素が配列内に存在する必要があります。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

*Lpbuttons*ポインターは、構造体の`TBBUTTON`配列を指します。 各`TBBUTTON`構造体は、ボタンのスタイル、イメージ、または文字列、コマンド ID、状態、およびユーザー定義データを使用して、追加するボタンを関連付けます。

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

メンバーは次のとおりです。

- `iBitmap`

   ボタンイメージの0から始まるインデックス。このボタンにイメージがない場合は-1。

- `idCommand`

   ボタンに関連付けられているコマンド識別子。 この識別子は、ボタンが選択されたときに、WM_COMMAND メッセージで送信されます。 `fsStyle`メンバーに TBSTYLE_SEP 値がある場合、このメンバーはゼロである必要があります。

- `fsState`

   ボタンの状態フラグ。 次に示す値の組み合わせを指定できます。

   - TBSTATE_CHECKED ボタンに TBSTYLE_CHECKED スタイルがあり、押されています。

   - TBSTATE_ENABLED ボタンはユーザー入力を受け入れます。 この状態を持たないボタンはユーザー入力を受け付けず、淡色表示になります。

   - TBSTATE_HIDDEN ボタンが表示されず、ユーザー入力を受け取ることはできません。

   - TBSTATE_INDETERMINATE ボタンがグレーで表示されます。

   - TBSTATE_PRESSED ボタンが押されていることを示します。

   - TBSTATE_WRAP をクリックすると、このボタンの後に改行が続きます。 このボタンには、TBSTATE_ENABLED 状態も含まれている必要があります。

- `fsStyle`

   ボタンのスタイル。 次に示す値の組み合わせを指定できます。

   - TBSTYLE_BUTTON は、標準のプッシュボタンを作成します。

   - TBSTYLE_CHECK は、ユーザーがクリックするたびに、押された状態と unpressed 状態を切り替えるボタンを作成します。 ボタンの背景色は、押された状態のときに異なります。

   - TBSTYLE_CHECKGROUP は、グループ内の別のボタンが押されるまで押された状態を維持するチェックボタンを作成します。

   - TBSTYLE_GROUP は、グループ内の別のボタンが押されるまで押されたままになるボタンを作成します。

   - TBSTYLE_SEP によって区切り文字が作成され、ボタングループ間のギャップが小さくなります。 このスタイルのボタンは、ユーザー入力を受け取りません。

- `dwData`

   ユーザー定義データ。

- `iString`

   ボタンのラベルとして使用する文字列の0から始まるインデックス。このボタンに文字列がない場合は-1。

指定したインデックスを持つイメージや文字列は、 [AddBitmap](#addbitmap)、 [addstring](#addstring)、または[addstring](#addstrings)を使用して、以前にツールバーコントロールの一覧に追加されている必要があります。

##  <a name="addstring"></a>  CToolBarCtrl::AddString

リソース ID として渡された新しい文字列を、ツールバーの文字列の内部リストに追加します。

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>パラメーター

*nStringID*<br/>
ツールバーコントロールの文字列リストに追加する文字列リソースのリソース識別子。

### <a name="return-value"></a>戻り値

成功した場合に追加された最初の新しい文字列の0から始まるインデックス。それ以外の場合は-1。

##  <a name="addstrings"></a>  CToolBarCtrl::AddStrings

ツールバーコントロールで使用できる文字列のリストに新しい文字列または文字列を追加します。

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>パラメーター

*lpszStrings*<br/>
ツールバーの文字列リストに追加する1つ以上の null で終わる文字列を格納するバッファーのアドレス。 最後の文字列は、2つの null 文字で終了する必要があります。

### <a name="return-value"></a>戻り値

成功した場合に追加された最初の新しい文字列の0から始まるインデックス。それ以外の場合は-1。

### <a name="remarks"></a>Remarks

バッファー内の文字列は null 文字で区切る必要があります。 最後の文字列に2つの null ターミネータがあることを確認する必要があります。 定数文字列を適切に書式設定するには、次のように記述します。

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

または

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

内に複数の null `CString`文字を含めることはできないため、この関数にオブジェクトを渡すことはできません。 `CString`

##  <a name="autosize"></a>CToolBarCtrl:: AutoSize

ツールバーコントロール全体のサイズを変更します。

```
void AutoSize();
```

### <a name="remarks"></a>Remarks

親ウィンドウのサイズが変化したとき、またはツールバーのサイズが変化したときに、この関数を呼び出す必要があります (ボタンやビットマップのサイズを設定したり、文字列を追加したりする場合など)。

##  <a name="changebitmap"></a>CToolBarCtrl:: ChangeBitmap

現在のツールバーコントロールのボタンのビットマップを変更します。

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*idButton*|から新しいビットマップを受け取るボタンのコマンド識別子。|
|*iBitmap*|から現在のツールバーコントロールのイメージリスト内のイメージの0から始まるインデックス。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドが成功すると、指定したイメージが指定したボタンに表示されます。

このメソッドは、Windows SDK で説明されている[TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、ファイル **保存** ボタンのビットマップを **バージョン情報** ボタンのビットマップに変更します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

##  <a name="checkbutton"></a>CToolBarCtrl:: CheckButton

ツールバーコントロールの特定のボタンをオンまたはオフにします。

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
チェックまたはオフにするボタンのコマンド識別子。

*bCheck*<br/>
ボタンを確認する場合は TRUE、オフにする場合は FALSE。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ボタンがオンになっている場合は、押されているように見えます。 複数のボタンの状態を変更する場合は、代わりに[SetState](#setstate)を呼び出すことを検討してください。

##  <a name="commandtoindex"></a>CToolBarCtrl:: CommandToIndex

指定したコマンド識別子に関連付けられているボタンの0から始まるインデックスを取得します。

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタンインデックスを検索するコマンド ID。

### <a name="return-value"></a>戻り値

コマンド ID に関連付けられているボタンの0から始まるインデックス。

### <a name="remarks"></a>Remarks

##  <a name="create"></a>  CToolBarCtrl::Create

ツールバーコントロールを作成し、 `CToolBarCtrl`オブジェクトにアタッチします。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*dwStyle*<br/>
ツールバーコントロールのスタイルを指定します。 ツールバーには、常に WS_CHILD スタイルが必要です。 さらに、 **「解説**」で説明されているように、ツールバーのスタイルとウィンドウスタイルの任意の組み合わせを指定できます。

*rect*<br/>
必要に応じて、ツールバーコントロールのサイズと位置を指定します。 これは、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/previous-versions/dd162897\(v=vs.85\))構造体のいずれかになります。

*pParentWnd*<br/>
ツールバーコントロールの親ウィンドウを指定します。 NULL にすることはできません。

*nID*<br/>
ツールバーコントロールの ID を指定します。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

を作成する`CToolBarCtrl`には、2つの手順を実行します。 まず、コンストラクターを呼び出し、次にを`Create`呼び出します。これにより、ツールバーコントロールが`CToolBarCtrl`作成され、オブジェクトにアタッチされます。 次のウィンドウスタイルを toolbar コントロールに適用します。

- 常に WS_CHILD

- WS_VISIBLE 通常

- WS_DISABLED はまれ

ウィンドウスタイルの説明については、Windows SDK の「 [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) 」を参照してください。

必要に応じて、Windows SDK で説明されているように、[一般的なコントロールスタイル](/windows/win32/Controls/common-control-styles)の組み合わせを適用します。

ツールバースタイルの組み合わせをコントロールまたはボタン自体に適用します。 スタイルについては、Windows SDK の「[ツールバーコントロールとボタンのスタイル](/windows/win32/Controls/toolbar-control-and-button-styles)」を参照してください。

拡張ツールバースタイルを使用するには、を`Create`呼び出した後に [SetExtendedStyle](#setextendedstyle) を呼び出します。 拡張ウィンドウスタイルを使用してツールバーを作成するには、の`Create`代わりに[CToolBarCtrl:: CreateEx](#createex)を呼び出します。

ツールバーコントロールは、ツールバーウィンドウのサイズと位置を自動的に設定します。 高さは、ツールバーのボタンの高さに基づいています。 幅は、親ウィンドウのクライアント領域の幅と同じです。 CCS_TOP および CCS_BOTTOM スタイルによって、クライアント領域の上部または下部にツールバーを配置するかどうかが決定されます。 既定では、ツールバーには CCS_TOP スタイルが設定されています。

##  <a name="createex"></a>  CToolBarCtrl::CreateEx

コントロール (子ウィンドウ) を作成し、 `CToolBarCtrl`オブジェクトに関連付けます。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*dwExStyle*<br/>
作成するコントロールの拡張スタイルを指定します。 拡張 Windows スタイルの一覧については、Windows SDK の[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)の*dwexstyle*パラメーターを参照してください。

*dwStyle*<br/>
ツールバーコントロールのスタイルを指定します。 ツールバーには、常に WS_CHILD スタイルが必要です。 さらに、「[作成](#create)」の「**解説**」で説明されているように、ツールバーのスタイルとウィンドウスタイルの任意の組み合わせを指定できます。

*rect*<br/>
*PParentWnd*のクライアント座標で、作成されるウィンドウのサイズと位置を記述する[RECT](/previous-versions/dd162897\(v=vs.85\))構造体への参照。

*pParentWnd*<br/>
コントロールの親であるウィンドウへのポインター。

*nID*<br/>
コントロールの子ウィンドウ ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

Windows `CreateEx`拡張スタイルの先頭**WS_EX_** によって指定された拡張 windows スタイルを適用するには、[[作成](#create)] ではなくを使用します。 `CreateEx`*Dwexstyle*によって指定された拡張 Windows スタイルを使用して、コントロールを作成します。 [SetExtendedStyle](#setextendedstyle)を使用して、コントロールに固有の拡張スタイルを設定します。 たとえば、を使用`CreateEx`して、このようなスタイルを WS_EX_CONTEXTHELP `SetExtendedStyle`として設定しますが、を使用して、そのようなスタイルを TBSTYLE_EX_DRAWDDARROWS として設定します。 詳細については、「Windows SDK の[ツールバーの拡張スタイル](/windows/win32/Controls/toolbar-extended-styles)」に記載されているスタイルを参照してください。

##  <a name="ctoolbarctrl"></a>  CToolBarCtrl::CToolBarCtrl

`CToolBarCtrl` オブジェクトを構築します。

```
CToolBarCtrl();
```

### <a name="remarks"></a>Remarks

ツールバーを使用できるようにするには、 [Create](#create)を呼び出す必要があります。

##  <a name="customize"></a>CToolBarCtrl:: Customize

[ツールバーのカスタマイズ] ダイアログボックスを表示します。

```
void Customize();
```

### <a name="remarks"></a>Remarks

このダイアログボックスを使用すると、ユーザーはボタンを追加したり削除したりしてツールバーをカスタマイズできます。 カスタマイズをサポートするには、ツールバーの親ウィンドウでカスタマイズ通知メッセージを処理する必要があります。詳細については、「[カスタマイズ通知の処理](../../mfc/handling-customization-notifications.md)」を参照してください。 ツールバーは、CCS_ADJUSTABLE スタイルを使用して作成されている必要もあります。詳細については、「 [CToolBarCtrl:: Create](#create)」を参照してください。

##  <a name="deletebutton"></a>CToolBarCtrl::D eleteButton

ツールバーコントロールからボタンを削除します。

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
削除するボタンの0から始まるインデックス。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

##  <a name="enablebutton"></a>CToolBarCtrl:: EnableButton

ツールバーコントロールの指定したボタンを有効または無効にします。

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
有効または無効にするボタンのコマンド識別子。

*bEnable*<br/>
ボタンを有効にする場合は TRUE。このボタンを無効にする場合は FALSE。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ボタンが有効になっている場合は、そのボタンをクリックして確認できます。 複数のボタンの状態を変更する場合は、代わりに[SetState](#setstate)を呼び出すことを検討してください。

##  <a name="getanchorhighlight"></a>  CToolBarCtrl::GetAnchorHighlight

ツールバーのアンカーの強調表示の設定を取得します。

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>戻り値

0以外の場合、アンカーの強調表示が有効になります。 ゼロの場合、アンカーの強調表示は無効になります。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight)の動作を実装します。

##  <a name="getbitmap"></a>  CToolBarCtrl::GetBitmap

ツールバーのボタンに関連付けられているビットマップのインデックスを取得します。

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ビットマップインデックスを取得するボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

成功した場合はビットマップのインデックスを返します。それ以外の場合は0を返します。

### <a name="remarks"></a>Remarks

Windows SDK の[TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap)の機能を実装します。

##  <a name="getbitmapflags"></a>CToolBarCtrl:: GetBitmapFlags

ツールバーからビットマップフラグを取得します。

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>戻り値

TBBF_LARGE フラグが設定されている UINT。ディスプレイが大きなツールバーのビットマップをサポートできる場合は、それ以外の場合はオフにします。

### <a name="remarks"></a>Remarks

ツールバーを作成した後、ツールバーにビットマップを追加する前に、このメソッドを呼び出す必要があります。 戻り値は、ディスプレイが大きなビットマップをサポートするかどうかを示します。 ディスプレイが大きなビットマップをサポートしていて、それを使用する場合は、 [AddBitmap](#addbitmap)を使用して大きなビットマップを追加する前に、 [Setbitmapsize](#setbitmapsize)と[SetButtonSize](#setbuttonsize)を呼び出します。

##  <a name="getbutton"></a>CToolBarCtrl:: GetButton

ツールバーコントロールの指定したボタンに関する情報を取得します。

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
情報を取得するボタンの0から始まるインデックス。

*[lpButton]*<br/>
ボタン情報の`TBBUTTON`コピーを受け取る構造体のアドレス。 構造体の詳細については、 `TBBUTTON` 「 [CToolBarCtrl:: addbuttons](#addbuttons) 」を参照してください。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

##  <a name="getbuttoncount"></a>  CToolBarCtrl::GetButtonCount

ツールバーコントロールに現在存在するボタンの数を取得します。

```
int GetButtonCount() const;
```

### <a name="return-value"></a>戻り値

ボタンの数。

##  <a name="getbuttoninfo"></a>  CToolBarCtrl::GetButtonInfo

ツールバーのボタンの情報を取得します。

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*ptbbi*<br/>
ボタン情報を受け取る[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は、ボタンの0から始まるインデックス。それ以外の場合は-1。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)の動作を実装します。

##  <a name="getbuttonsize"></a>CToolBarCtrl:: GetButtonSize

ツールバーボタンのサイズを取得します。

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>戻り値

それぞれ、LOWORD と HIWORD の幅と高さの値を含む DWORD 値です。

##  <a name="getbuttontext"></a>CToolBarCtrl:: GetButtonText

現在のツールバーコントロールの指定したボタンの表示テキストを取得します。

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*idButton*|から表示テキストを取得するボタンの識別子。|

### <a name="return-value"></a>戻り値

指定したボタンの表示テキストを格納している[CString](../../atl-mfc-shared/using-cstring.md) 。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext)メッセージを送信します。

##  <a name="getcolorscheme"></a>  CToolBarCtrl::GetColorScheme

現在のツールバーコントロールの配色を取得します。

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*lpColorScheme*|入出力配色情報を受け取る[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)構造体へのポインター。 このメソッドから制御が戻るときに、ツールバーコントロールの強調表示の色と影の色が構造体によって記述されます。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme)メッセージを送信します。

##  <a name="getdisabledimagelist"></a>CToolBarCtrl:: GetDisabledImageList

ツールバーコントロールが無効なボタンを表示するために使用するイメージリストを取得します。

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>戻り値

[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。無効になっているイメージリストが設定されていない場合は NULL。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)の動作を実装します。 MFC の`GetDisabledImageList`実装では、 `CImageList`イメージリストをハンドルするのではなく、ツールバーコントロールのボタンイメージを含むオブジェクトを使用します。

##  <a name="getdroptarget"></a>CToolBarCtrl:: GetDropTarget

ツールバーコントロールの[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)インターフェイスを取得します。

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>パラメーター

*ppDropTarget*<br/>
[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)インターフェイスポインターへのポインター。 エラーが発生した場合は、このアドレスに NULL ポインターが配置されます。

### <a name="return-value"></a>戻り値

操作の成功または失敗を示す HRESULT 値を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETOBJECT](/windows/win32/Controls/tb-getobject)の動作を実装します。

##  <a name="getextendedstyle"></a>CToolBarCtrl:: GetExtendedStyle

ツールバーコントロールの拡張スタイルを取得します。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>戻り値

ツールバーコントロールに現在使用されている拡張スタイルを表す DWORD。 スタイルの一覧については、Windows SDK の「[ツールバーの拡張スタイル](/windows/win32/Controls/toolbar-extended-styles)」を参照してください。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)の動作を実装します。

##  <a name="gethotimagelist"></a>  CToolBarCtrl::GetHotImageList

ツールバーコントロールが "ホット" ボタンを表示するために使用するイメージリストを取得します。 マウスポインターが上にあると、ホットボタンが強調表示されます。

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>戻り値

[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。無効になっているイメージリストが設定されていない場合は NULL。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist)の動作を実装します。 マウスポインターが上にあると、ホットボタンが強調表示されます。

##  <a name="gethotitem"></a>  CToolBarCtrl::GetHotItem

ツールバーのホット項目のインデックスを取得します。

```
int GetHotItem() const;
```

### <a name="return-value"></a>戻り値

ツールバーのホット項目の0から始まるインデックス。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)の動作を実装します。

##  <a name="getimagelist"></a>  CToolBarCtrl::GetImageList

ツールバーコントロールが既定の状態のボタンを表示するために使用するイメージリストを取得します。

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>戻り値

[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。イメージリストが設定されていない場合は NULL。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist)の動作を実装します。

##  <a name="getinsertmark"></a>  CToolBarCtrl::GetInsertMark

ツールバーの現在の挿入マークを取得します。

```
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>パラメーター

*ptbim*<br/>
挿入マークを受け取る[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)構造体へのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)の動作を実装します。

##  <a name="getinsertmarkcolor"></a>  CToolBarCtrl::GetInsertMarkColor

ツールバーの挿入マークの描画に使用する色を取得します。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>戻り値

現在の挿入マークの色を格納している COLORREF 値。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)の動作を実装します。

##  <a name="getitemrect"></a>  CToolBarCtrl::GetItemRect

ツールバーコントロールのボタンの外接する四角形を取得します。

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
情報を取得するボタンの0から始まるインデックス。

*lpRect*<br/>
外接する四角形の座標を受け取る[RECT](/previous-versions/dd162897\(v=vs.85\))構造体または[CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトのアドレス。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、状態が TBSTATE_HIDDEN に設定されているボタンの外接する四角形を取得しません。

##  <a name="getmaxsize"></a>CToolBarCtrl:: GetMaxSize

ツールバーに表示されているすべてのボタンと区分線の合計サイズを取得します。

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>パラメーター

*pSize*<br/>
項目のサイズを受け取る[サイズ](/windows/win32/api/windef/ns-windef-size)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)の動作を実装します。

##  <a name="getmaxtextrows"></a>CToolBarCtrl:: GetMaxTextRows

ツールバーボタンに表示されるテキスト行の最大数を取得します。

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>戻り値

ツールバーボタンに表示されるテキスト行の最大数。

##  <a name="getmetrics"></a>CToolBarCtrl:: GetMetrics

`CToolBarCtrl`オブジェクトのメトリックを取得します。

```
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>パラメーター

*ptbm*<br/>
`CToolBarCtrl`オブジェクトの[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)構造体へのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、 [TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics)メッセージの機能をエミュレートします。

##  <a name="getpadding"></a>  CToolBarCtrl::GetPadding

現在のツールバーコントロールの水平方向と垂直方向の余白を取得します。

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*pnHorzPadding*|入出力ツールバーコントロールの水平方向の余白 (ピクセル単位) を受け取る整数。|
|*pnVertPadding*|入出力ツールバーコントロールの垂直方向の余白 (ピクセル単位) を受け取る整数。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_GETPADDING](/windows/win32/Controls/tb-getpadding)メッセージを送信します。

##  <a name="getpressedimagelist"></a>  CToolBarCtrl::GetPressedImageList

現在のツールバーコントロールが押された状態のボタンを表すために使用するイメージリストを取得します。

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>戻り値

現在のコントロールのイメージリストを格納している[CImageList](../../mfc/reference/cimagelist-class.md)へのポインター。このようなイメージリストが設定されていない場合は NULL。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist)メッセージを送信します。

##  <a name="getrect"></a>  CToolBarCtrl::GetRect

指定したツールバーボタンの外接する四角形を取得します。

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*lpRect*<br/>
外接する四角形の情報を受け取る[RECT](/previous-versions/dd162897\(v=vs.85\))構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETRECT](/windows/win32/Controls/tb-getrect)の動作を実装します。

##  <a name="getrows"></a>  CToolBarCtrl::GetRows

ツールバーコントロールによって現在表示されているボタンの行の数を取得します。

```
int GetRows() const;
```

### <a name="return-value"></a>戻り値

ツールバーに現在表示されているボタンの行の数。

### <a name="remarks"></a>Remarks

TBSTYLE_WRAPABLE スタイルを使用してツールバーを作成しない限り、行の数は常に1になります。

##  <a name="getstate"></a>  CToolBarCtrl::GetState

ツールバーコントロール内の指定したボタンの状態に関する情報を取得します。このボタンは、有効になっているか、押されているか、チェックされているかなどです。

```
int GetState(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
情報を取得するボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

成功した場合はボタンの状態情報、それ以外の場合は-1。 ボタンの状態情報は、 [CToolBarCtrl:: AddButtons](#addbuttons)に示されている値の組み合わせにすることができます。

### <a name="remarks"></a>Remarks

この関数は、複数のボタンの状態を取得する場合に特に便利です。 1つの状態だけを取得するには、次のいずれかのメンバー関数を使用します。[Isbuttonenabled](#isbuttonenabled)、 [isbuttonenabled](#isbuttonchecked)、 [isbuttonenabled](#isbuttonpressed)れた、 [Isbuttonenabled](#isbuttonhidden)、または[isbuttonenabled](#isbuttonindeterminate)。 ただし、メンバー関数は、TBSTATE_WRAP ボタンの状態を検出する唯一の方法です。 `GetState`

##  <a name="getstring"></a>  CToolBarCtrl::GetString

ツールバーの文字列を取得します。

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>パラメーター

*nString*<br/>
文字列のインデックス。

*lpstrString*<br/>
文字列を返すために使用されるバッファーへのポインター。

*cchMaxLen*<br/>
バッファーの長さ (バイト単位)。

*str*<br/>
文字列。

### <a name="return-value"></a>戻り値

成功した場合は文字列の長さ、それ以外の場合は-1。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_GETSTRING](/windows/win32/Controls/tb-getstring)の動作を実装します。

##  <a name="getstyle"></a>CToolBarCtrl:: GetStyle

ツールバーコントロールに現在適用されているスタイルを取得します。

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>戻り値

Windows SDK で説明されているように、[ツールバーコントロールスタイル](/windows/win32/Controls/toolbar-control-and-button-styles)の組み合わせを格納している DWORD。

##  <a name="gettooltips"></a>CToolBarCtrl:: GetToolTips ヒント

ツールバーコントロールに関連付けられているツールヒントコントロール (存在する場合) のハンドルを取得します。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>戻り値

ツールバーに関連付けられている[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。ツールバーにツールヒントコントロールが関連付けられていない場合は NULL。

### <a name="remarks"></a>Remarks

ツールバーコントロールは通常、独自のツールヒントコントロールを作成して維持するため、ほとんどのプログラムはこの関数を呼び出す必要がありません。

##  <a name="hittest"></a>  CToolBarCtrl::HitTest

ツールバーコントロール内のポイントの位置を決定します。

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>パラメーター

*ppt*<br/>
メンバー内`x`のヒットテストの x 座標と`y`メンバー内のヒットテストの y 座標を格納している[点](/previous-versions/dd162805\(v=vs.85\))構造体へのポインター。 座標は、ツールバーのクライアント領域を基準としています。

### <a name="return-value"></a>戻り値

ツールバー上のポイントの位置を示す整数値。 値が0または正の値の場合、この戻り値は、そのポイントがある区切り記号以外の項目の0から始まるインデックスです。

戻り値が負の場合、ポイントはボタン内に存在しません。 戻り値の絶対値は、区切り記号項目のインデックス、または最も近い区切り記号以外の項目のインデックスです。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_HITTEST](/windows/win32/Controls/tb-hittest)の動作を実装します。

##  <a name="hidebutton"></a>  CToolBarCtrl::HideButton

ツールバーコントロールの指定したボタンを非表示にするか表示します。

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
表示または非表示にするボタンのコマンド識別子。

*bHide*<br/>
ボタンを非表示にする場合は TRUE、表示する場合は FALSE。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

複数のボタンの状態を変更する場合は、代わりに[SetState](#setstate)を呼び出すことを検討してください。

##  <a name="indeterminate"></a>  CToolBarCtrl::Indeterminate

ツールバーコントロールの指定したボタンの不確定状態を設定または解除します。

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
不確定状態を設定またはクリアするボタンのコマンド識別子。

*ビン分割*<br/>
指定したボタンの不確定状態を設定する場合は TRUE、オフにする場合は FALSE。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

不確定ボタンは灰色で表示されます。たとえば、選択したテキストに太字と通常の文字の両方が含まれている場合、ワードプロセッサのツールバーの [太字] ボタンが表示されます。 複数のボタンの状態を変更する場合は、代わりに[SetState](#setstate)を呼び出すことを検討してください。

##  <a name="insertbutton"></a>  CToolBarCtrl::InsertButton

ツールバーコントロールにボタンを挿入します。

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
ボタンの0から始まるインデックス。 この関数は、新しいボタンをこのボタンの左側に挿入します。

*[lpButton]*<br/>
挿入するボタン`TBBUTTON`に関する情報を格納している構造体のアドレス。 構造体の説明については、 `TBBUTTON` 「 [CToolBarCtrl:: addbuttons](#addbuttons) 」を参照してください。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定したインデックスを持つイメージや文字列は、 [AddBitmap](#addbitmap)、 [addstring](#addstring)、または[addstring](#addstrings)を使用して、以前にツールバーコントロールの一覧に追加されている必要があります。

##  <a name="insertmarkhittest"></a>  CToolBarCtrl::InsertMarkHitTest

ツールバーのポイントの挿入マーク情報を取得します。

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>パラメーター

*ppt*<br/>
ツールバーのクライアント領域を基準とした、ヒットテストの座標を格納している[ポイント](/previous-versions/dd162805\(v=vs.85\))構造体へのポインター。

*ptbim*<br/>
挿入マーク情報を受け取る[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)構造体へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)の動作を実装します。

##  <a name="isbuttonchecked"></a>  CToolBarCtrl::IsButtonChecked

ツールバーコントロールの指定したボタンがチェックされているかどうかを判断します。

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツールバーのボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

ボタンがオンになっている場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>Remarks

複数のボタンの状態を取得する場合は、 [GetState](#getstate)を呼び出すことを検討してください。

##  <a name="isbuttonenabled"></a>  CToolBarCtrl::IsButtonEnabled

ツールバーコントロールの指定したボタンが有効かどうかを判断します。

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツールバーのボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

ボタンが有効になっている場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>Remarks

複数のボタンの状態を取得する場合は、 [GetState](#getstate)を呼び出すことを検討してください。

##  <a name="isbuttonhidden"></a>  CToolBarCtrl::IsButtonHidden

ツールバーコントロール内の指定したボタンを非表示にするかどうかを決定します。

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツールバーのボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

ボタンが非表示の場合は0以外の場合は。それ以外の場合は0。

### <a name="remarks"></a>Remarks

複数のボタンの状態を取得する場合は、 [GetState](#getstate)を呼び出すことを検討してください。

##  <a name="isbuttonhighlighted"></a>  CToolBarCtrl::IsButtonHighlighted

ツールバーボタンの強調表示の状態を確認します。

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
からツールバーボタンのコマンド ID。

### <a name="return-value"></a>戻り値

ボタンが強調表示されている場合は正の整数、ボタンが強調表示されていない場合は0、エラーが発生した場合は-1。

##  <a name="isbuttonindeterminate"></a>  CToolBarCtrl::IsButtonIndeterminate

ツールバーコントロールの指定したボタンが不確定であるかどうかを判断します。

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
からツールバーのボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

ボタンが不確定の場合は正の整数、ボタンが不確定でない場合は0、エラーが発生した場合は-1。

### <a name="remarks"></a>Remarks

不確定のボタンは淡色表示されます。たとえば、ワードプロセッサのツールバーの [太字] ボタンが、選択したテキストに太字と通常の文字の両方が含まれている場合に表示されます。 複数のボタンの状態を取得する場合は、 [GetState](#getstate)を呼び出すことを検討してください。

##  <a name="isbuttonpressed"></a>  CToolBarCtrl::IsButtonPressed

ツールバーコントロール内の指定したボタンが押されたかどうかを判断します。

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ツールバーのボタンのコマンド識別子。

### <a name="return-value"></a>戻り値

ボタンが押されている場合は0以外の値。それ以外の場合は0。

### <a name="remarks"></a>Remarks

複数のボタンの状態を取得する場合は、 [GetState](#getstate)を呼び出すことを検討してください。

##  <a name="loadimages"></a>CToolBarCtrl:: LoadImages

ビットマップをツールバーコントロールのイメージリストに読み込みます。

```
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>パラメーター

*iBitmapID*<br/>
読み込むイメージを含むビットマップの ID。 独自のビットマップリソースを指定するには、このパラメーターをビットマップリソースの ID に設定し、 *hInst*を NULL に設定します。 ビットマップリソースは、イメージリストに1つのイメージとして追加されます。 標準のシステム定義ビットマップを追加するには、 *hinst*を HINST_COMMCTRL に設定し、このパラメーターに次のいずれかの id を設定します。

|ビットマップ ID|説明|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|大きなサイズのエクスプローラービットマップ|
|IDB_HIST_SMALL_COLOR|エクスプローラービットマップのサイズが小さい|
|IDB_STD_LARGE_COLOR|標準ビットマップ (大規模)|
|IDB_STD_SMALL_COLOR|標準ビットマップ (小さいサイズ)|
|IDB_VIEW_LARGE_COLOR|大きいサイズのビットマップを表示する|
|IDB_VIEW_SMALL_COLOR|ビットマップを小さいサイズで表示する|

*hinst*<br/>
呼び出し元アプリケーションへのプログラムインスタンスハンドル。 このパラメーターを HINST_COMMCTRL して、標準のイメージリストを読み込むことができます。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)の動作を実装します。

##  <a name="mapaccelerator"></a>  CToolBarCtrl::MapAccelerator

アクセラレータ文字をツールバーボタンにマップします。

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>パラメーター

*chAccel*<br/>
マップされるアクセラレータ文字。 この文字は、ボタンのテキストで下線が引かれている文字と同じです。

*pIDBtn*<br/>
*ChAccel*で指定されたアクセラレータに対応するボタンのコマンド識別子を受け取る UINT へのポインター。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator)の動作を実装します。

##  <a name="markbutton"></a>  CToolBarCtrl::MarkButton

ツールバーコントロールの特定のボタンの強調表示の状態を設定します。

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*fHighlight 表示*<br/>
設定する強調表示の状態を指定します。 既定値は TRUE です。 FALSE に設定すると、ボタンは既定の状態に設定されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)の動作を実装します。

##  <a name="movebutton"></a>  CToolBarCtrl::MoveButton

あるインデックスから別のインデックスにボタンを移動します。

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>パラメーター

*nOldPos*<br/>
移動するボタンの0から始まるインデックス。

*nNewPos*<br/>
ボタンの変換先の0から始まるインデックス。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)の動作を実装します。

##  <a name="pressbutton"></a>CToolBarCtrl::P ressButton

ツールバーコントロールの指定されたボタンを押すか、または解放します。

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
から押すボタンまたは解放するボタンのコマンド識別子。

*bPress*<br/>
から指定したボタンを押す場合は TRUE。指定したボタンを解放する場合は FALSE。 既定値は TRUE です。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

複数のボタンの状態を変更する場合は、代わりに[SetState](#setstate)を呼び出すことを検討してください。

このメソッドは、Windows SDK で説明されている[TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton)メッセージを送信します。

##  <a name="replacebitmap"></a>  CToolBarCtrl::ReplaceBitmap

現在のツールバーコントロールの既存のビットマップを新しいビットマップに置き換えます。

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*ビットマップの事前プレースホルダー*|から置換するビットマップと新しいビットマップを記述する[TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap)構造体へのポインター。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、標準ツールバーのビットマップを別のビットマップに置き換えます。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

##  <a name="restorestate"></a>  CToolBarCtrl::RestoreState

パラメーターによって指定されたレジストリ内の場所から、ツールバーコントロールの状態を復元します。

```
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>パラメーター

*hKeyRoot*<br/>
レジストリで現在開いているキー、または次の定義済みの予約済みハンドルの値のいずれかを識別します。

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
値が関連付けられているサブキーの名前を格納している null で終わる文字列を指します。 このパラメーターには、null または空の文字列へのポインターを指定できます。 パラメーターが NULL の場合、 *Hkeyroot*パラメーターで識別されるキーに値が追加されます。

*lpszValueName*<br/>
取得する値の名前を格納している文字列を指します。 この名前の値がキーにまだ存在しない場合、関数はキーに値を追加します。

##  <a name="savestate"></a>CToolBarCtrl:: SaveState

パラメーターによって指定されたレジストリ内の場所に、ツールバーコントロールの状態を保存します。

```
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>パラメーター

*hKeyRoot*<br/>
レジストリで現在開いているキー、または次の定義済みの予約済みハンドルの値のいずれかを識別します。

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
値が関連付けられているサブキーの名前を格納している null で終わる文字列を指します。 このパラメーターには、null または空の文字列へのポインターを指定できます。 パラメーターが NULL の場合、 *Hkeyroot*パラメーターで識別されるキーに値が追加されます。

*lpszValueName*<br/>
設定する値の名前を格納している文字列を指します。 この名前の値がキーにまだ存在しない場合、関数はキーに値を追加します。

##  <a name="setanchorhighlight"></a>  CToolBarCtrl::SetAnchorHighlight

ツールバーのアンカーの強調表示の設定を設定します。

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>パラメーター

*fAnchor*<br/>
からアンカーの強調表示を有効にするか無効にするかを指定します。 この値が0以外の場合は、アンカーの強調表示が有効になります。 この値が0の場合、アンカーの強調表示は無効になります

### <a name="return-value"></a>戻り値

前のアンカー設定。 強調表示が有効になっている場合、この値は0以外になります。 強調表示が有効になっていない場合、この値は0です。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されているように、Win32 message [TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)の動作を実装します。

##  <a name="setbitmapsize"></a>CToolBarCtrl:: SetBitmapSize

ツールバーコントロールに追加する実際のビットマップイメージのサイズを設定します。

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>パラメーター

*size*<br/>
ビットマップイメージの幅と高さ (ピクセル単位)。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、ビットマップをツールバーに追加する前にのみ呼び出す必要があります。 アプリケーションでビットマップサイズが明示的に設定されていない場合は、既定で 16 x 15 ピクセルに設定されます。

##  <a name="setbuttoninfo"></a>  CToolBarCtrl::SetButtonInfo

ツールバーの既存のボタンの情報を設定します。

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタン識別子。

*ptbbi*<br/>
ボタン情報を受け取る[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo)の動作を実装します。

##  <a name="setbuttonsize"></a>CToolBarCtrl:: SetButtonSize

ツールバーコントロールのボタンのサイズを設定します。

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>パラメーター

*size*<br/>
ボタンの幅と高さ (ピクセル単位)。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ボタンのサイズは、常に、それが囲むビットマップサイズと同じ大きさである必要があります。 この関数は、ビットマップをツールバーに追加する前にのみ呼び出す必要があります。 アプリケーションがボタンのサイズを明示的に設定していない場合は、既定で 24 x 22 ピクセルに設定されます。

### <a name="example"></a>例

  「 [CToolBar:: GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)」の例を参照してください。

##  <a name="setbuttonstructsize"></a>CToolBarCtrl:: SetButtonStructSize

`TBBUTTON`構造体のサイズを指定します。

```
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>パラメーター

*nSize*<br/>
`TBBUTTON`構造体のサイズ (バイト単位)。

### <a name="remarks"></a>Remarks

追加のデータを`TBBUTTON`構造体に格納する場合は、から`TBBUTTON`新しい構造体を派生させたり、必要なメンバーを追加したり、構造体を`TBBUTTON`最初のメンバーとして含む新しい構造体を作成したりすることができます。 次に、この関数を呼び出して、新しい構造体のサイズをツールバーに制御するように指示します。

構造体の詳細については、 `TBBUTTON` 「 [CToolBarCtrl:: addbuttons](#addbuttons) 」を参照してください。

##  <a name="setbuttonwidth"></a>CToolBarCtrl:: SetButtonWidth

ツールバーコントロールのボタンの幅の最小値と最大値を設定します。

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>パラメーター

*cxMin*<br/>
ボタンの幅の最小値 (ピクセル単位)。 ツールバーのボタンがこの値より狭くなることはありません。

*cxMax*<br/>
ボタンの最大幅 (ピクセル単位)。 ボタンのテキストが幅を超えている場合、コントロールには省略記号ポイントで表示されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)の動作を実装します。

##  <a name="setcmdid"></a>  CToolBarCtrl::SetCmdID

指定したボタンが押されたときに所有者ウィンドウに送信されるコマンド識別子を設定します。

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*nIndex*<br/>
コマンド ID を設定するボタンの0から始まるインデックス。

*nID*<br/>
選択したボタンを設定するコマンド ID。

### <a name="return-value"></a>戻り値

成功した場合は0以外の値を返します。それ以外の場合は0。

##  <a name="setcolorscheme"></a>  CToolBarCtrl::SetColorScheme

現在のツールバーコントロールの配色を設定します。

```
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*lpColorScheme*|からツールバーコントロールの強調表示色と影の色を記述する[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)構造体へのポインター。|

### <a name="remarks"></a>Remarks

Windows Vista のビジュアルテーマが設定されている場合、このメソッドは無効です。

このメソッドは、Windows SDK で説明されている[TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、現在のツールバーコントロールの配色を設定します。 このコード例では、各ツールボタンの左端と上端を赤、右端と下端を青にします。 ユーザーがボタンを押すと、ボタンの赤い縁が青に変わり、青い縁が赤に変わります。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

##  <a name="setdisabledimagelist"></a>CToolBarCtrl:: SetDisabledImageList

ツールバーコントロールが無効にされたボタンを表示するために使用するイメージリストを設定します。

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

*pImageList*<br/>
無効なボタンイメージ`CImageList`を表示するためにツールバーコントロールによって使用されるイメージを格納しているオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

ツールバーコントロールによって、無効のボタンイメージを表示するために以前に使用された[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist)の動作を実装します。 の`SetDisabledImageList` MFC 実装では、 `CImageList`イメージリストをハンドルするのではなく、ツールバーコントロールの無効になっているボタンイメージを含むオブジェクトを使用します。

##  <a name="setdrawtextflags"></a>CToolBarCtrl:: SetDrawTextFlags

指定した四角形内のテキストを描画するために使用される Win32 関数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)のフラグを設定します。フラグの設定方法に従って書式設定されます。

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>パラメーター

*dwMask*<br/>
テキストを描画するときに*Dwdtflags*内のどのビットが使用されるかを示す、Win32 関数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)で指定されている1つ以上の DT_ フラグの組み合わせ。

*dwDTFlags*<br/>
ボタンのテキストを描画する方法を示す、Win32 関数`DrawText`で指定される1つ以上の DT_ フラグの組み合わせ。 この値は、ボタン`DrawText`テキストが描画されるときにに渡されます。

### <a name="return-value"></a>戻り値

前のテキストの描画フラグを格納している DWORD。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags)の動作を実装します。 このメンバー関数は、フラグの設定方法に`DrawText`従って書式設定された、指定した四角形内のテキストを描画する Win32 関数のフラグを設定します。

##  <a name="setextendedstyle"></a>  CToolBarCtrl::SetExtendedStyle

ツールバーコントロールの拡張スタイルを設定します。

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>パラメーター

*dwExStyle*<br/>
新しい拡張スタイルを指定する値。 このパラメーターは、ツールバーの拡張スタイルの組み合わせにすることができます。

### <a name="return-value"></a>戻り値

以前の拡張スタイルを表す DWORD。 スタイルの一覧については、Windows SDK の「[ツールバーの拡張スタイル](/windows/win32/Controls/toolbar-extended-styles)」を参照してください。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)の動作を実装します。

##  <a name="sethotimagelist"></a>  CToolBarCtrl::SetHotImageList

ツールバーコントロールが "ホット" ボタンを表示するために使用するイメージリストを設定します。

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

*pImageList*<br/>
ホットボタンイメージを`CImageList`表示するためにツールバーコントロールによって使用されるイメージを格納しているオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

ホットボタンイメージを表示するために、ツールバーコントロールによって以前に使用された[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)の動作を実装します。

の`SetHotImageList` MFC 実装では、 `CImageList`イメージリストをハンドルするのではなく、ツールバーコントロールのホットボタンイメージを含むオブジェクトを使用します。 ポインターがその上にあると、ホットボタンが強調表示されます。

##  <a name="sethotitem"></a>  CToolBarCtrl::SetHotItem

ツールバーのホット項目を設定します。

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>パラメーター

*nHot*<br/>
ホットになる項目の0から始まるインデックス番号。 この値が-1 の場合、どの項目もホットになりません。

### <a name="return-value"></a>戻り値

前のホット項目のインデックス。ホット項目がない場合は-1。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)の動作を実装します。

##  <a name="setimagelist"></a>  CToolBarCtrl::SetImageList

ツールバーが既定の状態のボタンを表示するために使用するイメージリストを設定します。

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

*pImageList*<br/>
ボタンイメージを既定`CImageList`の状態で表示するために、ツールバーコントロールによって使用されるイメージを格納しているオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

ボタンイメージを既定の状態で表示するために、以前に toolbar コントロールによって使用された[CImageList](../../mfc/reference/cimagelist-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)の動作を実装します。

MFC の`SetImageList`実装では、 `CImageList`イメージリストをハンドルするのではなく、ツールバーコントロールのボタンイメージを含むオブジェクトを使用します。

##  <a name="setindent"></a>CToolBarCtrl:: SetIndent

ツールバーコントロールの最初のボタンのインデントを設定します。

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>パラメーター

*iIndent*<br/>
インデントをピクセル単位で指定する値。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

##  <a name="setinsertmark"></a>  CToolBarCtrl::SetInsertMark

ツールバーの現在の挿入マークを設定します。

```
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>パラメーター

*ptbim*<br/>
挿入マークを含む[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)構造体へのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark)の動作を実装します。

##  <a name="setinsertmarkcolor"></a>  CToolBarCtrl::SetInsertMarkColor

ツールバーの挿入マークの描画に使用する色を設定します。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>パラメーター

*clrNew*<br/>
新しい挿入マークの色を格納している COLORREF 値。

### <a name="return-value"></a>戻り値

前の挿入マークの色を格納している COLORREF 値。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、Win32 message [TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor)の動作を実装します。

##  <a name="setmaxtextrows"></a>CToolBarCtrl:: SetMaxTextRows

ツールバーボタンに表示されるテキスト行の最大数を設定します。

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>パラメーター

*iMaxRows*<br/>
設定する行の最大数。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

##  <a name="setmetrics"></a>CToolBarCtrl:: SetMetrics

`CToolBarCtrl`オブジェクトのメトリックを設定します。

```
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>パラメーター

*ptbm*<br/>
`CToolBarCtrl`オブジェクトの[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)構造体へのポインター。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、 [TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics)メッセージの機能をエミュレートします。

##  <a name="setowner"></a>  CToolBarCtrl::SetOwner

ツールバーコントロールのオーナーウィンドウを設定します。

```
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
ツールバーコントロール`CWnd`の`CWnd`新しいオーナーウィンドウとなる、またはの派生オブジェクトへのポインター。

### <a name="remarks"></a>Remarks

[所有者] ウィンドウは、ツールバーから通知を受け取るウィンドウです。

##  <a name="setpadding"></a>  CToolBarCtrl::SetPadding

現在のツールバーコントロールの水平方向と垂直方向の余白を設定します。

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*nHorzPadding*|からツールバーコントロールの水平方向の余白 (ピクセル単位) を指定します。|
|*nVertPadding*|からツールバーコントロールの垂直方向の余白 (ピクセル単位) を指定します。|

### <a name="return-value"></a>戻り値

下位の文字が前の水平方向の余白の値を含み、その上位の単語に前の垂直方向の余白が含まれている DWORD。 埋め込み値はピクセル単位で計測されます。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_SETPADDING](/windows/win32/Controls/tb-setpadding)メッセージを送信します。

### <a name="example"></a>例

現在のツールバーコントロールの水平方向と垂直方向の余白を20ピクセルに設定するコード例を次に示します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

##  <a name="setpressedimagelist"></a>  CToolBarCtrl::SetPressedImageList

現在のツールバーコントロールが押された状態のボタンを表すために使用するイメージリストを設定します。

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>パラメーター

|パラメーター|説明|
|---------------|-----------------|
|*iImageID*|からイメージリストの0から始まるインデックス。 イメージリストを1つだけ使用する場合は、このパラメーターを0に設定します。|
|*pImageList*|から新しいイメージリストを格納している[CImageList](../../mfc/reference/cimagelist-class.md)へのポインター。|

### <a name="return-value"></a>戻り値

現在のコントロールの前のイメージリストを格納している[CImageList](../../mfc/reference/cimagelist-class.md)へのポインター。このようなイメージリストが設定されていない場合は NULL。

### <a name="remarks"></a>Remarks

このメソッドは、Windows SDK で説明されている[TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist)メッセージを送信します。

### <a name="example"></a>例

次のコード例では、押されたイメージリストが既定のイメージリストと同じになるように設定します。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

##  <a name="setrows"></a>  CToolBarCtrl::SetRows

ツールバーコントロールで、要求された行数に合わせてサイズを変更するように求めます。

```
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*nRows*<br/>
要求された行数。

*bLarger*<br/>
指定された行数にツールバーのサイズを変更できない場合に、より多くの行を使用するか、より小さい行を使用するかを示します。

*lpRect*<br/>
ツールバーの新しい外接する四角形を受け取る、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/previous-versions/dd162897\(v=vs.85\))構造体を指します。

### <a name="remarks"></a>Remarks

ツールバーのサイズが要求された数または行数に合わせて変更できない場合、そのサイズは、 *Blarger*の値に応じて、次に大きいか、次に小さい有効なサイズのいずれかに変更されます。 *Blarger*が TRUE の場合、新しい行数は要求された数よりも大きくなります。 *Blarger*が FALSE の場合、新しい行数は要求された数よりも小さくなります。

すべての行に同じ数のボタン (最後の行を除く) が含まれるようにボタンを配置できる場合は、ツールバーに対して指定された行数が有効になります。 たとえば、4つのボタンを含むツールバーのサイズを3行にすることはできません。これは、最後の2つの行の方が短いためです。 3行にサイズを変更しようとすると、 *Blarger*が TRUE であった場合は4行、 *BLARGER*が FALSE の場合は2行が取得されます。

ツールバーに区分線がある場合は、指定された行数が有効な場合の規則が複雑になります。 レイアウトが計算され、グループが1つの行に合わない場合を除き、ボタングループ (最初の行とグループの最後のボタンの前に区切り記号が付いたボタン) が複数の行に分割されることはありません。

グループが1つの行に合わない場合、次のグループは、大きいグループが終了した行に配置されていても、次の行で開始されます。 このルールの目的は、大規模なグループを分離することです。 結果の垂直方向の区切り記号は、行としてカウントされます。

また`SetRows` 、メンバー関数は、常に最小のツールバーサイズになるレイアウトを選択します。 TBSTYLE_WRAPABLE スタイルを使用してツールバーを作成した後、コントロールのサイズを変更すると、コントロールの幅に合わせて上記のメソッドが適用されます。

この関数は、TBSTYLE_WRAPABLE スタイルを使用して作成されたツールバーに対してのみ呼び出すことができます。

##  <a name="setstate"></a>CToolBarCtrl:: SetState

ツールバーコントロールの指定したボタンの状態を設定します。

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
ボタンのコマンド識別子。

*nState*<br/>
状態フラグ。 [CToolBarCtrl:: AddButtons](#addbuttons)では、ボタンの状態の一覧に表示される値の組み合わせを指定できます。

### <a name="return-value"></a>戻り値

成功した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、ボタンの状態の1つ以上を設定する場合に特に便利です。 1つの状態のみを設定するには、次のいずれかのメンバー関数を使用します。[Enablebutton](#enablebutton)、 [checkbutton](#checkbutton)、 [hidebutton](#hidebutton)、[不確定](#indeterminate)、または[pressbutton](#pressbutton)。

##  <a name="setstyle"></a>CToolBarCtrl:: System.windows.forms.control.setstyle

ツールバーコントロールのスタイルを設定します。

```
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>パラメーター

*dwStyle*<br/>
Windows SDK で説明されているように、[ツールバーコントロールスタイル](/windows/win32/Controls/toolbar-control-and-button-styles)の組み合わせを格納している DWORD。

##  <a name="settooltips"></a>CToolBarCtrl:: SetToolTips ヒント

ツールヒントコントロールをツールバーコントロールに関連付けます。

```
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>パラメーター

*pTip*<br/>
[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。

##  <a name="setwindowtheme"></a>CToolBarCtrl:: SetWindowTheme

`CToolBarCtrl`オブジェクトの視覚スタイルを設定します。

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>パラメーター

*pszSubAppName*<br/>
設定するツールバーの visual スタイルを含む Unicode 文字列へのポインター。

### <a name="return-value"></a>戻り値

戻り値は使用されません。

### <a name="remarks"></a>Remarks

このメンバー関数は、Windows SDK で説明されているように、 [TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme)メッセージの機能をエミュレートします。

## <a name="see-also"></a>関連項目

[MFC のサンプル CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC サンプル MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[CToolBar クラス](../../mfc/reference/ctoolbar-class.md)
