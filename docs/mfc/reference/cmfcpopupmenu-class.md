---
title: CMFCPopupMenu クラス
ms.date: 10/18/2018
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
ms.openlocfilehash: 2f61c5aea825d85043ad273c640c4aabd38ebbb5
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69505130"
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu クラス

Windows のポップアップ メニュー機能を実装し、ティアオフ メニューやツールヒントなどの機能を追加することでそれを拡張します。
詳細については、Visual Studio のインストール**の\\VC atlmfc\\\\src mfc**フォルダーにあるソースコードを参照してください。

## <a name="syntax"></a>構文

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## <a name="members"></a>メンバー

### <a name="protected-constructors"></a>プロテクト コンストラクター

|名前|説明|
|----------|-----------------|
|[CMFCPopupMenu:: CMFCPopupMenu](#cmfcpopupmenu)|`CMFCPopupMenu` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||
|[CMFCPopupMenu:: Always Showemptyツールエントリ](#alwaysshowemptytoolsentry)|ユーザー定義ツールの空のエントリを表示するためにポップアップメニューを有効にするかどうかを設定します。|
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||
|[CMFCPopupMenu:: CheckArea](#checkarea)|ポップアップメニューを基準とするポイントの位置を決定します。|
|[CMFCPopupMenu:: CloseMenu](#closemenu)||
|[CMFCPopupMenu:: Create](#create)|ポップアップメニューを作成し、 `CMFCPopupMenu`オブジェクトにアタッチします。|
|[CMFCPopupMenu::D efaultMouseClickOnClose](#defaultmouseclickonclose)||
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|ポップアップメニューのロゴを初期化します。|
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|メニューのサウンドを有効にします。|
|[CMFCPopupMenu::EnableResize](#enableresize)||
|[CMFCPopupMenu:: EnableScrolling](#enablescrolling)||
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||
|[CMFCPopupMenu:: FindSubItemByCommand](#findsubitembycommand)||
|[CMFCPopupMenu:: GetActiveMenu](#getactivemenu)|現在アクティブなメニューを返します。|
|[CMFCPopupMenu:: Getアニメーション速度](#getanimationspeed)|ポップアップメニューのアニメーション速度を返します。|
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|ポップアップメニューアニメーションの現在の型を返します。|
|[CMFCPopupMenu:: GetDropDirection](#getdropdirection)||
|[CMFCPopupMenu:: GetForceMenuFocus](#getforcemenufocus)|ポップアップメニューが表示されたときに、フォーカスがメニューバーに返されるかどうかを示します。|
|[CMFCPopupMenu:: GetForceShadow](#getforceshadow)||
|[CMFCPopupMenu:: GetHMenu](#gethmenu)|添付メニューリソースへのハンドルを返します。|
|[CMFCPopupMenu:: GetMenuBar](#getmenubar)|ポップアップメニュー内に埋め込まれている[Cmfcpopupmenubar](../../mfc/reference/cmfcpopupmenubar-class.md)を返します。|
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|指定したインデックス位置にあるメニュー項目へのポインターを返します。|
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|ポップアップメニュー内の項目数を返します。|
|[CMFCPopupMenu:: GetMessageWnd](#getmessagewnd)|フレームワークがポップアップメニューメッセージをルーティングするウィンドウへのポインターを返します。|
|[CMFCPopupMenu:: GetParentArea](#getparentarea)||
|[CMFCPopupMenu:: GetParentButton](#getparentbutton)|親ツールバーボタンへのポインターを返します。|
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|親ポップアップメニューへのポインターを返します。|
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||
|[CMFCPopupMenu:: GetParentToolBar](#getparenttoolbar)|親ツールバーへのポインターを返します。|
|[CMFCPopupMenu:: Getquickカスタマイズ Etype](#getquickcustomizetype)||
|[CMFCPopupMenu:: GetSelItem](#getselitem)|現在選択されているメニューコマンドへのポインターを返します。|
|[CMFCPopupMenu:: Hasのサイズ変更](#hasbeenresized)||
|[CMFCPopupMenu:: Hiderarelyused コマンド](#hiderarelyusedcommands)|ポップアップメニューで使用頻度の低いコマンドを非表示にできるかどうかを示します。|
|[CMFCPopupMenu:: InCommand](#incommand)||
|[CMFCPopupMenu:: InsertItem](#insertitem)|新しい項目をポップアップメニューの指定した位置に挿入します。|
|[CMFCPopupMenu:: InsertSeparator](#insertseparator)|ポップアップメニューの指定した位置に区切り記号を挿入します。|
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||
|[CMFCPopupMenu:: IsCustomizePane](#iscustomizepane)|ポップアップメニューが**Quickcustomizepane**として機能しているかどうかを示します。|
|[CMFCPopupMenu:: IsEscClose](#isescclose)||
|[CMFCPopupMenu:: IsIdle](#isidle)|ポップアップメニューが現在アイドル状態かどうかを示します。|
|[CMFCPopupMenu:: IsMenuSound](#ismenusound)||
|[CMFCPopupMenu:: IsQuickCustomize](#isquickcustomize)|関連付けられている[Cmfctoolbarmenubutton クラス](../../mfc/reference/cmfctoolbarmenubutton-class.md)が quickcustomize モードであるかどうかを判断します。|
|[CMFCPopupMenu:: IsResizeble](#isresizeble)||
|[CMFCPopupMenu:: Isright Align](#isrightalign)|メニューを右揃えまたは左揃えにするかどうかを示します。|
|[CMFCPopupMenu:: IsScrollable 可能](#isscrollable)||
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|ユーザーがポップアップメニューからコマンドを選択したときに、フレームワークが親フレームに通知するかどうかを示します。|
|[CMFCPopupMenu:: IsShown](#isshown)|ポップアップメニューが現在表示されているかどうかを示します。|
|[CMFCPopupMenu:: MoveTo](#moveto)||
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|( `CFrameWnd::OnCmdMsg`をオーバーライドします)。|
|[CMFCPopupMenu::P ostCommand](#postcommand)||
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|( `CFrameWnd::PreTranslateMessage`をオーバーライドします)。|
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|標準コントロールバーのオン/オフを切り替えるか、またはフレームウィンドウのサイズが変更されたときに、フレームワークによって呼び出されます。 ( [CFrameWnd:: RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)をオーバーライドします)。|
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|ポップアップメニューからすべての項目を削除します。|
|[CMFCPopupMenu::RemoveItem](#removeitem)|指定した項目をポップアップメニューから削除します。|
|[CMFCPopupMenu:: SaveState](#savestate)||
|[CMFCPopupMenu:: Setアニメーション速度](#setanimationspeed)|ポップアップメニューのアニメーション速度を設定します。|
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|ポップアップメニューのアニメーションの種類を設定します。|
|[CMFCPopupMenu:: SetAutoDestroy](#setautodestroy)||
|[CMFCPopupMenu:: SetDefaultItem](#setdefaultitem)|ポップアップメニューの既定のコマンドを設定します。|
|[CMFCPopupMenu:: SetForceMenuFocus](#setforcemenufocus)|ポップアップメニューが表示されたときに、入力フォーカスをメニューバーに強制的に戻します。|
|[CMFCPopupMenu:: SetForceShadow](#setforceshadow)|ポップアップメニューがメインフレームの外側に表示されたときに、フレームワークがメニューの影を描画するようにします。|
|[CMFCPopupMenu:: SetMaxWidth](#setmaxwidth)|ポップアップメニューの最大の幅を設定します。|
|[CMFCPopupMenu:: SetMessageWnd](#setmessagewnd)||
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||
|[CMFCPopupMenu:: Setquickカスタマイズ Etype](#setquickcustomizetype)||
|[CMFCPopupMenu:: SetQuickMode](#setquickmode)||
|[CMFCPopupMenu:: Setright Align](#setrightalign)|ポップアップメニューのメニューの配置を設定します。|
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|ユーザーがコマンドを選択したときにポップアップメニューで親フレームを通知するかどうかを制御するフラグを設定します。|
|[CMFCPopupMenu:: ShowAllCommands](#showallcommands)|ポップアップメニューですべてのコマンドを強制的に表示します。|
|[CMFCPopupMenu:: TriggerResize](#triggerresize)||
|[CMFCPopupMenu:: UpdateAllShadows](#updateallshadows)|開いているすべてのポップアップメニューの影を更新します。|
|[CMFCPopupMenu:: UpdateShadow](#updateshadow)|ポップアップメニューの影を更新します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[CMFCPopupMenu:: CreateTearOffBar](#createtearoffbar)||
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||
|[CMFCPopupMenu:: On Item](#onchooseitem)||

### <a name="remarks"></a>Remarks

通常、MFC はポップアップメニューを自動的に作成します。 オブジェクトを`CMFCPopupMenu`手動で作成する場合は、ヒープに1つを割り当ててから、 [CMFCPopupMenu:: create](#create)を呼び出します。

## <a name="example"></a>例

ポップアップメニューオブジェクトを構成する方法を次の例に示します。 この例では、ポップアップメニューのロゴとサウンドを設定する方法、アニメーションの速度と種類を設定する方法、メインフレームの外側にポップアップメニューを表示したときにメニューの影を描画する方法、最大の幅を設定する方法、およびポップアップメニューの右のメニューの配置を設定する方法を示します。 このコードスニペットは、[カスタムページサンプル](../../overview/visual-cpp-samples.md)に含まれています。

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxpopupmenu

##  <a name="activatepopupmenu"></a>  CMFCPopupMenu::ActivatePopupMenu

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### <a name="parameters"></a>パラメーター

から*Ptopframe*<br/>
から*pPopupMenu*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="alwaysshowemptytoolsentry"></a>  CMFCPopupMenu::AlwaysShowEmptyToolsEntry

ユーザー定義ツールの空のエントリを表示するためにポップアップメニューを有効にするかどうかを設定します。

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### <a name="parameters"></a>パラメーター

*bShow*<br/>
からポップアップメニューに空のエントリを表示できる場合は TRUE。それ以外の場合は FALSE。

##  <a name="areallcommandsshown"></a>  CMFCPopupMenu::AreAllCommandsShown

```
BOOL AreAllCommandsShown() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="checkarea"></a>CMFCPopupMenu:: CheckArea

ポップアップメニューを基準とするポイントの位置を決定します。

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### <a name="parameters"></a>パラメーター

*ptScreen*<br/>
から画面座標で表される点。

### <a name="return-value"></a>戻り値

ポイントがポップアップメニューに対して相対的な位置を示す MENUAREA_TYPE パラメーター。

### <a name="remarks"></a>Remarks

MENUAREA_TYPE パラメーターには、次のいずれかの値を指定できます。

- 外部- *Ptscreen*はポップアップメニューの外側にあります。

- LOGO- *Ptscreen*はロゴ領域上にあります。

- TEAROFF_CAPTION- *Ptscreen*はティアオフキャプション上にあります。

- SHADOW_BOTTOM- *Ptscreen*は、ポップアップメニューの下詰め (影) 上にあります。

- SHADOW_RIGHT- *Ptscreen*は、ポップアップメニューの右上にあります。

- MENU- *Ptscreen*はコマンドの上にあります。

##  <a name="closemenu"></a>CMFCPopupMenu:: CloseMenu

```
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### <a name="parameters"></a>パラメーター

から*bSetFocusToBar*<br/>

### <a name="remarks"></a>Remarks

##  <a name="cmfcpopupmenu"></a>CMFCPopupMenu:: CMFCPopupMenu

[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトを構築します。

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### <a name="parameters"></a>パラメーター

*pCustPage*<br/>
からカスタマイズページへのポインター。

*lpszTitle*<br/>
からメニューのキャプションを格納している文字列。

### <a name="remarks"></a>Remarks

このメソッドは、 `CMFCPopupMenu`のリソースを割り当てます。 ポップアップメニュー項目を作成するには、 [CMFCPopupMenu:: create](#create)を呼び出します。

##  <a name="create"></a>CMFCPopupMenu:: Create

ポップアップメニューを作成し、 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトにアタッチします。

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### <a name="parameters"></a>パラメーター

*pWndParent*<br/>
からの親ウィンドウ`CMFCPopupMenu`。

*x*<br/>
からポップアップメニューの位置の水平画面座標

*y*<br/>
からポップメニューの位置を表示する垂直方向の画面座標。

*hMenu*<br/>
からメニューリソースを処理するハンドル。

*化*<br/>
からメニューがカスタマイズ可能かどうかを示すブール型パラメーターです。 FALSE は、ポップアップメニューがカスタマイズ可能であることを示します。

*bOwnMessage*<br/>
からフレームワークがメニューメッセージをどのようにルーティングするかを示すブール型パラメーター。 詳細については、「解説」を参照してください。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

*BOwnMessage*が TRUE の場合、フレームワークはすべてのメニューメッセージを*pWndParent*にルーティングします。 *bOwnMessage*が TRUE の場合、 *pWndParent*を NULL にすることはできません。 *BOwnMessage*が FALSE の場合、フレームワークはメニューメッセージを親ポップアップメニューにルーティングします。

### <a name="example"></a>例

クラスのメソッド`Create`を使用する方法を次の例に示します。 `CMFCPopuMenu` このコードスニペットは、[カスタムページサンプル](../../overview/visual-cpp-samples.md)に含まれています。

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

##  <a name="createtearoffbar"></a>CMFCPopupMenu:: CreateTearOffBar

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>パラメーター

から*pWndMain*<br/>
から*uiID*<br/>
から*Lpszname*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="defaultmouseclickonclose"></a>CMFCPopupMenu::D efaultMouseClickOnClose

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="enablemenulogo"></a>  CMFCPopupMenu::EnableMenuLogo

ポップアップメニューのロゴを初期化します。

```
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### <a name="parameters"></a>パラメーター

*iLogoSize*<br/>
からロゴのサイズ (ピクセル単位)。

*nLogoLocation*<br/>
からロゴの位置を示す列挙データ型。

### <a name="remarks"></a>Remarks

ロゴを表示するには、メインフレームウィンドウで[CFrameWndEx:: OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo)メソッドを実装します。

*NLogoLocation*に指定できる値は、MENU_LOGO_LEFT、MENU_LOGO_RIGHT、MENU_LOGO_TOP、および MENU_LOGO_BOTTOM です。

##  <a name="enablemenusound"></a>  CMFCPopupMenu::EnableMenuSound

メニューのサウンドを有効にします。

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*bEnable*<br/>
からサウンドを有効にする場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

サウンドを有効にすると、ユーザーがポップアップメニューを開いたとき、またはメニューコマンドを選択したときに、フレームワークによって[PlaySound](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound)メソッドが呼び出されます。 既定では、この機能は有効になっています。

##  <a name="enableresize"></a>  CMFCPopupMenu::EnableResize

```
void EnableResize(CSize sizeMinResize);
```

### <a name="parameters"></a>パラメーター

から*sizeMinResize*<br/>

### <a name="remarks"></a>Remarks

##  <a name="enablescrolling"></a>  CMFCPopupMenu::EnableScrolling

```
void EnableScrolling(BOOL = TRUE);
```

### <a name="parameters"></a>パラメーター

から*BOOL*<br/>

### <a name="remarks"></a>Remarks

##  <a name="enablevertresize"></a>  CMFCPopupMenu::EnableVertResize

```
void EnableVertResize(int nMinResize);
```

### <a name="parameters"></a>パラメーター

から*Nminresize*<br/>

### <a name="remarks"></a>Remarks

##  <a name="findsubitembycommand"></a>CMFCPopupMenu:: FindSubItemByCommand

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### <a name="parameters"></a>パラメーター

から*uiCmd*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="getactivemenu"></a>  CMFCPopupMenu::GetActiveMenu

現在アクティブなメニューを返します。

```
static CMFCPopupMenu* GetActiveMenu();
```

### <a name="return-value"></a>戻り値

アクティブなポップアップメニューへのポインター。現在アクティブなポップアップメニューがない場合は NULL。

### <a name="remarks"></a>Remarks

各アプリケーションには、アクティブなポップアップメニューを1つしか含めることができません。

##  <a name="getanimationspeed"></a>CMFCPopupMenu:: Getアニメーション速度

ポップアップメニューのアニメーション速度を返します。

```
static UINT GetAnimationSpeed();
```

### <a name="return-value"></a>戻り値

ポップアップメニューのアニメーションが完了するまでにかかった時間 (ミリ秒単位) を示す整数。

### <a name="remarks"></a>Remarks

アニメーションの速度はグローバルな値です。 ポップアップメニューのアニメーション速度を変更するには、 [CMFCPopupMenu:: Setanimation speed](#setanimationspeed)を使用します。

##  <a name="getanimationtype"></a>  CMFCPopupMenu::GetAnimationType

ポップアップアニメーションの現在の型を返します。

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### <a name="parameters"></a>パラメーター

*bNoSystem*<br/>
からこのメソッドがグローバル値をチェックするかどうかを示すブール型パラメーター。 このメソッドが[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)のこのインスタンスのアニメーションスタイルを返すようにする場合は FALSE。

### <a name="return-value"></a>戻り値

アニメーションの種類を説明する列挙値。

### <a name="remarks"></a>Remarks

ポップアップメニューのアニメーションのスタイルは、アプリケーションに対してグローバルです。 [CMFCPopupMenu:: Setanimation type](#setanimationtype)を使用して、アニメーションのスタイルを設定します。

次の表に、使用可能なアニメーションの種類を示します。

|||
|-|-|
|NO_ANIMATION|ポップアップメニューはアニメーション化されず、すぐに表示されます。  |
|折り畳み|フレームワークによって、左上隅のポップアップメニューが右下隅に表示されます。  |
|挿入|ポップアップメニューは、上から下に移動します。  |
|非|ポップアップメニューは、まず透過的に見え、徐々に solidifies に見えます。  |

##  <a name="getdropdirection"></a>  CMFCPopupMenu::GetDropDirection

```
DROP_DIRECTION GetDropDirection() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="getforcemenufocus"></a>  CMFCPopupMenu::GetForceMenuFocus

ポップアップメニューが表示されたときに、フォーカスがメニューバーに返されるかどうかを示します。

```
static BOOL GetForceMenuFocus();
```

### <a name="return-value"></a>戻り値

ポップアップメニューが表示されたときに、入力フォーカスがメニューバーに返される場合は TRUE。ポップアップメニューがフォーカスを保持する場合は FALSE。

### <a name="remarks"></a>Remarks

既定では、アプリケーションはメニューバーにフォーカスを返しません。 この設定を変更するには、 [CMFCPopupMenu:: SetForceMenuFocus](#setforcemenufocus)を使用します。

##  <a name="getforceshadow"></a>  CMFCPopupMenu::GetForceShadow

```
static BOOL __stdcall GetForceShadow();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="gethmenu"></a>  CMFCPopupMenu::GetHMenu

添付メニューリソースへのハンドルを返します。

```
HMENU GetHMenu();
```

##  <a name="getmenubar"></a>  CMFCPopupMenu::GetMenuBar

ポップアップメニュー内に埋め込まれている[Cmfcpopupmenubar](../../mfc/reference/cmfcpopupmenubar-class.md)を返します。

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### <a name="return-value"></a>戻り値

埋め込ま`CMFCPopupMenuBar`れたへのポインター。

### <a name="remarks"></a>Remarks

ポップアップメニューには、オブジェクトが埋め`CMFCPopupMenuBar`込まれています。 別の埋め込みクラスを使用している場合は、派生クラスでこのメソッドをオーバーライドする必要があります。

##  <a name="getmenuitem"></a>  CMFCPopupMenu::GetMenuItem

指定したインデックス位置にあるメニュー項目へのポインターを返します。

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### <a name="parameters"></a>パラメーター

*iIndex*<br/>
からメニュー項目の0から始まるインデックス。

### <a name="return-value"></a>戻り値

メニュー項目へのポインター。 インデックスが無効な場合は NULL になります。

### <a name="remarks"></a>Remarks

メニュー項目は、 [Cmfctoolbarmenubutton クラス](../../mfc/reference/cmfctoolbarmenubutton-class.md)によって表されます。 このメソッドを呼び出すと、適切な`CMFCToolBarMenuButton`へのポインターが返されます。

##  <a name="getmenuitemcount"></a>  CMFCPopupMenu::GetMenuItemCount

ポップアップメニュー内の項目数を返します。

```
int GetMenuItemCount() const;
```

### <a name="return-value"></a>戻り値

メニュー内の項目の数。

##  <a name="getmessagewnd"></a>CMFCPopupMenu:: GetMessageWnd

フレームワークがポップアップメニューメッセージをルーティングするウィンドウへのポインターを返します。

```
CWnd* GetMessageWnd() const;
```

### <a name="return-value"></a>戻り値

ポップアップメニューメッセージを受け取るウィンドウへのポインター。ウィンドウがない場合は NULL です。

### <a name="remarks"></a>Remarks

[CMFCPopupMenu:: create](#create)メソッドを使用してポップアップメニューを作成する場合は、メニューメッセージを受信するウィンドウを指定します。

##  <a name="getparentarea"></a>  CMFCPopupMenu::GetParentArea

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### <a name="parameters"></a>パラメーター

[in] *rectParentBtn*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="getparentbutton"></a>  CMFCPopupMenu::GetParentButton

親ツールバーボタンへのポインターを返します。

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### <a name="return-value"></a>戻り値

親ツールバーボタンへのポインター。 ポップアップメニューに親のツールバーボタンがない場合は NULL です。

### <a name="remarks"></a>Remarks

は`CMFCPopupMenu` 、メニューのボタンに関連付けることができます。 このシナリオでは、ユーザーが親のツールバーボタンを選択したときにポップアップメニューが表示されます。

ポップアップメニューがショートカットメニューの場合は、親ツールバーボタンが表示されません。

##  <a name="getparentpopupmenu"></a>  CMFCPopupMenu::GetParentPopupMenu

親ポップアップメニューへのポインターを返します。

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### <a name="return-value"></a>戻り値

親`CMFCPopupMenu`オブジェクトへのポインターです。親ポップアップメニューがない場合は NULL です。

### <a name="remarks"></a>Remarks

ポップアップメニューは、サブメニューの場合`CMFCPopupMenu`にのみ、親オブジェクトを持ちます。

##  <a name="getparentribbonelement"></a>  CMFCPopupMenu::GetParentRibbonElement

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="getparenttoolbar"></a>  CMFCPopupMenu::GetParentToolBar

親ツールバーへのポインターを返します。

```
CMFCToolBar* GetParentToolBar() const;
```

### <a name="return-value"></a>戻り値

親ツールバーへのポインター。 ポップアップメニューに親ツールバーがない場合は NULL です。

### <a name="remarks"></a>Remarks

`CMFCPopupMenu`がショートカットメニューの場合、親ツールバーはありません。

##  <a name="getquickcustomizetype"></a>CMFCPopupMenu:: Getquickカスタマイズ Etype

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="getselitem"></a>CMFCPopupMenu:: GetSelItem

現在選択されているメニューコマンドへのポインターを返します。

```
CMFCToolBarMenuButton* GetSelItem();
```

### <a name="return-value"></a>戻り値

現在選択されているメニューコマンドへのポインター。項目が選択されていない場合は NULL です。

### <a name="remarks"></a>Remarks

ポップアップメニューのメニューコマンドは、 [Cmfctoolbarmenubutton クラス](../../mfc/reference/cmfctoolbarmenubutton-class.md)、またはから`CMFCToolBarMenuButton`派生したクラスによって表されます。

##  <a name="hasbeenresized"></a>CMFCPopupMenu:: Hasのサイズ変更

```
BOOL HasBeenResized() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="hiderarelyusedcommands"></a>CMFCPopupMenu:: Hiderarelyused コマンド

ポップアップメニューで使用頻度の低いコマンドを非表示にできるかどうかを示します。

```
BOOL HideRarelyUsedCommands() const;
```

### <a name="return-value"></a>戻り値

ポップアップメニューで使用頻度の低いコマンドを非表示にできる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドは、ポップアップメニューで使用頻度の低いコマンドを非表示にできるかどうかを指定します。構成が有効になっている場合には無効です。 ポップアップメニューに親ボタンがあり、親ウィンドウが[Cmfcmenubar クラス](../../mfc/reference/cmfcmenubar-class.md)から派生している場合、使用頻度の低いコマンドを非表示にすることができます。 この機能を有効にするには[Cmfcmenubar:: SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus)を使用し、この機能が現在有効になっているかどうかを判断するには[Cmfcmenubar:: IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus)を使用します。 親ウィンドウに対して、これらのメソッドの両方を呼び出す必要があります。

##  <a name="incommand"></a>CMFCPopupMenu:: InCommand

```
virtual BOOL InCommand();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="insertitem"></a>  CMFCPopupMenu::InsertItem

新しい項目をポップアップメニューの指定した位置に挿入します。

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### <a name="parameters"></a>パラメーター

*;*<br/>
から追加するメニュー項目への参照。

*iInsertAt*<br/>
から新しい項目の0から始まるインデックス。 *IInsertAt*が-1 の場合、項目はメニューの最後に追加されます。

### <a name="return-value"></a>戻り値

項目が挿入された位置の0から始まるインデックス。 メソッドが失敗した場合は-1。

### <a name="remarks"></a>Remarks

*IInsertAt*に無効な値を指定すると、このメソッドは失敗します (現在ポップアップメニューに表示されている項目の数よりも大きい整数など)。

##  <a name="insertseparator"></a>  CMFCPopupMenu::InsertSeparator

ポップアップメニューの指定した位置に区切り記号を挿入します。

```
int InsertSeparator(int iInsertAt = -1);
```

### <a name="parameters"></a>パラメーター

*iInsertAt*<br/>
からこのメソッドが区切り記号を挿入する位置の、0から始まるインデックス番号。

### <a name="return-value"></a>戻り値

区切り記号が挿入された位置の0から始まるインデックス。 このメソッドが失敗した場合は-1。

### <a name="remarks"></a>Remarks

*IInsertAt*の値-1 は、このメソッドがポップアップメニューの末尾に区切り記号を追加することを意味します。

*IInsertAt*が無効な値の場合、このメソッドは失敗します。

##  <a name="isalwaysclose"></a>  CMFCPopupMenu::IsAlwaysClose

```
virtual BOOL IsAlwaysClose() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isalwaysshowemptytoolsentry"></a>  CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="iscustomizepane"></a>CMFCPopupMenu:: IsCustomizePane

ポップアップメニューが**Quickcustomizepane**として機能しているかどうかを示します。

```
BOOL IsCustomizePane();
```

### <a name="return-value"></a>戻り値

ポップアップが**QuckCustomizePane**の場合は TRUE を返します。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

ユーザーがポップアップメニューを直接カスタマイズできるようにするには、 **Quickcustomizepane ウィンドウ**を使用します。 **Quickcustomizepane**は`CMFCPopupMenu` 、ユーザーがツールバーボタンをクリックして直接編集したときに表示されるです。

アプリケーションでは、 [CMDIFrameWndEx:: OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane)中にこのメソッドを呼び出す必要があります。

##  <a name="isescclose"></a>CMFCPopupMenu:: IsEscClose

```
BOOL IsEscClose();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isidle"></a>  CMFCPopupMenu::IsIdle

ポップアップメニューが現在アイドル状態かどうかを示します。

```
virtual BOOL IsIdle() const;
```

### <a name="return-value"></a>戻り値

ポップアップメニューがアイドルモードの場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

既定では、表示アニメーションが完了し、ユーザーがポップアップメニューをスクロールしていない場合、ポップアップメニューはアイドルモードになります。

##  <a name="ismenusound"></a>CMFCPopupMenu:: IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isquickcustomize"></a>CMFCPopupMenu:: IsQuickCustomize

関連付けられている[Cmfctoolbarmenubutton クラス](../../mfc/reference/cmfctoolbarmenubutton-class.md)が quickcustomize モードであるかどうかを判断します。

```
BOOL IsQuickCustomize();
```

### <a name="return-value"></a>戻り値

関連付けられたメニューボタンが QuickCustomize モードである場合は TRUE。それ以外の場合は FALSE。 このメソッドは、ポップアップメニューがに関連付けら`CMFCToolBarMenuButton`れていない場合にも FALSE を返します。

### <a name="remarks"></a>Remarks

QuickCustomize モードでは、ユーザーはツールバーのボタンを選択して、ボタンを直接カスタマイズします。

##  <a name="isresizeble"></a>CMFCPopupMenu:: IsResizeble

```
BOOL IsResizeble() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isrightalign"></a>  CMFCPopupMenu::IsRightAlign

メニューを右揃えまたは左揃えにするかどうかを示します。

```
BOOL IsRightAlign() const;
```

### <a name="return-value"></a>戻り値

メニューが右上にある場合は TRUE。メニューが左揃えの場合は FALSE。

### <a name="remarks"></a>Remarks

[CMFCPopupMenu:: Setright align](#setrightalign)を使用して、メニューの配置を設定できます。 既定では、ポップアップメニューでは左揃えが使用されます。

メニューの配置はグローバル設定ではなく、ポップアップメニューによって異なる場合があります。

##  <a name="isscrollable"></a>CMFCPopupMenu:: IsScrollable 可能

```
BOOL IsScrollable() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="issendmenuselectmsg"></a>  CMFCPopupMenu::IsSendMenuSelectMsg

ユーザーがポップアップメニューからコマンドを選択したときに、フレームワークが親フレームに通知するかどうかを示します。

```
static BOOL IsSendMenuSelectMsg();
```

### <a name="return-value"></a>戻り値

フレームワークが親フレームに通知する場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

フレームワークは、使用したがメニューコマンドを選択したときに WM_MENUSELECT メッセージを送信して、親フレームに通知します。

##  <a name="isshown"></a>CMFCPopupMenu:: IsShown

ポップアップメニューが現在表示されているかどうかを示します。

```
BOOL IsShown() const;
```

### <a name="return-value"></a>戻り値

ポップアップメニューが表示される場合は TRUE。それ以外の場合は FALSE。

##  <a name="moveto"></a>  CMFCPopupMenu::MoveTo

```
void MoveTo(const CPoint& pt);
```

### <a name="parameters"></a>パラメーター

から*pt*<br/>

### <a name="remarks"></a>Remarks

##  <a name="onchangehot"></a>  CMFCPopupMenu::OnChangeHot

```
virtual void OnChangeHot(int nHot);
```

### <a name="parameters"></a>パラメーター

から*Nhot*<br/>

### <a name="remarks"></a>Remarks

##  <a name="onchooseitem"></a>CMFCPopupMenu:: On Item

```
virtual void OnChooseItem(UINT uidCmdID);
```

### <a name="parameters"></a>パラメーター

から*Uidcmdid*<br/>

### <a name="remarks"></a>Remarks

##  <a name="oncmdmsg"></a>  CMFCPopupMenu::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>パラメーター

から*nID*<br/>
から*nCode*<br/>
から*Pextra*<br/>
から*pHandlerInfo*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="postcommand"></a>CMFCPopupMenu::P ostCommand

```
BOOL PostCommand(UINT uiCommandID);
```

### <a name="parameters"></a>パラメーター

から*uiCommandID*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="pretranslatemessage"></a>  CMFCPopupMenu::PreTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>パラメーター

から*pMsg*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="recalclayout"></a>  CMFCPopupMenu::RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>パラメーター

から*Bnotify*<br/>

### <a name="remarks"></a>Remarks

##  <a name="removeallitems"></a>  CMFCPopupMenu::RemoveAllItems

ポップアップメニューからすべての項目を削除します。

```
void RemoveAllItems();
```

##  <a name="removeitem"></a>  CMFCPopupMenu::RemoveItem

指定した項目をポップアップメニューから削除します。

```
BOOL RemoveItem(int iIndex);
```

### <a name="parameters"></a>パラメーター

*iIndex*<br/>
から削除する項目の0から始まるインデックス。

### <a name="return-value"></a>戻り値

メソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドは、項目の削除によって影響を受けるすべての区切り記号を自動的に配置します。 フレームワークによる区切り記号の再配置方法の詳細については、「 [Cmfctoolbar:: RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton)」を参照してください。

##  <a name="savestate"></a>CMFCPopupMenu:: SaveState

```
virtual void SaveState();
```

### <a name="remarks"></a>Remarks

##  <a name="setanimationspeed"></a>CMFCPopupMenu:: Setアニメーション速度

ポップアップメニューのアニメーション速度を設定します。

```
static void SetAnimationSpeed(UINT nElapse);
```

### <a name="parameters"></a>パラメーター

*nElapse*<br/>
から新しいアニメーション速度 (ミリ秒単位)。

### <a name="remarks"></a>Remarks

アニメーションの速度はグローバルな値であり、アプリケーションのすべてのポップアップメニューに影響します。 この値は、ポップアップメニューのアニメーションを完了するために必要な時間を指定します。

既定では、このパラメーターは30ミリ秒に設定されています。 *Nelapse*の有効な値の範囲は 0 ~ 200 です。

##  <a name="setanimationtype"></a>  CMFCPopupMenu::SetAnimationType

このポップアップメニューのアニメーションの種類を設定します。

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### <a name="parameters"></a>パラメーター

*type*<br/>
からアニメーションの種類を指定する列挙データ型。

### <a name="remarks"></a>Remarks

*型*の有効な値の一覧については、「 [CMFCPopupMenu:: getアニメーション型](#getanimationtype)」を参照してください。

##  <a name="setautodestroy"></a>CMFCPopupMenu:: SetAutoDestroy

```
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### <a name="parameters"></a>パラメーター

から*Bautodestroy*<br/>

### <a name="remarks"></a>Remarks

##  <a name="setdefaultitem"></a>  CMFCPopupMenu::SetDefaultItem

ポップアップメニューの既定のコマンドを設定します。

```
void SetDefaultItem(UINT uiCmd);
```

### <a name="parameters"></a>パラメーター

*uiCmd*<br/>
から新しい既定のコマンドのメニューコマンド ID。

### <a name="remarks"></a>Remarks

ポップアップメニューの既定のコマンドは、ポップアップメニューが表示されたときに選択されるコマンドです。

##  <a name="setforcemenufocus"></a>  CMFCPopupMenu::SetForceMenuFocus

ポップアップメニューが表示されたときに、入力フォーカスをメニューバーに強制的に戻します。

```
static void SetForceMenuFocus(BOOL bValue);
```

### <a name="parameters"></a>パラメーター

*bValue*<br/>
からフレームワークがポップアップメニューが表示されたときに、入力フォーカスをメニューバーに強制的に適用する場合は TRUE。 ポップアップメニューでフォーカスを保持する場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドは、アプリケーションのすべてのポップアップメニューに対してグローバルなフラグを設定します。 既定では、この機能は有効になっていません。

##  <a name="setforceshadow"></a>  CMFCPopupMenu::SetForceShadow

ポップアップメニューがメインフレームの外側に表示されたときに、フレームワークがメニューの影を描画するようにします。

```
static void SetForceShadow(BOOL bValue);
```

### <a name="parameters"></a>パラメーター

*bValue*<br/>
からフレームワークでメニューの影を描画する場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このメソッドを呼び出すと、アプリケーションでグローバルフラグが設定されます。 このフラグは、アプリケーションのすべてのポップアップメニューに影響します。

##  <a name="setmaxwidth"></a>CMFCPopupMenu:: SetMaxWidth

ポップアップメニューの最大の幅を設定します。

```
void SetMaxWidth(int iMaxWidth);
```

### <a name="parameters"></a>パラメーター

*iMaxWidth*<br/>
からポップアップメニューの最大幅 (ピクセル単位)。

### <a name="remarks"></a>Remarks

メニューコマンドに関連付けられているテキストが最大幅に合わない場合は、切り捨てられ、幅に合わない部分が3つのドットに置き換えられます。

##  <a name="setmessagewnd"></a>CMFCPopupMenu:: SetMessageWnd

```
void SetMessageWnd(CWnd* pMsgWnd);
```

### <a name="parameters"></a>パラメーター

から*pMsgWnd*<br/>

### <a name="remarks"></a>Remarks

##  <a name="setparentribbonelement"></a>  CMFCPopupMenu::SetParentRibbonElement

```
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>パラメーター

から*Pelem*<br/>

### <a name="remarks"></a>Remarks

##  <a name="setquickcustomizetype"></a>CMFCPopupMenu:: Setquickカスタマイズ Etype

```
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### <a name="parameters"></a>パラメーター

から*型*<br/>

### <a name="remarks"></a>Remarks

##  <a name="setquickmode"></a>  CMFCPopupMenu::SetQuickMode

```
void SetQuickMode();
```

### <a name="remarks"></a>Remarks

##  <a name="setrightalign"></a>CMFCPopupMenu:: Setright Align

ポップアップメニューのメニューの配置を設定します。

```
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### <a name="parameters"></a>パラメーター

*bRightAlign*<br/>
からメニューの配置を示すブール値。 TRUE は右揃え、FALSE は左揃えを示します。

### <a name="remarks"></a>Remarks

既定では、すべてのポップアップメニューは左揃えになっています。

##  <a name="setsendmenuselectmsg"></a>  CMFCPopupMenu::SetSendMenuSelectMsg

ユーザーがコマンドを選択したときにポップアップメニューで親フレームを通知するかどうかを制御するフラグを設定します。

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### <a name="parameters"></a>パラメーター

*bSet*<br/>
からポップアップメニューが親フレームを通知する場合は TRUE、それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

これは、アプリケーションのすべてのポップアップメニューのグローバルオプションです。 この設定が有効になっている場合、ユーザーがコマンドを選択したときにポップアップメニューから親フレームに WM_MENUSELECT メッセージが送信されます。

##  <a name="showallcommands"></a>CMFCPopupMenu:: ShowAllCommands

ポップアップメニューですべてのコマンドを強制的に表示します。

```
void ShowAllCommands();
```

### <a name="remarks"></a>Remarks

これはグローバル設定ではなく、現在のポップアップメニューのみに影響します。

##  <a name="triggerresize"></a>  CMFCPopupMenu::TriggerResize

```
void TriggerResize();
```

### <a name="remarks"></a>Remarks

##  <a name="updateallshadows"></a>CMFCPopupMenu:: UpdateAllShadows

開いているすべてのポップアップメニューの影を更新します。

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>パラメーター

*lprectScreen*<br/>
から更新する領域を画面座標で指定する四角形。

### <a name="remarks"></a>Remarks

このメソッドは、アニメーション化されたコントロールや、動的なコンテンツを持つその他のウィンドウにポップアップメニューを表示する場合に便利です。

##  <a name="updateshadow"></a>CMFCPopupMenu:: UpdateShadow

ポップアップメニューの影を更新します。

```
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>パラメーター

*lprectScreen*<br/>
から更新する領域の境界を指定する画面座標の四角形。

### <a name="remarks"></a>Remarks

シャドウを持つポップアップメニューがアニメーション化されたイメージと重なっている場合に、このメソッドを呼び出します。

## <a name="see-also"></a>関連項目

[階層図](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPopupMenuBar クラス](../../mfc/reference/cmfcpopupmenubar-class.md)
