---
title: CMFCToolBarMenuButton クラス
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 883d6a9242066289f15e58179a03c4f609699141
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69504714"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton クラス

ポップアップ メニューを含むツール バー ボタンです。
詳細については、Visual Studio のインストール**の\\VC atlmfc\\\\src mfc**フォルダーにあるソースコードを参照してください。

## <a name="syntax"></a>構文

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CMFCToolBarMenuButton:: CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|`CMFCToolBarMenuButton` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CMFCToolBarMenuButton:: CompareWith](#comparewith)|指定`CMFCToolBarButton`したオブジェクトとこのインスタンスを比較します。 ( [CMFCToolBarButton:: CompareWith で](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith)オーバーライドします)。|
|[CMFCToolBarMenuButton:: CopyFrom](#copyfrom)|別のツールバーボタンのプロパティを現在のボタンにコピーします。 ( [CMFCToolBarButton:: CopyFrom を](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)オーバーライドします)。|
|[CMFCToolBarMenuButton:: CreateFromMenu](#createfrommenu)|Windows のメニューハンドルからツールバーメニューを初期化します。|
|[CMFCToolBarMenuButton:: CreateMenu](#createmenu)|ツールバーメニューのコマンドで構成される Windows メニューを作成します。 Windows メニューへのハンドルを返します。|
|[CMFCToolBarMenuButton:: CreatePopupMenu](#createpopupmenu)|ツールバーメニューを表示するポップアップメニューオブジェクト ( [CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)) を作成します。|
|[CMFCToolBarMenuButton:: EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton:: GetCommands](#getcommands)|ツールバーメニューのコマンド一覧に対する読み取り専用アクセスを提供します。|
|[CMFCToolBarMenuButton:: GetImageRect](#getimagerect)|ボタンイメージの外接する四角形を取得します。|
|[CMFCToolBarMenuButton:: GetPaletteRows](#getpaletterows)|メニューがパレットモードの場合、ポップアップメニュー内の行の数を返します。|
|[CMFCToolBarMenuButton:: GetPopupMenu](#getpopupmenu)|ボタンに関連付けられているポップアップメニューオブジェクトへのポインターを返します。|
|[CMFCToolBarMenuButton:: HasButton](#hasbutton)||
|[CMFCToolBarMenuButton:: ホットボーダーを持つ](#havehotborder)|ユーザーがボタンを選択したときに、ボタンの境界線を表示するかどうかを決定します。 ( [CMFCToolBarButton:: は、ホットボーダー](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: IsBorder](#isborder)||
|[CMFCToolBarMenuButton:: IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton:: IsDroppedDown](#isdroppeddown)|ポップアップメニューを表示するかどうかを指定します。|
|[CMFCToolBarMenuButton:: IsEmptyMenuAllowed](#isemptymenuallowed)|選択されたメニュー項目からユーザーがサブメニューを開けるかどうかを判断するために、フレームワークによって呼び出されます。|
|[CMFCToolBarMenuButton:: IsExclusive](#isexclusive)|ボタンが排他モードであるかどうか、つまり、ユーザーがポインターを別のツールバーまたはボタンの上に移動した場合でも、ポップアップメニューを開いたままにするかどうかを決定します。|
|[CMFCToolBarMenuButton:: IsMenuPaletteMode](#ismenupalettemode)|ポップアップメニューがパレットモードであるかどうかを判断します。|
|[CMFCToolBarMenuButton:: IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton:: IsTearOffMenu](#istearoffmenu)|ポップアップメニューにティアオフバーがあるかどうかを判断します。|
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton:: OnBeforeDrag](#onbeforedrag)|ボタンをドラッグできるかどうかを指定します。 ( [CMFCToolBarButton:: OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: On電卓 Atesize](#oncalculatesize)|指定されたデバイスコンテキストとドッキング状態のボタンのサイズを計算するために、フレームワークによって呼び出されます。 ( [CMFCToolBarButton:: On電卓 Atesize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: OnCancelMode](#oncancelmode)|[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)メッセージを処理するためにフレームワークによって呼び出されます。 ( [CMFCToolBarButton:: OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: OnChangeParentWnd](#onchangeparentwnd)|新しいツールバーにボタンが挿入されたときにフレームワークによって呼び出されます。 ( [CMFCToolBarButton:: OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd)をオーバーライドします。)|
|[CMFCToolBarMenuButton:: OnClick](#onclick)|ユーザーがマウスボタンをクリックしたときにフレームワークによって呼び出されます。 ( [CMFCToolBarButton:: OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: OnClickMenuItem](#onclickmenuitem)|ユーザーがポップアップメニュー内の項目を選択すると、フレームワークによって呼び出されます。|
|[CMFCToolBarMenuButton:: OnContextHelp](#oncontexthelp)|親ツールバーが WM_HELPHITTEST メッセージを処理するときに、フレームワークによって呼び出されます。 ( [CMFCToolBarButton:: OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp)をオーバーライドします。)|
|[CMFCToolBarMenuButton:: OnDraw](#ondraw)|指定されたスタイルとオプションを使用してボタンを描画するために、フレームワークによって呼び出されます。 ( [CMFCToolBarButton:: OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: OnDrawOnCustomizeList](#ondrawoncustomizelist)|**[カスタマイズ]** ダイアログボックスの **[コマンド]** ウィンドウにボタンを描画するために、フレームワークによって呼び出されます。 ( [CMFCToolBarButton:: OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist)をオーバーライドします。)|
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|ユーザーがポップアップメニューを開いたときに、フレームワークによって呼び出されます。|
|[CMFCToolBarMenuButton:: ResetImageToDefault](#resetimagetodefault)|は、ボタンに関連付けられているイメージを既定値に設定します。 ( [CMFCToolBarButton:: ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault)をオーバーライドします。)|
|[CMFCToolBarMenuButton:: SaveBarState](#savebarstate)|ツールバーボタンの状態を保存します。 ( [CMFCToolBarButton:: SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: Serialize](#serialize)|アーカイブからこのオブジェクトを読み取るか、アーカイブに書き込みます。 ( [CMFCToolBarButton:: Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: SetACCData](#setaccdata)|指定され`CAccessibilityData`たオブジェクトに、ツールバーボタンのアクセシビリティデータを設定します。 ( [CMFCToolBarButton:: setのデータ](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata)をオーバーライドします)。|
|[CMFCToolBarMenuButton:: SetMenuOnly](#setmenuonly)|ツールバーにボタンを追加できるかどうかを指定します。|
|[CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode)|ポップアップメニューをパレットモードにするかどうかを指定します。|
|[CMFCToolBarMenuButton:: SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton:: SetRadio](#setradio)|ツールバーのメニューボタンに、選択されていることを示すアイコンが表示されるようにします。|
|[CMFCToolBarMenuButton:: SetTearOff](#settearoff)|ポップアップメニューのティアオフバー ID を指定します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[CMFCToolBarMenuButton::D rawDocumentIcon](#drawdocumenticon)|メニューボタンにアイコンを描画します。|

### <a name="data-members"></a>データ メンバー

|名前|説明|
|----------|-----------------|
|[CMFCToolBarMenuButton:: m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|TRUE の場合、ボタンが描画されると、フレームワークは常に[CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)を呼び出します。|

## <a name="remarks"></a>Remarks

は`CMFCToolBarMenuButton` 、メニュー、サブメニューを持つメニュー項目、コマンドを実行するかメニューを表示するボタン、またはメニューだけを表示するボタンとして表示できます。 メニューボタンの動作と外観を決定するには、コンストラクター `CMFCToolbarMenuButton::CMFCToolbarMenuButton`のボタンに関連付けられているイメージ、テキスト、メニューハンドル、コマンド ID などのパラメーターを指定します。

`CMFCToolbarMenuButton`クラスから派生したカスタムクラスでは、 [DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)マクロを使用する必要があります。 [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)マクロは、アプリケーションの終了時にエラーを生成します。

## <a name="example"></a>例

次の例では、オブジェクトを`CMFCToolBarMenuButton`構成する方法を示します。 このコードは、ドロップダウンメニューがパレットモードであることを指定する方法を示しています。また、メニューバーのメニューボタンをユーザーがドラッグしたときに作成されるティアオフバーの ID を指定する方法を示しています。 このコード スニペットは、 [Word パッド サンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>必要条件

**ヘッダー:** afxtoolbarmenubutton.h

##  <a name="cmfctoolbarmenubutton"></a>CMFCToolBarMenuButton:: CMFCToolBarMenuButton

`CMFCToolBarMenuButton` オブジェクトを構築します。

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>パラメーター

*src*<br/>
から`CMFCToolBarMenuButton` この`CMFCToolBarMenuButton`オブジェクトにコピーされる既存のオブジェクト。

*uiID*<br/>
からユーザーがボタンをクリックしたときに実行されるコマンドの ID です。コマンドを直接実行しないメニューボタンの場合は、または (UINT)-1 です。

*hMenu*<br/>
からメニューへのハンドル。または、ボタンにメニューがない場合は NULL になります。

*iImage*<br/>
からボタンのイメージのインデックス。このボタンにアイコンがない場合、または*uiID*によって指定されたコマンドのアイコンを使用する場合は-1。 インデックスは、アプリケーション内の各`CMFCToolBarImages`オブジェクトに対して同じです。

*lpszText*<br/>
からツールバーメニューボタンのテキスト。

*bUserButton*<br/>
からボタンにユーザー定義のイメージが表示される場合は TRUE。*UiID*によって指定されたコマンドに関連付けられている定義済みのイメージがボタンに表示される場合は FALSE。

### <a name="remarks"></a>Remarks

*UiID*が有効なコマンド ID である場合、このボタンはユーザーがクリックしたときにそのコマンドを実行します。 *HMenu*が有効なメニューハンドルの場合、ボタンがメニューに表示されたときに、ツールバーまたはサブメニューにドロップダウンメニューが表示されます。 *UiID*と*hMenu*の両方が有効な場合、ボタンは分割ボタンで、ユーザーがクリックしたときにコマンドを実行する部分と、ユーザーがクリックしたときにメニューをドロップダウンする下矢印が表示された部分が含まれます。 ただし、 *hMenu*が有効な場合、ボタンがメニューに挿入されたときにコマンドを実行するためのボタンをクリックすることはできません。

### <a name="example"></a>例

`CMFCToolBarMenuButton`クラスのオブジェクトを構築する方法を次の例に示します。 このコード スニペットは、 [Word パッド サンプル](../../overview/visual-cpp-samples.md)の一部です。

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

##  <a name="comparewith"></a>CMFCToolBarMenuButton:: CompareWith

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>パラメーター

から*その他*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="copyfrom"></a>CMFCToolBarMenuButton:: CopyFrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>パラメーター

から*src*<br/>

### <a name="remarks"></a>Remarks

##  <a name="createfrommenu"></a>CMFCToolBarMenuButton:: CreateFromMenu

Windows のメニューハンドルからツールバーメニューを初期化します。

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>パラメーター

*hMenu*<br/>
からメニューへのハンドル。

### <a name="remarks"></a>Remarks

ツールバーのメニューボタンを使用すると、ドロップダウンサブメニューを表示できます。

フレームワークは、このメソッドを呼び出して、メニューからサブメニューのコマンドを初期化します。

##  <a name="createmenu"></a>CMFCToolBarMenuButton:: CreateMenu

ツールバーメニューのコマンドで構成されるメニューを作成します。 メニューへのハンドルを返します。

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>戻り値

成功した場合はメニューへのハンドル。 ツールバーのメニューボタンに関連付けられているコマンドの一覧が空の場合は NULL です。

### <a name="remarks"></a>Remarks

派生クラスでこのメソッドをオーバーライドすると、メニューの生成方法をカスタマイズできます。

##  <a name="createpopupmenu"></a>  CMFCToolBarMenuButton::CreatePopupMenu

ツールバー `CMFCPopupMenu`メニューを表示するオブジェクトを作成します。

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>戻り値

ツールバーメニューボタン`CMFCPopupMenu`に関連付けられているドロップダウンメニューを表示するオブジェクトへのポインター。

### <a name="remarks"></a>Remarks

このメソッドは、ボタンに関連付けられているドロップダウンメニューの表示を準備するために、フレームワークによって呼び出されます。

既定の実装では、新しい`CMFCPopupMenu`オブジェクトを構築して返します。 [CMFCPopupMenu クラス](cmfcpopupmenu-class.md)の派生型を使用する場合、または追加の初期化を実行する場合は、このメソッドをオーバーライドします。

##  <a name="drawdocumenticon"></a>CMFCToolBarMenuButton::D rawDocumentIcon

メニューボタンにドキュメントアイコンを描画します。

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
からデバイスコンテキストへのポインター。

*rectImage*<br/>
から画像の外接する四角形の座標。

*hIcon*<br/>
からアイコンへのハンドル。

### <a name="remarks"></a>Remarks

このメソッドは、ドキュメントアイコンを取得し、 *rectImage*で指定された領域の中央にあるメニューボタンに描画します。

##  <a name="enablequickcustomize"></a>CMFCToolBarMenuButton:: EnableQuickCustomize

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>Remarks

##  <a name="hasbutton"></a>CMFCToolBarMenuButton:: HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="havehotborder"></a>CMFCToolBarMenuButton:: ホットボーダーを持つ

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isborder"></a>CMFCToolBarMenuButton:: IsBorder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isclickedonmenu"></a>  CMFCToolBarMenuButton::IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="isquickmode"></a>CMFCToolBarMenuButton:: IsQuickMode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="getcommands"></a>CMFCToolBarMenuButton:: GetCommands

ツールバーメニューのコマンド一覧に対する読み取り専用アクセスを提供します。

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>戻り値

[CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)オブジェクトのコレクションを含む、 [CObList クラス](../../mfc/reference/coblist-class.md)オブジェクトへの const 参照。

### <a name="remarks"></a>Remarks

ツールバーのメニューボタンを使用して、サブメニューを表示できます。 コマンドの一覧は、コンストラクターのサブメニュー、または[Cmfctoolbarmenubutton:: CreateFromMenu](#createfrommenu)のメニュー (HMENU) のハンドルとして指定できます。 メニューは、 [CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)から派生し、内部`CObList`オブジェクトに格納されているオブジェクトの一覧に変換されます。 このリストにアクセスするには、このメソッドを呼び出します。

##  <a name="getimagerect"></a>CMFCToolBarMenuButton:: GetImageRect

ボタンイメージの外接する四角形を取得します。

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>パラメーター

*rectImage*<br/>
入出力イメージの外接する`CRect`四角形の座標を受け取るオブジェクトへの参照。

##  <a name="getpaletterows"></a>CMFCToolBarMenuButton:: GetPaletteRows

メニューがパレットモードの場合、ドロップダウンメニューの行の数を返します。

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>戻り値

パレット内の行の数。

### <a name="remarks"></a>Remarks

メニューボタンがパレットモードに設定されている場合、メニュー項目は、限られた数の行のみを含む複数の列に表示されます。 行の数を取得するには、このメソッドを呼び出します。 [パレット] モードを有効または無効にし、 [Cmfctoolbarmenubutton:: SetMenuPaletteMode](#setmenupalettemode)を使用して行数を指定できます。

##  <a name="getpopupmenu"></a>CMFCToolBarMenuButton:: GetPopupMenu

ボタンのドロップダウンメニューを表す[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトへのポインターを返します。

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>戻り値

フレームワークがツールバーメニューボタンのサブメニューを描画したときに作成された[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトへのポインター。サブメニューが表示されない場合は NULL です。

### <a name="remarks"></a>Remarks

ツールバーのメニューボタンにドロップダウンメニューが表示されている場合、このボタンはメニューを表す[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトを作成します。 オブジェクトへの`CMFCPopupMenu`ポインターを取得するには、このメソッドを呼び出します。 返されたポインターは一時的なものであり、ユーザーがドロップダウンメニューを閉じたときには無効になるため、格納しないでください。

##  <a name="isdroppeddown"></a>CMFCToolBarMenuButton:: IsDroppedDown

ポップアップメニューが現在表示されているかどうかを示します。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>戻り値

ツールバーのメニューボタンにサブメニューが表示される場合は TRUE。それ以外の場合は FALSE。

##  <a name="isemptymenuallowed"></a>CMFCToolBarMenuButton:: IsEmptyMenuAllowed

メニュー項目が空のサブメニューを表示するかどうかを指定します。

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>戻り値

現在選択されているメニュー項目から、サブメニューが空の場合でも、フレームワークがサブメニューを開く場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

フレームワークは、ユーザーが現在選択されているメニュー項目からサブメニューを開こうとしたときに、このメソッドを呼び出します。 サブメニューが空`IsEmptyMenuAllowed`で、FALSE が返された場合、サブメニューは開きません。

既定の実装では、FALSE が返されます。 この動作をカスタマイズするには、このメソッドをオーバーライドします。

##  <a name="isexclusive"></a>CMFCToolBarMenuButton:: IsExclusive

ボタンが排他モードであるかどうかを示します。

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>戻り値

ボタンが排他モードで動作している場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

ユーザーがボタンのポップアップメニューを開いて、別のツールバーまたはメニューボタンの上にマウスポインターを移動すると、ボタンが排他モードの場合を除き、ポップアップメニューが閉じます。

既定の実装では、常に FALSE が返されます。 排他モードを有効にする場合は、派生クラスでこのメソッドをオーバーライドします。

##  <a name="ismenupalettemode"></a>  CMFCToolBarMenuButton::IsMenuPaletteMode

ドロップダウンメニューがパレットモードであるかどうかを判断します。

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>戻り値

パレットモードが有効な場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

メニューボタンがパレットモードに設定されている場合、メニュー項目は、限られた数の行のみを含む複数の列に表示されます。 行の数を取得するには、このメソッドを呼び出します。 このパレットモードを有効または無効にするには、 [Cmfctoolbarmenubutton:: SetMenuPaletteMode](#setmenupalettemode)を呼び出します。

##  <a name="istearoffmenu"></a>CMFCToolBarMenuButton:: IsTearOffMenu

ドロップダウンメニューにティアオフバーがあるかどうかを示します。

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>戻り値

ツールバーのメニューボタンにティアオフバーがある場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

ティアオフ機能を有効にし、ティアオフバー ID を設定するには、 [Cmfctoolbarmenubutton:: SetTearOff](#settearoff)を呼び出します。

##  <a name="m_balwayscallownerdraw"></a>CMFCToolBarMenuButton:: m_bAlwaysCallOwnerDraw

ボタンが描画されるときに、フレームワークが常に[CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)を呼び出すかどうかを指定します。

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>Remarks

このメンバー変数が TRUE に設定されている場合、ボタンは常に[CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)メソッドを呼び出して、ボタン上にイメージを表示します。 が`m_bAlwaysCallOwnerDraw` FALSE の場合、イメージが事前定義されている場合、ボタン自体はイメージを描画します。 それ以外の場合`OnDrawMenuImage`は、を呼び出します。

##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>Remarks

##  <a name="onbeforedrag"></a>  CMFCToolBarMenuButton::OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="oncalculatesize"></a>CMFCToolBarMenuButton:: On電卓 Atesize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>パラメーター

から*pDC*<br/>
から*既定値の設定*<br/>
から*bHorz*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="oncancelmode"></a>CMFCToolBarMenuButton:: OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Remarks

##  <a name="onchangeparentwnd"></a>CMFCToolBarMenuButton:: OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>パラメーター

から*pWndParent*<br/>

### <a name="remarks"></a>Remarks

##  <a name="onclick"></a>CMFCToolBarMenuButton:: OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>パラメーター

から*pWnd*<br/>
から*Bdelay*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="onclickmenuitem"></a>CMFCToolBarMenuButton:: OnClickMenuItem

ユーザーがドロップダウンメニューで項目を選択したときにフレームワークによって呼び出されます。

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>戻り値

フレームワークが既定のメニュー項目の処理を続行する必要がある場合は FALSE。それ以外の場合は TRUE です。 既定の実装では、常に FALSE が返されます。

### <a name="remarks"></a>Remarks

ユーザーがメニュー項目をクリックすると、フレームワークはその項目に関連付けられているコマンドを実行します。

メニュー項目の処理をカスタマイズするに`OnClickMenuItem`は、クラスから`CMFCToolBarMenuButton`派生したクラスでをオーバーライドします。 また、 [CFrameWndEx:: OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu)をオーバーライドし、派生クラスのインスタンスで特殊な処理を必要とするメニューボタンを置き換える必要があります。

##  <a name="oncontexthelp"></a>CMFCToolBarMenuButton:: OnContextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

から*pWnd*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="ondraw"></a>CMFCToolBarMenuButton:: OnDraw

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>パラメーター

から*pDC*<br/>
から*rect*<br/>
から*Pimages*<br/>
から*bHorz*<br/>
から*Bカスタマイズの emode*<br/>
から*Bhighlight 表示*<br/>
[in] *bDrawBorder*<br/>
から*bGrayDisabledButtons*<br/>

### <a name="remarks"></a>Remarks

##  <a name="ondrawoncustomizelist"></a>CMFCToolBarMenuButton:: OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>パラメーター

から*pDC*<br/>
から*rect*<br/>
から*選択された bselected*<br/>

### <a name="return-value"></a>戻り値

### <a name="remarks"></a>Remarks

##  <a name="openpopupmenu"></a>  CMFCToolBarMenuButton::OpenPopupMenu

ユーザーがツールバーのメニューボタンのドロップダウンメニューを開いたときに、フレームワークによって呼び出されます。

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
からドロップダウンメニューコマンドを受け取るウィンドウを指定します。 ツールバーのメニューボタンに親ウィンドウがある場合にのみ、NULL を指定できます。

### <a name="return-value"></a>戻り値

[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)オブジェクトが作成され、正常に開かれた場合は TRUE です。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

この関数は、ユーザーがツールバーのメニューボタンからドロップダウンメニューを開いたときに、フレームワークによって呼び出されます。

##  <a name="resetimagetodefault"></a>  CMFCToolBarMenuButton::ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Remarks

##  <a name="savebarstate"></a>CMFCToolBarMenuButton:: SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Remarks

フレームワークは、ドラッグアンドドロップ操作の結果としてツールバーボタンを作成するときに、このメソッドを呼び出します。 このメソッドは、トップレベルポップアップメニューの[CMFCPopupMenu:: SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate)メソッドを呼び出します。これにより、ポップアップメニューの親ボタンがメニューを再作成します。

##  <a name="serialize"></a>CMFCToolBarMenuButton:: Serialize

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

から*ar*<br/>

### <a name="remarks"></a>Remarks

##  <a name="setaccdata"></a>CMFCToolBarMenuButton:: SetACCData

リボン要素のアクセシビリティ データを設定します。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>パラメーター

*pParent*<br/>
リボン要素の親ウィンドウ。

*data*<br/>
リボン要素のアクセシビリティ データ。

### <a name="return-value"></a>戻り値

常に TRUE を返します。

### <a name="remarks"></a>Remarks

既定では、このメソッドはリボン要素のアクセシビリティデータを設定し、常に TRUE を返します。 アクセシビリティ データを設定し、成功または失敗を示す値を返すようにするには、このメソッドをオーバーライドします。

##  <a name="setmenuonly"></a>CMFCToolBarMenuButton:: SetMenuOnly

有効なコマンド ID とサブメニューの両方がある場合に、ボタンをメニューボタンとして描画するか分割ボタンとして描画するかを指定します。

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>パラメーター

*bMenuOnly*<br/>
から有効なコマンド id とサブメニューの両方がある場合に、このボタンをメニューボタンとして表示する場合は TRUE。有効なコマンド ID とサブメニューの両方がある場合は、このボタンを分割ボタンとして表示する場合は FALSE。

### <a name="remarks"></a>Remarks

通常、ツールバーのメニューボタンにサブメニューとコマンド ID の両方がある場合、メニューは、メインボタンと下向きの矢印ボタンが付いた分割ボタンとして表示されます。 このメソッドを呼び出し、 *Bmenuonly*が TRUE の場合、ボタンは、ボタンの下矢印が付いた単一のメニューボタンとして表示されます。 ユーザーがいずれかのモードで矢印をクリックすると、サブメニューが開き、ユーザーがいずれかのモードでボタンの矢印以外の部分をクリックすると、フレームワークによってコマンドが実行されます。

##  <a name="setmenupalettemode"></a>CMFCToolBarMenuButton:: SetMenuPaletteMode

ドロップダウンメニューをパレットモードにするかどうかを指定します。

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>パラメーター

*bMenuPaletteMode*<br/>
からドロップダウンメニューをパレットモードにするかどうかを指定します。

*nPaletteRows*<br/>
からパレットの行数。

### <a name="remarks"></a>Remarks

パレットモードでは、すべてのメニュー項目が複数列のパレットとして表示されます。 *NPaletteRows*を使用して、行数を指定します。

##  <a name="setmessagewnd"></a>CMFCToolBarMenuButton:: SetMessageWnd

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>パラメーター

から*pWndMessage*<br/>

### <a name="remarks"></a>Remarks

##  <a name="setradio"></a>CMFCToolBarMenuButton:: SetRadio

チェックボックスをオンにすると、オプションボタンのスタイルアイコンを表示するためのツールバーメニューボタンを設定します。

```
virtual void SetRadio();
```

### <a name="remarks"></a>Remarks

チェックされている間にメニューボタンが描画されると、[ [Cmfcvisualmanager:: OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck) ] を呼び出してチェックマークアイコンを描画します。 既定では`OnDrawMenuCheck` 、は、現在のビジュアルマネージャーがメニューボタンにチェックボックスのスタイルチェックマークを描画することを要求します。 このメソッドを呼び出した後、現在のビジュアルマネージャーはメニューボタンにラジオボタンのスタイルチェックマークを描画します。 この変更を元に戻すことはできません。

このメソッドを呼び出し、メニューボタンが現在表示されている場合は、更新されます。

##  <a name="settearoff"></a>CMFCToolBarMenuButton:: SetTearOff

ドロップダウンメニューのティアオフバーの ID を指定します。

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>パラメーター

*uiBarID*<br/>
から新しいティアオフバー ID を指定します。

### <a name="remarks"></a>Remarks

ユーザーがメニューバーからメニューボタンをドラッグしたときに作成されるティアオフバーの ID を指定するには、このメソッドを呼び出します。 *Uibarid*パラメーターが0の場合、ユーザーはメニューボタンを無効にすることはできません。

[CWinAppEx:: EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus)を呼び出して、アプリケーションでティアオフメニュー機能を有効にします。

## <a name="see-also"></a>関連項目

[階層図](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton クラス](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar クラス](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu クラス](../../mfc/reference/cmfcpopupmenu-class.md)
