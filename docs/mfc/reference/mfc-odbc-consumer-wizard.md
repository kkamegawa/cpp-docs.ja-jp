---
title: MFC ODBC コンシューマー ウィザード
ms.date: 08/29/2019
helpviewer_keywords:
- wizards [MFC]
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
ms.openlocfilehash: 84fdc0d180f5b1b0f2e64c3597cb474611ad3914
ms.sourcegitcommit: e10a5feea193c249ddc5a6faba48e7c6d8784e73
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/30/2019
ms.locfileid: "70177437"
---
# <a name="mfc-odbc-consumer-wizard"></a>MFC ODBC コンシューマー ウィザード

::: moniker range="vs-2019"

このウィザードは、Visual Studio 2019 以降では利用できません。

::: moniker-end

::: moniker range="<=vs-2017"

このウィザードでは、指定されたデータソースにアクセスするために必要な ODBC レコードセットクラスとデータバインドを設定します。

## <a name="uielement-list"></a>UIElement の一覧

- **Data Source**

  **[データソース]** ボタンを使用すると、指定した ODBC ドライバーを使用して、指定したデータソースを設定できます。 データソースファイル (DSN) の詳細については、「ODBC SDK の[ファイルデータソース](/sql/odbc/reference/file-data-sources)」を参照してください。

  **[データソースの選択**] ダイアログボックスには、次の2つのタブがあります。

  - **[ファイルデータソース]** タブ:

     **[検索対象]** ボックスでは、データソースとして使用するファイルを選択するディレクトリを指定します。 既定値は、Files\Common Files\ODBC\Data Sources です。 既存のファイルデータソース (dsn ファイル) がメインリストボックスに表示されます。 [ODBC データソースアドミニストレーター](/sql/odbc/admin/odbc-data-source-administrator)の **[ファイル DSN]** タブを使用して事前にデータソースを設定するか、このダイアログボックスを使用して新しいデータソースを作成することができます。

     このダイアログボックスから新しいファイルデータソースを作成するには`New` 、をクリックして DSN 名を指定します。 **[新しいデータソースの作成]** ダイアログボックスが表示されます。 **新しいデータソースの作成** ダイアログボックスで、適切なドライバー `Next`を選択してクリックし、**参照** をクリックして、データソースとして使用するファイルの名前を選択します (.xls ファイルなどの非 DSN ファイルを表示するには、すべてのファイル を選択する必要があります)。 をクリックし、完了 をクリックします。 `Next` (DSN 以外のファイルを選択した場合は、"ODBC Microsoft Excel セットアップ" などのドライバー固有のダイアログボックスが表示され、ファイルが DSN に変換されます)。

     > [!NOTE]
     > ODBC データソースアドミニストレーターを使用して、事前に新しいファイルデータソースを作成することもできます。 **[スタート]** メニューから、 **[設定]** 、 **[コントロールパネル]** 、 **[管理ツール]** 、 **[データソース (odbc)]** の順に選択し、 **[odbc データソースアドミニストレーター]** をクリックします。

     **[DSN 名]** ボックスでは、ファイルデータソースの名前を指定できます。 DSN 名は、Excel ファイルの場合は .xls、Access ファイルの場合は .mdb など、適切なファイル拡張子で終わる必要があります。

     Dsn の詳細については、「ODBC SDK の[ファイルデータソース](/sql/odbc/reference/file-data-sources)」を参照してください。

  - **[マシンデータソース]** タブ:

     このタブには、システムデータソースとユーザーデータソースが一覧表示されます。 ユーザーデータソースは、このコンピューター上のユーザーに固有です。 システムデータソースは、このコンピューター上のすべてのユーザーまたはシステム全体のサービスで使用できます。 ODBC SDK の「[マシンデータソース](/sql/odbc/reference/machine-data-sources)」を参照してください。

     ODBC データソースの詳細については、「ODBC SDK の[データソース](/sql/odbc/reference/data-sources)」を参照してください。

  **[OK]** をクリックして終了します。 **[データベース オブジェクトの選択]** ダイアログ ボックスが表示されます。 このダイアログボックスで、コンシューマーが使用するテーブルまたはビューを選択します。 複数のビューおよびテーブルを選択するには、コントロールキーを押しながら項目をクリックします。 **[OK]** をクリックして終了します。

- **Class**

      The name of the consumer class, based by default on the name of the file or machine data source that you selected.

- **.h ファイル**

   コンシューマークラスのヘッダーファイルの名前。既定では、選択したファイルまたはマシンのデータソースの名前に基づきます。

- **.cpp ファイル**

   コンシューマークラスの実装ファイルの名前。既定では、選択したファイルまたはマシンのデータソースの名前に基づきます。

- **Type**

   レコードセットがダイナセット (既定値) とスナップショットのどちらであるかを指定します。

   - **ダイナセット**:レコードセットがダイナセットであることを指定します。 ダイナセットは、クエリを実行した結果、クエリを実行したデータベースのデータにインデックス付きビューを提供します。 ダイナセットは、元のデータに対して整数のインデックスのみをキャッシュするため、スナップショットに対するパフォーマンスの向上を実現します。 インデックスは、クエリの結果として検出された各レコードを直接指し、レコードが削除されたかどうかを示します。 また、クエリされたレコードの更新された情報にアクセスすることもできます。 既定値です。

   - **スナップショット**:レコードセットがスナップショットであることを指定します。 スナップショットは、クエリの結果であり、ある時点のデータベースのビューです。 クエリの結果として検出されたすべてのレコードがキャッシュされるため、元のレコードに対する変更は表示されません。

- **すべての列をバインドする**

   選択したテーブル内のすべての列がバインドされているかどうかを指定します。 このボックス (既定値) を選択すると、すべての列がバインドされます。このチェックボックスをオンにしない場合は、バインドされている列がないため、レコードセットクラスでそれらを手動でバインドする必要があります。

::: moniker-end

## <a name="see-also"></a>関連項目

[MFC ODBC コンシューマー](../../mfc/reference/adding-an-mfc-odbc-consumer.md)<br/>
[コード ウィザードを使用した機能の追加](../../ide/adding-functionality-with-code-wizards-cpp.md)
