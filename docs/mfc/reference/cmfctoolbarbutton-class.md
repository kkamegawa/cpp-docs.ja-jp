---
title: CMFCToolBarButton クラス
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: cfdde6aea42ff96957c18ef73f62a4e4f49292ff
ms.sourcegitcommit: a8ef52ff4a4944a1a257bdaba1a3331607fb8d0f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/11/2020
ms.locfileid: "77127445"
---
# <a name="cmfctoolbarbutton-class"></a>CMFCToolBarButton クラス

ツールバーにボタンの機能を提供します。

## <a name="syntax"></a>構文

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|Name|説明|
|----------|-----------------|
|[CMFCToolBarButton:: CMFCToolBarButton](#cmfctoolbarbutton)|`CMFCToolBarButton` オブジェクトを構築して初期化します。|
|`CMFCToolBarButton::~CMFCToolBarButton`|デストラクターです。|

### <a name="public-methods"></a>パブリック メソッド

|Name|説明|
|----------|-----------------|
|[CMFCToolBarButton:: CanBeDropped](#canbedropped)|カスタマイズ中にユーザーがツールバーまたはメニュー上にボタンを配置できるかどうかを指定します。|
|[CMFCToolBarButton:: CanBeStored](#canbestored)|ボタンを格納できるかどうかを指定します。|
|[CMFCToolBarButton:: CanBeStretched](#canbestretched)|カスタマイズ中にユーザーがボタンを引き伸ばすことができるかどうかを指定します。|
|[CMFCToolBarButton:: CompareWith](#comparewith)|指定された `CMFCToolBarButton` オブジェクトとこのインスタンスを比較します。|
|[CMFCToolBarButton:: CopyFrom](#copyfrom)|別のツールバーボタンのプロパティを現在のボタンにコピーします。|
|[CMFCToolBarButton:: CreateFromOleData](#createfromoledata)|指定された `COleDataObject` オブジェクトから `CMFCToolBarButton` オブジェクトを作成します。|
|`CMFCToolBarButton::CreateObject`|このクラス型の動的インスタンスを作成するために、フレームワークで使用されます。|
|[CMFCToolBarButton:: EnableWindow](#enablewindow)|マウス入力およびキーボード入力を有効または無効にします。|
|[CMFCToolBarButton:: ExportToMenuButton](#exporttomenubutton)|ツールバーボタンのテキストをメニューにコピーします。|
|[CMFCToolBarButton:: GetClipboardFormat](#getclipboardformat)|アプリケーションのグローバルクリップボード形式を取得します。|
|[CMFCToolBarButton:: GetHwnd](#gethwnd)|ツールバーボタンに関連付けられているウィンドウハンドルを取得します。|
|[CMFCToolBarButton:: GetImage](#getimage)|ボタンのイメージインデックスを取得します。|
|[CMFCToolBarButton:: GetInvalidateRect](#getinvalidaterect)|再描画する必要があるボタンのクライアント領域の領域を取得します。|
|[CMFCToolBarButton:: GetParentWnd](#getparentwnd)|ボタンの親ウィンドウを取得します。|
|[CMFCToolBarButton:: GetProtectedCommands](#getprotectedcommands)|ユーザーがカスタマイズできないコマンドの一覧を取得します。|
|[CMFCToolBarButton:: GetTextSize](#gettextsize)|ボタンテキストのサイズを取得します。|
|[CMFCToolBarButton:: HasFocus](#hasfocus)|ボタンに現在の入力フォーカスがあるかどうかを判断します。|
|[CMFCToolBarButton:: ホットボーダーを持つ](#havehotborder)|ユーザーがボタンを選択したときに、ボタンの境界線を表示するかどうかを決定します。|
|[CMFCToolBarButton:: IsDrawImage](#isdrawimage)|ボタンにイメージを表示するかどうかを決定します。|
|[CMFCToolBarButton:: IsDrawText](#isdrawtext)|ボタンにテキストラベルを表示するかどうかを決定します。|
|[CMFCToolBarButton:: IsDroppedDown](#isdroppeddown)|ボタンにサブメニューを表示するかどうかを決定します。|
|[CMFCToolBarButton:: IsEditable](#iseditable)|ボタンをカスタマイズできるかどうかを判断します。|
|[CMFCToolBarButton:: IsExtraSize](#isextrasize)|拡張された境界線でボタンを表示できるかどうかを決定します。|
|[CMFCToolBarButton:: IsFirstInGroup](#isfirstingroup)|ボタンがボタングループの最初の位置にあるかどうかを判断します。|
|[CMFCToolBarButton:: IsHidden](#ishidden)|ボタンを非表示にするかどうかを決定します。|
|[CMFCToolBarButton:: IsHorizontal](#ishorizontal)|ボタンが水平ツールバーに配置されているかどうかを判断します。|
|[CMFCToolBarButton:: IsLastInGroup](#islastingroup)|ボタンがボタングループの最後の位置にあるかどうかを指定します。|
|[CMFCToolBarButton:: IsLocked](#islocked)|ボタンがロックされている (カスタマイズできない) ツールバーにあるかどうかを判断します。|
|[CMFCToolBarButton:: IsOwnerOf](#isownerof)|ボタンが、指定されたウィンドウハンドルの所有者かどうかを判断します。|
|[CMFCToolBarButton:: IsVisible](#isvisible)|ツールバーボタンを表示するかどうかを決定します。|
|[CMFCToolBarButton:: IsWindowVisible](#iswindowvisible)|ボタンの基になるウィンドウハンドルを表示するかどうかを決定します。|
|[CMFCToolBarButton:: NotifyCommand](#notifycommand)|ボタンが[WM_COMMAND](/windows/win32/menurc/wm-command)メッセージを処理するかどうかを指定します。|
|[CMFCToolBarButton:: OnAddToCustomizePage](#onaddtocustomizepage)|ボタンが **[カスタマイズ]** ダイアログボックスに追加されたときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnBeforeDrag](#onbeforedrag)|ボタンをドラッグできるかどうかを指定します。|
|[CMFCToolBarButton:: OnBeforeDrop](#onbeforedrop)|ユーザーがボタンを対象のツールバーにドロップできるかどうかを指定します。|
|[CMFCToolBarButton:: On電卓 Atesize](#oncalculatesize)|指定されたデバイスコンテキストとドッキング状態のボタンのサイズを計算するために、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnCancelMode](#oncancelmode)|[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)メッセージを処理するためにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnChangeParentWnd](#onchangeparentwnd)|新しいツールバーにボタンが挿入されたときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnClick](#onclick)|ユーザーがマウスボタンをクリックしたときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnClickUp](#onclickup)|ユーザーがマウスボタンを離したときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnContextHelp](#oncontexthelp)|親ツールバーが WM_HELPHITTEST メッセージを処理するときに、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnCtlColor](#onctlcolor)|親ツールバーが WM_CTLCOLOR メッセージを処理するときに、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: Onカスタマイズ Emenu](#oncustomizemenu)|親ツールバーにアプリケーションがショートカットメニューを表示するときに、指定されたメニューをボタンが変更できるようにします。|
|[CMFCToolBarButton:: OnDblClk](#ondblclk)|親ツールバーが[WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk)メッセージを処理するときに、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnDraw](#ondraw)|指定されたスタイルとオプションを使用してボタンを描画するために、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnDrawOnCustomizeList](#ondrawoncustomizelist)|**[カスタマイズ]** ダイアログボックスの **[コマンド]** ウィンドウにボタンを描画するために、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnGetCustomToolTipText](#ongetcustomtooltiptext)|ボタンのカスタムツールヒントテキストを取得するために、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: Onglobalフォントの変更](#onglobalfontschanged)|グローバルフォントが変更されたときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnMove](#onmove)|親ツールバーが移動したときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnShow](#onshow)|ボタンが表示または非表示になったときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnSize](#onsize)|親ツールバーがサイズまたは位置を変更し、この変更によってボタンのサイズを変更する必要がある場合に、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnToolHitTest](#ontoolhittest)|親ツールバーがボタンの外接する四角形にポイントがあるかどうかを判断する必要がある場合に、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: OnUpdateToolTip](#onupdatetooltip)|親ツールバーがツールヒントテキストを更新するときに、フレームワークによって呼び出されます。|
|[CMFCToolBarButton::P repareDrag](#preparedrag)|ボタンがドラッグアンドドロップ操作を実行しようとしているときに、フレームワークによって呼び出されます。|
|[CMFCToolBarButton:: Rect](#rect)|ボタンの外接する四角形を取得します。|
|[CMFCToolBarButton:: ResetImageToDefault](#resetimagetodefault)|は、ボタンに関連付けられているイメージを既定値に設定します。|
|[CMFCToolBarButton:: SaveBarState](#savebarstate)|ツールバーボタンの状態を保存します。|
|[CMFCToolBarButton:: Serialize](#serialize)|アーカイブからこのオブジェクトを読み取るか、アーカイブに書き込みます。 ( [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize)をオーバーライドします)。|
|[CMFCToolBarButton:: Setのデータ](#setaccdata)|ツールバーボタンのユーザー補助データを使用して、提供された `CAccessibilityData` オブジェクトを設定します。|
|[CMFCToolBarButton:: Setクリップの Formatname](#setclipboardformatname)|グローバルクリップボード形式の名前を変更します。|
|[CMFCToolBarButton:: SetImage](#setimage)|ボタンのイメージインデックスを設定します。|
|[CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands)|ユーザーがカスタマイズできないコマンドの一覧を設定します。|
|[CMFCToolBarButton:: SetRadio](#setradio)|ボタンがチェックされた状態を変更したときにフレームワークによって呼び出されます。|
|[CMFCToolBarButton:: SetRect](#setrect)|ボタンの外接する四角形を設定します。|
|[CMFCToolBarButton:: System.windows.forms.control.setstyle](#setstyle)|ボタンのスタイルを設定します。|
|[CMFCToolBarButton:: SetVisible](#setvisible)|ボタンを表示するかどうかを指定します。|
|[CMFCToolBarButton:: Show](#show)|ボタンの表示と非表示を切り替えます。|

### <a name="data-members"></a>データ メンバー

|Name|説明|
|----------|-----------------|
|[CMFCToolBarButton:: m_bImage](#m_bimage)|ボタンにイメージを表示するかどうかを指定します。|
|[CMFCToolBarButton:: m_bText](#m_btext)|ボタンにテキストラベルを表示するかどうかを指定します。|
|[CMFCToolBarButton:: m_bTextBelow](#m_btextbelow)|ボタンのイメージの下にテキストラベルを表示するかどうかを指定します。|
|[CMFCToolBarButton:: m_bUserButton](#m_buserbutton)|ボタンにユーザー定義のイメージがあるかどうかを指定します。|
|[CMFCToolBarButton:: m_bWholeText](#m_bwholetext)|ボタンが外接する四角形に収まりきらない場合でもフルテキストラベルを表示するかどうかを指定します。|
|[CMFCToolBarButton:: m_bWrap](#m_bwrap)|区切り記号の横にあるボタンを次の行に配置するかどうかを指定します。|
|[CMFCToolBarButton:: m_bWrapText](#m_bwraptext)|複数行のテキストラベルを有効にするかどうかを指定します。|
|[CMFCToolBarButton:: m_nID](#m_nid)|ボタンのコマンド ID。|
|[CMFCToolBarButton:: m_nStyle](#m_nstyle)|ボタンのスタイル。|
|[CMFCToolBarButton:: m_strText](#m_strtext)|ボタンのテキストラベル。|

## <a name="remarks"></a>コメント

`CMFCToolbarButton` オブジェクトは、ツールバー上に存在するコントロールです。 動作は、通常のボタンの動作に似ています。 このオブジェクトには、イメージとテキストラベルを割り当てることができます。 ツールバーのボタンには、コマンド ID を設定することもできます。 ユーザーがツールバーボタンをクリックすると、フレームワークによって、この ID によって指定されたコマンドが実行されます。

通常、ツールバーボタンはカスタマイズできます。ユーザーは、ボタンを1つのツールバーから別のツールバーにドラッグしたり、テキストラベルや画像をコピー、貼り付け、削除、編集したりできます。 ユーザーがツールバーをカスタマイズできないようにするには、次の2つの方法のいずれかでツールバーをロックします。 [Cmfctoolbar:: LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)を呼び出すときに `bLocked` フラグを TRUE に設定するか、 [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands)メソッドを使用して、保護されたコマンドのグローバルリストに個々のボタンのコマンド ID を追加します。

`CMFCToolBarButton` オブジェクトは、アプリケーションのツールバーイメージのグローバルコレクションのイメージを表示します。 これらのコレクションは、親ツールバーである[Cmfctoolbar クラス](../../mfc/reference/cmfctoolbar-class.md)によって管理されます。 詳細については、「 [Cmfctoolbarimages クラス](../../mfc/reference/cmfctoolbarimages-class.md)」を参照してください。

ユーザーがツールバーボタンをクリックすると、親ツールバーがマウスメッセージを処理し、適切なアクションをボタンに伝えます。 このボタンに有効なコマンド ID が指定されている場合、親ツールバーは WM_COMMAND メッセージを親フレームに送信します。

`CMFCToolBarButton` クラスは、 [Cmfctoolbarmenubutton クラス](../../mfc/reference/cmfctoolbarmenubutton-class.md)、 [CMFCToolBarEditBoxButton クラス](../../mfc/reference/cmfctoolbareditboxbutton-class.md)、 [CMFCToolBarComboBoxButton クラス](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md)など、他のツールバーボタンクラスの基本クラスです。

## <a name="example"></a>例

次の例は、`CMFCToolBarButton` クラスのさまざまなメソッドを使用して `CMFCToolBarButton` オブジェクトを構成する方法を示しています。 この例では、マウスとキーボード入力を有効にする方法、ボタンのイメージインデックスを設定する方法、ボタンの外接する四角形を設定する方法、ボタンを表示する方法を示します。 このコードスニペットは、[タブコントロールのサンプル](../../overview/visual-cpp-samples.md)に含まれています。

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>要件

**ヘッダー:** afxtoolbarbutton

##  <a name="canbedropped"></a>CMFCToolBarButton:: CanBeDropped

カスタマイズ中にユーザーがツールバーまたはメニュー上にボタンを配置できるかどうかを指定します。

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>パラメーター

*pToolbar*<br/>
から未使用.

### <a name="return-value"></a>戻り値

このメソッドは TRUE を返します。

### <a name="remarks"></a>コメント

既定では、ツールバーボタンは、カスタマイズ可能な (ロックされていない) ツールバーごとにドロップできます。

このメソッドの既定の実装では、TRUE が返されます。 このメソッドをオーバーライドし、ユーザーがボタンを再配置できないようにする場合は FALSE を返します。

##  <a name="canbestored"></a>CMFCToolBarButton:: CanBeStored

ボタンを格納できるかどうかを判断します。

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>戻り値

このメソッドは TRUE を返します。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを使用して、ボタンがドラッグアンドドロップ操作に参加できるかどうかを判断します。

既定の実装では、TRUE が返されます。 ドラッグアンドドロップ操作の一部としてボタンを格納できない場合は、このメソッドをオーバーライドします。 ドラッグアンドドロップ操作の詳細については、「 [OLE ドラッグアンドドロップ](../../mfc/drag-and-drop-ole.md)」を参照してください。

##  <a name="canbestretched"></a>CMFCToolBarButton:: CanBeStretched

カスタマイズ中にユーザーがボタンを引き伸ばすことができるかどうかを指定します。

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

このメソッドは、ボタンをカスタマイズモードで拡大できるかどうかを判断するために、フレームワークによって使用されます。

このメソッドの既定の実装では、FALSE が返されます。 コンボボックスやスライダーなどの可変幅コントロールに対して TRUE を返すには、このメソッドをオーバーライドします。

カスタマイズモードの詳細については、「 [Cmfctoolbar:: Setcustomization emode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)」を参照してください。

##  <a name="cmfctoolbarbutton"></a>CMFCToolBarButton:: CMFCToolBarButton

`CMFCToolBarButton` オブジェクトを構築して初期化します。

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>パラメーター

*uiID*<br/>
からボタンのコマンド ID。

*iImage*<br/>
からイメージのコレクション内のボタンのイメージインデックス。

*lpszText*<br/>
からボタンのテキストラベル。 NULL にすることができます。

*bUserButton*<br/>
からボタンがユーザー定義であるかどうかを示すブール値。 このパラメーターが TRUE の場合、ボタンはユーザー定義です。 それ以外の場合、ボタンイメージはリソースから読み込まれます。

*化*<br/>
からボタンをカスタマイズできるかどうかを決定するブール値。 このパラメーターが TRUE の場合、ボタンをカスタマイズすることはできません。 それ以外の場合は、ボタンをカスタマイズできます。

##  <a name="comparewith"></a>CMFCToolBarButton:: CompareWith

指定された `CMFCToolBarButton` オブジェクトとこのインスタンスを比較します。

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>パラメーター

*other*<br/>
からこのインスタンスと比較するオブジェクトへの参照。

### <a name="return-value"></a>戻り値

指定されたオブジェクトがこのインスタンスの値と等しい場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>コメント

既定の実装は、指定されたオブジェクトのコマンド ID がこのインスタンスのコマンド ID と等しいかどうかを判断します。 2つの `CMFCToolBarButton` オブジェクトが等しいかどうかを判断するために追加の処理を実行する必要がある場合は、このメソッドをオーバーライドします。

##  <a name="copyfrom"></a>CMFCToolBarButton:: CopyFrom

別のツールバーボタンのプロパティを現在のボタンにコピーします。

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>パラメーター

*src*<br/>
[in]コピー元のソースボタンへの参照。

### <a name="remarks"></a>コメント

このツールバーボタンに別のツールバーボタンをコピーするには、このメソッドを呼び出します。

##  <a name="createfromoledata"></a>CMFCToolBarButton:: CreateFromOleData

指定された `COleDataObject` オブジェクトから `CMFCToolBarButton` オブジェクトを作成します。

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
からソース OLE データオブジェクト。

### <a name="return-value"></a>戻り値

作成される `CMFCToolBarButton` オブジェクト。

### <a name="remarks"></a>コメント

このメソッドは、さまざまな形式でデータ転送を実行するためにフレームワークによって使用されます。 たとえば、`CMFCOutlookBarPane::OnDragOver` メソッドでは、このメソッドを使用してドラッグアンドドロップ操作を実行します。

##  <a name="enablewindow"></a>CMFCToolBarButton:: EnableWindow

マウス入力およびキーボード入力を有効または無効にします。

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>パラメーター

*bEnable*<br/>
から入力を有効にする場合は、このパラメーターを TRUE に設定します。入力を無効にする場合は FALSE に設定します。

### <a name="remarks"></a>コメント

このメソッドは、`EnableWindow` 関数を呼び出して、入力を有効または無効にします。 詳細については、Windows SDK の「 [Enablewindow](/windows/win32/api/winuser/nf-winuser-enablewindow) 」を参照してください。

##  <a name="exporttomenubutton"></a>CMFCToolBarButton:: ExportToMenuButton

ツールバーボタンのテキストをメニューにコピーします。

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>パラメーター

*menuButton*<br/>
からターゲットメニューボタンへの参照。

### <a name="return-value"></a>戻り値

このメソッドは TRUE を返します。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、ツールバーのボタンからメニューボタンにテキストをコピーします。 既定の実装では、ボタンのテキストラベルがコピーされます。 テキストラベルが空の場合、このメソッドはボタンのツールヒントテキストをコピーします。

このメソッドの既定の実装では、TRUE が返されます。 [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)から派生したオブジェクトを、フレームワークがメニューボタンに変換するときに追加のアクションを実行する場合は、このメソッドをオーバーライドします。

##  <a name="getclipboardformat"></a>CMFCToolBarButton:: GetClipboardFormat

アプリケーションのグローバルクリップボード形式を取得します。

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>戻り値

アプリケーションのグローバルな CLIPFORMAT 値。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、OLE データ転送操作のクリップボード形式を取得します。 たとえば、 [CMFCToolBarButton:: CreateFromOleData](#createfromoledata)メソッドは、このメソッドを使用して、ソース OLE データオブジェクトからデータをコピーします。

このメソッドは、このメソッドが初めて呼び出されたときに、グローバルな CLIPFORMAT の値を設定します。 このメソッドへの後続の呼び出しはすべて、この値を返します。

アプリケーション間でドラッグアンドドロップ操作を実行できるようにするには、 [CMFCToolBarButton:: Set formatname](#setclipboardformatname)メソッドを呼び出します。

MFC でのクリップボードの詳細については、「[クリップボード](../../mfc/clipboard.md)」を参照してください。

##  <a name="gethwnd"></a>CMFCToolBarButton:: GetHwnd

ツールバーボタンに関連付けられているウィンドウハンドルを取得します。

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>戻り値

ツールバーボタンに関連付けられているウィンドウハンドル。ツールバーのボタンにウィンドウハンドルが関連付けられていない場合は NULL。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、NULL が返されます。 このメソッドをオーバーライドすると、特定のコントロールのウィンドウハンドルが返されます。

##  <a name="getimage"></a>CMFCToolBarButton:: GetImage

ボタンのイメージインデックスを取得します。

```
int GetImage() const;
```

### <a name="return-value"></a>戻り値

このボタンに関連付けられているイメージのインデックス。

### <a name="remarks"></a>コメント

ボタンにユーザー定義のイメージがある場合 (つまり、 *Buserbutton*がコンストラクターで TRUE であった場合)、返されたインデックスはユーザー定義のイメージのコレクション内のイメージを指定します (「 [Cmfctoolbar:: getuserimages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)」を参照してください)。 それ以外の場合、インデックスは、リソースファイルから読み込まれるイメージのコレクション内のイメージを指定します (「 [Cmfctoolbar:: GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)」を参照してください)。 リソースファイルの詳細については、「[リソースファイルの操作](../../windows/working-with-resource-files.md)」を参照してください。

##  <a name="getinvalidaterect"></a>CMFCToolBarButton:: GetInvalidateRect

再描画する必要があるボタンのクライアント領域の領域を取得します。

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>戻り値

再描画する必要がある領域を指定する `CRect` オブジェクト。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、クライアント領域全体が返されます。 別の領域を再描画する場合は、このメソッドをオーバーライドします。

##  <a name="getparentwnd"></a>CMFCToolBarButton:: GetParentWnd

ボタンの親ウィンドウを取得します。

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>戻り値

ボタンの親ウィンドウ。

##  <a name="getprotectedcommands"></a>CMFCToolBarButton:: GetProtectedCommands

ユーザーがカスタマイズできないコマンドの一覧を取得します。

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>戻り値

保護されたコマンドの一覧。

### <a name="remarks"></a>コメント

カスタマイズモードでは、フレームワークによって保護されているツールバーボタンコマンドが無効になります。 ユーザーは、無効になっているツールバーボタンに対してドラッグアンドドロップおよび編集操作を実行できません。

[CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands)メソッドを使用して、保護されたコマンドの一覧を定義します。

##  <a name="gettextsize"></a>CMFCToolBarButton:: GetTextSize

ボタンテキストのサイズを取得します。

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>戻り値

ボタンテキストのサイズ (ピクセル単位) を格納しているサイズオブジェクト。

##  <a name="hasfocus"></a>CMFCToolBarButton:: HasFocus

ボタンに現在の入力フォーカスがあるかどうかを判断します。

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>戻り値

ボタンに入力フォーカスがある場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、ボタンに入力フォーカスがある場合、または入力フォーカスのあるウィンドウの子または子孫ウィンドウの場合、0以外の値が返されます。 この関数をオーバーライドして、この動作をカスタマイズできます。

##  <a name="havehotborder"></a>CMFCToolBarButton:: ホットボーダーを持つ

ユーザーがボタンを選択したときに、ボタンの境界線を表示するかどうかを決定します。

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>戻り値

このメソッドは TRUE を返します。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、ユーザーがツールバーボタンを選択したときにその境界線を表示するかどうかを決定します。

既定の実装では、TRUE が返されます。 このメソッドをオーバーライドして、この動作をカスタマイズできます。

##  <a name="isdrawimage"></a>CMFCToolBarButton:: IsDrawImage

ボタンにイメージを表示するかどうかを決定します。

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>戻り値

ボタンにイメージが表示されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

このメソッドは、ツールバーボタンに関連付けられているイメージがない場合 ( [CMFCToolBarButton:: GetImage](#getimage)が-1 を返した場合)、または[CMFCToolBarButton:: m_bImage](#m_bimage)が false に設定されている場合は false を返します。

##  <a name="isdrawtext"></a>CMFCToolBarButton:: IsDrawText

ボタンにテキストラベルを表示するかどうかを決定します。

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>戻り値

テキストラベルを表示する場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

ツールバーボタンにテキストラベルが関連付けられていない場合 ( [CMFCToolBarButton:: m_strText](#m_strtext)が空の場合)、または[CMFCToolBarButton:: m_bText](#m_btext)が false に設定されている場合、このメソッドは false を返します。

##  <a name="isdroppeddown"></a>CMFCToolBarButton:: IsDroppedDown

ボタンにサブメニューを表示するかどうかを決定します。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、FALSE が返されます。 コントロールにサブメニューが表示されている場合は、このメソッドをオーバーライドして TRUE を返します。

##  <a name="iseditable"></a>CMFCToolBarButton:: IsEditable

ボタンをカスタマイズできるかどうかを判断します。

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>戻り値

ユーザーがボタンをカスタマイズできる場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、ユーザーがドラッグアンドドロップ操作または編集操作を使用してツールバーボタンをカスタマイズできるかどうかを判断します。

既定の実装では、ボタンのコマンド ID が標準コマンドである場合は FALSE が返されます (`IsStandardCommand` 関数を呼び出すことによって判断できます)。または、コマンド ID が保護されたコマンドの一覧に含まれている場合はです。 保護されたコマンドの詳細については、「 [CMFCToolBarButton:: GetProtectedCommands](#getprotectedcommands) and [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands)」を参照してください。

動作をカスタマイズするには、このメソッドをオーバーライドします。

##  <a name="isextrasize"></a>CMFCToolBarButton:: IsExtraSize

拡張された境界線でボタンを表示できるかどうかを決定します。

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>戻り値

拡張境界線を使用してツールバーボタンを表示できる場合は0以外。それ以外の場合は0です。

### <a name="remarks"></a>コメント

いくつかのスキンでは、ツールバーボタンの境界線 (丸いボタンなど) に余分なサイズが使用されます。

ユーザーがこのボタンをあるツールバーから別のツールバーに移動した場合、フレームワークは[CMFCToolBarButton:: OnChangeParentWnd](#onchangeparentwnd)メソッドを呼び出します。 [CMFCToolBarButton:: OnChangeParentWnd](#onchangeparentwnd)メソッドは、追加のサイズフラグを新しい親ツールバーのに設定します (詳細については、「 [Cmfctoolbar:: IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)」を参照してください)。

##  <a name="isfirstingroup"></a>CMFCToolBarButton:: IsFirstInGroup

ボタンがボタングループの最初の位置にあるかどうかを判断します。

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>戻り値

ボタンがボタングループの最初のボタンである場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

このメソッドは、同じ行に配置され、区切り記号またはツールバーの境界線によって制限される、隣接するボタンのセットとして*ボタングループ*を定義します。 ツールバーのボタンが **[カスタマイズ]** ボタンを参照している場合、このメソッドは FALSE を返します。 **[カスタマイズ]** ボタンの詳細については、「 [Cmfctoolbar:: GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)」を参照してください。

[CMFCToolBarButton:: IsLastInGroup](#islastingroup)メソッドを呼び出して、ボタンがボタングループの最後の位置にあるかどうかを確認します。

##  <a name="ishidden"></a>CMFCToolBarButton:: IsHidden

ボタンを非表示にするかどうかを決定します。

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>戻り値

ボタンが非表示 (非表示) の場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

フレームワークは、親ツールバーが拡大され、ツールバーボタンが表示されるかどうかを判断するときに、このメソッドを呼び出します。

[CMFCToolBarButton:: SetVisible](#setvisible)メソッドを使用してボタンを非表示に設定した場合は、 [CMFCToolBarButton:: IsVisible](#isvisible)を使用して、ツールバーボタンが表示されているかどうかを確認します。

既定では、すべてのツールバーボタンが表示されます。 ツールバーボタンを表示または非表示にするには、 [CMFCToolBarButton:: Show](#show)メソッドを使用します。

##  <a name="ishorizontal"></a>CMFCToolBarButton:: IsHorizontal

ボタンが水平ツールバーに配置されているかどうかを判断します。

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>戻り値

ツールバーボタンが水平ツールバーに配置されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、ツールバーボタンのレイアウトを決定します。

このメソッドは、`m_bHorz` データメンバーを返します。 `m_bHorz` データメンバーの既定値は TRUE です。[CMFCToolBarButton:: OnDraw](#ondraw)メソッドを呼び出すたびにリセットされます。

##  <a name="islastingroup"></a>CMFCToolBarButton:: IsLastInGroup

ボタンがボタングループの最後の位置にあるかどうかを指定します。

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>戻り値

ボタンがボタングループの最後のボタンである場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

このメソッドは、*ボタングループ*を、同じ行に配置され、区切り記号またはツールバーの境界線によって制限される隣接するボタンのセットとして定義します。このメソッドは、ツールバーボタンに親ツールバーがない場合、またはツールバーボタンが **[カスタマイズ]** ボタンを参照している場合に FALSE を返します。 **[カスタマイズ]** ボタンの詳細については、「 [Cmfctoolbar:: GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)」を参照してください。

[CMFCToolBarButton:: IsFirstInGroup](#isfirstingroup)メソッドを呼び出して、ボタンがボタングループの最初の位置にあるかどうかを確認します。

##  <a name="islocked"></a>CMFCToolBarButton:: IsLocked

ボタンがロックされている (カスタマイズできない) ツールバーにあるかどうかを判断します。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>戻り値

ロックされたツールバーにボタンがある場合は0以外。それ以外の場合は0です。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、ユーザーがドラッグアンドドロップ操作または編集操作を使用してツールバーボタンをカスタマイズできるかどうかを判断します。 [Cmfctoolbar:: loadtoolbar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)メソッドを使用して、親ツールバーの locked 属性を設定します。 フレームワークは、親ツールバーに挿入する各ツールバーボタン ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) のコンストラクターに、この属性の値を渡します。

##  <a name="isownerof"></a>CMFCToolBarButton:: IsOwnerOf

ボタンが、指定されたウィンドウハンドルの所有者かどうかを判断します。

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>パラメーター

*hwnd*<br/>
からウィンドウハンドル。

### <a name="return-value"></a>戻り値

ボタンが、指定されたウィンドウハンドルの所有者である場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

*Hwnd*が直接ウィンドウハンドルを参照しているか、ボタンに関連付けられているウィンドウハンドルの子である場合、このメソッドは0以外の値を返します。 *Hwnd*が NULL の場合、このメソッドは0を返します。

##  <a name="isvisible"></a>CMFCToolBarButton:: IsVisible

ツールバーボタンを表示するかどうかを決定します。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>戻り値

ツールバーボタンが表示されている場合は0以外。それ以外の場合は0です。

### <a name="remarks"></a>コメント

[CMFCToolBarButton:: SetVisible](#setvisible)メソッドを使用して、ツールバーボタンの表示と非表示を切り替えることができます。 [CMFCToolBarButton:: SetVisible](#setvisible)を呼び出して親ツールバーのレイアウトを再計算した後、親ツールバーで[CPane:: AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)メソッドを呼び出します。

##  <a name="iswindowvisible"></a>CMFCToolBarButton:: IsWindowVisible

ボタンの基になるウィンドウハンドルを表示するかどうかを決定します。

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>戻り値

ボタンの基になるウィンドウハンドルを表示する場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

基になるウィンドウハンドルの styles 属性に WS_VISIBLE スタイルが含まれている場合、このメソッドは0以外の値を返します。 このメソッドは、ボタンの基になるウィンドウハンドルが NULL の場合に FALSE を返します。

##  <a name="m_bimage"></a>CMFCToolBarButton:: m_bImage

ボタンにイメージを表示するかどうかを指定します。

```
BOOL m_bImage;
```

### <a name="remarks"></a>コメント

このデータメンバーが TRUE に設定されている場合は、ツールバーボタンに関連付けられているイメージがフレームワークによって表示されます。それ以外の場合は、フレームワークによってイメージが表示されません。 このメンバーは、 [CMFCToolBarButton:: m_bImage](#m_bimage)メソッドの戻り値に影響します。

##  <a name="m_btext"></a>CMFCToolBarButton:: m_bText

ボタンにテキストラベルを表示するかどうかを指定します。

```
BOOL m_bText;
```

### <a name="remarks"></a>コメント

このデータメンバーが TRUE に設定されている場合、フレームワークはツールバーボタンのテキストラベルを表示します。それ以外の場合、フレームワークはテキストラベルを表示しません。 このメンバーは、 [CMFCToolBarButton:: m_bText](#m_btext)メソッドの戻り値に影響します。

##  <a name="m_btextbelow"></a>CMFCToolBarButton:: m_bTextBelow

ボタンのイメージの下にテキストラベルを表示するかどうかを指定します。

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>コメント

このメンバー変数が TRUE に設定されている場合、フレームワークは、イメージの下にボタンのテキストを表示します。 このメンバーの既定値は FALSE です。

##  <a name="m_buserbutton"></a>CMFCToolBarButton:: m_bUserButton

ボタンにユーザー定義のイメージがあるかどうかを指定します

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>コメント

このデータメンバーは、ボタンにユーザー定義イメージが関連付けられている場合に TRUE に設定されます。

##  <a name="m_bwholetext"></a>CMFCToolBarButton:: m_bWholeText

ボタンが外接する四角形に収まりきらない場合でもフルテキストラベルを表示するかどうかを指定します。

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>コメント

このデータメンバーが TRUE に設定されている場合、フレームワークはボタンを拡大してフルテキストラベルを表示します。 それ以外の場合は、フレームワークによって切り捨てられ、テキストラベルに省略記号 ( **...** ) が追加されます。

##  <a name="m_bwrap"></a>CMFCToolBarButton:: m_bWrap

区切り記号の横にあるボタンを次の行に配置するかどうかを指定します。

```
BOOL m_bWrap;
```

### <a name="remarks"></a>コメント

フレームワークでは、ツールバーボタンが現在の行に合わない場合、またはレイアウトを指定するときに、このデータメンバーを TRUE に設定します (たとえば、特定の数のツールバーボタンを1行に収めることができます)。

このデータメンバーが TRUE に設定され、ツールバーが水平方向またはフローティング状態にドッキングされている場合、フレームワークは次の行にこのボタンを配置します。

このデータメンバーの既定値は FALSE です。

##  <a name="m_bwraptext"></a>CMFCToolBarButton:: m_bWrapText

複数行のテキストラベルを有効にするかどうかを指定します。

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>コメント

この静的メンバー変数が TRUE の場合、フレームワークでは、ツールバーボタンに複数行のテキストラベルを表示するためのすべてのツールバーが有効になります。

このデータメンバーの既定値は FALSE です。

##  <a name="m_nid"></a>CMFCToolBarButton:: m_nID

ボタンのコマンド ID。

```
UINT m_nID;
```

### <a name="remarks"></a>コメント

コマンド ID-1 は、ボタンが区切り記号であることを示します。 すべてのボタンの区切り記号には、TBBS_SEPARATOR スタイルが設定されています。 ボタンスタイルの詳細については、「 [CMFCToolBarButton:: m_nStyle](#m_nstyle) 」を参照してください。

##  <a name="m_nstyle"></a>CMFCToolBarButton:: m_nStyle

ボタンのスタイル。

```
UINT m_nStyle;
```

### <a name="remarks"></a>コメント

使用可能なツールバーボタンスタイルの一覧については、「[ツールバーコントロールスタイル](../../mfc/reference/toolbar-control-styles.md)」を参照してください。

##  <a name="m_strtext"></a>CMFCToolBarButton:: m_strText

ボタンのテキストラベル。

```
CString m_strText;
```

### <a name="remarks"></a>コメント

このデータメンバーには、ボタンのテキストラベルが含まれています。 テキストラベルは空にすることができます。

##  <a name="notifycommand"></a>CMFCToolBarButton:: NotifyCommand

ボタンが[WM_COMMAND](/windows/win32/menurc/wm-command)メッセージを処理するかどうかを指定します。

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>パラメーター

*iNotifyCode*<br/>
からコマンドに関連付けられている通知メッセージ。

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

フレームワークは、 [WM_COMMAND](/windows/win32/menurc/wm-command)メッセージを親ウィンドウに送信しようとしているときに、このメソッドを呼び出します。

既定では、このメソッドは FALSE を返します。 WM_COMMAND メッセージを処理する場合は TRUE を返し、親ツールバーでメッセージを処理する必要がある場合は FALSE を返すには、このメソッドをオーバーライドします。

##  <a name="onaddtocustomizepage"></a>CMFCToolBarButton:: OnAddToCustomizePage

ボタンが **[カスタマイズ]** ダイアログボックスに追加されたときにフレームワークによって呼び出されます。

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 ボタンが **[カスタマイズ]** ダイアログボックスに追加されたときに何らかのアクションを実行する場合は、このメソッドをオーバーライドします。

##  <a name="onbeforedrag"></a>CMFCToolBarButton:: OnBeforeDrag

ボタンをドラッグできるかどうかを指定します。

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>戻り値

ボタンをドラッグできる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

フレームワークは、ユーザーがボタンのドラッグを開始する前に、このメソッドを呼び出します。

このメソッドの既定の実装では、TRUE が返されます。 このメソッドをオーバーライドすると、ボタンのドラッグを無効にするために FALSE が返されます。

##  <a name="onbeforedrop"></a>CMFCToolBarButton:: OnBeforeDrop

ユーザーがボタンを対象のツールバーにドロップできるかどうかを指定します。

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>パラメーター

*pTarget*<br/>
からドラッグアンドドロップ操作の対象。

### <a name="return-value"></a>戻り値

指定されたターゲットのツールバーにボタンをドロップできる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

フレームワークは、ボタンがツールバーにドロップされる前に、このメソッドを呼び出します。

このメソッドの既定の実装では、TRUE が返されます。 このメソッドをオーバーライドして FALSE を返し、指定されたターゲットでの削除操作を無効にします。

##  <a name="oncalculatesize"></a>CMFCToolBarButton:: On電卓 Atesize

指定されたデバイスコンテキストとドッキング状態のボタンのサイズを計算するために、フレームワークによって呼び出されます。

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
からボタンを表示するデバイスコンテキスト。

*既定値の設定*<br/>
からボタンの既定のサイズ。

*bHorz*<br/>
から親ツールバーのドッキング状態。 このパラメーターは、ツールバーが水平方向にドッキングされている場合、またはフローティング状態の場合は TRUE、ツールバーが垂直方向にドッキングされている場合は FALSE です。

### <a name="return-value"></a>戻り値

ボタンの大きさをピクセル単位で格納する `SIZE` 構造体。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、指定したデバイスコンテキストとドッキング状態のツールバーボタンのサイズを決定します。

既定の実装では、テキストとイメージのサイズ (表示されている場合)、テキストとイメージの位置 (イメージの下または右側のテキスト)、およびツールバーのドッキング状態が考慮されます。

標準以外のボタン (たとえば、エディットボックスボタン) のサイズを指定する場合は、このメソッドをオーバーライドします。

##  <a name="oncancelmode"></a>CMFCToolBarButton:: OnCancelMode

[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)メッセージを処理するためにフレームワークによって呼び出されます。

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 [WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)メッセージを処理する場合は、このメソッドをオーバーライドします。

##  <a name="onchangeparentwnd"></a>CMFCToolBarButton:: OnChangeParentWnd

新しいツールバーにボタンが挿入されたときにフレームワークによって呼び出されます。

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>パラメーター

*pWndParent*<br/>
から新しい親ウィンドウ。

### <a name="remarks"></a>コメント

ツールバーにボタンが挿入されます。たとえば、ユーザーが1つのツールバーから別のツールバーにドラッグした場合などです。

このメソッドの既定の実装では、何も実行されません。

##  <a name="onclick"></a>CMFCToolBarButton:: OnClick

ユーザーがマウスボタンをクリックしたときにフレームワークによって呼び出されます。

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
からツールバーボタンの親ウィンドウ。

*bDelay*<br/>
からメッセージを遅延で処理する必要がある場合は TRUE。

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

フレームワークは、ユーザーがツールバーボタンをクリックしたときにこのメソッドを呼び出します。

既定の実装では、何も実行されず、FALSE が返されます。 ボタンがクリックメッセージを処理する場合は、このメソッドをオーバーライドして0以外の値を返します。

##  <a name="onclickup"></a>CMFCToolBarButton:: OnClickUp

ユーザーがマウスボタンを離したときにフレームワークによって呼び出されます。

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

フレームワークは、ユーザーがツールバーボタンを離したときにこのメソッドを呼び出します。

既定の実装では、何も実行されず、FALSE が返されます。 ボタンがクリックメッセージを処理する場合は、このメソッドをオーバーライドして0以外の値を返します。

##  <a name="oncontexthelp"></a>CMFCToolBarButton:: OnContextHelp

親ツールバーが WM_HELPHITTEST メッセージを処理するときに、フレームワークによって呼び出されます。

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
からツールバーボタンの親ウィンドウ。

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されず、FALSE が返されます。 ボタンがヘルプメッセージを処理する場合は、このメソッドをオーバーライドして0以外の値を返します。

WM_HELPHITTEST メッセージの詳細については、「[テクニカルノート 28: 状況依存のヘルプのサポート](../../mfc/tn028-context-sensitive-help-support.md)」を参照してください。

##  <a name="onctlcolor"></a>CMFCToolBarButton:: OnCtlColor

親ツールバーが WM_CTLCOLOR メッセージを処理するときに、フレームワークによって呼び出されます。

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
からボタンを表示するデバイスコンテキスト。

*nCtlColor*<br/>
から特定の色の通知。

### <a name="return-value"></a>戻り値

フレームワークがボタンの背景を描画するために使用する brush オブジェクトへのハンドル。

### <a name="remarks"></a>コメント

フレームワークは、親ツールバーが Windows コントロールを含むツールバーボタンの WM_CTLCOLOR メッセージを処理するときに、このメソッドを呼び出します。 ツールバーボタンがウィンドウなしの場合、フレームワークはこのメソッドを呼び出しません。

ツールバーフレームワークがカスタマイズモードで、ツールバーボタンがロック解除されている場合、フレームワークはこのメソッドを呼び出します。 カスタマイズモードの詳細については、「 [Cmfctoolbar:: Setcustomization emode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)」を参照してください。 ツールバーボタンのロックの詳細については、「 [CMFCToolBarButton:: IsLocked](#islocked)」を参照してください。

既定の実装では、何も実行されず、NULL が返されます。

##  <a name="oncustomizemenu"></a>CMFCToolBarButton:: Onカスタマイズ Emenu

親ツールバーにアプリケーションがショートカットメニューを表示するときに、指定されたメニューをボタンが変更できるようにします。

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>パラメーター

*pMenu*<br/>
からカスタマイズするメニュー。

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

既定の実装では、何も実行されず、FALSE が返されます。 指定されたメニューの内容を変更する場合は、このメソッドをオーバーライドし、0以外の値を返します。

##  <a name="ondblclk"></a>CMFCToolBarButton:: OnDblClk

親ツールバーが[WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk)メッセージを処理するときに、フレームワークによって呼び出されます。

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
[in]-ボタンの親ウィンドウ。

### <a name="remarks"></a>コメント

このメソッドは、親ツールバーが[WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk)メッセージを処理するときに `CMFCToolBar::OnLButtonDblClk` メソッドによって呼び出されます。

このメソッドの既定の実装では、何も実行されません。

##  <a name="ondraw"></a>CMFCToolBarButton:: OnDraw

指定されたスタイルとオプションを使用してボタンを描画するために、フレームワークによって呼び出されます。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
からボタンを表示するデバイスコンテキスト。

*rect*<br/>
からボタンの外接する四角形。

*pImages*<br/>
からボタンに関連付けられているツールバーイメージのコレクション。

*bHorz*<br/>
から親ツールバーのドッキング状態。 このパラメーターは、ボタンが水平方向にドッキングされている場合は TRUE、ボタンが垂直方向にドッキングされている場合は FALSE です。

*Bカスタマイズの Emode*<br/>
からツールバーがカスタマイズモードであるかどうかを指定します。 このパラメーターは、ツールバーがカスタマイズモードの場合は TRUE、ツールバーがカスタマイズモードでない場合は FALSE です。

*bHighlight 表示*<br/>
からボタンを強調表示するかどうかを指定します。 このパラメーターは、ボタンが強調表示されている場合は TRUE、ボタンが強調表示されていない場合は FALSE になります。

*bDrawBorder*<br/>
からボタンの境界線を表示するかどうかを指定します。 このパラメーターは、ボタンの境界線を表示する場合は TRUE、ボタンの境界線を表示しない場合は FALSE になります。

*bGrayDisabledButtons*<br/>
から無効なボタンを網掛けするか、無効になっているイメージのコレクションを使用するかどうかを指定します。 このパラメーターは、無効にしたボタンを網掛けする場合に TRUE になり、無効になったイメージのコレクションをこのメソッドで使用する必要がある場合は FALSE になります。

### <a name="remarks"></a>コメント

ツールバーボタンの描画をカスタマイズするには、このメソッドをオーバーライドします。

##  <a name="ondrawoncustomizelist"></a>CMFCToolBarButton:: OnDrawOnCustomizeList

**[カスタマイズ]** ダイアログボックスの **[コマンド]** ウィンドウにボタンを描画するために、フレームワークによって呼び出されます。

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
からボタンを表示するデバイスコンテキスト。

*rect*<br/>
からボタンの外接する四角形。

*選択された bSelected*<br/>
からボタンが選択されているかどうかを指定します。 このパラメーターが TRUE の場合、ボタンが選択されます。 このパラメーターが FALSE の場合、ボタンは選択されません。

### <a name="return-value"></a>戻り値

指定したデバイスコンテキストのボタンの幅 (ピクセル単位)。

### <a name="remarks"></a>コメント

このメソッドは、ボタンがオーナー描画リストボックスに表示されようとしているときに、カスタマイズ ダイアログボックス (**コマンド** タブ) によって呼び出されます。

このメソッドの既定の実装では、使用可能な場合、ボタンのイメージとテキストラベルが表示されます。 ボタンのテキストラベルが使用できない場合は、メソッドによってツールヒントのテキストが表示されます。

カスタム描画を実行するには、このメソッドをオーバーライドします。

##  <a name="ongetcustomtooltiptext"></a>CMFCToolBarButton:: OnGetCustomToolTipText

ボタンのカスタムツールヒントテキストを取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>パラメーター

*strToolTip*<br/>
入出力カスタムのツールヒントテキストを受け取る `CString` オブジェクト。

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

フレームワークは、ツールバーボタンのツールヒントを表示するときに、このメソッドを呼び出します。 このメソッドが FALSE を返す場合、フレームワークは既定のツールヒントを使用します。

既定の実装では、何も実行されず、FALSE が返されます。 このメソッドをオーバーライドし、0以外の値を返して、ツールバーボタンにカスタムのツールヒントテキストを指定します。

##  <a name="onglobalfontschanged"></a>CMFCToolBarButton:: Onglobalフォントの変更

グローバルフォントが変更されたときにフレームワークによって呼び出されます。

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 ボタンテキストの表示に使用されるフォントを更新するには、このメソッドをオーバーライドします。

##  <a name="onmove"></a>CMFCToolBarButton:: OnMove

親ツールバーが移動したときにフレームワークによって呼び出されます。

```
virtual void OnMove();
```

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 親ツールバーが移動したときにボタンの位置を変更するには、このメソッドをオーバーライドします。

##  <a name="onshow"></a>CMFCToolBarButton:: OnShow

ボタンが表示または非表示になったときにフレームワークによって呼び出されます。

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>パラメーター

*bShow*<br/>
からボタンを表示するかどうかを指定します。 このパラメーターが TRUE の場合は、ボタンが表示されます。 それ以外の場合、ボタンは表示されません。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 このメソッドをオーバーライドして、ボタンの表示を更新します。

##  <a name="onsize"></a>CMFCToolBarButton:: OnSize

親ツールバーがサイズまたは位置を変更し、この変更によってボタンのサイズが変更されるときに、フレームワークによって呼び出されます。

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>パラメーター

*iSize*<br/>
からボタンの新しい幅。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 親ツールバーのサイズまたは位置が変更されたときに、ボタンのサイズを変更するには、このメソッドをオーバーライドします。

##  <a name="ontoolhittest"></a>CMFCToolBarButton:: OnToolHitTest

親ツールバーがボタンの外接する四角形にポイントがあるかどうかを判断する必要がある場合に、フレームワークによって呼び出されます。

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>パラメーター

*pWnd*<br/>
からボタンの親ウィンドウ。 NULL にすることができます。

*pTI*<br/>
からツールヒントコントロールのツールに関する情報を格納している `TOOLINFO` 構造体。

### <a name="return-value"></a>戻り値

ボタンが親フレームウィンドウへのポインターを取得できる場合は `OnMenuButtonToolHitTest` の結果。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

このメソッドは、親ウィンドウを有効なフレームオブジェクトに変換できる場合、次のいずれかのメソッドを呼び出します。

- [CMDIFrameWndEx:: OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx:: OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

##  <a name="onupdatetooltip"></a>CMFCToolBarButton:: OnUpdateToolTip

親ツールバーがツールヒントテキストを更新するときに、フレームワークによって呼び出されます。

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>パラメーター

*pWndParent*<br/>
から親ウィンドウ。

*iButtonIndex*<br/>
から親ボタンコレクション内のボタンの0から始まるインデックス。

*wndToolTip*<br/>
からツールヒントのテキストを表示するコントロール。

*str*<br/>
入出力更新されたツールヒントテキストを受け取る `CString` オブジェクト。

### <a name="return-value"></a>戻り値

このメソッドは FALSE を返します。

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されず、FALSE が返されます。 ツールヒントテキスト文字列を指定した場合は、このメソッドをオーバーライドして0以外の値を返します。

##  <a name="preparedrag"></a>CMFCToolBarButton::P repareDrag

ボタンがドラッグアンドドロップ操作を実行しようとしているときに、フレームワークによって呼び出されます。

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>パラメーター

*srcItem*<br/>
からドラッグアンドドロップ操作に関する状態情報を格納する `COleDataSource` オブジェクト。

### <a name="return-value"></a>戻り値

操作が成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

フレームワークは、このメソッドを呼び出して、指定された `COleDataSource` オブジェクトに状態を格納するツールバーボタンを準備します。 このメソッドは、それ自体を共有ファイルにシリアル化し、そのファイルを[COleDataSource:: CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata)メソッドに渡すことによって、その状態を格納します。 ツールバーボタンのシリアル化の詳細については、「 [CMFCToolBarButton:: Serialize](#serialize)」を参照してください。

このメソッドは何も実行せず、ボタンを格納できない場合は TRUE を返します ( [CMFCToolBarButton:: CanBeStored](#canbestored)メソッドは FALSE を返します)。 オブジェクトのシリアル化中に例外が発生した場合は、FALSE を返します。

OLE のドラッグアンドドロップ操作の詳細については、「 [ole ドラッグアンドドロップ](../../mfc/drag-and-drop-ole.md)」を参照してください。

##  <a name="rect"></a>CMFCToolBarButton:: Rect

ボタンの外接する四角形を取得します。

```
const CRect& Rect() const;
```

### <a name="return-value"></a>戻り値

ボタンの外接する四角形を格納している `CRect` オブジェクト。

##  <a name="resetimagetodefault"></a>CMFCToolBarButton:: ResetImageToDefault

は、ボタンに関連付けられているイメージを既定値に設定します。

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>コメント

このメソッドは、 [cmfctoolbar:: GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage)メソッドを使用して、親ツールバーから既定のイメージを取得します。 ボタンに関連付けられた既定のイメージがない場合、このメソッドは、 [CStringT:: LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring)メソッドを使用して、文字列リソースに従ってボタンのテキストラベルを設定します。 文字列リソースの詳細については、「[リソースファイルの操作](../../windows/working-with-resource-files.md)」を参照してください。

このメソッドでは、ボタンにユーザー定義のイメージがある場合、何も実行されません。

##  <a name="savebarstate"></a>CMFCToolBarButton:: SaveBarState

ツールバーボタンの状態を保存します。

```
virtual void SaveBarState();
```

### <a name="remarks"></a>コメント

フレームワークは、ドラッグアンドドロップ操作の結果として `CMFCToolBarButton` オブジェクトを作成するときに、このメソッドを呼び出します。

このメソッドの既定の実装では、何も実行されません。 ツールバーボタンの状態を外部データソースに保存するには、このメソッドをオーバーライドします。

##  <a name="serialize"></a>CMFCToolBarButton:: Serialize

アーカイブからこのオブジェクトを読み取るか、アーカイブに書き込みます。

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*金*<br/>
からまたはのシリアル化元となる `CArchive` オブジェクト。

### <a name="remarks"></a>コメント

このメソッドは、クリップボードやドラッグアンドドロップ操作などのデータ転送プロセスをサポートしています。 このメソッドは、指定された `CArchive` オブジェクトの ID、テキストラベル、イメージ ID などのボタンのプロパティを読み取りまたは書き込みます。

シリアル化の例については、「[シリアル化: オブジェクト](../../mfc/serialization-serializing-an-object.md)のシリアル化」を参照してください。

##  <a name="setaccdata"></a>CMFCToolBarButton:: Setのデータ

ツールバーボタンのユーザー補助データを使用して、提供された `CAccessibilityData` オブジェクトを設定します。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>パラメーター

*pParent*<br/>
からツールバーボタンの親ウィンドウ。

*data*<br/>
からツールバーボタンのユーザー補助データを格納する `CAccessibilityData` オブジェクト。

### <a name="return-value"></a>戻り値

このメソッドは TRUE を返します。

### <a name="remarks"></a>コメント

ツールバーボタンがアクセシビリティデータを提供しない場合は、このメソッドをオーバーライドして FALSE を返します。

##  <a name="setclipboardformatname"></a>CMFCToolBarButton:: Setクリップの Formatname

グローバルクリップボード形式の名前を変更します。

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>パラメーター

*lpszName*<br/>
からグローバルクリップボード形式の新しい名前。 NULL にすることはできません。

### <a name="remarks"></a>コメント

このメソッドを使用すると、複数のアプリケーション間でドラッグアンドドロップ操作を行うことができます。 各アプリケーションは、同じクリップボード形式名を指定する必要があります。

フレームワークが[CMFCToolBarButton:: GetClipboardFormat](#getclipboardformat)を呼び出す前に、このメソッドを呼び出す必要があります。

##  <a name="setimage"></a>CMFCToolBarButton:: SetImage

ボタンのイメージインデックスを設定します。

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>パラメーター

*iImage*<br/>
からツールバーイメージのコレクション内のイメージのインデックス。

### <a name="remarks"></a>コメント

ツールバーボタンが区切り記号の場合、 *iImage*は区切りボタンの新しい幅を参照します。

*IImage*が0未満の場合、このメソッドは画像の描画を無効にし、ボタンのテキストラベルの描画を有効にします。

##  <a name="setprotectedcommands"></a>CMFCToolBarButton:: SetProtectedCommands

ユーザーがカスタマイズできないコマンドの一覧を設定します。

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>パラメーター

*lstCmds*<br/>
から保護されたコマンドの一覧。

### <a name="remarks"></a>コメント

カスタマイズモードでは、フレームワークによって保護されているツールバーボタンコマンドが無効になります。 ユーザーは、無効になっているツールバーボタンに対してドラッグアンドドロップおよび編集操作を実行できません。

[CMFCToolBarButton:: GetProtectedCommands](#getprotectedcommands)メソッドを使用して、保護されたコマンドの一覧を取得します。

##  <a name="setradio"></a>CMFCToolBarButton:: SetRadio

ボタンがチェックされた状態を変更したときにフレームワークによって呼び出されます。

```
virtual void SetRadio();
```

### <a name="remarks"></a>コメント

このメソッドの既定の実装では、何も実行されません。 ボタンがチェックされた状態を変更したときにカスタムアクションを実行するには、このメソッドをオーバーライドします。

##  <a name="setrect"></a>CMFCToolBarButton:: SetRect

ボタンの外接する四角形を設定します。

```
void SetRect(const CRect rect);
```

### <a name="parameters"></a>パラメーター

*rect*<br/>
からボタンの新しい外接する四角形。

### <a name="remarks"></a>コメント

このメソッドは、新しい外接する四角形を設定した後に[CMFCToolBarButton:: OnMove](#onmove)メソッドを呼び出します。

##  <a name="setstyle"></a>CMFCToolBarButton:: System.windows.forms.control.setstyle

ボタンのスタイルを設定します。

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>パラメーター

*nStyle*<br/>
からボタンの新しいスタイル。

### <a name="remarks"></a>コメント

既定の実装では、 [CMFCToolBarButton:: m_nStyle](#m_nstyle)データメンバーが*nstyle*に設定されます。 スタイルの変更を処理するために追加の処理を実行する場合は、このメソッドをオーバーライドします。 有効なスタイルフラグの一覧については、「 [ToolBar コントロールスタイル](toolbar-control-styles.md)」を参照してください。

##  <a name="setvisible"></a>CMFCToolBarButton:: SetVisible

ボタンを表示するかどうかを指定します。

```
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>パラメーター

*bShow*<br/>
からボタンを表示するか非表示にするかを指定するブール値です。 このパラメーターが TRUE の場合、ボタンが表示されます。 パラメーターが FALSE の場合、ボタンは非表示になります。

### <a name="remarks"></a>コメント

特定のツールバーボタンを表示または非表示にするには、この関数を使用します。 このメソッドを呼び出した後、 [CPane:: AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)メソッドを呼び出します。

##  <a name="show"></a>CMFCToolBarButton:: Show

ボタンの表示と非表示を切り替えます。

```
void Show(BOOL bShow);
```

### <a name="parameters"></a>パラメーター

*bShow*<br/>
からボタンを表示するか非表示にするかを指定するブール値です。 このパラメーターが TRUE の場合、ボタンが表示されます。 パラメーターが FALSE の場合、ボタンは非表示になります。

### <a name="remarks"></a>コメント

フレームワークは、親ツールバーのサイズが変更されたときに、ツールバーボタンの表示を更新するために、このメソッドを呼び出します。 フレームワークは、ボタンがツールバーの境界内に収まらなくなったときに、 *bShow*を FALSE に設定してこのメソッドを呼び出します。 フレームワークは、ツールバーの境界内にボタンのサイズを変更した後に、 *bShow*を TRUE に設定してこのメソッドを呼び出します。

[CMFCToolBarButton:: SetVisible](#setvisible)メソッドを使用して、ボタンの全般的な表示を設定します。

このメソッドは、ボタンの表示状態を更新した後、 [CMFCToolBarButton:: OnShow](#onshow)メソッドを呼び出します。

## <a name="see-also"></a>参照

[階層図](../../mfc/hierarchy-chart.md)<br/>
[クラス](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar クラス](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCToolBarImages クラス](../../mfc/reference/cmfctoolbarimages-class.md)
