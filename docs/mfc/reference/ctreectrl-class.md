---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: eda7a2430aa13bb8d30649d796d9f72f900b9097
ms.sourcegitcommit: 27d9db019f6d84c94de9e6aff0170d918cee6738
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/06/2020
ms.locfileid: "75676978"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Windows コモン ツリー ビュー コントロールの機能が用意されています。

## <a name="syntax"></a>構文

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|[名前]|説明|
|----------|-----------------|
|[CTreeCtrl:: CTreeCtrl](#ctreectrl)|`CTreeCtrl` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|[名前]|説明|
|----------|-----------------|
|[CTreeCtrl:: Create](#create)|ツリービューコントロールを作成し、`CTreeCtrl` オブジェクトにアタッチします。|
|[CTreeCtrl:: CreateDragImage](#createdragimage)|指定されたツリービューアイテムのドラッグビットマップを作成します。|
|[CTreeCtrl:: CreateEx](#createex)|指定した Windows 拡張スタイルを使用してツリーコントロールを作成し、`CTreeCtrl` オブジェクトにアタッチします。|
|[CTreeCtrl::D eleteAllItems](#deleteallitems)|ツリービューコントロール内のすべての項目を削除します。|
|[CTreeCtrl::D eleteItem](#deleteitem)|ツリービューコントロール内の新しい項目を削除します。|
|[CTreeCtrl:: EditLabel](#editlabel)|指定されたツリービューアイテムを埋め込み先で編集します。|
|[CTreeCtrl:: EndEditLabelNow](#endeditlabelnow)|現在のツリービューコントロールのツリービュー項目のラベルに対する編集操作をキャンセルします。|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|ツリービューの項目がツリービューコントロールに確実に表示されるようにします。|
|[CTreeCtrl:: Expand](#expand)|指定したツリービュー項目の子項目を展開または折りたたみます。|
|[CTreeCtrl:: GetBkColor](#getbkcolor)|コントロールの現在の背景色を取得します。|
|[CTreeCtrl:: GetCheck](#getcheck)|ツリーコントロール項目のチェックの状態を取得します。|
|[CTreeCtrl:: GetChildItem](#getchilditem)|指定したツリービュー項目の子を取得します。|
|[CTreeCtrl::GetCount](#getcount)|ツリービューコントロールに関連付けられているツリー項目の数を取得します。|
|[CTreeCtrl:: GetDropHilightItem](#getdrophilightitem)|ドラッグアンドドロップ操作の対象を取得します。|
|[CTreeCtrl:: GetEditControl](#geteditcontrol)|指定されたツリービュー項目の編集に使用される編集コントロールのハンドルを取得します。|
|[CTreeCtrl:: GetExtendedStyle](#getextendedstyle)|現在のツリービューコントロールが使用している拡張スタイルを取得します。|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|指定したツリービューアイテムの最初に表示されたアイテムを取得します。|
|[CTreeCtrl:: GetImageList](#getimagelist)|ツリービューコントロールに関連付けられているイメージリストのハンドルを取得します。|
|[CTreeCtrl:: GetIndent](#getindent)|ツリービュー項目の親からのオフセット (ピクセル単位) を取得します。|
|[CTreeCtrl:: GetInsertMarkColor](#getinsertmarkcolor)|ツリービューの挿入マークの描画に使用する色を取得します。|
|[CTreeCtrl:: GetItem](#getitem)|指定されたツリービューアイテムの属性を取得します。|
|[CTreeCtrl:: GetItemData](#getitemdata)|項目に関連付けられているアプリケーション固有の値を返します。|
|[CTreeCtrl:: GetItemExpandedImageIndex](#getitemexpandedimageindex)|現在のツリービューコントロールの指定された項目が展開された状態のときに表示するイメージのインデックスを取得します。|
|[CTreeCtrl:: GetItemHeight](#getitemheight)|ツリービュー項目の現在の高さを取得します。|
|[CTreeCtrl:: GetItemImage](#getitemimage)|項目に関連付けられたイメージを取得します。|
|[CTreeCtrl:: GetItemPartRect](#getitempartrect)|現在のツリービューコントロール内の指定した項目の指定した部分の外接する四角形を取得します。|
|[CTreeCtrl:: GetItemRect](#getitemrect)|ツリービューアイテムの外接する四角形を取得します。|
|[CTreeCtrl:: GetItemState](#getitemstate)|項目の状態を返します。|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|現在のツリービューコントロール内の指定された項目の拡張状態を取得します。|
|[CTreeCtrl:: GetItemText](#getitemtext)|項目のテキストを返します。|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|現在のツリービューコントロールの最後に展開された項目を取得します。|
|[CTreeCtrl:: GetLineColor](#getlinecolor)|ツリービューコントロールの現在の線の色を取得します。|
|[CTreeCtrl:: GetNextItem](#getnextitem)|指定したリレーションシップに一致する次のツリービューアイテムを取得します。|
|[CTreeCtrl:: GetNextSiblingItem](#getnextsiblingitem)|指定したツリービュー項目の次の兄弟を取得します。|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|指定したツリービュー項目の次に表示される項目を取得します。|
|[CTreeCtrl::GetParentItem](#getparentitem)|指定したツリービュー項目の親を取得します。|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|指定したツリービュー項目の前の兄弟を取得します。|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|指定したツリービュー項目の前に表示されている項目を取得します。|
|[CTreeCtrl:: GetRootItem](#getrootitem)|指定したツリービュー項目のルートを取得します。|
|[CTreeCtrl:: GetScrollTime](#getscrolltime)|ツリービューコントロールの最大スクロール時間を取得します。|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|現在のツリービューコントロール内の選択された項目の数を取得します。|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|現在選択されているツリービューアイテムを取得します。|
|[CTreeCtrl:: GetTextColor](#gettextcolor)|コントロールの現在のテキストの色を取得します。|
|[CTreeCtrl:: GetToolTips ヒント](#gettooltips)|ツリービューコントロールによって使用される子ツールヒントコントロールへのハンドルを取得します。|
|[CTreeCtrl:: GetVisibleCount](#getvisiblecount)|ツリービューコントロールに関連付けられている、表示されるツリー項目の数を取得します。|
|[CTreeCtrl::HitTest](#hittest)|`CTreeCtrl` オブジェクトに関連付けられたカーソルの現在位置を返します。|
|[CTreeCtrl:: InsertItem](#insertitem)|ツリービューコントロールに新しい項目を挿入します。|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|指定した項目に子項目がある場合は0以外の値を返します。|
|[CTreeCtrl:: MapAccIdToItem](#mapaccidtoitem)|指定したアクセシビリティ識別子を、現在のツリービューコントロールのツリービュー項目を識別するハンドルに割り当てます。|
|[CTreeCtrl:: Mapitemtoの Id](#mapitemtoaccid)|現在のツリービューコントロール内のツリービュー項目に対して、指定したハンドルをアクセシビリティ識別子にマップします。|
|[CTreeCtrl:: Select](#select)|指定したツリービューアイテムを選択、表示、または再描画します。|
|[CTreeCtrl:: SelectDropTarget](#selectdroptarget)|ドラッグアンドドロップ操作の対象としてツリー項目を再描画します。|
|[CTreeCtrl:: SelectItem](#selectitem)|指定されたツリービューアイテムを選択します。|
|[CTreeCtrl:: SelectSetFirstVisible](#selectsetfirstvisible)|指定したツリービューアイテムを最初に表示されるアイテムとして選択します。|
|[CTreeCtrl:: SetAutoscrollInfo](#setautoscrollinfo)|現在のツリービューコントロールの自動スクロール率を設定します。|
|[CTreeCtrl:: SetBkColor](#setbkcolor)|コントロールの背景色を設定します。|
|[CTreeCtrl:: SetCheck](#setcheck)|ツリーコントロール項目のチェックの状態を設定します。|
|[CTreeCtrl:: SetExtendedStyle](#setextendedstyle)|現在のツリービューコントロールの拡張スタイルを設定します。|
|[CTreeCtrl:: SetImageList](#setimagelist)|ツリービューコントロールに関連付けられているイメージリストのハンドルを設定します。|
|[CTreeCtrl:: SetIndent](#setindent)|ツリービューアイテムの親からのオフセット (ピクセル単位) を設定します。|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|ツリービューコントロールに挿入マークを設定します。|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|ツリービューの挿入マークの描画に使用する色を設定します。|
|[CTreeCtrl:: SetItem](#setitem)|指定されたツリービューアイテムの属性を設定します。|
|[CTreeCtrl:: SetItemData](#setitemdata)|項目に関連付けられているアプリケーション固有の値を設定します。|
|[CTreeCtrl:: SetItemExpandedImageIndex](#setitemexpandedimageindex)|現在のツリービューコントロールの指定した項目が展開された状態のときに表示されるイメージのインデックスを設定します。|
|[CTreeCtrl:: SetItemHeight](#setitemheight)|ツリービューアイテムの高さを設定します。|
|[CTreeCtrl:: SetItemImage](#setitemimage)|イメージを項目に関連付けます。|
|[CTreeCtrl:: SetItemState](#setitemstate)|項目の状態を設定します。|
|[CTreeCtrl:: SetItemStateEx](#setitemstateex)|現在のツリービューコントロール内の指定された項目の拡張状態を設定します。|
|[CTreeCtrl:: SetItemText](#setitemtext)|項目のテキストを設定します。|
|[CTreeCtrl:: SetLineColor](#setlinecolor)|ツリービューコントロールの現在の線の色を設定します。|
|[CTreeCtrl:: SetScrollTime](#setscrolltime)|ツリービューコントロールの最大スクロール時間を設定します。|
|[CTreeCtrl:: SetTextColor](#settextcolor)|コントロールのテキストの色を設定します。|
|[CTreeCtrl:: SetToolTips ヒント](#settooltips)|ツリービューコントロールの子ツールヒントコントロールを設定します。|
|[CTreeCtrl:: ShowInfoTip](#showinfotip)|現在のツリービューコントロール内の指定された項目のヒントを表示します。|
|[CTreeCtrl:: SortChildren](#sortchildren)|指定された親項目の子を並べ替えます。|
|[CTreeCtrl:: SortChildrenCB](#sortchildrencb)|アプリケーション定義の並べ替え関数を使用して、指定した親項目の子を並べ替えます。|

## <a name="remarks"></a>コメント

"ツリービューコントロール" は、ドキュメント内の見出し、インデックス内のエントリ、ディスク上のファイルやディレクトリなどの項目の階層リストを表示するウィンドウです。 各項目は、ラベルとオプションのビットマップイメージで構成され、各項目に関連付けられているサブ項目のリストを持つことができます。 項目をクリックすると、関連付けられているサブ項目のリストを展開したり折りたたんだりできます。

このコントロール (および `CTreeCtrl` クラス) は、Windows 98 および Windows NT version 4 以降で実行されているプログラムに対してのみ使用できます。

`CTreeCtrl`の使用方法の詳細については、以下を参照してください。

- [コントロール](../../mfc/controls-mfc.md)

- [CTreeCtrl の使い方](../../mfc/using-ctreectrl.md)

- Windows SDK 内の[ツリービューコントロール参照](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>要件

**ヘッダー:** afxcmn.h

##  <a name="create"></a>  CTreeCtrl::Create

ダイアログボックステンプレートでツリーコントロールを指定した場合、または[CTreeView](../../mfc/reference/ctreeview-class.md)を使用している場合は、ダイアログボックスまたはビューの作成時にツリーコントロールが自動的に作成されます。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*dwStyle*<br/>
ツリービューコントロールのスタイルを指定します。 Windows SDK で説明されているように、 [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)で説明されているウィンドウスタイルと[ツリービューコントロールスタイル](/windows/win32/Controls/tree-view-control-window-styles)の任意の組み合わせを適用します。

*rect*<br/>
ツリービューコントロールのサイズと位置を指定します。 これは、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは[RECT](/previous-versions/dd162897\(v=vs.85\))構造体のいずれかになります。

*pParentWnd*<br/>
ツリービューコントロールの親ウィンドウ (通常は `CDialog`) を指定します。 NULL にすることはできません。

*nID*<br/>
ツリービューコントロールの ID を指定します。

### <a name="return-value"></a>戻り値

初期化が成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>コメント

他のウィンドウの子ウィンドウとしてツリーコントロールを作成する場合は、`Create` メンバー関数を使用します。 `Create`を使用してツリーコントロールを作成する場合は、他のツリービュースタイルに加えて、WS_VISIBLE を渡す必要があります。

`CTreeCtrl` を作成するには、2つの手順を実行します。 最初にコンストラクターを呼び出し、次に `Create`を呼び出します。これにより、ツリービューコントロールが作成され、`CTreeCtrl` オブジェクトにアタッチされます。

拡張ウィンドウスタイルを使用してツリーコントロールを作成するには`Create`、ではなく [CreateEx](#createex) を呼び出します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

##  <a name="createex"></a>  CTreeCtrl::CreateEx

この関数を呼び出して、コントロール (子ウィンドウ) を作成し、`CTreeCtrl` オブジェクトに関連付けます。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>パラメーター

*dwExStyle*<br/>
作成するコントロールの拡張スタイルを指定します。 拡張 Windows スタイルの一覧については、Windows SDK の[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)の*dwexstyle*パラメーターを参照してください。

*dwStyle*<br/>
ツリービューコントロールのスタイルを指定します。 Windows SDK で説明されているように、 [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)で説明されているウィンドウスタイルと[ツリービューコントロールスタイル](/windows/win32/Controls/tree-view-control-window-styles)の任意の組み合わせを適用します。

*rect*<br/>
*PParentWnd*のクライアント座標で、作成されるウィンドウのサイズと位置を記述する[RECT](/previous-versions/dd162897\(v=vs.85\))構造体への参照。

*pParentWnd*<br/>
コントロールの親であるウィンドウへのポインター。

*nID*<br/>
コントロールの子ウィンドウ ID。

### <a name="return-value"></a>戻り値

成功した場合は0以外。それ以外の場合は0。

### <a name="remarks"></a>コメント

Windows 拡張スタイルの先頭**WS_EX_** によって指定された拡張 windows スタイルを適用するには、 [Create](#create)ではなく `CreateEx` を使用します。

##  <a name="createdragimage"></a>CTreeCtrl:: CreateDragImage

この関数を呼び出して、指定した項目のビットマップをツリービューコントロールに作成し、ビットマップのイメージリストを作成して、イメージリストにビットマップを追加します。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ドラッグするツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常に終了した場合は、ドラッグしたビットマップが追加されたイメージリストへのポインター。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

アプリケーションでは、イメージリスト関数を使用して、項目をドラッグしているときにイメージを表示します。

`CImageList` オブジェクトは永続的であり、完了したら削除する必要があります。 例:

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

##  <a name="ctreectrl"></a>  CTreeCtrl::CTreeCtrl

`CTreeCtrl` オブジェクトを構築します。

```
CTreeCtrl();
```

##  <a name="deleteallitems"></a>  CTreeCtrl::DeleteAllItems

ツリービューコントロールからすべての項目を削除するには、この関数を呼び出します。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

##  <a name="deleteitem"></a>  CTreeCtrl::DeleteItem

ツリービューコントロールから項目を削除するには、この関数を呼び出します。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
削除するツリー項目のハンドル。 *Hitem*に TVI_ROOT 値が含まれている場合、すべての項目がツリービューコントロールから削除されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

##  <a name="editlabel"></a>  CTreeCtrl::EditLabel

指定した項目のテキストの埋め込み先編集を開始するには、この関数を呼び出します。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
編集するツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常に終了した場合は、項目のテキストを編集するために使用される `CEdit` オブジェクトへのポインター。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

編集を行うには、項目のテキストをテキストを含む単一行のエディットコントロールに置き換えます。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

##  <a name="endeditlabelnow"></a>  CTreeCtrl::EndEditLabelNow

現在のツリービューコントロールのツリービュー項目のラベルに対する編集操作を終了します。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*保存しないで保存*|から編集操作を実行する前にツリービュー項目の変更を破棄する場合は TRUE。操作を実行する前にツリービュー項目に対する変更を保存する場合は FALSE。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow)メッセージを送信します。

##  <a name="ensurevisible"></a>  CTreeCtrl::EnsureVisible

ツリービュー項目が確実に表示されるようにするには、この関数を呼び出します。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
表示されるツリー項目のハンドル。

### <a name="return-value"></a>戻り値

指定した項目が表示されていることを確認するために、ツリービューコントロール内の項目がスクロールされた場合に TRUE を返します。 それ以外の場合、戻り値は FALSE になります。

### <a name="remarks"></a>コメント

必要に応じて、この関数は、項目が表示されるように、親項目を展開するか、ツリービューコントロールをスクロールします。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

##  <a name="expand"></a>CTreeCtrl:: Expand

この関数を呼び出して、指定した親項目に関連付けられている子項目 (存在する場合) のリストを展開または折りたたみます。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
展開されているツリー項目のハンドル。

*nCode*<br/>
実行するアクションの種類を示すフラグ。 このフラグには、次のいずれかの値を指定できます。

- TVE_COLLAPSE 一覧を折りたたみます。

- TVE_COLLAPSERESET リストを折りたたみ、子項目を削除します。 TVIS_EXPANDEDONCE 状態フラグがリセットされます。 このフラグは、TVE_COLLAPSE フラグと共に使用する必要があります。

- TVE_EXPAND 一覧を展開します。

- 現在展開されている場合はリストを折りたたみ、現在折りたたまれている場合は展開 TVE_TOGGLE ます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: ensurevisible\](#ensurevisible)」の例を参照してください。

##  <a name="getbkcolor"></a>CTreeCtrl:: GetBkColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)の動作を実装します。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>戻り値

コントロールの現在のウィンドウの背景色を表す COLORREF 値。 この値が-1 の場合、コントロールはシステムウィンドウの色を使用します。 この場合は、`::GetSysColor(COLOR_WINDOW)` を使用して、コントロールが使用している現在のシステムカラーを取得できます。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetTextColor](#settextcolor)」の例を参照してください。

##  <a name="getcheck"></a>  CTreeCtrl::GetCheck

項目のチェック状態を取得するには、このメンバー関数を呼び出します。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
状態情報を受け取る HTREEITEM。

### <a name="return-value"></a>戻り値

ツリーコントロール項目がチェックされている場合は0以外。それ以外の場合は0です。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetCheck](#setcheck)」の例を参照してください。

##  <a name="getchilditem"></a>  CTreeCtrl::GetChildItem

この関数を呼び出して、 *hItem*によって指定された項目の子であるツリービュー項目を取得します。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

成功した場合は、子項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

##  <a name="getcount"></a>  CTreeCtrl::GetCount

ツリービューコントロール内の項目の数を取得するには、この関数を呼び出します。

```
UINT GetCount() const;
```

### <a name="return-value"></a>戻り値

ツリービューコントロール内の項目の数。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

##  <a name="getdrophilightitem"></a>CTreeCtrl:: GetDropHilightItem

ドラッグアンドドロップ操作の対象となる項目を取得するには、この関数を呼び出します。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>戻り値

正常に終了した場合に削除される項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="geteditcontrol"></a>  CTreeCtrl::GetEditControl

この関数を呼び出して、ツリービュー項目のテキストを編集するために使用されている編集コントロールのハンドルを取得します。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>戻り値

正常に終了した場合は、項目のテキストを編集するために使用するエディットコントロールへのポインター。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

##  <a name="getextendedstyle"></a>  CTreeCtrl::GetExtendedStyle

現在のツリービューコントロールが使用している拡張スタイルを取得します。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>戻り値

現在のツリービューコントロールの拡張スタイルのビットごとの組み合わせ (または) を格納している値。 詳細については、「[ツリービューコントロールの拡張スタイル](/windows/win32/Controls/tree-view-control-window-extended-styles)」を参照してください。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle)メッセージを送信します。

##  <a name="getfirstvisibleitem"></a>  CTreeCtrl::GetFirstVisibleItem

この関数を呼び出して、ツリービューコントロールの最初に表示されている項目を取得します。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>戻り値

最初に表示される項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetCheck](#setcheck)」の例を参照してください。

##  <a name="getimagelist"></a>  CTreeCtrl::GetImageList

この関数を呼び出して、ツリービューコントロールに関連付けられている通常のイメージリストまたは状態イメージリストのハンドルを取得します。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>パラメーター

*nImageList*<br/>
取得するイメージリストの種類。 イメージリストには、次のいずれかの値を指定できます。

- TVSIL_NORMAL は、ツリービューアイテムの選択されたイメージと選択されていないイメージを含む通常のイメージリストを取得します。

- TVSIL_STATE は、ユーザー定義の状態にあるツリービュー項目のイメージを含む状態イメージリストを取得します。

### <a name="return-value"></a>戻り値

成功した場合は、コントロールのイメージリストへのポインター。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

ツリービューコントロール内の各項目には、1組のビットマップイメージを関連付けることができます。 項目が選択されると1つのイメージが表示され、項目が選択されていないときにもう一方のイメージが表示されます。 たとえば、項目を選択したときに開いているフォルダーを表示し、選択されていない場合は閉じたフォルダーを表示することができます。

イメージリストの詳細については、「 [CImageList](../../mfc/reference/cimagelist-class.md)クラス」を参照してください。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

##  <a name="getindent"></a>  CTreeCtrl::GetIndent

この関数を呼び出して、子項目が親項目に対して相対的にインデントされる量をピクセル単位で取得します。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>戻り値

ピクセル単位で計測されたインデントの量。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

##  <a name="getinsertmarkcolor"></a>  CTreeCtrl::GetInsertMarkColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)の動作を実装します。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>戻り値

現在の挿入マークの色を格納している COLORREF 値。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

##  <a name="getitem"></a>  CTreeCtrl::GetItem

指定したツリービューアイテムの属性を取得するには、この関数を呼び出します。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>パラメーター

*pItem*<br/>
Windows SDK で説明されているように、 [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

  「 [CTreeCtrl::D eleteitem](#deleteitem)」の例を参照してください。

##  <a name="getitemdata"></a>  CTreeCtrl::GetItemData

指定した項目に関連付けられているアプリケーション固有の値を取得するには、この関数を呼び出します。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
データを取得する項目のハンドル。

### <a name="return-value"></a>戻り値

*HItem*によって指定された項目に関連付けられた、ポインターサイズのアプリケーション固有の値。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

##  <a name="getitemexpandedimageindex"></a>CTreeCtrl:: GetItemExpandedImageIndex

現在のツリービューコントロールの指定された項目が展開された状態のときに表示するイメージのインデックスを取得します。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からツリービューコントロール項目を処理します。|

### <a name="return-value"></a>戻り値

指定した項目が展開された状態のときに表示されるイメージのインデックス。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)メッセージを送信します。 このメッセージは、ツリービューコントロール項目を記述する[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体を返します。このメソッドは、この構造体から `iExpandedImage` メンバーを取得します。

##  <a name="getitemheight"></a>CTreeCtrl:: GetItemHeight

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)の動作を実装します。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>戻り値

項目の高さ (ピクセル単位)。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

##  <a name="getitemimage"></a>  CTreeCtrl::GetItemImage

ツリービューコントロール内の各項目には、1組のビットマップイメージを関連付けることができます。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
取得するイメージを持つ項目のハンドル。

*nImage*<br/>
ツリービューコントロールのイメージリスト内の項目のイメージのインデックスを受け取る整数。

*nSelectedImage*<br/>
ツリービューコントロールのイメージリスト内で項目の選択されたイメージのインデックスを受け取る整数。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

項目のラベルの左側に画像が表示されます。 項目が選択されると1つのイメージが表示され、項目が選択されていないときにもう一方のイメージが表示されます。 たとえば、項目を選択したときに開いているフォルダーを表示し、選択されていない場合は閉じたフォルダーを表示することができます。

この関数を呼び出して、ツリービューコントロールのイメージリスト内で項目のイメージと選択したイメージのインデックスを取得します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

##  <a name="getitempartrect"></a>  CTreeCtrl::GetItemPartRect

現在のツリービューコントロール内の指定した項目の指定した部分の外接する四角形を取得します。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からツリービューコントロール項目を処理します。|
|*nPart*|からパーツの識別子。 TVGIPR_BUTTON に設定する必要があります。|
|*lpRect*|入出力[RECT](/previous-versions/dd162897\(v=vs.85\))構造体へのポインター。 このメソッドが成功した場合、構造体は、 *hItem*と*nPart*によって指定されたパーツの四角形の座標を受け取ります。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

各ツリーコントロール項目は、グラフィックスの四角形によって制限されます。 その四角形のポイントがクリックされるたびに、その項目は*ヒット*したと言われます。 このメソッドは、四角形のポイントがクリックされると、 *hItem*パラメーターで識別される項目がヒットする最大の四角形を返します。

このメソッドは、Windows SDK で説明されている TVM_GETITEMPARTRECT メッセージを送信します。 詳細については、 [TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)マクロを参照してください。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、ユーザー補助識別子と、 [CTreeCtrl:: MapAccIdToItem](#mapaccidtoitem)メソッドを使用して、ルートツリービュー項目へのハンドルを取得します。 次に、この例では、ハンドルと[CTreeCtrl:: GetItemPartRect](#getitempartrect)メソッドを使用して、その項目の周りに3d 四角形を描画します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。 ここでは、 [CTreeCtrl:: Mapitemtoて id](#mapitemtoaccid)メソッドを使用して、ルートツリービュー項目とアクセシビリティ識別子を関連付けています。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="getitemrect"></a>  CTreeCtrl::GetItemRect

*HItem*の外接する四角形を取得し、それが可視かどうかを判断するには、この関数を呼び出します。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリービューコントロール項目のハンドル。

*lpRect*<br/>
外接する四角形を受け取る[RECT](/previous-versions/dd162897\(v=vs.85\))構造体へのポインター。 座標は、ツリービューコントロールの左上隅を基準としています。

*bTextOnly*<br/>
このパラメーターが0以外の場合、外接する四角形には項目のテキストのみが含まれます。 それ以外の場合は、項目がツリービューコントロール内で占有する行全体が含まれます。

### <a name="return-value"></a>戻り値

項目が表示されていて、外接する四角形が*lpRect*に含まれている場合は0以外の。 それ以外の場合は、 *lpRect*が初期化されていません。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

##  <a name="getitemstate"></a>  CTreeCtrl::GetItemState

*HItem*によって指定された項目の状態を返します。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
状態が取得される項目のハンドル。

*nStateMask*<br/>
取得する1つ以上の状態を示すマスク。 *NStateMask*で使用できる値の詳細については、Windows SDK の[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体の `state` と `stateMask` のメンバーに関する説明を参照してください。

### <a name="return-value"></a>戻り値

NStateMask によって指定された値のビットごとの OR を保持する UINT。 使用可能な値の詳細については、「 [CTreeCtrl:: GetItem](#getitem)」を参照してください。 特定の状態の値を調べるには、次の例に示すように、state 値と戻り値のビットごとの AND 演算を実行します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

##  <a name="getitemstateex"></a>  CTreeCtrl::GetItemStateEx

現在のツリービューコントロール内の指定された項目の拡張状態を取得します。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からツリービューコントロール項目を処理します。|

### <a name="return-value"></a>戻り値

項目の拡張された状態。 詳細については、 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の `uStateEx` メンバーを参照してください。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)メッセージを送信します。 このメッセージは、ツリービューコントロール項目を記述する[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体を返します。このメソッドは、この構造体から `uStateEx` メンバーを取得します。

##  <a name="getitemtext"></a>  CTreeCtrl::GetItemText

*HItem*によって指定された項目のテキストを返します。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
テキストを取得する項目のハンドル。

### <a name="return-value"></a>戻り値

項目のテキストを格納している `CString` オブジェクト。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetNextItem](#getnextitem)」の例を参照してください。

##  <a name="getlastvisibleitem"></a>  CTreeCtrl::GetLastVisibleItem

現在のツリービューコントロール内の、最後に展開されていないノード項目を取得します。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>戻り値

メソッドが成功した場合は、展開されていない最後のノード項目へのハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem)メッセージを送信します。 詳細については、そのメッセージの*フラグ*パラメーターの TVGN_LASTVISIBLE フラグを参照してください。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数の1つ以上を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、最後に展開されていないツリービューノード項目へのハンドルを取得し、その項目の周りに3D 四角形を描画します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

##  <a name="getlinecolor"></a>  CTreeCtrl::GetLineColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)の動作を実装します。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>戻り値

現在の線の色。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

##  <a name="getnextitem"></a>  CTreeCtrl::GetNextItem

この関数を呼び出して、 *nCode*パラメーターによって指定されたリレーションシップを持つツリービューアイテムを*hItem*に取得します。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

*nCode*<br/>
*HItem*に対する関係の種類を示すフラグ。 このフラグには、次のいずれかの値を指定できます。

- TVGN_CARET 現在選択されている項目を取得します。

- TVGN_CHILD は、 *hItem*パラメーターによって指定された項目の最初の子項目を取得します。

- TVGN_DROPHILITE は、ドラッグアンドドロップ操作の対象となる項目を取得します。

- TVGN_FIRSTVISIBLE 最初に表示される項目を取得します。

- TVGN_LASTVISIBLE ツリー内で最後に展開された項目を取得します。 これは、ツリービューウィンドウに表示される最後の項目を取得しません。

- TVGN_NEXT は、次の兄弟項目を取得します。

- TVGN_NEXTVISIBLE 指定した項目の後に表示される次の項目を取得します。

- TVGN_PARENT 指定した項目の親を取得します。

- TVGN_PREVIOUS は、前の兄弟項目を取得します。

- TVGN_PREVIOUSVISIBLE、指定した項目の前に表示されている最初の項目を取得します。

- 指定した項目が含まれているルート項目の最初の子項目を TVGN_ROOT 取得します。

### <a name="return-value"></a>戻り値

成功した場合は、次の項目のハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

取得する項目がツリーのルートノードである場合、この関数は NULL を返します。 たとえば、このメッセージをツリービューのルートノードの第1レベルの子の TVGN_PARENT フラグと共に使用すると、メッセージは NULL を返します。

### <a name="example"></a>使用例

ループで `GetNextItem` を使用する例については、「 [CTreeCtrl::D eleteitem](#deleteitem)」を参照してください。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

##  <a name="getnextsiblingitem"></a>  CTreeCtrl::GetNextSiblingItem

この関数を呼び出して、 *hItem*の次の兄弟を取得します。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

次の兄弟項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

##  <a name="getnextvisibleitem"></a>  CTreeCtrl::GetNextVisibleItem

次に表示される*hItem*の項目を取得するには、この関数を呼び出します。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

次に表示される項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetCheck](#setcheck)」の例を参照してください。

##  <a name="getparentitem"></a>  CTreeCtrl::GetParentItem

この関数を呼び出して、 *hItem*の親を取得します。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

親項目のハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

指定した項目の親がツリーのルートノードである場合、この関数は NULL を返します。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: ensurevisible\](#ensurevisible)」の例を参照してください。

##  <a name="getprevsiblingitem"></a>  CTreeCtrl::GetPrevSiblingItem

この関数を呼び出して、 *hItem*の前の兄弟を取得します。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

前の兄弟のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

##  <a name="getprevvisibleitem"></a>  CTreeCtrl::GetPrevVisibleItem

この関数を呼び出して、 *hItem*の前に表示されている項目を取得します。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

前に表示されていた項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

##  <a name="getrootitem"></a>  CTreeCtrl::GetRootItem

ツリービューコントロールのルート項目を取得するには、この関数を呼び出します。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>戻り値

ルート項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: EditLabel](#editlabel)」の例を参照してください。

##  <a name="getscrolltime"></a>  CTreeCtrl::GetScrollTime

このメンバー関数を呼び出して、ツリービューコントロールの最大スクロール時間を取得します。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>戻り値

スクロール時間の最大値 (ミリ秒単位)。

### <a name="remarks"></a>コメント

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)の動作を実装します。

##  <a name="getselectedcount"></a>  CTreeCtrl::GetSelectedCount

現在のツリービューコントロール内の選択された項目の数を取得します。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>戻り値

選択された項目の数。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount)メッセージを送信します。

##  <a name="getselecteditem"></a>  CTreeCtrl::GetSelectedItem

この関数を呼び出して、ツリービューコントロールの現在選択されている項目を取得します。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>戻り値

選択された項目のハンドル。それ以外の場合は NULL。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

##  <a name="gettextcolor"></a>  CTreeCtrl::GetTextColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)の動作を実装します。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>戻り値

現在のテキストの色を表す COLORREF 値。 この値が-1 の場合、コントロールはテキストの色にシステムカラーを使用します。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetTextColor](#settextcolor)」の例を参照してください。

##  <a name="gettooltips"></a>CTreeCtrl:: GetToolTips ヒント

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)の動作を実装します。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>戻り値

ツリーコントロールによって使用される[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。 [Create](#create) member 関数でスタイル TVS_NOTOOLTIPS が使用されている場合、ツールヒントは使用されず、NULL が返されます。

### <a name="remarks"></a>コメント

MFC による `GetToolTips` の実装では、ツールヒントコントロールのハンドルではなく、ツリーコントロールによって使用される `CToolTipCtrl` オブジェクトが返されます。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

##  <a name="getvisiblecount"></a>  CTreeCtrl::GetVisibleCount

ツリービューコントロールで表示される項目の数を取得するには、この関数を呼び出します。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>戻り値

ツリービューコントロールに表示される項目の数。それ以外の場合は-1。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetCheck](#setcheck)」の例を参照してください。

##  <a name="hittest"></a>  CTreeCtrl::HitTest

この関数を呼び出して、ツリービューコントロールのクライアント領域を基準とした、指定したポイントの位置を確認します。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>パラメーター

*pt*<br/>
テストするポイントのクライアント座標。

*pFlags*<br/>
ヒットテストの結果に関する情報を受け取る整数へのポインター。 「解説」の `flags` メンバーの下に一覧表示されている1つ以上の値を指定できます。

*pHitTestInfo*<br/>
ヒットテストの位置を含み、ヒットテストの結果に関する情報を受け取る、 [TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)構造体のアドレス。

### <a name="return-value"></a>戻り値

指定されたポイントを占有するツリービュー項目のハンドル。項目がポイントを占有していない場合は NULL。

### <a name="remarks"></a>コメント

この関数が呼び出されたときに、 *pt*パラメーターはテストする点の座標を指定します。 関数は、指定されたポイントにある項目のハンドルを返します。項目が存在しない場合は NULL を返します。 また、 *Pflags*パラメーターには、指定されたポイントの場所を示す値が含まれています。 指定できる値は次のとおりです。

|||
|-|-|
|Value|説明|
|TVHT_ABOVE|クライアント領域の上にあります。|
|TVHT_BELOW|クライアント領域の下。|
|TVHT_NOWHERE|クライアント領域で、最後の項目の下にあります。|
|TVHT_ONITEM|項目に関連付けられているビットマップまたはラベル。|
|TVHT_ONITEMBUTTON|項目に関連付けられているボタンをクリックします。|
|TVHT_ONITEMICON|項目に関連付けられているビットマップ。|
|TVHT_ONITEMINDENT|項目に関連付けられているインデント。|
|TVHT_ONITEMLABEL|項目に関連付けられているラベル (文字列)。|
|TVHT_ONITEMRIGHT|項目の右側の領域。|
|TVHT_ONITEMSTATEICON|ユーザー定義の状態にあるツリービューの項目の状態アイコン。|
|TVHT_TOLEFT|クライアント領域の左側に移動します。|
|TVHT_TORIGHT|クライアント領域の右側にあります。|
|||

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="insertitem"></a>  CTreeCtrl::InsertItem

ツリービューコントロールに新しい項目を挿入するには、この関数を呼び出します。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>パラメーター

*lpInsertStruct*<br/>
挿入するツリービューアイテムの属性を指定する `TVINSERTSTRUCT` へのポインター。

*nMask*<br/>
設定する属性を指定する整数。 Windows SDK の `TVITEM` 構造を参照してください。

*lpszItem*<br/>
項目のテキストを含む文字列のアドレス。

*nImage*<br/>
ツリービューコントロールのイメージリスト内の項目のイメージのインデックス。

*nSelectedImage*<br/>
ツリービューコントロールのイメージリスト内の項目の選択されたイメージのインデックス。

*nState*<br/>
項目の状態の値を指定します。 適切な状態の一覧については、「Windows SDK のツリービューコントロール項目の状態」を参照してください。

*nStateMask*<br/>
設定する状態を指定します。 Windows SDK の `TVITEM` 構造を参照してください。

*lParam*<br/>
項目に関連付けられた、ポインターサイズのアプリケーション固有の値。

*hParent*<br/>
挿入された項目の親のハンドル。

*hInsertAfter*<br/>
新しい項目を挿入する先の項目のハンドル。

### <a name="return-value"></a>戻り値

成功した場合は、新しい項目のハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>コメント

この例では、ツリーコントロール項目を挿入するときに、関数の各バージョンを使用する必要がある状況を示します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

##  <a name="itemhaschildren"></a>  CTreeCtrl::ItemHasChildren

この関数は、 *hItem*によって指定されたツリー項目に子項目があるかどうかを判断するために使用します。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

*HItem*によって指定されたツリー項目に子項目がある場合は0以外の。それ以外の場合は0。

### <a name="remarks"></a>コメント

その場合は、 [CTreeCtrl:: GetChildItem](#getchilditem)を使用して、これらの子項目を取得できます。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetSelectedItem](#getselecteditem)」の例を参照してください。

##  <a name="mapaccidtoitem"></a>  CTreeCtrl::MapAccIdToItem

指定したアクセシビリティ識別子を、現在のツリービューコントロールのツリービュー項目のハンドルに割り当てます。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*Uの Id*|からツリービュー項目内の要素のアクセシビリティ識別子。|

### <a name="return-value"></a>戻り値

*U`HTREEITEM`id*パラメーターに対応するツリービュー項目 () へのハンドル。 詳細については、 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の*hItem*メンバーを参照してください。

### <a name="remarks"></a>コメント

ユーザー補助機能は、障碍のあるユーザーがコンピューターを使用できるようにするアプリケーションです。 ユーザー補助識別子は、ウィンドウ内の要素を一意に指定するために `IAccessible` インターフェイスによって使用されます。 アクセシビリティ識別子の詳細については、「 [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322)」の「Active Accessibility のサポートについて」を検索してください。

このメソッドは、Windows SDK で説明されている[TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem)メッセージを送信します。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、ユーザー補助識別子と、 [CTreeCtrl:: MapAccIdToItem](#mapaccidtoitem)メソッドを使用して、ルートツリービュー項目へのハンドルを取得します。 この例では、ハンドルと[CTreeCtrl:: GetItemPartRect](#getitempartrect)メソッドを使用して、その項目の周りに3d 四角形を描画します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。 ここでは、 [CTreeCtrl:: Mapitemtoて id](#mapitemtoaccid)メソッドを使用して、ルートツリービュー項目とアクセシビリティ識別子を関連付けています。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="mapitemtoaccid"></a>  CTreeCtrl::MapItemToAccID

現在のツリービューコントロール内のツリービュー項目の指定されたハンドルをアクセシビリティ識別子にマップします。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からコントロール内のツリービュー項目のハンドル。 詳細については、 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の*hItem*メンバーを参照してください。|

### <a name="return-value"></a>戻り値

*HItem*パラメーターに対応するアクセシビリティ識別子。

### <a name="remarks"></a>コメント

ユーザー補助機能は、障碍のあるユーザーがコンピューターを使用できるようにするアプリケーションです。 ユーザー補助識別子は、ウィンドウ内の要素を一意に指定するために `IAccessible` インターフェイスによって使用されます。 アクセシビリティ識別子の詳細については、「 [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322)」の「Active Accessibility のサポートについて」を検索してください。

このメソッドは、Windows SDK で説明されている[TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid)メッセージを送信します。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、ツリービューコントロール項目の識別番号を取得します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。 このコード例では、ルート国/地域ノードの一意の識別番号を取得します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

##  <a name="select"></a>  CTreeCtrl::Select

この関数を呼び出して、指定されたツリービュー項目を選択するか、項目をビューにスクロールするか、ドラッグアンドドロップ操作の対象を示すために使用されるスタイルで項目を再描画します。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

*nCode*<br/>
実行するアクションの種類。 このパラメーターには、次のいずれかの値を指定できます。

- TVGN_CARET 選択項目を指定した項目に設定します。

- TVGN_DROPHILITE は、ドラッグアンドドロップ操作の対象を示すために使用されるスタイルで、指定された項目を再描画します。

- TVGN_FIRSTVISIBLE は、指定された項目が最初に表示される項目であるように、ツリービューを垂直方向にスクロールします。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

*NCode*に TVGN_CARET 値が含まれている場合、親ウィンドウは TVN_SELCHANGING と TVN_SELCHANGED 通知メッセージを受信します。 さらに、指定した項目が折りたたまれた親項目の子である場合は、親の子項目のリストが展開され、指定した項目が表示されます。 この場合、親ウィンドウは TVN_ITEMEXPANDING と TVN_ITEMEXPANDED 通知メッセージを受信します。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: system.windows.media.visualtreehelper.hittest](#hittest)」の例を参照してください。

##  <a name="selectdroptarget"></a>CTreeCtrl:: SelectDropTarget

ドラッグアンドドロップ操作の対象を示すために使用されるスタイルで項目を再描画するには、この関数を呼び出します。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="selectitem"></a>  CTreeCtrl::SelectItem

指定されたツリービューアイテムを選択するには、この関数を呼び出します。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
ツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

*HItem*が NULL の場合、この関数は項目を選択しません。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="selectsetfirstvisible"></a>CTreeCtrl:: SelectSetFirstVisible

この関数を呼び出して、指定した項目が最初に表示される項目になるように、ツリービューを垂直方向にスクロールします。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
最初に表示される項目として設定するツリー項目のハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

関数は、TVM_SELECTITEM と TVGN_FIRSTVISIBLE メッセージパラメーターを使用して、ウィンドウにメッセージを送信します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

##  <a name="setautoscrollinfo"></a>  CTreeCtrl::SetAutoscrollInfo

現在のツリービューコントロールの自動スクロール率を設定します。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*uPixelsPerSec*|からスクロールする1秒あたりのピクセル数。|
|*uUpdateTime*|からコントロールの更新間の時間間隔。|

### <a name="return-value"></a>戻り値

常に TRUE を返します。

### <a name="remarks"></a>コメント

自動スクロールパラメーターを使用して、現在表示されていない項目を表示するようにスクロールします。 ツリービューコントロールには TVS_EX_AUTOHSCROLL 拡張スタイルが必要です。これについては、「[ツリービューコントロールの拡張スタイル](/windows/win32/Controls/tree-view-control-window-extended-styles)」で説明されています。

このメソッドは、Windows SDK で説明されている[TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo)メッセージを送信します。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールの自動スクロール動作を設定します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。 ツリービューコントロールは、フォーカスのあるツリー項目を表示するために自動的にスクロールする必要があるように、意図的に縮小しました。 このコード例では、ツリー項目が表示されるまで、5秒ごとに30ピクセル/秒を自動的にスクロールするようにツリービューコントロールを設定します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

##  <a name="setbkcolor"></a>CTreeCtrl:: SetBkColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)の動作を実装します。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>パラメーター

*/clr*<br/>
新しい背景色を格納している COLORREF 値。 この値が-1 の場合、コントロールは背景色に対してシステムカラーを使用するように戻ります。

### <a name="return-value"></a>戻り値

現在のテキストの色を表す COLORREF 値。 この値が-1 の場合、コントロールはテキストの色にシステムカラーを使用します。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: SetTextColor](#settextcolor)」の例を参照してください。

##  <a name="setcheck"></a>  CTreeCtrl::SetCheck

ツリーコントロール項目のチェックの状態を設定するには、このメンバー関数を呼び出します。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
チェック状態の変更を受け取る HTREEITEM。

*fCheck*<br/>
ツリーコントロール項目をオンまたはオフにするかどうかを示します。 既定では、`SetCheck` によって、チェックされる項目が設定されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

ツリーコントロール項目がオンになっている場合 ( *Fcheck*が TRUE に設定されている場合)、項目は横のチェックマーク付きで表示されます。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>使用例

チェックボックスを使用するには、ツリーコントロールを設定する前に TVS_CHECKBOXES を設定します。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

##  <a name="setextendedstyle"></a>  CTreeCtrl::SetExtendedStyle

現在のツリービューコントロールの拡張スタイルを設定します。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*dwExMask*|から現在のツリービューコントロール内のどのスタイルがこのメソッドの影響を受けるかを指定するビットマスク。 このパラメーターが0の場合、このパラメーターは無視され、 *Dwexstyles*パラメーターの値がツリービューコントロールに割り当てられます。<br /><br /> 「[ツリービューコントロールの拡張スタイル](/windows/win32/Controls/tree-view-control-window-extended-styles)」で説明されているスタイルの0またはビットごとの組み合わせ (または) を指定します。|
|*dwExStyles*|から現在のツリービューコントロール内の設定またはクリアするスタイルを指定するビットマスク。<br /><br /> スタイルの組み合わせを設定するには、「[ツリービューコントロールの拡張スタイル](/windows/win32/Controls/tree-view-control-window-extended-styles)」で説明されているスタイルのビットごとの組み合わせ (または) を指定します。 一連のスタイルをクリアするには、0を指定します。|

### <a name="return-value"></a>戻り値

前の拡張コントロールスタイルを含む値。

### <a name="remarks"></a>コメント

このメソッドは、 *Dwexmask*パラメーターに指定されているスタイルをクリアし、 *dwexmask*パラメーターで指定されたスタイルを設定します。 *Dwexmask*のビットに対応する拡張スタイルのみが変更されます。

このメソッドは、Windows SDK で説明されている[TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle)メッセージを送信します。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、TVS_EX_AUTOHSCROLL 拡張スタイルを現在のツリービューコントロールに追加します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。 ツリービューコントロールは、フォーカスのあるツリー項目を表示するために自動的にスクロールする必要があるように、意図的に縮小しました。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

##  <a name="setimagelist"></a>  CTreeCtrl::SetImageList

この関数を呼び出して、ツリービューコントロールの通常の一覧または状態のイメージリストを設定し、新しいイメージを使用してコントロールを再描画します。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>パラメーター

*pImageList*<br/>
割り当てるイメージリストへのポインター。 *Pimagelist*が NULL の場合、すべてのイメージがツリービューコントロールから削除されます。

*nImageListType*<br/>
設定するイメージリストの種類。 イメージリストには、次のいずれかの値を指定できます。

- ツリービューアイテムの選択したイメージと選択されていないイメージを含む通常のイメージリストを TVSIL_NORMAL 設定します。 オーバーレイイメージには、この状態を使用する必要があります。

- ユーザー定義の状態にあるツリービューアイテムの画像を含む状態イメージリストを TVSIL_STATE 設定します。

### <a name="return-value"></a>戻り値

前のイメージリストへのポインター (存在する場合)。それ以外の場合は NULL。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetImageList](#getimagelist)」の例を参照してください。

##  <a name="setindent"></a>  CTreeCtrl::SetIndent

この関数を呼び出して、ツリービューコントロールのインデントの幅を設定し、新しい幅を反映するようにコントロールを再描画します。

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>パラメーター

*n インデント*<br/>
インデントの幅 (ピクセル単位)。 *Nindent*がシステム定義の最小幅よりも小さい場合、新しい幅はシステム定義の最小値に設定されます。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetIndent](#getindent)」の例を参照してください。

##  <a name="setinsertmark"></a>  CTreeCtrl::SetInsertMark

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)の動作を実装します。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
挿入マークが配置される項目を指定する HTREEITEM。 この引数が NULL の場合、挿入マークは削除されます。

*fAfter*<br/>
指定した項目の前または後に挿入マークが配置されているかどうかを指定するブール値。 この引数が0以外の場合、挿入マークは項目の後に配置されます。 この引数が0の場合、挿入マークは項目の前に配置されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

##  <a name="setinsertmarkcolor"></a>  CTreeCtrl::SetInsertMarkColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)の動作を実装します。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>パラメーター

*clrNew*<br/>
新しい挿入マークの色を格納している COLORREF 値。

### <a name="return-value"></a>戻り値

前の挿入マークの色を格納している COLORREF 値。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetInsertMarkColor](#getinsertmarkcolor)」の例を参照してください。

##  <a name="setitem"></a>  CTreeCtrl::SetItem

指定したツリービュー項目の属性を設定するには、この関数を呼び出します。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>パラメーター

*pItem*<br/>
Windows SDK で説明されているように、新しい項目の属性を格納している[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体へのポインター。

*hItem*<br/>
属性が設定される項目のハンドル。 Windows SDK の `TVITEM` 構造体の `hItem` メンバーを参照してください。

*nMask*<br/>
設定する属性を指定する整数。 `TVITEM` 構造の `mask` メンバーを参照してください。

*lpszItem*<br/>
項目のテキストを含む文字列のアドレス。

*nImage*<br/>
ツリービューコントロールのイメージリスト内の項目のイメージのインデックス。 `TVITEM` 構造の `iImage` メンバーを参照してください。

*nSelectedImage*<br/>
ツリービューコントロールのイメージリスト内の項目の選択されたイメージのインデックス。 `TVITEM` 構造の `iSelectedImage` メンバーを参照してください。

*nState*<br/>
項目の状態の値を指定します。 `TVITEM` 構造の `State` メンバーを参照してください。

*nStateMask*<br/>
設定する状態を指定します。 `TVITEM` 構造の `stateMask` メンバーを参照してください。

*lParam*<br/>
項目に関連付けられた、ポインターサイズのアプリケーション固有の値。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

`TVITEM` 構造体では、`hItem` メンバーが項目を識別し、`mask` メンバーが設定する属性を指定します。

`mask` メンバーまたは*Nmask*パラメーターで TVIF_TEXT 値が指定されている場合、`pszText` メンバーまたは*lpszitem*は null で終わる文字列のアドレスであり、`cchTextMax` メンバーは無視されます。 `mask` (または*Nmask*) が TVIF_STATE の値を指定する場合、`stateMask` メンバーまたは*nStateMask*パラメーターは、変更する項目の状態を指定し、`state` member または*nState*パラメーターにこれらの状態の値を格納します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

##  <a name="setitemdata"></a>  CTreeCtrl::SetItemData

指定した項目に関連付けられているアプリケーション固有の値を設定するには、この関数を呼び出します。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
データを取得する項目のハンドル。

*dwData*<br/>
*HItem*によって指定された項目に関連付けられた、ポインターサイズのアプリケーション固有の値。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

##  <a name="setitemexpandedimageindex"></a>CTreeCtrl:: SetItemExpandedImageIndex

現在のツリービューコントロールの指定した項目が展開された状態のときに表示されるイメージのインデックスを設定します。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からツリービューコントロール項目を処理します。|
|*I、*|から指定した項目が展開された状態のときに表示されるイメージのインデックス。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)メッセージを送信します。 このメソッドは、[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) 構造体の`iExpandedImage`メンバーに*i*パラメーターを割り当て、メッセージ内でその構造体を使用します。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例は、ctreectrl: [: GetItemExpandedImageIndex](#getitemexpandedimageindex)メソッドが、 [Ctreectrl:: SetItemExpandedImageIndex](#setitemexpandedimageindex)メソッドによって設定された値を返すかどうかを判断するための単純なテストです。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

##  <a name="setitemheight"></a>CTreeCtrl:: SetItemHeight

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)の動作を実装します。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>パラメーター

*cyHeight*<br/>
ツリービュー内のすべての項目の新しい高さをピクセル単位で指定します。 この引数がイメージの高さよりも小さい場合、イメージの高さに設定されます。 この引数が偶数でない場合は、最も近い偶数の値に丸められます。 この引数が-1 の場合、コントロールは既定の項目の高さを使用してに戻ります。

### <a name="return-value"></a>戻り値

項目の前の高さ (ピクセル単位)。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetItemHeight](#getitemheight)」の例を参照してください。

##  <a name="setitemimage"></a>  CTreeCtrl::SetItemImage

イメージを項目に関連付けます。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
イメージを設定する項目のハンドル。

*nImage*<br/>
ツリービューコントロールのイメージリスト内の項目のイメージのインデックス。

*nSelectedImage*<br/>
ツリービューコントロールのイメージリスト内の項目の選択されたイメージのインデックス。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

ツリービューコントロール内の各項目には、1組のビットマップイメージを関連付けることができます。 項目のラベルの左側に画像が表示されます。 項目が選択されると1つのイメージが表示され、項目が選択されていないときにもう一方のイメージが表示されます。 たとえば、項目を選択したときに開いているフォルダーを表示し、選択されていない場合は閉じたフォルダーを表示することができます。

この関数を呼び出して、ツリービューコントロールのイメージリスト内で項目のイメージと選択したイメージのインデックスを設定します。

イメージの詳細については、「 [CImageList](../../mfc/reference/cimagelist-class.md)」を参照してください。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetItemImage](#getitemimage)」の例を参照してください。

##  <a name="setitemstate"></a>  CTreeCtrl::SetItemState

*HItem*によって指定された項目の状態を設定します。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
状態が設定される項目のハンドル。

*nState*<br/>
項目の新しい状態を指定します。

*nStateMask*<br/>
変更する状態を指定します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

状態の詳細については、「 [CTreeCtrl:: GetItem](#getitem)」を参照してください。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetItemState](#getitemstate)」の例を参照してください。

##  <a name="setitemstateex"></a>  CTreeCtrl::SetItemStateEx

現在のツリービューコントロール内の指定された項目の拡張状態を設定します。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からツリービューコントロール項目を処理します。|
|*uStateEx*|から項目の拡張された状態。 詳細については、 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の `uStateEx` メンバーを参照してください。|

### <a name="return-value"></a>戻り値

このメソッドが成功した場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>コメント

このメソッドは、Windows SDK で説明されている[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)メッセージを送信します。 このメソッドは、 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の `uStateEx` メンバーに*ustateex*パラメーターを割り当て、メッセージでその構造体を使用します。

### <a name="example"></a>使用例

次のコード例では、現在のツリービューコントロールにアクセスするために使用される、`m_treeCtrl`変数を定義します。 このコード例では、符号なし整数といくつかの HTREEITEM 変数も定義されています。 次の例では、これらの変数を使用します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>使用例

次のコード例では、ツリービューの項目を無効の状態に設定します。 ここでは示されていないコード例の前のセクションでは、米国のルート国/地域ノード、ペンシルバニア州とワシントン州のサブノード、およびこれらの州の都市のツリー項目で構成されるツリービューを作成しました。 このコード例では、ペンシルバニアノードを disabled 状態に設定します。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

##  <a name="setitemtext"></a>  CTreeCtrl::SetItemText

*HItem*によって指定された項目のテキストを設定します。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
テキストを設定する項目のハンドル。

*lpszItem*<br/>
項目の新しいテキストを含む文字列のアドレス

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

##  <a name="setlinecolor"></a>  CTreeCtrl::SetLineColor

このメンバー関数を呼び出して、ツリービューコントロールの現在の行の色を設定します。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>パラメーター

*clrNew*<br/>
新しい線の色。

### <a name="return-value"></a>戻り値

前の行の色。

### <a name="remarks"></a>コメント

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)の動作を実装します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

##  <a name="setscrolltime"></a>  CTreeCtrl::SetScrollTime

このメンバー関数を呼び出して、ツリービューコントロールの最大スクロール時間を設定します。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>パラメーター

*uScrollTime*<br/>
新しい最大スクロール時間 (ミリ秒単位)。 この値が100未満の場合、100に切り上げられます。

### <a name="return-value"></a>戻り値

前の最大スクロール時間 (ミリ秒単位)。

### <a name="remarks"></a>コメント

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)の動作を実装します。

##  <a name="settextcolor"></a>  CTreeCtrl::SetTextColor

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)の動作を実装します。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>パラメーター

*/clr*<br/>
新しいテキストの色を格納している COLORREF 値。 この引数が-1 の場合、コントロールはテキストの色に対してシステムカラーを使用するように戻ります。

### <a name="return-value"></a>戻り値

前のテキストの色を表す COLORREF 値。 この値が-1 の場合、コントロールはテキストの色にシステムカラーを使用していました。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

##  <a name="settooltips"></a>CTreeCtrl:: SetToolTips ヒント

このメンバー関数は、Windows SDK で説明されているように、Win32 メッセージ[TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)の動作を実装します。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>パラメーター

*pWndTip*<br/>
ツリーコントロールが使用する[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

コントロールで以前に使用されていたツールヒントを格納している[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)オブジェクトへのポインター。以前にツールヒントが使用されていない場合は NULL。

### <a name="remarks"></a>コメント

ツールヒントを使用するには、`CTreeCtrl` オブジェクトを作成するときに TVS_NOTOOLTIPS スタイルを指定します。

### <a name="example"></a>使用例

  「 [CTreeCtrl:: GetToolTips ヒント](#gettooltips)」の例を参照してください。

##  <a name="showinfotip"></a>  CTreeCtrl::ShowInfoTip

現在のツリービューコントロール内の指定された項目のヒントを表示します。

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

|パラメータ|説明|
|---------------|-----------------|
|*hItem*|からコントロール内のツリービュー項目へのハンドル。 詳細については、 [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)構造体の `hItem` メンバーを参照してください。|

### <a name="remarks"></a>コメント

ツールヒントとインフォヒントの違いの詳細については、「 [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322)」の「ツールヒントとヒント」を検索してください。

このメソッドは、Windows SDK で説明されている[TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip)メッセージを送信します。

##  <a name="sortchildren"></a>  CTreeCtrl::SortChildren

ツリービューコントロール内の指定された親項目の子項目をアルファベット順に並べ替えるには、この関数を呼び出します。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>パラメーター

*hItem*<br/>
子項目が並べ替えられる親項目のハンドル。 *HItem*が NULL の場合、並べ替えはツリーのルートから続行されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

`SortChildren` はツリーを再帰しません。*hItem*の直下の子のみが並べ替えられます。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

##  <a name="sortchildrencb"></a>CTreeCtrl:: SortChildrenCB

項目を比較するアプリケーション定義のコールバック関数を使用して、ツリービューの項目を並べ替えるには、この関数を呼び出します。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>パラメーター

*pSort*<br/>
[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

構造体の比較関数 `lpfnCompare`は、最初の項目が2番目の項目の前にある場合は負の値を返し、最初の項目が2番目の項目の場合は正の値、2つの項目が等しい場合は0を返す必要があります。

*LParam1*パラメーターと*lParam2*パラメーターは、比較対象の2つの項目の[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)構造体の `lParam` メンバーに対応します。 *Lparamsort*パラメーターは、`TV_SORTCB` 構造体の `lParam` メンバーに対応します。

### <a name="example"></a>使用例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>関連項目

[MFC のサンプル CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[CImageList クラス](../../mfc/reference/cimagelist-class.md)
