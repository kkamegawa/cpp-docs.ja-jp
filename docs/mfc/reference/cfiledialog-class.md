---
title: CFileDialog クラス
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: c301766b64af7fc1523b39adad91d9b52a5e88f7
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69506596"
---
# <a name="cfiledialog-class"></a>CFileDialog クラス

ファイルのオープンまたはファイルの保存操作に使用されるコモンダイアログボックスをカプセル化します。

## <a name="syntax"></a>構文

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|`CFileDialog` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|ダイアログにチェックボタンを追加します。|
|[CFileDialog::AddComboBox](#addcombobox)|ダイアログにコンボボックスを追加します。|
|[CFileDialog::AddControlItem](#addcontrolitem)|ダイアログのコンテナーコントロールに項目を追加します。|
|[CFileDialog::AddEditBox](#addeditbox)|ダイアログにエディットボックスを追加します。|
|[CFileDialog::AddMenu](#addmenu)|メニューをダイアログに追加します。|
|[CFileDialog::AddPlace](#addplace)|オーバーロードされます。 ユーザーが項目を開いたり保存したりできる場所の一覧にフォルダーを追加します。|
|[CFileDialog::AddPushButton](#addpushbutton)|ダイアログにボタンを追加します。|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|ダイアログにオプションボタン (ラジオボタンとも呼ばれます) グループを追加します。|
|[CFileDialog::AddSeparator](#addseparator)|ダイアログに区切り記号を追加します。|
|[CFileDialog::AddText](#addtext)|ダイアログにテキストの内容を追加します。|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|メンバー`m_ofn`変数に格納さ`CFileDialog`れているパラメーターとフラグに一致するように、の状態を更新します。|
|[CFileDialog: oModal:D](#domodal)|ダイアログボックスを表示し、ユーザーが選択できるようにします。|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|ダイアログの **[開く]** または **[保存]** ボタンのドロップダウンリストを有効にします。|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|ダイアログのビジュアルグループへの要素の追加を停止します。|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|ダイアログのチェックボタン (チェックボックス) の現在の状態を取得します。|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|ダイアログで見つかったコンテナーコントロール内の項目の現在の状態を取得します。|
|[CFileDialog::GetControlState](#getcontrolstate)|指定したコントロールの現在の可視性と有効な状態を取得します。|
|[CFileDialog:: GetEditBoxText](#geteditboxtext)|エディットボックスコントロール内の現在のテキストを取得します。|
|[CFileDialog::GetFileExt](#getfileext)|選択されたファイルの拡張子を返します。|
|[CFileDialog::GetFileName](#getfilename)|選択されたファイルのファイル名を返します。|
|[CFileDialog::GetFileTitle](#getfiletitle)|選択されたファイルのタイトルを返します。|
|[CFileDialog::GetFolderPath](#getfolderpath)|エクスプローラー形式の**開い**ている、または [共通に保存] ダイアログボックスで現在開い**て**いるフォルダーまたはディレクトリのパスを取得します。|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|カスタマイズ`CFileDialog`されたオブジェクトの内部 COM オブジェクトを取得します。|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|[ファイルを**開く**] ダイアログボックス`CFileDialog`として使用されるの内部 COM オブジェクトを取得します。|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|[ファイルの**保存**] ダイアログボックス`CFileDialog`として使用されるの内部 COM オブジェクトを取得します。|
|[CFileDialog::GetNextPathName](#getnextpathname)|次に選択されたファイルの完全パスを返します。|
|[CFileDialog::GetOFN](#getofn)|オブジェクトの構造体を取得します。 `OPENFILENAME` `CFileDialog`|
|[CFileDialog::GetPathName](#getpathname)|選択されたファイルの完全パスを返します。|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|選択されたファイルの読み取り専用の状態を返します。|
|[CFileDialog:: GetResult](#getresult)|ユーザーがダイアログで行った選択肢を取得します。|
|[CFileDialog:: GetResults](#getresults)|複数選択を可能にするダイアログのユーザーの選択肢を取得します。|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|ダイアログの指定されたコンテナーコントロールから特定の項目を取得します。|
|[CFileDialog::GetStartPosition](#getstartposition)|ファイル名リストの最初の要素の位置を返します。|
|[CFileDialog::HideControl](#hidecontrol)|エクスプローラー形式で [共通] ダイアログボックスで指定したコントロールを非表示にします。|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|フォルダーピッカーモードの現在のダイアログがあるかどうかを判断します。|
|[CFileDialog::MakeProminent](#makeprominent)|コントロールをダイアログに配置して、追加された他のコントロールと比較して表示します。|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|ダイアログのコンテナーコントロールから項目を削除します。|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|ダイアログのチェックボタン (チェックボックス) の現在の状態を設定します。|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|ダイアログで見つかったコンテナーコントロールの項目の現在の状態を設定します。|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|コントロール項目のテキストを設定します。 たとえば、ラジオボタンやメニュー内の項目に付随するテキストなどです。|
|[CFileDialog:: SetControlLabel](#setcontrollabel)|ボタンテキストやエディットボックスラベルなど、コントロールに関連付けられたテキストを設定します。|
|[CFileDialog::SetControlState](#setcontrolstate)|指定されたコントロールの現在の可視性と有効な状態を設定します。|
|[CFileDialog::SetControlText](#setcontroltext)|[エクスプローラー形式で**開く**] または [共通**として保存**] ダイアログボックスで、指定したコントロールのテキストを設定します。|
|[CFileDialog::SetDefExt](#setdefext)|エクスプローラー スタイルの**ファイルオープン**もしくは、**名前を付けて保存**コモンダイアログボックスでの既定のファイル名拡張子を設定します。|
|[CFileDialog:: SetEditBoxText](#seteditboxtext)|エディットボックスコントロール内の現在のテキストを設定します。|
|[CFileDialog:: SetProperties](#setproperties)|保存される項目に対して使用される既定値を定義するプロパティ ストアを提供します。|
|[CFileDialog:: SetSelectedControlItem](#setselectedcontrolitem)|ダイアログのオプションボタングループまたはコンボボックスで、特定の項目の選択された状態を設定します。|
|[CFileDialog::SetTemplate](#settemplate)|`CFileDialog`オブジェクトで使用するダイアログ ボックスのテンプレートを設定します。|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|ダイアログでビジュアルグループを宣言します。 後続の "add" メソッドを呼び出すと、その要素がこのグループに追加されます。|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|格納されているデータを更新して、`m_ofn`メンバー変数の内容をファイル ダイアログ ボックスの現在の状態と一致させます。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|ボタンがクリックされたときに呼び出されます。|
|[CFileDialog:: OnCheckButtonToggled](#oncheckbuttontoggled)|チェックボックスをオンまたはオフにしたときに呼び出されます。|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|コントロールがアクティブになっているときに呼び出されます。|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|WM_NOTIFY CDN_SELCHANGE メッセージを処理します。|
|[CFileDialog::OnFileNameOK](#onfilenameok)|ダイアログボックスに入力されたファイル名を検証します。|
|[CFileDialog::OnFolderChange](#onfolderchange)|WM_NOTIFY CDN_FOLDERCHANGE メッセージを処理します。|
|[CFileDialog::OnInitDone](#oninitdone)|WM_NOTIFY CDN_INITDONE メッセージを処理します。|
|[CFileDialog::OnItemSelected](#onitemselected)|コンテナー項目が選択されているときに呼び出されます。|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|ファイルの選択が変更されたときにカスタムアクションを実行できるようにします。|
|[CFileDialog::OnShareViolation](#onshareviolation)|共有違反を処理します。|
|[CFileDialog::OnTypeChange](#ontypechange)|WM_NOTIFY CDN_TYPECHANGE メッセージを処理します。|

### <a name="public-data-members"></a>パブリック データ メンバー

|名前|説明|
|----------|-----------------|
|[CFileDialog:: m_ofn](#m_ofn)|Windows `OPENFILENAME`の構造体。 [基本ファイル] ダイアログボックスのパラメーターへのアクセスを提供します。|

## <a name="remarks"></a>Remarks

一般的なファイルのダイアログボックスを使用すると、ファイルの選択ダイアログボックスを実装できます。たとえば、 **[ファイルを開く]** や **[名前を付けて保存]** など、Windows 標準と一貫性があります。

提供され`CFileDialog`ているコンストラクターと同様にを使用することも、独自のダイアログボックスクラス`CFileDialog`をから派生させ、必要に応じてコンストラクターを記述することもできます。 どちらの場合も、これらのダイアログボックスは[CCommonDialog クラス](../../mfc/reference/ccommondialog-class.md)から派生しているので、標準の MFC ダイアログボックスのように動作します。 `CFileDialog`は、COMMDLG に依存します。Windows に含まれている DLL ファイル。

Windows Vista 以降では、 `CFileDialog`の外観と機能の両方が、以前のバージョンの windows と異なります。 既定`CFileDialog`では、プログラムが windows vista 以降でコンパイルされて実行される場合、コードの変更なしで新しい Windows Vista 以降のスタイルが自動的に使用されます。 コンストラクターで*Bviのスタイル*パラメーターを使用して、この自動更新を手動でオーバーライドします。 自動更新の例外は、カスタマイズされたダイアログボックスです。 新しいスタイルに変換されることはありません。 コンストラクターの詳細については、「 [cfiledialog:: cfiledialog](#cfiledialog)」を参照してください。

> [!NOTE]
>  コントロール ID システムは、を`CFileDialog`使用するときに、windows の以前のバージョンとは異なります。 以前のバージョンの Windows から`CFileDialog`プロジェクトを移植するには、コード内のコントロールへのすべての参照を更新する必要があります。

一部`CFileDialog`のメソッドは、Windows Vista 以降ではサポートされていません。 メソッドがサポートされているかどうかについては、個々のメソッドのトピックを確認してください。 また、次の継承関数は、Windows Vista 以降ではサポートされていません。

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

`CFileDialog`クラスの windows メッセージは、使用しているオペレーティングシステムによって異なります。 たとえば、 `CFileDialog`クラスの場合、Windows XP では、 [cdialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel)と[cdialog:: OnOK](../../mfc/reference/cdialog-class.md#onok)はサポートされません。 ただし、Windows Vista 以降のオペレーティングシステムではサポートされています。 生成されるさまざまなメッセージとその受信順序の詳細については、「 [CFileDialog サンプル:イベントの順序](../../overview/visual-cpp-samples.md)をログに記録しています。

`CFileDialog`オブジェクトを使用するには、最初に`CFileDialog`コンストラクターを使用してオブジェクトを作成します。 ダイアログボックスを構築した後は、 [CFileDialog:: m_ofn](#m_ofn)構造体の任意の値を設定または変更して、ダイアログボックスコントロールの値または状態を初期化できます。 構造体の型`OPENFILENAME`はです。 `m_ofn` 詳細については、Windows SDK の[Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照してください。

ダイアログボックスコントロールを初期化した後、 [CFileDialog::D oModal](#domodal)メソッドを呼び出してダイアログボックスを表示し、ユーザーがパスとファイル名を入力できるようにします。 `DoModal` ユーザーには、[ok] \(IDOK) またはキャンセル (IDCANCEL) ボタンがクリックしたかどうかを返します。 が`DoModal` IDOK を返す場合は、 `CFileDialog`パブリックメンバー関数のいずれかを使用して、ユーザーによって格納されている情報を取得できます。

> [!NOTE]
> Windows Vista 以降では、 [Ifiledialog:: SetFileTypes](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes)を複数回呼び出すと、エラーが発生します。 の任意のインスタンス`SetFileTypes`に対するの2回目の呼び出しでは、Windows Vista 以降で E_UNEXPECTEDが返されます。`CFileDialog` 一部`CFileDialog`のメソッド関数`SetFileTypes`はを呼び出します。 たとえば、 `CFileDialog::DoModal` `CFileDialog`の同じインスタンスに対してを呼び出すと、 [ASSERT](diagnostic-services.md#assert)が生成されます。

`CFileDialog`には、共有違反、ファイル名の検証、およびリストボックスの変更通知のカスタム処理を行うことができる、保護されたメンバーがいくつか含まれています。 これらのプロテクトメンバーは、既定の処理が自動的に実行されるため、ほとんどのアプリケーションで使用する必要がないコールバック関数です。 これらの関数のメッセージマップエントリは、標準の仮想関数であるため、必須ではありません。

Windows の[Commdlgextendederror](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror)関数を使用すると、ダイアログボックスの初期化中にエラーが発生したかどうかを確認し、エラーの詳細を調べることができます。

オブジェクトの`CFileDialog`破棄は自動的に処理されます。 [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog)を呼び出す必要はありません。

ユーザーが複数のファイルを選択できるようにするには、を`DoModal`呼び出す前に OFN_ALLOWMULTISELECT フラグを設定します。 返された複数のファイル名の一覧に対応するには、独自のファイル名のバッファーを指定する必要があります。 これを行うに`m_ofn.lpstrFile`は、を`CFileDialog`構築した後、を呼び出す`DoModal`前に、割り当てたバッファーへのポインターでを置き換えます。

さらに、が指す`m_ofn.nMaxFile` `m_ofn.lpstrFile`バッファー内の文字数を使用してを設定する必要があります。 選択するファイルの最大数をに`n`設定すると、必要なバッファーサイズは`n * (_MAX_PATH + 1) + 1`になります。 バッファーに最初に返される項目は、ファイルが選択されたフォルダーへのパスです。 Windows Vista またはそれ以降のスタイルのダイアログボックスでは、ディレクトリとファイル名の文字列は null で終了し、最後のファイル名の後に null 文字が追加されます。 この形式を使用すると、[エクスプローラースタイル] ダイアログボックスで、スペースを含む長いファイル名を返すことができます。 旧スタイルのダイアログボックスの場合、ディレクトリとファイル名の文字列はスペースで区切られ、関数はファイル名にスペースを含む短いファイル名を使用します。

次の例では、バッファーを使用して複数のファイル名を取得し、一覧表示する方法を示します。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

ユーザーが複数のファイル名を選択した場合のバッファーサイズを変更するには、から`CFileDialog`新しいクラスを派生させ、 [CFileDialog:: OnFileNameChange](#onfilenamechange)メソッドをオーバーライドする必要があります。

から`CFileDialog`新しいクラスを派生させる場合は、メッセージマップを使用して任意のメッセージを処理できます。 既定のメッセージ処理を拡張するには、から`CFileDialog`クラスを派生させ、新しいクラスにメッセージマップを追加して、新しいメッセージのメンバー関数を提供します。 ダイアログボックスをカスタマイズするためのフック関数を指定する必要はありません。

ダイアログボックスをカスタマイズするには、から`CFileDialog`クラスを派生させ、カスタムダイアログボックステンプレートを指定して、拡張コントロールからの通知メッセージを処理するメッセージマップを追加します。 未処理のメッセージを基底クラスに渡します。 フック関数をカスタマイズする必要はありません。

の Windows Vista またはそれ以降の`CFileDialog`スタイルを使用している場合は、メッセージマップおよびダイアログボックステンプレートを使用できません。 代わりに、同様の機能に COM インターフェイスを使用する必要があります。

の使用`CFileDialog`方法の詳細については、「[コモンダイアログクラス](../../mfc/common-dialog-classes.md)」を参照してください。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxdlgs

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

ダイアログにチェックボタンを追加します。

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するチェックボタンの ID。

*strLabel*<br/>
チェックボタンの名前。

*bChecked*<br/>
チェックボタンの現在の状態を示すブール値。 オンになっている場合は TRUE。それ以外の場合は FALSE

### <a name="remarks"></a>Remarks

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

ダイアログにコンボボックスを追加します。

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するコンボボックスの ID。

### <a name="remarks"></a>Remarks

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

ダイアログのコンテナーコントロールに項目を追加します。

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
項目を追加するコンテナーコントロールの ID。

*dwIDItem*<br/>
項目の ID。

*strLabel*<br/>
項目のテキスト。

### <a name="remarks"></a>Remarks

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

ダイアログにエディットボックスを追加します。

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するエディットボックスの ID。

*strText*<br/>
エディットボックスの名前。

### <a name="remarks"></a>Remarks

##  <a name="addmenu"></a>  CFileDialog::AddMenu

メニューをダイアログに追加します。

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するメニューの ID。

*strLabel*<br/>
メニュー名。

### <a name="remarks"></a>Remarks

##  <a name="addplace"></a>  CFileDialog::AddPlace

ユーザーが項目を開いたり保存したりできる場所の一覧にフォルダーを追加します。

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>パラメーター

*lpszFolder*<br/>
ユーザーが使用できるようにするフォルダーへのパス。 フォルダーのみを指定できます。

*fdap*<br/>
リスト内のフォルダーの配置場所を指定します。

*プサイ*<br/>
ユーザーが使用できるようにするフォルダーを表す IShellItem へのポインター。 フォルダーのみを指定できます。

### <a name="remarks"></a>Remarks

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

ダイアログにボタンを追加します。

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するボタンの ID。

*strLabel*<br/>
ボタン名。

### <a name="remarks"></a>Remarks

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

ダイアログにオプションボタン (ラジオボタンとも呼ばれます) グループを追加します。

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するオプションボタングループの ID。

### <a name="remarks"></a>Remarks

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

ダイアログに区切り記号を追加します。

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加する区切り記号の ID。

### <a name="remarks"></a>Remarks

##  <a name="addtext"></a>  CFileDialog::AddText

ダイアログにテキストを追加します。

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
追加するテキストの ID。

*strText*<br/>
テキスト名。

### <a name="remarks"></a>Remarks

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

`m_ofn`データ構造に格納されている値に基づいて、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)の現在の状態を更新します。

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Remarks

Windows Vista より前のバージョンの Windows では、メンバーの[Openfilename](/previous-versions/windows/embedded/ms911906\(v=msdn.10\))データ構造は、 `CFileDialog`の状態と継続的に同期されていました。 [M_ofn](#m_ofn)メンバー変数に対する変更は、ダイアログボックスの状態にすぐに反映されました。 また、ダイアログボックスの状態を変更すると、すぐにメンバー `m_ofn`変数が更新されます。

Windows Vista 以降では、 `m_ofn`メンバー変数の値と`CFileDialog`の状態は同期されるとは限りません。 この関数は、 `CFileDialog`の状態を強制的に更新して、 `m_ofn`構造体に一致させます。 Windows[は、CFileDialog::D oModal](#domodal)時にこの関数を自動的に呼び出します。

Windows Vista 以降で`CFileDialog`クラスを使用する方法の詳細については、「 [CFileDialog クラス](../../mfc/reference/cfiledialog-class.md)」を参照してください。

### <a name="example"></a>例

  「 [CFileDialog:: UpdateOFNFromShellDialog」](#updateofnfromshelldialog)の例を参照してください。

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

標準の Windows ファイルダイアログボックスを構築するには、この関数を呼び出します。

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>パラメーター

*Boペン Filedialog*<br/>
[in]このパラメーターを作成するダイアログ ボックスの種類を指定します。 **[ファイルを開く**] ダイアログボックスを構築するには、TRUE に設定します。 **[ファイル名を付けて保存]** ダイアログボックスを作成するには、FALSE に設定します。

*lpszDefExt*<br/>
から既定のファイル名拡張子。 ユーザーの [ファイル名] ボックスに既知の拡張機能 (ユーザーのコンピューターに関連付けられているもの) が含まれていない場合は、 *Lpszdefext*によって指定された拡張子が自動的にファイル名に追加されます。 このパラメーターが NULL の場合、拡張機能は追加されません。

*lpszFileName*<br/>
[in]ファイル名ボックスに表示される初期ファイル名。 NULL の場合、初期ファイル名は表示されません。

*dwFlags*<br/>
からダイアログボックスをカスタマイズするために使用できる1つ以上のフラグの組み合わせ。 これらのフラグの詳細については、Windows SDK の[Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照してください。 `m_ofn.Flags`構造体メンバーを変更する場合は、変更でビットごとの or 演算子を使用して、既定の動作をそのまま維持します。

*lpszFilter*<br/>
からファイルに適用できるフィルターを指定する一連の文字列のペア。 ファイルフィルターを指定すると、フィルター条件に一致するファイルのみが [ファイル] ボックスの一覧に表示されます。 ファイルフィルターの使用方法の詳細については、「解説」を参照してください。

*pParentWnd*<br/>
からファイルダイアログボックスの親またはオーナーウィンドウへのポインター。

*dwSize*<br/>
から`OPENFILENAME`構造体のサイズ。 この値は、オペレーティングシステムのバージョンによって異なります。 MFC では、このパラメーターを使用して、作成する適切な種類のダイアログボックスを決定しています。 既定のサイズは0です。これは、プログラムが実行されているオペレーティングシステムのバージョンに基づいて、使用する正しいダイアログボックスのサイズが MFC コードによって決定されることを意味します。

*Bviているスタイル*<br/>
から**メモ**このパラメーターは Visual Studio 2008 以降で使用でき、Windows Vista 以降で実行している場合にのみ、新しいスタイルのダイアログが使用されます。

ファイルダイアログのスタイルを指定するパラメーター。 新しい Vista スタイルファイルのダイアログを使用するには、TRUE に設定します。 それ以外の場合は、古いスタイルのダイアログボックスが使用されます。 Vista での実行の詳細については、「解説」を参照してください。

### <a name="remarks"></a>Remarks

Boの値に応じて、 **[ファイルを開く]** ダイアログボックスまたは **[ファイル名を付けて保存]** ダイアログボックスが作成されます。

*Lpszdefext*を使用して既定の拡張機能を指定すると、ユーザーのコンピューターにファイルの関連付けが含まれている拡張機能が予測できない場合があるため、期待どおりの動作が得られない可能性があります。 既定の拡張機能の追加をより詳細に制御する必要がある場合は、から`CFileDialog`独自のクラスを派生させ、 `CFileDialog::OnFileNameOK`メソッドをオーバーライドして独自の拡張処理を実行できます。

ユーザーが複数のファイルを選択できるようにするには、OFN_ALLOWMULTISELECT フラグを設定してから、 [DoModal](#domodal)を呼び出します。 返された複数のファイル名のリストを格納するには、独自のファイル名のバッファーを指定する必要があります。 これを行うには、`DoModal` を呼び出す前に、ユーザーが割り当てたバッファーへの [CFileDialog](../../mfc/reference/cfiledialog-class.md) ポインターで `m_ofn.lpstrFile` を置き換えます。 さらに、は、 `m_ofn.nMaxFile`が指す`m_ofn.lpstrFile`バッファー内の文字数でを設定する必要があります。 選択するファイルの最大数を*n*に設定した場合、必要なバッファーサイズは`n`* (_max_path + 1) + 1 になります。 例えば:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

ユーザーがマウスまたはキーボードを使用してエクスプローラースタイルのダイアログボックスのサイズを変更できるようにするには、OFN_ENABLESIZING フラグを設定します。 このフラグの設定が必要なのは、フックプロシージャまたはカスタムテンプレートを指定した場合のみです。 このフラグは、エクスプローラースタイルのダイアログボックスでのみ機能します。旧形式のダイアログボックスのサイズを変更することはできません。

*Lpszfilter*パラメーターは、ファイルをファイルリストに表示するために必要なファイル名の種類を決定するために使用されます。 文字列ペアの最初の文字列は、フィルターについて説明します。2番目の文字列は、使用するファイル名拡張子を示します。 区切り記号としてセミコロン ('; ' 文字) を使用して、複数の拡張機能を指定できます。 文字列は2つの '&#124;' 文字で終わり、その後に NULL 文字が続きます。 このパラメーターには、 [CString](../../atl-mfc-shared/using-cstring.md)オブジェクトを使用することもできます。

たとえば、Microsoft Excel では、ユーザーは、拡張子が xlc (chart) または .xls (ワークシート) のファイルを開くことができます。 Excel のフィルターは次のように記述できます。

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

ただし、この文字列を使用して`OPENFILENAME`構造を直接更新する場合は、縦棒 ('&#124;') ではなく、null 文字 ' \ 0 ' を使用して文字列を区切る必要があります。

*Bvistastyle*パラメーターは、Windows Vista 以降で実行されている場合にのみ適用できます。 以前のバージョンの Windows では、このパラメーターは無視されます。 *Bviて style*が TRUE に設定されている場合、Visual Studio 2008 以降を使用してプログラムをコンパイルすると、[新しい Vista スタイル**ファイル] ダイアログボックス**が使用されます。 それ以外の場合は、前の MFC スタイル**ファイルダイアログ**が使用されます。

ダイアログテンプレートは、 *Bviのスタイル*に基づくダイアログではサポートされていません

### <a name="example"></a>例

  「 [CFileDialog::D oModal](#domodal)」の例を参照してください。

##  <a name="domodal"></a>  CFileDialog::DoModal

Windows の [共通ファイル] ダイアログボックスを表示し、ユーザーがファイルとディレクトリを参照してファイル名を入力できるようにするには、この関数を呼び出します。

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>戻り値

IDOK または IDCANCEL。 IDCANCEL が返された場合は、Windows の[Commdlgextendederror](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror)関数を呼び出して、エラーが発生したかどうかを確認します。

IDOK と IDCANCEL は、ユーザーが [OK] または [キャンセル] ボタンを選択したかどうかを示す定数です。

### <a name="remarks"></a>Remarks

`m_ofn`構造体のメンバーを設定することによって、さまざまなファイルダイアログボックスオプションを初期化する場合は、を`DoModal`呼び出す前に、ダイアログオブジェクトが構築された後にこの操作を行う必要があります。

たとえば、ユーザーが複数のファイルを選択できるようにするには、このトピックのコード例`DoModal`に示すように、を呼び出す前に OFN_ALLOWMULTISELECT フラグを設定します。

ユーザーがダイアログボックスの [OK] ボタンまたは [キャンセル] ボタンをクリックするか、ダイアログボックスのコントロールメニューから [閉じる] オプションを選択すると、アプリケーションにコントロールが返されます。 その後、他のメンバー関数を呼び出して、ダイアログボックスに入力した設定または情報を取得できます。

`DoModal`は、クラス`CDialog`からオーバーライドされる仮想関数です。

### <a name="example"></a>例

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

ダイアログの [開く] または [保存] ボタンのドロップダウンリストを有効にします。

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
ドロップダウンリストの ID。

### <a name="remarks"></a>Remarks

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

ダイアログのビジュアルグループへの要素の追加を停止します。

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>戻り値

成功した場合は S_OK を返します。それ以外の場合は、エラー値。

### <a name="remarks"></a>Remarks

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

ダイアログのチェックボタン (チェックボックス) の現在の状態を取得します。

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
チェックボックスの ID。

*bChecked*<br/>
チェックボックスの状態。 TRUE はチェックされていることを示します。FALSE は unchecked を示します。

### <a name="remarks"></a>Remarks

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

ダイアログで見つかったコンテナーコントロール内の項目の現在の状態を取得します。

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナーコントロールの ID。

*dwIDItem*<br/>
項目の ID。

*dwState*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙子から、より多くの値の1つを受け取る変数への参照。

### <a name="remarks"></a>Remarks

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

指定したコントロールの現在の可視性と有効な状態を取得します。

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

*dwState*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙子から1つ以上の値を受け取る変数への参照。

### <a name="remarks"></a>Remarks

##  <a name="geteditboxtext"></a>CFileDialog:: GetEditBoxText

エディットボックスコントロール内の現在のテキストを取得します。

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
エディットボックスの ID。

*strText*<br/>
テキスト値。

### <a name="remarks"></a>Remarks

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

この関数を呼び出して、ダイアログボックスに入力されたファイル名の拡張子を取得します。

```
CString GetFileExt() const;
```

### <a name="return-value"></a>戻り値

ファイル名の拡張子。

### <a name="remarks"></a>Remarks

たとえば、入力したファイルの名前がデータであるとします。Txt は`GetFileExt` "txt" を返します。

に`m_ofn.Flags` OFN_ALLOWMULTISELECT フラグが設定されている場合、この文字列には null で終わる文字列のシーケンスが含まれます。最初の文字列は選択されたファイルグループのディレクトリパス、その後にユーザーが選択したすべてのファイルの名前が続きます。 ファイルのパス名を取得するには、 [GetStartPosition](#getstartposition)および[GetNextPathName](#getnextpathname)メンバー関数を使用します。

##  <a name="getfilename"></a>  CFileDialog::GetFileName

ダイアログボックスに入力したファイル名の名前を取得するには、この関数を呼び出します。

```
CString GetFileName() const;
```

### <a name="return-value"></a>戻り値

ファイルの名前です。

### <a name="remarks"></a>Remarks

ファイルの名前には、プレフィックスと拡張子の両方が含まれます。 たとえば、 `GetFileName`は "TEXT" を返します。C:\FILES\TEXT.DAT. ファイルの DAT

に`m_ofn.Flags`フラグが`OFN_ALLOWMULTISELECT`設定されている場合は、 [GetStartPosition](#getstartposition)と[GetNextPathName](#getnextpathname)を呼び出して、ファイルのパス名を取得する必要があります。

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

この関数を呼び出して、ダイアログボックスに入力されたファイルのタイトルを取得します。

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>戻り値

ファイルのタイトル。

### <a name="remarks"></a>Remarks

ファイルのタイトルには、パスまたは拡張子のないプレフィックスだけが含まれます。 たとえば、は`GetFileTitle` 、ファイル C:\FILES\TEXT.DAT. の "TEXT" を返します。

に`m_ofn.Flags` OFN_ALLOWMULTISELECT フラグが設定されている場合、この文字列には null で終わる文字列のシーケンスが含まれます。最初の文字列は選択されたファイルグループのディレクトリパス、その後にユーザーが選択したすべてのファイルの名前が続きます。 このため、 [GetStartPosition](#getstartposition)および[GetNextPathName](#getnextpathname)メンバー関数を使用して、リスト内の次のファイル名を取得します。

### <a name="example"></a>例

  「 [CFileDialog::D oModal](#domodal)」の例を参照してください。

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

このメンバー関数を呼び出して、エクスプローラー形式の [開く] または [共通として保存] ダイアログボックスの現在開いているフォルダーまたはディレクトリのパスを取得します。

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>戻り値

現在開いているフォルダーまたはディレクトリを含む[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクト。

### <a name="remarks"></a>Remarks

ダイアログボックスは、OFN_EXPLORER スタイルを使用して作成されている必要があります。それ以外の場合、メソッドはアサーションで失敗します。

このメソッドを呼び出すことができるのは、ダイアログボックスが表示されている間だけです。 ダイアログボックスが閉じられると、この関数は機能しなくなり、メソッドはアサーションで失敗します。

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

指定された[CFileDialog](../../mfc/reference/cfiledialog-class.md)の内部 COM オブジェクトへのポインターを取得します。

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>戻り値

の内部 COM オブジェクト`CFileDialog`へのポインター。 このポインターを適切に解放する必要があります。

### <a name="remarks"></a>Remarks

この関数は、Windows Vista 以降の場合にのみ使用し、 *Bviのスタイル*が TRUE に設定されたオブジェクトを使用します。 この関数を使用すると、 *Bviて style*が FALSE の場合、リリースモードでは NULL が返され、デバッグモードではアサーションがスローされます。

インターフェイスの`IFileDialogCustomize`詳細については、「 [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)」を参照してください。

### <a name="example"></a>例

この例では、内部 COM オブジェクトを取得します。 このコード例を実行するには、Windows Vista 以降でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

指定`CFileDialog`したの内部 COM オブジェクトへのポインターを取得します。

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>戻り値

の内部 COM オブジェクト`CFileDialog`へのポインター。 このポインターを適切に解放する必要があります。

### <a name="remarks"></a>Remarks

この関数は、Windows Vista 以降の場合にのみ使用し、 *Bviのスタイル*が TRUE に設定されたオブジェクトを使用します。 が開いているダイアログボックス`CFileDialog`でない場合 、または*bviの style*が FALSE に設定されている場合、この関数は NULL を返します。 この最後のケースでは、関数はリリースモードでは NULL のみを返します。デバッグモードでは、アサーションがスローされます。

インターフェイスの`IFileOpenDialog`詳細については、「 [ifileopendialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)」を参照してください。

### <a name="example"></a>例

この例では、内部 COM オブジェクトを取得します。 このコードを実行するには、Windows Vista 以降でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

指定`CFileDialog`したの内部 COM オブジェクトへのポインターを取得します。

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>戻り値

の内部 COM オブジェクト`CFileDialog`へのポインター。 このポインターを適切に解放する必要があります。

### <a name="remarks"></a>Remarks

この関数は、Windows Vista 以降の場合にのみ使用し、 *Bviのスタイル*が TRUE に設定されたオブジェクトを使用します。 が [保存] ダイアログボックスで`CFileDialog`ない場合、または*bviの style*が FALSE に設定されている場合、この関数は NULL を返します。 この最後のケースでは、関数はリリースモードでは NULL のみを返します。デバッグモードでは、アサーションがスローされます。

インターフェイスの`IFileSaveDialog`詳細については、「 [IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)」を参照してください。

### <a name="example"></a>例

この例では、内部 COM オブジェクトを取得します。 このコード例を実行するには、Windows Vista 以降でコンパイルする必要があります。

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

この関数を呼び出して、ダイアログボックスで選択したグループから次のファイル名を取得します。

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>パラメーター

*po*<br/>
前`GetNextPathName`の呼び出しまたは`GetStartPosition`関数呼び出しによって返された位置の値への参照。 リストの末尾に到達した場合は NULL。

### <a name="return-value"></a>戻り値

ファイルの完全パス名を返します。

### <a name="remarks"></a>Remarks

ファイル名のパスには、ファイルのタイトルにディレクトリパス全体を加えたものが含まれます。 たとえば、 `GetNextPathName`は "C:\FILES\TEXT." を返します。C:\FILES\TEXT.DAT. ファイルの DAT `GetNextPathName` を`GetStartPosition`呼び出して最初の位置を設定する場合は、前方反復ループでを使用できます。

選択範囲が1つのファイルのみで構成されている場合は、そのファイル名が返されます。

##  <a name="getofn"></a>  CFileDialog::GetOFN

関連付けられ`OPENFILENAME`ている構造体を取得します。

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>戻り値

[Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体。

### <a name="remarks"></a>Remarks

この関数の2番目のバージョンを使用して、ファイルを構築した後、 `DoModal`メンバー関数と共に表示する前に、 **[ファイルを開く**] ダイアログボックスまたは **[ファイル名を付けて保存]** ダイアログボックスの外観を初期化します。 たとえば、の`lpstrTitle` `m_ofn`メンバーを、ダイアログボックスに表示させるキャプションに設定できます。

##  <a name="getpathname"></a>  CFileDialog::GetPathName

この関数を呼び出して、ダイアログボックスに入力されたファイルの完全なパスを取得します。

```
CString GetPathName() const;
```

### <a name="return-value"></a>戻り値

ファイルの完全パス名を返します。

### <a name="remarks"></a>Remarks

ファイル名のパスには、ファイルのタイトルにディレクトリパス全体を加えたものが含まれます。 たとえば、 `GetPathName`は "C:\FILES\TEXT." を返します。C:\FILES\TEXT.DAT. ファイルの DAT

に`m_ofn.Flags` OFN_ALLOWMULTISELECT フラグが設定されている場合、この文字列には、null で表される文字列のシーケンスが含まれます。この文字列の最初の文字列は選択されたファイルグループのディレクトリパスで、その後にユーザーが選択したすべてのファイルの名前が続きます。 このため、 [GetStartPosition](#getstartposition)および[GetNextPathName](#getnextpathname)メンバー関数を使用して、リスト内の次のファイル名を取得します。

### <a name="example"></a>例

  「 [CFileDialog::D oModal](#domodal)」の例を参照してください。

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

Windows の標準の [ファイルを開く] および [ファイル名を付けて保存] ダイアログボックスで [読み取り専用] チェックボックスがオンになっているかどうかを確認するには、この関数を呼び出します。

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>戻り値

ダイアログボックスの [読み取り専用] チェックボックスがオンになっている場合は0以外。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

[読み取り専用] チェックボックスを非表示にするには、 `CFileDialog`コンストラクターで OFN_HIDEREADONLY スタイルを設定します。

> [!NOTE]
> Windows Vista 以降のスタイル`CFileDialog`オブジェクトでは、この機能はサポートされていません。 Windows Vista 以降のスタイル`CFileDialog`でこの関数を使用しようとすると、 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)がスローされます。

##  <a name="getresult"></a>  CFileDialog::GetResult

ユーザーがダイアログで行った選択を取得します。

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>戻り値

ユーザーの選択肢を表す IShellItem へのポインター。

### <a name="remarks"></a>Remarks

##  <a name="getresults"></a>  CFileDialog::GetResults

ダイアログで複数の選択を許可するユーザーの選択肢を取得します。

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>戻り値

ダイアログボックスで選択された項目にアクセスできる IShellItemArray へのポインター。

### <a name="remarks"></a>Remarks

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

ダイアログの指定されたコンテナーコントロールから特定の項目を取得します。

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナーコントロールの ID。

*dwIDItem*<br/>
コントロールでユーザーが選択した項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

OFN_ALLOWMULTISELECT フラグが設定されている場合`m_ofn.Flags` 、このメンバー関数を呼び出して、リスト内の最初のファイルパス名の位置を取得します。

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>戻り値

反復処理に使用できる位置の値。リストが空の場合は NULL です。

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

このメンバー関数を呼び出して、エクスプローラー形式の [共通] ダイアログボックスで指定したコントロールを非表示にします。

```
void HideControl(int nID);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
非表示にするコントロールの ID。

### <a name="remarks"></a>Remarks

ダイアログボックスは、OFN_EXPLORER スタイルを使用して作成されている必要があります。それ以外の場合、関数はアサーションで失敗します。

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

現在のダイアログがフォルダー選択モードであるかどうかを判断します。

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>戻り値

ダイアログがフォルダーピッカーモードの場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

##  <a name="m_ofn"></a>CFileDialog:: m_ofn

`m_ofn`は型`OPENFILENAME`の構造体です。 この構造体のデータは、 `CFileDialog`の現在の状態を表します。

### <a name="remarks"></a>Remarks

この構造体を使用して、ファイルを構築した後、 [DoModal](#domodal)メソッドを使用して表示する前に、 **[ファイルを開く**] ダイアログボックスまたは **[ファイル名を付けて保存]** ダイアログボックスの外観を初期化します。 たとえば、の`m_ofn` *lpstrtitle*メンバーを、ダイアログボックスに表示させるキャプションに設定できます。

Windows Vista またはそれ以降のスタイル [ の ](../../mfc/reference/cfiledialog-class.md)CFileDialog `m_ofn`では、はダイアログボックスの状態と常に一致するとは限りません。 以前のバージョンの Windows では、ダイアログボックスと同期されています。 Windows Vista 以降での`m_ofn`構造と`CFileDialog`状態の同期の詳細については、「 [CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog)および[cfiledialog:: updateofnfromshelldialog](#updateofnfromshelldialog) 」を参照してください。

Windows Vista 以降のスタイルファイルダイアログでは、の特定のメンバーとフラグ`CFileDialog`がサポートされていません。 結果として、これらの影響はありません。

Windows Vista 以降でサポートされていないメンバーの一覧を次に示します。

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

次のフラグはサポートされていないため、Windows Vista またはそれ以降の`CFileDialog`スタイルを使用しても効果はありません。

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- Windows Vista 以降では OFN_LONGNAMES

- Windows Vista 以降では OFN_NOLONGNAMES

- Windows Vista 以降では OFN_NONETWORKBUTTON

- OFN_READONLY

- OFN_SHOWHELP

この構造体の詳細については、Windows SDK の[Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照してください。

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

コントロールをダイアログに配置し、他のコントロールと比較して表示します。

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

### <a name="remarks"></a>Remarks

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

ボタンがクリックされたときに呼び出されます。

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
ボタンの ID。

### <a name="remarks"></a>Remarks

##  <a name="oncheckbuttontoggled"></a>CFileDialog:: OnCheckButtonToggled

チェックボックスをオンまたはオフにしたときに呼び出されます。

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
チェックボックスの ID。

*bChecked*<br/>
Checked または unchecked。

### <a name="remarks"></a>Remarks

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

コントロールがアクティブになると呼び出されます。

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

### <a name="remarks"></a>Remarks

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

WM_NOTIFY CDN_SELCHANGE メッセージを処理する場合は、このメソッドをオーバーライドします。

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Remarks

ユーザーが **[開く]** または **[名前を付けて保存]** ダイアログボックスのファイルリストで新しいファイルまたはフォルダーを選択すると、システムによって CDN_SELCHANGE メッセージが送信されます。 このメッセージに応答してアクションを実行する場合は、このメソッドをオーバーライドします。

OFN_EXPLORER フラグが有効になっている状態でダイアログボックスが作成された場合にのみ、システムはこのメッセージを送信します。 通知の詳細については、「 [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange)」を参照してください。 OFN_EXPLORER フラグの詳細については、 [Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照し、[[開く] および [名前を付けて保存] ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

共通ファイルのダイアログボックスに入力されたファイル名のカスタム検証を提供する場合にのみ、この関数をオーバーライドします。

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>戻り値

ファイル名が有効なファイル名でない場合は1です。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

この関数を使用すると、アプリケーション固有の理由によってファイル名を拒否できます。 通常、この関数を使用する必要はありません。これは、フレームワークによってファイル名の既定の検証が提供され、無効なファイル名が入力された場合にメッセージボックスが表示されるためです。

1が返された場合は、ユーザーが別のファイル名を入力するためのダイアログボックスが表示されたままになります。 戻り値が0の場合、ダイアログプロシージャはダイアログを閉じます。 他の0以外の戻り値は現在予約されているため、使用しないでください。

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

WM_NOTIFYCDN_FOLDERCHANGE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Remarks

[開く] または [名前を付けて保存] ダイアログボックスで新しいフォルダーが開かれると、通知メッセージが送信されます。

通知は、ダイアログボックスが OFN_EXPLORER スタイルで作成された場合にのみ送信されます。 通知の詳細については、「 [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange)」を参照してください。 OFN_EXPLORER スタイルの詳細については、 [Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照し、[[開く] および [名前を付けて保存] ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

この関数をオーバーライドして、WM_NOTIFY CDN_INITDONE メッセージを処理します。

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Remarks

システムが **[開く]** または **[名前を付けて保存]** ダイアログボックスでコントロールの配置を完了すると、この通知メッセージが送信され、子ダイアログボックスのコントロールの領域が確保されます。

ダイアログボックスが OFN_EXPLORER スタイルを使用して作成された場合にのみ、システムはこのを送信します。 通知の詳細については、「 [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone)」を参照してください。 OFN_EXPLORER スタイルの詳細については、 [Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照し、[[開く] および [名前を付けて保存] ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

> [!NOTE]
> Windows Vista 以降のスタイルファイルダイアログでは、この機能はサポートされていません。 Windows Vista 以降のスタイルファイルダイアログでこの関数を使用しようとすると、 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)がスローされます。

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

コンテナー項目が選択されると呼び出されます。

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナーコントロールの ID。

*dwIDItem*<br/>
項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

この関数は、リストボックス内の現在の選択範囲が変更されるたびに呼び出されます。

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>パラメーター

*nIDBox*<br/>
選択が発生したリストボックスまたはコンボボックスの ID。

*iCurSel*<br/>
現在の選択範囲のインデックス。

*nCode*<br/>
コントロール通知コード。 このパラメーターには、次のいずれかの値を指定する必要があります。

- CD_LBSELCHANGE は、単一選択リストボックスで選択された項目である*iCurSel*を指定します。

- CD_LBSELSUB は、複数選択のリストボックスで*iCurSel*が選択されていないことを指定します。

- CD_LBSELADD は、複数選択のリストボックスで*iCurSel*を選択することを指定します。

- CD_LBSELNOITEMS は、複数選択のリストボックスには存在しないことを指定します。

### <a name="remarks"></a>Remarks

この関数をオーバーライドすると、リストボックスで選択した変更のカスタム処理を行うことができます。 たとえば、この関数を使用すると、ユーザーが選択した各ファイルのアクセス権または最終更新日を表示できます。

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

共有違反のカスタム処理を提供するには、この関数をオーバーライドします。

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>パラメーター

*lpszPathName*<br/>
共有違反が発生したファイルのパス。

### <a name="return-value"></a>戻り値

次のいずれかの値です。

- OFN_SHAREFALLTHROUGH ダイアログボックスからファイル名が返されます。

- OFN_SHARENOWARN これ以上のアクションを実行する必要はありません。

- OFN_SHAREWARN ユーザーは、このエラーに対して標準の警告メッセージを受信します。

### <a name="remarks"></a>Remarks

通常、この関数を使用する必要はありません。これは、フレームワークが共有違反の既定のチェックを提供し、共有違反が発生した場合にメッセージボックスを表示するためです。

共有違反チェックを無効にする場合は、ビットごとの OR 演算子を使用して、 `m_ofn.Flags`フラグ OFN_SHAREAWARE をと結合します。

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

WM_NOTIFYCDN_TYPECHANGE メッセージを処理するには、この関数をオーバーライドします。

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Remarks

[開く] または [名前を付けて保存] ダイアログボックスで、ユーザーがファイルの種類の一覧から新しいファイルの種類を選択すると、通知メッセージが送信されます。

通知は、ダイアログボックスが OFN_EXPLORER スタイルで作成された場合にのみ送信されます。 通知の詳細については、「 [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange)」を参照してください。 OFN_EXPLORER スタイルの詳細については、 [Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)構造体を参照し、[[開く] および [名前を付けて保存] ダイアログボックス](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)を参照してください。

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

ダイアログのコンテナーコントロールから項目を削除します。

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
項目を削除するコンテナーコントロールの ID。

*dwIDItem*<br/>
項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

ダイアログのチェックボタン (チェックボックス) の現在の状態を設定します。

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
チェックボックスの ID。

*bChecked*<br/>
チェックボックスの状態。 TRUE はチェックされていることを示します。FALSE は Unchecked を示します。

### <a name="remarks"></a>Remarks

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

ダイアログで見つかったコンテナーコントロールの項目の現在の状態を設定します。

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナーコントロールの ID。

*dwIDItem*<br/>
項目の ID。

*dwState*<br/>
コントロールの新しい状態を示す CDCONTROLSTATE 列挙子の1つ以上の値。

### <a name="remarks"></a>Remarks

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

コントロール項目のテキストを設定します。 たとえば、ラジオボタンやメニュー内の項目に付随するテキストなどです。

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナーコントロールの ID。

*dwIDItem*<br/>
項目の ID。

*strLabel*<br/>
項目のテキスト。

### <a name="remarks"></a>Remarks

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

ボタンテキストやエディットボックスラベルなど、コントロールに関連付けられたテキストを設定します。

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

*strLabel*<br/>
コントロール名。

### <a name="remarks"></a>Remarks

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

指定されたコントロールの現在の可視性と有効な状態を設定します。

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コントロールの ID。

*dwState*<br/>
コントロールの現在の状態を示す CDCONTROLSTATE 列挙子の1つ以上の値。

### <a name="remarks"></a>Remarks

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

エクスプローラースタイルの **[開く**] または **[名前を付けて保存]** ダイアログボックスで、指定したコントロールのテキストを設定するには、このメソッドを呼び出します。

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
からテキストを設定するコントロールの ID。

*lpsz*<br/>
からコントロールに設定するテキストが格納されている文字列へのポインター。

### <a name="remarks"></a>Remarks

この関数の両方のバージョンは、Unicode を使用するアプリケーションに対して有効です。 ただし、ANSI を使用するアプリケーションでは、LPCSTR 型のバージョンのみが有効です。

このメソッドを使用するには、OFN_EXPLORER スタイルを使用してダイアログボックスを作成する必要があります。 それ以外の場合、関数はアサーションで失敗します。

##  <a name="setdefext"></a>  CFileDialog::SetDefExt

エクスプローラースタイルの [開く] または [共通として保存] ダイアログボックスの既定のファイル名拡張子を設定するには、この関数を呼び出します。

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>パラメーター

*lpsz*<br/>
ダイアログボックスオブジェクトに使用する既定の拡張子を格納している文字列へのポインター。 この文字列にピリオド (.) を含めることはできません。

### <a name="remarks"></a>Remarks

ダイアログボックスは、OFN_EXPLORER スタイルを使用して作成されている必要があります。それ以外の場合、関数はアサーションで失敗します。

##  <a name="seteditboxtext"></a>CFileDialog:: SetEditBoxText

エディットボックスコントロール内の現在のテキストを設定します。

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
エディットボックスの ID。

*strText*<br/>
テキスト値。

### <a name="remarks"></a>Remarks

##  <a name="setproperties"></a>CFileDialog:: SetProperties

保存される項目に対して使用される既定値を定義するプロパティ ストアを提供します。

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>パラメーター

*lpszPropList*<br/>
";" で区切られた定義済みプロパティのリスト。 フラグの一覧については、 [Openfilename](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)の**flags**セクションを参照してください。

### <a name="remarks"></a>Remarks

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

ダイアログのオプションボタングループまたはコンボボックスで、特定の項目の選択された状態を設定します。

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
コンテナーコントロールの ID。

*dwIDItem*<br/>
コントロールでユーザーが選択した項目の ID。

### <a name="remarks"></a>Remarks

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

[CFileDialog](../../mfc/reference/cfiledialog-class.md)オブジェクトのダイアログボックステンプレートを設定します。

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>パラメーター

*nWin3ID*<br/>
からエクスプローラー `CFileDialog`以外のオブジェクトのテンプレートリソースの ID 番号を格納します。 このテンプレートは、Windows NT 3.51 または OFN_EXPLORER スタイルが存在しない場合にのみ使用されます。

*nWin4ID*<br/>
からエクスプローラー `CFileDialog`オブジェクトのテンプレートリソースの ID 番号を格納します。 このテンプレートは、Windows NT 4.0 以降のバージョン、Windows 95 以降のバージョン、または OFN_EXPLORER スタイルが存在する場合にのみ使用されます。

*lpWin3ID*<br/>
からエクスプローラー `CFileDialog`以外のオブジェクトのテンプレートリソースの名前を格納します。 このテンプレートは、Windows NT 3.51 または OFN_EXPLORER スタイルが存在しない場合にのみ使用されます。

*lpWin4ID*<br/>
からエクスプローラー `CFileDialog`オブジェクトのテンプレートリソースの名前を格納します。 このテンプレートは、Windows NT 4.0 以降のバージョン、Windows 95 以降のバージョン、または OFN_EXPLORER スタイルが存在する場合にのみ使用されます。

### <a name="remarks"></a>Remarks

システムは、指定されたテンプレートの1つのみを使用します。 システムは、OFN_EXPLORER スタイルの有無と、アプリケーションが実行されているオペレーティングシステムに基づいて、どのテンプレートを使用するかを決定します。 エクスプローラー以外のテンプレートとエクスプローラースタイルのテンプレートの両方を指定すると、windows NT 3.51、Windows NT 4.0 以降のバージョン、および Windows 95 以降のバージョンを簡単にサポートできます。

> [!NOTE]
> Windows Vista またはそれ以降のスタイルファイルのダイアログボックスでは、この機能はサポートされていません。 Windows Vista 以降のスタイルファイルダイアログボックスでこの関数を使用しようとすると、 [CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)がスローされます。 別の方法として、カスタマイズされたダイアログを使用することもできます。 カスタム`CFileDialog`の使用方法の詳細については、「 [IFileDialogCustomize](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)」を参照してください。

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

ダイアログでビジュアルグループを宣言します。 後続の "add" メソッドを呼び出すと、その要素がこのグループに追加されます。

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>パラメーター

*dwIDCtl*<br/>
ビジュアルグループの ID。

*strLabel*<br/>
グループ名。

### <a name="remarks"></a>Remarks

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

内部オブジェクト`m_ofn`の現在の状態に基づいて、 [CFileDialog](../../mfc/reference/cfiledialog-class.md)のデータ構造を更新します。

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Remarks

Windows Vista より前のバージョンの Windows では、メンバーの[Openfilename](/previous-versions/windows/embedded/ms911906\(v=msdn.10\))データ構造は、 `CFileDialog`の状態と継続的に同期されていました。 [M_ofn](#m_ofn)メンバー変数に対する変更は、ダイアログボックスの状態に直接影響します。 また、ダイアログの状態を変更すると、m_ofn メンバー変数が直ちに更新されます。

Windows Vista 以降では、 `m_ofn`データ構造は自動的に更新されません。 `m_ofn`メンバー変数のデータの精度を保証するには、データにアクセスする`UpdateOFNFromShellDialog`前に関数を呼び出す必要があります。 この関数は、 [Ifiledialog:: OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)の処理中に Windows によって自動的に呼び出されます。

Windows Vista 以降で`CFileDialog`クラスを使用する方法の詳細については、「 [CFileDialog クラス](../../mfc/reference/cfiledialog-class.md)」を参照してください。

### <a name="example"></a>例

この例では`CFileDialog` 、を表示する前にを更新します。 `m_ofn`メンバー変数を更新する前に、ダイアログボックスの現在の状態に同期する必要があります。

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>関連項目

[CCommonDialog クラス](../../mfc/reference/ccommondialog-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)
