---
title: COleControl クラス
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/06/2019
ms.locfileid: "70741399"
---
# <a name="colecontrol-class"></a>COleControl クラス

OLE コントロールを開発するための強力な基底クラスです。

## <a name="syntax"></a>構文

```
class COleControl : public CWnd
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[COleControl:: COleControl](#colecontrol)|`COleControl` オブジェクトを作成します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|コントロールの現在の外観を取得します。|
|[COleControl::AmbientBackColor](#ambientbackcolor)|アンビエント BackColor プロパティの値を返します。|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|コンテナーによって指定されたコントロールの名前を返します。|
|[COleControl::AmbientFont](#ambientfont)|アンビエントフォントプロパティの値を返します。|
|[COleControl::AmbientForeColor](#ambientforecolor)|アンビエント ForeColor プロパティの値を返します。|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|コンテナーのロケール ID を返します。|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|コンテナーによって使用される単位の種類を返します。|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|グラブハンドルを表示するかどうかを決定します。|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|陰影を表示するかどうかを決定します。|
|[COleControl::AmbientTextAlign](#ambienttextalign)|コンテナーによって指定されたテキストの配置の種類を返します。|
|[COleControl::AmbientUIDead](#ambientuidead)|コントロールがユーザーインターフェイスの操作に応答する必要があるかどうかを判断します。|
|[COleControl::AmbientUserMode](#ambientusermode)|コンテナーのモードを決定します。|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|バインドされたプロパティが変更されたことをコンテナーに通知します。|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|プロパティ値を編集するためのアクセス許可を要求します。|
|[COleControl::ClientToParent](#clienttoparent)|コントロールの原点を基準とするポイントを、そのコンテナーの原点を基準とする相対ポイントに変換します。|
|[COleControl::ClipCaretRect](#clipcaretrect)|カーソルがコントロールによって重なっている場合は、カレット四角形を調整します。|
|[COleControl::ControlInfoChanged](#controlinfochanged)|コントロールによって処理されるニーモニックのセットが変更された後に、この関数を呼び出します。|
|[COleControl::DisplayError](#displayerror)|コントロールのユーザーにストックエラーイベントを表示します。|
|[COleControl::DoClick](#doclick)|Stock `DoClick`メソッドの実装。|
|[COleControl::DoPropExchange](#dopropexchange)|`COleControl`オブジェクトのプロパティをシリアル化します。|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Windows コントロールからサブクラス化された OLE コントロールを再描画します。|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|コントロールの単純なフレームのサポートを有効にします。|
|[COleControl::ExchangeExtent](#exchangeextent)|コントロールの幅と高さをシリアル化します。|
|[COleControl::ExchangeStockProps](#exchangestockprops)|コントロールのストックプロパティをシリアル化します。|
|[COleControl::ExchangeVersion](#exchangeversion)|コントロールのバージョン番号をシリアル化します。|
|[COleControl::FireClick](#fireclick)|Stock `Click`イベントを発生させます。|
|[COleControl::FireDblClick](#firedblclick)|Stock `DblClick`イベントを発生させます。|
|[COleControl::FireError](#fireerror)|Stock `Error`イベントを発生させます。|
|[COleControl::FireEvent](#fireevent)|カスタムイベントを発生します。|
|[COleControl::FireKeyDown](#firekeydown)|Stock `KeyDown`イベントを発生させます。|
|[COleControl::FireKeyPress](#firekeypress)|Stock `KeyPress`イベントを発生させます。|
|[COleControl::FireKeyUp](#firekeyup)|Stock `KeyUp`イベントを発生させます。|
|[COleControl::FireMouseDown](#firemousedown)|Stock `MouseDown`イベントを発生させます。|
|[COleControl::FireMouseMove](#firemousemove)|Stock `MouseMove`イベントを発生させます。|
|[COleControl::FireMouseUp](#firemouseup)|Stock `MouseUp`イベントを発生させます。|
|[COleControl::FireReadyStateChange](#firereadystatechange)|コントロールの準備完了の状態が変化したときにイベントを発生させます。|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|`IPointerInactive`インターフェイスをサポートするコントロールの既定のアクティベーション動作を変更します。|
|[COleControl::GetAmbientProperty](#getambientproperty)|指定されたアンビエントプロパティの値を返します。|
|[COleControl:: GetAppearance](#getappearance)|Stock の外観プロパティの値を返します。|
|[COleControl::GetBackColor](#getbackcolor)|Stock BackColor プロパティの値を返します。|
|[COleControl::GetBorderStyle](#getborderstyle)|Stock BorderStyle プロパティの値を返します。|
|[COleControl::GetCapture](#getcapture)|ウィンドウなしのアクティブなコントロールオブジェクトにマウスキャプチャがあるかどうかを判断します。|
|[COleControl::GetClassID](#getclassid)|コントロールの OLE クラス ID を取得します。|
|[COleControl::GetClientOffset](#getclientoffset)|コントロールの四角形領域の左上隅とクライアント領域の左上隅との差を取得します。|
|[COleControl::GetClientRect](#getclientrect)|コントロールのクライアント領域のサイズを取得します。|
|[COleControl::GetClientSite](#getclientsite)|コンテナー内の現在のクライアントサイトへのポインターをオブジェクトに照会します。|
|[COleControl::GetControlFlags](#getcontrolflags)|コントロールフラグの設定を取得します。|
|[COleControl::GetControlSize](#getcontrolsize)|OLE コントロールの位置とサイズを返します。|
|[COleControl::GetDC](#getdc)|ウィンドウなしのコントロールで、コンテナーからデバイスコンテキストを取得するための手段を提供します。|
|[COleControl::GetEnabled](#getenabled)|Stock Enabled プロパティの値を返します。|
|[COleControl::GetExtendedControl](#getextendedcontrol)|コンテナーに属する拡張コントロールオブジェクトへのポインターを取得します。|
|[COleControl::GetFocus](#getfocus)|コントロールにフォーカスがあるかどうかを判断します。|
|[COleControl::GetFont](#getfont)|ストックフォントプロパティの値を返します。|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|`CFontHolder`オブジェクトのメトリックを返します。|
|[COleControl::GetForeColor](#getforecolor)|Stock ForeColor プロパティの値を返します。|
|[COleControl::GetHwnd](#gethwnd)|Stock hWnd プロパティの値を返します。|
|[COleControl::GetMessageString](#getmessagestring)|メニュー項目のステータスバーのテキストを提供します。|
|[COleControl::GetNotSupported](#getnotsupported)|ユーザーがコントロールのプロパティ値にアクセスできないようにします。|
|[COleControl::GetReadyState](#getreadystate)|コントロールの準備状態を返します。|
|[COleControl::GetRectInContainer](#getrectincontainer)|コンテナーに対して相対的なコントロールの四角形を返します。|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|ストックフォントプロパティのメトリックを返します。|
|[COleControl::GetText](#gettext)|ストックテキストまたはキャプションプロパティの値を返します。|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|ウィンドウなしのコントロールをドラッグアンドドロップ操作の対象にすることを許可するには、をオーバーライドします。|
|[COleControl::InitializeIIDs](#initializeiids)|コントロールが使用する Iid がの基底クラスに通知します。|
|[COleControl::InternalGetFont](#internalgetfont)|ストックフォントプロパティのオブジェクトを返します。`CFontHolder`|
|[COleControl::InternalGetText](#internalgettext)|ストックキャプションまたはテキストプロパティを取得します。|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|コントロールの準備状態を設定し、状態変更イベントを発生させます。|
|[COleControl::InvalidateControl](#invalidatecontrol)|表示されているコントロールの領域を無効にして、再描画します。|
|[COleControl::InvalidateRgn](#invalidatergn)|指定された領域内のコンテナーウィンドウのクライアント領域を無効にします。 は、領域内のウィンドウなしのコントロールを再描画するために使用できます。|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|OLE コントロールの特殊な読み込みを可能にします。|
|[COleControl::IsModified](#ismodified)|コントロールの状態が変更されたかどうかを判断します。|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|コンテナーが現在の描画操作用に最適化された描画をサポートするかどうかを示します。|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|コントロールのサブクラスが Windows コントロールかどうかを判断するために呼び出されます。|
|[COleControl::Load](#load)|以前のすべての非同期データをリセットし、コントロールの非同期プロパティの新しい読み込みを開始します。|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|コンテナーによってコントロールを非アクティブにできるかどうかを決定します。|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|アンビエントプロパティが変更されたときに呼び出されます。|
|[COleControl:: Onています。](#onappearancechanged)|Stock の外観プロパティが変更されたときに呼び出されます。|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Stock BackColor プロパティが変更されたときに呼び出されます。|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Stock BorderStyle プロパティが変更されたときに呼び出されます。|
|[COleControl::OnClick](#onclick)|ストッククリックイベントを発生させるために呼び出されます。|
|[COleControl::OnClose](#onclose)|が呼び出された`IOleControl::Close`ことをコントロールに通知します。|
|[COleControl::OnDoVerb](#ondoverb)|コントロール動詞が実行された後に呼び出されます。|
|[COleControl::OnDraw](#ondraw)|コントロール自体の再描画が要求されたときに呼び出されます。|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|メタファイルデバイスコンテキストを使用してコントロール自体を再描画するように要求された場合に、コンテナーによって呼び出されます。|
|[COleControl::OnEdit](#onedit)|OLE コントロールをアクティブ化するためにコンテナーによって呼び出されます。|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Stock Enabled プロパティが変更されたときに呼び出されます。|
|[COleControl::OnEnumVerbs](#onenumverbs)|コントロールの動詞を列挙するために、コンテナーによって呼び出されます。|
|[COleControl::OnEventAdvise](#oneventadvise)|イベントハンドラーがコントロールに接続または切断されたときに呼び出されます。|
|[COleControl::OnFontChanged](#onfontchanged)|ストックフォントプロパティが変更されたときに呼び出されます。|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Stock ForeColor プロパティが変更されたときに呼び出されます。|
|[COleControl::OnFreezeEvents](#onfreezeevents)|コントロールのイベントが固定または凍結解除されるときに呼び出されます。|
|[COleControl::OnGetColorSet](#ongetcolorset)|が呼び出された`IOleObject::GetColorSet`ことをコントロールに通知します。|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|コンテナーにニーモニック情報を提供します。|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|プロパティ値を表す文字列を取得するために呼び出されます。|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|コンテナーメニューとマージされるコントロールのメニューのハンドルを要求します。|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|をオーバーライドして、提案されたサイズとエクステントモードに最も近いコントロールの表示サイズを取得します。|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|プロパティの有効な値を表す文字列を返します。|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|定義済みの文字列に対応する値を返します。|
|[COleControl::OnGetViewExtent](#ongetviewextent)|コントロールの表示領域のサイズを取得するには、をオーバーライドします (2 パス描画を有効にするために使用できます)。|
|[COleControl::OnGetViewRect](#ongetviewrect)|をオーバーライドして、コントロールのサイズを特定の位置から始まる四角形に変換します。|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|コントロールのビューの状態を取得するには、をオーバーライドします。|
|[COleControl::OnHideToolBars](#onhidetoolbars)|コントロールが UI で非アクティブになったときにコンテナーによって呼び出されます。|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|をオーバーライドして、マウスポインターの下にある非アクティブコントロールのコンテナーが WM_MOUSEMOVE メッセージをコントロールにディスパッチするようにします。|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|をオーバーライドして、マウスポインターの下にある非アクティブコントロールのコンテナーが WM_SETCURSOR メッセージをコントロールにディスパッチするようにします。|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Stock KeyDown イベントが発生した後に呼び出されます。|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Stock KeyPress イベントが発生した後に呼び出されます。|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Stock KeyUp イベントが発生した後に呼び出されます。|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|プロパティの編集に使用するプロパティページを示します。|
|[COleControl::OnMnemonic](#onmnemonic)|コントロールのニーモニックキーが押されたときに呼び出されます。|
|[COleControl::OnProperties](#onproperties)|コントロールの "Properties" 動詞が呼び出されたときに呼び出されます。|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|コントロールの表示が特定の点に重なっているかどうかを照会するには、をオーバーライドします。|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|コントロールの表示が、指定された四角形内の点に重なっているかどうかを照会するようにオーバーライドします。|
|[COleControl::OnRenderData](#onrenderdata)|指定された形式でデータを取得するためにフレームワークによって呼び出されます。|
|[COleControl::OnRenderFileData](#onrenderfiledata)|指定された形式でファイルからデータを取得するために、フレームワークによって呼び出されます。|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|指定された形式でグローバルメモリからデータを取得するために、フレームワークによって呼び出されます。|
|[COleControl::OnResetState](#onresetstate)|コントロールのプロパティを既定値にリセットします。|
|[COleControl::OnSetClientSite](#onsetclientsite)|が呼び出された`IOleControl::SetClientSite`ことをコントロールに通知します。|
|[COleControl:: OnSetData](#onsetdata)|コントロールのデータを別の値に置き換えます。|
|[COleControl::OnSetExtent](#onsetextent)|コントロールの範囲が変更された後に呼び出されます。|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|コントロールの次元が変更された後に呼び出されます。|
|[COleControl::OnShowToolBars](#onshowtoolbars)|コントロールが UI でアクティブになったときに呼び出されます。|
|[COleControl::OnTextChanged](#ontextchanged)|ストックテキストまたはキャプションプロパティが変更されたときに呼び出されます。|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|ウィンドウなしのコントロールのウィンドウメッセージ (マウスおよびキーボードメッセージを除く) を処理します。|
|[COleControl::ParentToClient](#parenttoclient)|コンテナーの原点を基準とする相対ポイントを、コントロールの原点を基準とするポイントに変換します。|
|[COleControl::PostModalDialog](#postmodaldialog)|モーダルダイアログボックスが閉じられたことをコンテナーに通知します。|
|[COleControl::PreModalDialog](#premodaldialog)|モーダルダイアログボックスが表示されようとしていることをコンテナーに通知します。|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|コントロールのウィンドウを破棄して再作成します。|
|[COleControl::Refresh](#refresh)|コントロールの外観を強制的に再描画します。|
|[COleControl::ReleaseCapture](#releasecapture)|マウスキャプチャを解放します。|
|[COleControl::ReleaseDC](#releasedc)|ウィンドウなしのコントロールのコンテナーの表示デバイスコンテキストを解放します。|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|コントロールウィンドウの親をリセットします。|
|[COleControl::ResetStockProps](#resetstockprops)|ストック`COleControl`プロパティを既定値に初期化します。|
|[COleControl::ResetVersion](#resetversion)|バージョン番号を指定された値に初期化します。|
|[COleControl::ScrollWindow](#scrollwindow)|ウィンドウなしのコントロールで、画面の埋め込み先のアクティブなイメージ内の領域をスクロールできるようにします。|
|[COleControl::SelectFontObject](#selectfontobject)|デバイスコンテキストにカスタムフォントプロパティを選択します。|
|[COleControl::SelectStockFont](#selectstockfont)|ストックフォントプロパティをデバイスコンテキストに選択します。|
|[COleControl::SerializeExtent](#serializeextent)|コントロールの表示領域をシリアル化または初期化します。|
|[COleControl::SerializeStockProps](#serializestockprops)|ストックプロパティを`COleControl`シリアル化または初期化します。|
|[COleControl::SerializeVersion](#serializeversion)|コントロールのバージョン情報をシリアル化または初期化します。|
|[COleControl:: SetAppearance](#setappearance)|Stock の外観プロパティの値を設定します。|
|[COleControl::SetBackColor](#setbackcolor)|Stock BackColor プロパティの値を設定します。|
|[COleControl::SetBorderStyle](#setborderstyle)|Stock BorderStyle プロパティの値を設定します。|
|[COleControl::SetCapture](#setcapture)|コントロールのコンテナーウィンドウが、コントロールの代わりにマウスキャプチャを受け取るようにします。|
|[COleControl::SetControlSize](#setcontrolsize)|OLE コントロールの位置とサイズを設定します。|
|[COleControl::SetEnabled](#setenabled)|Stock Enabled プロパティの値を設定します。|
|[COleControl::SetFocus](#setfocus)|コントロールのコンテナーウィンドウが、コントロールの代わりに入力フォーカスを受け取るようにします。|
|[COleControl::SetFont](#setfont)|ストックフォントプロパティの値を設定します。|
|[COleControl::SetForeColor](#setforecolor)|Stock ForeColor プロパティの値を設定します。|
|[COleControl::SetInitialSize](#setinitialsize)|コンテナーに最初に表示されるときの OLE コントロールのサイズを設定します。|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|コントロールの変更された状態を変更します。|
|[COleControl::SetNotPermitted](#setnotpermitted)|編集要求が失敗したことを示します。|
|[COleControl::SetNotSupported](#setnotsupported)|ユーザーがコントロールのプロパティ値を変更できないようにします。|
|[COleControl::SetRectInContainer](#setrectincontainer)|コンテナーを基準として、コントロールの四角形を設定します。|
|[COleControl::SetText](#settext)|ストックテキストまたはキャプションプロパティの値を設定します。|
|[COleControl::ThrowError](#throwerror)|OLE コントロールでエラーが発生したことを通知します。|
|[COleControl::TransformCoords](#transformcoords)|コンテナーとコントロールの間の座標値を変換します。|
|[COleControl::TranslateColor](#translatecolor)|OLE_COLOR 値を COLORREF 値に変換します。|
|[COleControl:: WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|次にコントロールが読み込まれるときにアンビエントプロパティを使用できるようにするかどうかを指定します。|
|[COleControl::WindowProc](#windowproc)|`COleControl`オブジェクトの Windows プロシージャを提供します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|コントロールの外観を更新する必要があるときに、フレームワークによって呼び出されます。|
|[COleControl: rawMetafile の:D](#drawmetafile)|メタファイルデバイスコンテキストが使用されているときに、フレームワークによって呼び出されます。|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|オートメーションメソッドの呼び出しを有効にします。|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|コントロールでサポートされているデータ形式の一覧を初期化するために、フレームワークによって呼び出されます。|

## <a name="remarks"></a>Remarks

から`CWnd`派生したこのクラスは、Windows ウィンドウオブジェクトのすべての機能に加え、OLE に固有の追加の機能 (イベントの発生やメソッドとプロパティをサポートする機能など) を継承します。

Ole コンテナーアプリケーションに OLE コントロールを挿入し、イベントの双方向のシステムを使用してコンテナーと通信するには、コンテナーに対してメソッドとプロパティを公開します。 標準 OLE コンテナーでは、OLE コントロールの基本機能のみがサポートされていることに注意してください。 OLE コントロールの拡張機能をサポートできません。 イベントの発生は、コントロールで特定のアクションが発生した結果、イベントがコンテナーに送信されるときに発生します。 さらに、コンテナーは、 C++クラスのメンバー関数とデータメンバーに類似したメソッドとプロパティの公開されたセットを使用して、コントロールと通信します。 この方法を使用すると、開発者はコントロールの外観を制御し、特定のアクションが発生したときにコンテナーに通知できます。

## <a name="windowless-controls"></a>ウィンドウなしのコントロール

OLE コントロールは、ウィンドウなしで埋め込み先で使用できます。 ウィンドウなしのコントロールには、大きな利点があります。

- ウィンドウなしのコントロールは透明で、四角形以外にすることができます

- ウィンドウなしのコントロールは、インスタンスのサイズとオブジェクトの作成時間を短縮します。

コントロールには、ウィンドウは必要ありません。 ウィンドウに用意されているサービスは、単一の共有ウィンドウ (通常はコンテナーの) と1つのディスパッチコードを使用して簡単に提供できます。 ウィンドウを用意することは、ほとんどの場合、オブジェクトの複雑な複雑さです。

ウィンドウなしのアクティベーションが使用されている場合、コンテナー (ウィンドウがある) には、コントロール独自のウィンドウによって提供されたサービスを提供する役割があります。 たとえば、コントロールがキーボードフォーカスに対してクエリを実行したり、マウスキャプチャにクエリを実行したり、デバイスコンテキストを取得したりする必要がある場合、これらの操作はコンテナーによって管理されます。 ウィンドウ`COleControl`なしのメンバー関数は、コンテナーに対してこれらの操作を呼び出します。

ウィンドウなしのアクティベーションが有効になっている場合、コンテナー `IOleInPlaceObjectWindowless`は、入力メッセージをコントロールのインターフェイス (ウィンドウなしのサポートのために[IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)の拡張機能) に委任します。 `COleControl`では、このインターフェイスを実装することで、マウスの座標を適切に調整した後に、これらのメッセージをコントロールのメッセージマップからディスパッチします。 これらのメッセージは、メッセージマップに対応するエントリを追加することで、通常のウィンドウメッセージのように処理できます。

ウィンドウなしのコントロールでは、対応`COleControl` `CWnd`するメンバー関数またはそれに関連する Windows API 関数の代わりに、常にメンバー関数を使用する必要があります。

OLE コントロールオブジェクトは、アクティブになったときにのみウィンドウを作成することもできますが、アクティブでないアクティブな遷移に必要な作業量が増加し、遷移の速度が低下します。 これが問題になる場合があります。例として、テキストボックスのグリッドを考えてみましょう。 列を cursoring に上下に移動する場合は、各コントロールをアクティブにしてから非アクティブ化する必要があります。 非アクティブ/アクティブ遷移の速度は、スクロール速度に直接影響します。

OLE コントロールフレームワークの開発の詳細については、 [MFC ActiveX コントロール](../../mfc/mfc-activex-controls.md)と[概要に関する記事を参照してください。MFC ActiveX コントロールプログラム](../../mfc/reference/mfc-activex-control-wizard.md)を作成する。 ウィンドウなしのコントロールやちらつきなしのコントロールなど、OLE コントロールの最適化の[詳細については、「MFC ActiveX コントロール」を参照してください。最適化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

アンビエント BackColor プロパティの値を返します。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント BackColor プロパティの現在の値 (存在する場合)。 プロパティがサポートされていない場合、この関数はシステム定義の Windows 背景色を返します。

### <a name="remarks"></a>Remarks

アンビエント BackColor プロパティは、すべてのコントロールで使用でき、コンテナーによって定義されます。 このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

コンテナーによってコントロールに割り当てられた名前は、ユーザーに表示されるエラーメッセージで使用できます。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>戻り値

OLE コントロールの名前。 既定値は長さ0の文字列です。

### <a name="remarks"></a>Remarks

このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientfont"></a>  COleControl::AmbientFont

アンビエントフォントプロパティの値を返します。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエントフォントディスパッチインターフェイスへのポインター。 既定値は NULL です。 戻り値が NULL でない場合は、その[IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)メンバー関数を呼び出すことによって、フォントを解放する必要があります。

### <a name="remarks"></a>Remarks

アンビエントフォントプロパティは、コンテナーによって定義され、すべてのコントロールで使用できます。このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

アンビエント ForeColor プロパティの値を返します。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント ForeColor プロパティの現在の値 (存在する場合)。 サポートされていない場合、この関数はシステム定義の Windows テキストの色を返します。

### <a name="remarks"></a>Remarks

アンビエント ForeColor プロパティは、すべてのコントロールで使用でき、コンテナーによって定義されます。 このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

コンテナーのロケール ID を返します。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>戻り値

コンテナーの LocaleID プロパティ (存在する場合) の値。 このプロパティがサポートされていない場合、この関数は0を返します。

### <a name="remarks"></a>Remarks

コントロールは、LocaleID を使用して、特定のロケールに合わせてユーザーインターフェイスを調整できます。 このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

コントロールオブジェクトの現在の外観設定を取得します。

```
short AmbientAppearance();
```

### <a name="return-value"></a>戻り値

コントロールの外観は次のとおりです。

- **0**フラットな外観

- **1** 3d の外観

### <a name="remarks"></a>Remarks

コントロールの DISPID_AMBIENT_APPEARANCE プロパティの現在の値を取得するには、この関数を呼び出します。

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

コンテナーによって使用される単位の種類を返します。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント ScaleUnits を格納している文字列。 このプロパティがサポートされていない場合、この関数は長さ0の文字列を返します。

### <a name="remarks"></a>Remarks

コンテナーの "アンビエント ScaleUnits" プロパティを使用すると、選択した単位 (twip やセンチメートルなど) でラベル付けされた位置や寸法を表示できます。 このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientshowgrabhandles"></a>COleControl:: AmbientShowGrabHandles

アクティブなときに、コンテナーがコントロールに対してグラブハンドルの表示を許可するかどうかを決定します。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>戻り値

グラブハンドルを表示する場合は0以外の。それ以外の場合は0です。 このプロパティがサポートされていない場合、この関数は0以外の値を返します。

### <a name="remarks"></a>Remarks

このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

UI がアクティブになっている場合に、コントロールがコントロールにハッチパターンで表示されるようにするかどうかを決定します。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>戻り値

ハッチパターンを表示する場合は0以外の。それ以外の場合は0です。 このプロパティがサポートされていない場合、この関数は0以外の値を返します。

### <a name="remarks"></a>Remarks

このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

コントロールコンテナーによって推奨されるアンビエントテキストの配置を決定します。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>戻り値

コンテナーのアンビエント TextAlign プロパティの状態。 このプロパティがサポートされていない場合、この関数は0を返します。

有効な戻り値の一覧を次に示します。

|戻り値|説明|
|------------------|-------------|
|0|一般的な配置 (右側の数字、左のテキスト)。|
|1|左揃え|
|2|中央揃え|
|3|右揃え|

### <a name="remarks"></a>Remarks

このプロパティは、すべての埋め込みコントロールで使用でき、コンテナーによって定義されます。 このプロパティをサポートするためにコンテナーが必要ではないことに注意してください。

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

コントロールがユーザーインターフェイスのアクションに応答するかどうかを判断します。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>戻り値

コントロールがユーザーインターフェイスの操作に応答する必要がある場合は0以外の。それ以外の場合は0です。 このプロパティがサポートされていない場合、この関数は0を返します。

### <a name="remarks"></a>Remarks

たとえば、デザインモードでコンテナーがこれを TRUE に設定する場合があります。

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

コンテナーがデザインモードとユーザーモードのどちらであるかを決定します。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>戻り値

コンテナーがユーザーモードの場合は0以外の。それ以外の場合は 0 (デザインモード)。 このプロパティがサポートされていない場合、この関数は TRUE を返します。

### <a name="remarks"></a>Remarks

たとえば、コンテナーは、デザインモードでこれを FALSE に設定できます。

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

バインドされたプロパティ値が変更されたことを通知します。

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのバインドされたプロパティのディスパッチ ID。

### <a name="remarks"></a>Remarks

これは、プロパティの値が変更されるたびに呼び出される必要があります。これは、プロパティの Set メソッドを使用して変更が行われていない場合でも同様です。 メンバー変数にマップされているバインドされたプロパティについては、特に注意してください。 メンバー変数が変更されるたびに`BoundPropertyChanged` 、を呼び出す必要があります。

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

`IPropertyNotifySink`インターフェイスからのアクセス許可を要求して、コントロールによって提供されるバインドされたプロパティ値を変更します。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのバインドされたプロパティのディスパッチ ID。

### <a name="return-value"></a>戻り値

変更が許可されている場合は0以外の。それ以外の場合は0です。 既定値は0以外です。

### <a name="remarks"></a>Remarks

アクセス許可が拒否された場合、コントロールはプロパティの値を変更できないようにする必要があります。 これを行うには、プロパティ値を変更しようとした操作を無視するか失敗させることができます。

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

*Ppoint*の座標を親座標に変換します。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではなく、境界線とスクロールバーを含むコントロール全体の領域。

*pPoint*<br/>
親 (コンテナー) の座標に変換される OLE クライアント領域ポイントへのポインター。

### <a name="remarks"></a>Remarks

入力時の*Ppoint*は、OLE コントロールのクライアント領域の原点 (コントロールのクライアント領域の左上隅) に対する相対値です。 出力の*Ppoint*は、親 (コンテナーの左上隅) の原点に対する相対値です。

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

重複する不透明なオブジェクトによって完全または部分的にカバーされている場合は、カレット四角形を調整します。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
入力時に、調整するカレット領域を含む[RECT](/windows/win32/api/windef/ns-windef-rect)構造体へのポインター。 出力時に、調整されたキャレット領域。または、カレット四角形が完全にカバーされている場合は NULL。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

キャレットは、通常、テキストやグラフィックスが挿入される場所を示す、点滅する線、ブロック、またはビットマップです。

ウィンドウなしのオブジェクトでは、カレットが部分的に、または重なり合うオブジェクトによって完全に非表示になっているかどうかを最初に確認せずに、カレットを安全に これを可能にするために、オブジェクトはを`ClipCaretRect`使用して、クリッピング領域に収まるようにカレットを調整 (縮小) できます。

カレットを作成するオブジェクトは、カレット四角形を`ClipCaretRect`に送信し、そのカレットに調整された四角形を使用します。 キャレットが完全に非表示になっている場合、このメソッドは FALSE を返します。この場合、キャレットはまったく表示されません。

##  <a name="colecontrol"></a>COleControl:: COleControl

`COleControl` オブジェクトを構築します。

```
COleControl();
```

### <a name="remarks"></a>Remarks

通常、この関数は直接呼び出されません。 代わりに、OLE コントロールは通常、クラスファクトリによって作成されます。

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

コントロールでサポートされているニーモニックのセットが変更されたときに、この関数を呼び出します。

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Remarks

この通知を受信すると、コントロールのコンテナーは[IOleControl:: Getcontrol Linfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)を呼び出して、新しいニーモニックのセットを取得します。 コンテナーは、この通知に応答する必要がないことに注意してください。

##  <a name="displayerror"></a>  COleControl::DisplayError

ストックエラーイベントが処理された後、フレームワークによって呼び出されます (イベントハンドラーがエラーの表示を抑制している場合を除く)。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>パラメーター

*scode*<br/>
報告されるステータスコードの値。 使用可能なコードの完全な一覧について[は、ActiveX コントロールに関する記事をご覧ください。高度な](../../mfc/mfc-activex-controls-advanced-topics.md)トピック。

*lpszDescription*<br/>
報告されているエラーの説明。

*lpszSource*<br/>
エラーを生成したモジュールの名前 (通常は OLE コントロールモジュールの名前)。

*lpszHelpFile*<br/>
エラーの説明を含むヘルプファイルの名前です。

*nHelpID*<br/>
報告されているエラーのヘルプコンテキスト ID。

### <a name="remarks"></a>Remarks

既定の動作では、 *lpszdescription*に含まれるエラーの説明を含むメッセージボックスが表示されます。

エラーの表示方法をカスタマイズするには、この関数をオーバーライドします。

##  <a name="doclick"></a>COleControl::D oClick

コントロールでマウスクリック操作をシミュレートします。

```
void DoClick();
```

### <a name="remarks"></a>Remarks

オーバーライド`COleControl::OnClick`可能なメンバー関数が呼び出され、ストック click イベントが発生します (コントロールでサポートされている場合)。

この関数は、doclick `COleControl`と呼ばれるストックメソッドとして基本クラスでサポートされています。 詳細については、ActiveX [コントロールに関する記事を参照してください。メソッド](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

ストリームやプロパティセットなど、永続的なストレージ表現からコントロールを読み込んだり、格納したりするときに、フレームワークによって呼び出されます。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
`CPropExchange` オブジェクトへのポインター。 フレームワークは、このオブジェクトを提供して、プロパティ交換のコンテキスト (方向を含む) を確立します。

### <a name="remarks"></a>Remarks

通常、この関数は、OLE コントロールの特定のユーザー定義プロパティを読み込んだり格納したりするために、 **PX_** ファミリの関数の呼び出しを行います。

コントロールウィザードを使用して OLE コントロールプロジェクトを作成した場合、この関数のオーバーライドされたバージョンは、に`COleControl`よってサポートされるストックプロパティを、 `COleControl::DoPropExchange`基本クラス関数の呼び出しでシリアル化します。 ユーザー定義プロパティを OLE コントロールに追加するときは、新しいプロパティをシリアル化するために、この関数を変更する必要があります。 シリアル化の詳細については、 [ActiveX コントロールに関する記事を参照してください。シリアル](../../mfc/mfc-activex-controls-serializing.md)化。

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Windows コントロールからサブクラス化された OLE コントロールを再描画します。

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
コントロールコンテナーのデバイスコンテキストへのポインター。

*rcBounds*<br/>
コントロールが描画される領域。

### <a name="remarks"></a>Remarks

この関数を呼び出して、非アクティブな OLE コントロールの描画を適切に処理します。 この関数は、OLE コントロールのサブクラスが Windows コントロールであり、コントロールの`OnDraw`関数で呼び出す必要がある場合にのみ使用してください。

この関数と Windows コントロールのサブクラス化の詳細については[、「ActiveX コントロール」を参照してください。Windows コントロール](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)のサブクラス化。

##  <a name="drawcontent"></a>  COleControl::DrawContent

コントロールの外観を更新する必要があるときに、フレームワークによって呼び出されます。

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイスコンテキストへのポインター。

*リターン*<br/>
描画される四角形の領域。

### <a name="remarks"></a>Remarks

この関数は、オーバーライド`OnDraw`可能な関数を直接呼び出します。

##  <a name="drawmetafile"></a>COleControl: rawMetafile の:D

メタファイルデバイスコンテキストが使用されているときに、フレームワークによって呼び出されます。

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
メタファイルデバイスコンテキストへのポインター。

*リターン*<br/>
描画される四角形の領域。

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

OLE コントロールの単純なフレーム特性を有効にします。

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Remarks

この特性により、コントロールは、他のコントロールの視覚的な含有をサポートできますが、真の OLE コンテインメントはサポートしません。 例として、内に複数のコントロールがあるグループボックスがあります。 これらのコントロールは OLE に含まれていませんが、同じグループボックス内にあります。

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

コントロールの範囲 (HIMETRIC 単位の次元) の状態をシリアル化または初期化します。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクトへのポインター。 フレームワークは、このオブジェクトを提供して、プロパティ交換のコンテキスト (方向を含む) を確立します。

### <a name="return-value"></a>戻り値

関数が成功した場合は0以外の場合は。それ以外の場合は0。

### <a name="remarks"></a>Remarks

通常、この関数は、の既定の`COleControl::DoPropExchange`実装によって呼び出されます。

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

コントロールのストックプロパティの状態をシリアル化または初期化します。

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
[CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクトへのポインター。 フレームワークは、このオブジェクトを提供して、プロパティ交換のコンテキスト (方向を含む) を確立します。

### <a name="remarks"></a>Remarks

通常、この関数は、の既定の`COleControl::DoPropExchange`実装によって呼び出されます。

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

コントロールのバージョン情報の状態をシリアル化または初期化します。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>パラメーター

*pPX*<br/>
`CPropExchange` オブジェクトへのポインター。 フレームワークは、このオブジェクトを提供して、プロパティ交換のコンテキスト (方向を含む) を確立します。

*dwVersionDefault*<br/>
コントロールの現在のバージョン番号。

*bConvert*<br/>
保存時に永続データを最新の形式に変換するか、読み込まれたのと同じ形式で保持するかを示します。

### <a name="return-value"></a>戻り値

関数が0以外で成功しました。それ以外の場合は0。

### <a name="remarks"></a>Remarks

通常、これは、コントロールのの`COleControl::DoPropExchange`オーバーライドによって呼び出される最初の関数になります。 読み込み時に、この関数は永続データのバージョン番号を読み取り、それに応じて[CPropExchange](../../mfc/reference/cpropexchange-class.md)オブジェクトの version 属性を設定します。 保存時に、この関数は永続データのバージョン番号を書き込みます。

永続性とバージョン管理の詳細については[、ActiveX コントロールに関する記事を参照してください。シリアル](../../mfc/mfc-activex-controls-serializing.md)化。

##  <a name="fireclick"></a>  COleControl::FireClick

アクティブなコントロール上でマウスをクリックすると、フレームワークによって呼び出されます。

```
void FireClick();
```

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

Click イベントを自動的に発生させるには、コントロールのイベントマップに stock Click イベントが定義されている必要があります。

##  <a name="firedblclick"></a>  COleControl::FireDblClick

アクティブなコントロールでマウスがダブルクリックされたときに、フレームワークによって呼び出されます。

```
void FireDblClick();
```

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

DblClick イベントが自動的に発生するようにするには、コントロールのイベントマップに stock DblClick イベントが定義されている必要があります。

##  <a name="fireerror"></a>  COleControl::FireError

ストックエラーイベントを発生させます。

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>パラメーター

*scode*<br/>
報告されるステータスコードの値。 使用可能なコードの完全な一覧について[は、ActiveX コントロールに関する記事をご覧ください。高度な](../../mfc/mfc-activex-controls-advanced-topics.md)トピック。

*lpszDescription*<br/>
報告されているエラーの説明。

*nHelpID*<br/>
報告されているエラーのヘルプ ID です。

### <a name="remarks"></a>Remarks

このイベントは、コントロール内でエラーが発生したことをコード内の適切な場所で通知する方法を提供します。 Click や MouseMove などの他のストックイベントとは異なり、フレームワークではエラーは発生しません。

プロパティの get 関数、プロパティセット関数、またはオートメーションメソッドの実行中に発生したエラーを報告するには、 [COleControl:: ThrowError](#throwerror)を呼び出します。

OLE コントロールの Stock Error イベントの実装では、SCODE 値が使用されます。 コントロールでこのイベントが使用され、Visual Basic 4.0 で使用される場合、Visual Basic では SCODE 値がサポートされていないため、エラーが発生します。

この問題を解決するには、コントロールのの SCODE パラメーターを手動で変更します。ODL ファイルを**長い形式**にします。 さらに、SCODE パラメーターを使用するすべてのカスタムイベント、メソッド、またはプロパティでも同じ問題が発生します。

##  <a name="fireevent"></a>  COleControl::FireEvent

任意の数の省略可能な引数を使用して、コントロールからユーザー定義イベントを発生させます。

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
発生させるイベントのディスパッチ ID。

*pbParams*<br/>
イベントのパラメーター型の記述子。

### <a name="remarks"></a>Remarks

通常、この関数を直接呼び出すことはできません。 代わりに、コントロールのクラス宣言のイベントマップセクションでイベント発生関数を呼び出します。

*Pbparams*引数は、スペースで区切られた**VTS_** のリストです。 スペース (コンマではない) で区切られるこれらの値の 1 つ以上は、関数のパラメーター リストを指定します。 次の値を指定できます。

|シンボル|パラメーターの型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Variant データ定数へのポインターを提供する VTS_FONT および VTS_PICTURE を除き、すべての variant 型に対して追加のバリアント定数が定義されています。 これらの定数には、 **VTS_P** `constantname`規約を使用して名前が付けられます。 たとえば、VTS_PCOLOR は VTS_COLOR 定数へのポインターです。

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

コントロールが UI アクティブのときにキーが押されたときにフレームワークによって呼び出されます。

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>パラメーター

*pnChar*<br/>
押されたキーの仮想キーコード値へのポインター。 標準の仮想キーコードの一覧については、「Winuser. h」を参照してください。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

KeyDown イベントが自動的に発生するようにするには、コントロールのイベントマップに stock KeyDown イベントが定義されている必要があります。

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

カスタムコントロールがコンテナー内でアクティブになっている間に、キーが押されて離されたときにフレームワークによって呼び出されます。

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>パラメーター

*pnChar*<br/>
押されたキーの文字値へのポインター。

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

イベントの受信者は、たとえば、すべての小文字を大文字に変換するなど、 *Pnchar*を変更することができます。 変更された文字を確認する場合は`OnKeyPressEvent`、をオーバーライドします。

KeyPress イベントが自動的に発生するようにするには、コントロールのイベントマップに stock KeyPress イベントが定義されている必要があります。

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

カスタムコントロールがコンテナー内でアクティブになっているときに、キーが離されたときにフレームワークによって呼び出されます。

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>パラメーター

*pnChar*<br/>
解放されたキーの仮想キーコード値へのポインター。 標準の仮想キーコードの一覧については、「Winuser. h」を参照してください。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

KeyUp イベントが自動的に発生するようにするには、コントロールのイベントマップに stock KeyUp イベントが定義されている必要があります。

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

アクティブなカスタムコントロールでマウスボタンが押されたときにフレームワークによって呼び出されます。

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*nButton*<br/>
押されたマウスボタンの数値。 次のいずれかの値を含めることができます。

- LEFT_BUTTON マウスの左ボタンが押されました。

- MIDDLE_BUTTON マウスの中央ボタンが押されました。

- RIGHT_BUTTON マウスの右ボタンが押されました。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

*x*<br/>
マウスボタンが押されたときのカーソルの x 座標。 座標は、コントロールウィンドウの左上隅を基準としています。

*y*<br/>
マウスボタンが押されたときのカーソルの y 座標。 座標は、コントロールウィンドウの左上隅を基準としています。

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

MouseDown イベントが自動的に発生するようにするには、コントロールのイベントマップに stock MouseDown イベントが定義されている必要があります。

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

カーソルがアクティブなカスタムコントロール上を移動すると、フレームワークによって呼び出されます。

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*nButton*<br/>
押されたマウスボタンの数値。 次の値の組み合わせが含まれています。

- LEFT_BUTTON の操作中に、マウスの左ボタンが押された状態になりました。

- MIDDLE_BUTTON の操作中に、マウスの中央ボタンが押された状態になりました。

- RIGHT_BUTTON 操作中にマウスの右ボタンが押された状態になります。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

*x*<br/>
カーソルの x 座標。 座標は、コントロールウィンドウの左上隅を基準としています。

*y*<br/>
カーソルの y 座標。 座標は、コントロールウィンドウの左上隅を基準としています。

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

MouseMove イベントが自動的に発生するようにするには、コントロールのイベントマップに stock MouseMove イベントが定義されている必要があります。

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

アクティブなカスタムコントロールでマウスボタンが離されたときにフレームワークによって呼び出されます。

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>パラメーター

*nButton*<br/>
マウスボタンを離したときの数値。 次のいずれかの値を指定できます。

- LEFT_BUTTON マウスの左ボタンが離されました。

- MIDDLE_BUTTON は、マウスの中央ボタンが離されました。

- RIGHT_BUTTON マウスの右ボタンが離されました。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

*x*<br/>
マウスボタンが離されたときのカーソルの x 座標。 座標は、コントロールウィンドウの左上隅を基準としています。

*y*<br/>
マウスボタンが離されたときのカーソルの y 座標。 座標は、コントロールウィンドウの左上隅を基準としています。

### <a name="remarks"></a>Remarks

このイベントがカスタムイベントとして定義されている場合は、イベントがいつ発生するかを決定します。

MouseUp イベントが自動的に発生するようにするには、コントロールのイベントマップに stock MouseUp イベントが定義されている必要があります。

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

コントロールの準備完了状態の現在の値を使用して、イベントを発生させます。

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Remarks

準備完了状態には、次のいずれかの値を指定できます。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールは現在プロパティを読み込んでいます|
|READYSTATE_LOADED|コントロールが初期化されました|
|READYSTATE_INTERACTIVE|コントロールには対話型にするための十分なデータがありますが、一部の非同期データがまだ読み込まれていません|
|READYSTATE_COMPLETE|コントロールにすべてのデータが含まれています|

[GetReadyState](#getreadystate)を使用して、コントロールの現在の準備状況を確認します。

[InternalSetReadyState](#internalsetreadystate)は、準備完了状態を指定された値`FireReadyStateChange`に変更し、を呼び出します。

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

`IPointerInactive`インターフェイスをサポートするコントロールの既定のアクティベーション動作を変更します。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>戻り値

ポインターのアクティブでない列挙体からのフラグの組み合わせ。 使用できるフラグは次のとおりです。

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|マウスの移動操作中にマウスが入ったときに、オブジェクトをアクティブにする必要があります。|
|POINTERINACTIVE_DEACTIVATEONLEAVE|マウスの移動操作中にマウスがオブジェクトから離れると、オブジェクトは非アクティブになります。|
|POINTERINACTIVE_ACTIVATEONDRAG|ドラッグアンドドロップ操作中にマウスをドラッグすると、オブジェクトがアクティブになります。|

### <a name="remarks"></a>Remarks

`IPointerInactive`インターフェイスが有効になっている場合、コンテナーは WM_SETCURSOR メッセージと WM_MOUSEMOVE メッセージをそれに委任します。 `COleControl`では、このインターフェイスを実装することで、マウスの座標を適切に調整した後に、これらのメッセージをコントロールのメッセージマップからディスパッチします。

をサポート`IPointerInactive`している非アクティブなオブジェクトの上にマウスポインターを持つ WM_SETCURSOR または WM_MOUSEMOVE メッセージを`GetActivationPolicy`コンテナーが受信するたびに、インターフェイスでを呼び出して、ポインターのアクティブでない列挙体からフラグを返す必要があります。

これらのメッセージは、メッセージマップに対応するエントリを追加することで、通常のウィンドウメッセージと同様に処理できます。 ハンドラーでは、最初にその`m_hWnd`値が NULL でないことを確認せずに、メンバー変数 (またはそれを使用するメンバー関数) を使用しないようにします。

マウスカーソルを設定したり、マウス移動イベント (特別な視覚フィードバックの提供など) を実行することを目的としたオブジェクトでは、POINTERINACTIVE_ACTIVATEONENTRY フラグを返し、アクティブな場合にのみフィードバックを描画する必要があります。 このフラグがオブジェクトから返された場合、コンテナーはすぐにそれをアクティブにして、へ`GetActivationPolicy`の呼び出しをトリガーしたメッセージと同じメッセージを転送します。

POINTERINACTIVE_ACTIVATEONENTRY と POINTERINACTIVE_DEACTIVATEONLEAVE の両方のフラグが返された場合、オブジェクトは、マウスがオブジェクトの上にあるときにのみアクティブになります。 POINTERINACTIVE_ACTIVATEONENTRY フラグだけが返された場合、オブジェクトは、マウスが最初にオブジェクトに入ったときにのみアクティブになります。

また、非アクティブなコントロールが OLE ドラッグアンドドロップ操作の対象になるようにすることもできます。 これには、ユーザーがオブジェクトをドラッグした時点でコントロールをアクティブにする必要があります。これにより、コントロールのウィンドウをドロップ先として登録できるようになります。 ドラッグ中にアクティベーションが発生するようにするには、POINTERINACTIVE_ACTIVATEONDRAG フラグを返します。

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

によっ`GetActivationPolicy`て伝達される情報は、コンテナーによってキャッシュされないようにする必要があります。 代わりに、このメソッドは、マウスが非アクティブなオブジェクトに入るたびに呼び出される必要があります。

アクティブでないオブジェクトが、マウスを入力したときに埋め込み先のアクティブ化を要求しない場合、そのオブジェクトのコンテナーは、マウスポインターがオブジェクトの上にある限り[OnInactiveSetCursor](#oninactivesetcursor)を呼び出すことによって、このオブジェクトに後続の WM_SETCURSOR メッセージをディスパッチする必要があります。

`IPointerInactive`インターフェイスを有効にすることは、通常、コントロールが常にマウスメッセージを処理できるようにすることを意味します。 `IPointerInactive`インターフェイスをサポートしていないコンテナーでこの動作を実現するには、コントロールを常に表示されている状態でアクティブにする必要があります。つまり、コントロールには、その他のフラグの間に OLEMISC_ACTIVATEWHENVISIBLE フラグを設定する必要があります。 ただし、でサポート`IPointerInactive`されているコンテナーでこのフラグが有効にならないようにするには、OLEMISC_IGNOREACTIVATEWHENVISIBLE フラグを指定することもできます。

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

コンテナーのアンビエントプロパティの値を取得します。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>パラメーター

*dwDispid*<br/>
必要なアンビエントプロパティのディスパッチ ID。

*vtProp*<br/>
*Pvprop*で返される値の型を指定する variant 型のタグ。

*pvProp*<br/>
プロパティ値または戻り値を受け取る変数のアドレスへのポインター。 このポインターの実際の型は、 *vtProp*によって指定された型と一致している必要があります。

|vtProp|PvProp の種類|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>戻り値

アンビエントプロパティがサポートされている場合は0以外の値です。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

を使用`GetAmbientProperty`してアンビエント DisplayName と scaleunits プロパティを取得する場合は、 *vtProp*を VT_BSTR に、 `CString*` *pvprop*をに設定します。 アンビエントフォントプロパティを取得する場合は、 *vtProp*を VT_FONT に、 *PVPROP*を lpfontdisp * に設定します。

[AmbientBackColor](#ambientbackcolor)や[AmbientFont](#ambientfont)などの一般的なアンビエントプロパティには、関数が既に用意されています。

##  <a name="getappearance"></a>  COleControl::GetAppearance

コントロールの stock 外観プロパティの Get 関数を実装します。

```
short GetAppearance ();
```

### <a name="return-value"></a>戻り値

成功した場合、戻り値は、現在の外観設定を**short** (VT_I2) 値として指定します。 この値は、コントロールの外観がフラットである場合は0、コントロールの外観が3D の場合は1になります。

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

コントロールの stock BackColor プロパティの Get 関数を実装します。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>戻り値

成功した場合、戻り値は、現在の背景色を OLE_COLOR 値として指定します。 この値は、を`TranslateColor`呼び出すことで、COLORREF 値に変換できます。

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

コントロールの stock BorderStyle プロパティの Get 関数を実装します。

```
short GetBorderStyle();
```

### <a name="return-value"></a>戻り値

コントロールに通常の境界線がある場合は1。コントロールに境界線がない場合は0。

##  <a name="getcapture"></a>  COleControl::GetCapture

オブジェクトに`COleControl`マウスキャプチャがあるかどうかを判断します。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>戻り値

コントロールがアクティブ化され、ウィンドウなしの場合、コントロールが現在マウスキャプチャを持っている (コントロールのコンテナーによって決定される) 場合は、**this**が返されます。キャプチャされていない場合は NULL を返します。

それ以外の場合`CWnd`は、マウスキャプチャを持つオブジェクトを返し`CWnd::GetCapture`ます (と同じ)。

### <a name="remarks"></a>Remarks

アクティブ化されたウィンドウなしコントロールは、 [SetCapture](#setcapture)が呼び出されたときにマウスキャプチャを受け取ります。

##  <a name="getclassid"></a>  COleControl::GetClassID

コントロールの OLE クラス ID を取得するために、フレームワークによって呼び出されます。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>パラメーター

*pclsid*<br/>
クラス ID の場所へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功しなかった場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

通常、 [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)によって実装されます。

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

コントロールの四角形領域の左上隅とクライアント領域の左上隅との差を取得します。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>パラメーター

*pdxOffset*<br/>
OLE コントロールのクライアント領域の横方向のオフセットへのポインター。

*pdyOffset*<br/>
OLE コントロールのクライアント領域の垂直オフセットへのポインター。

### <a name="remarks"></a>Remarks

OLE コントロールのコンテナー内に四角形の領域があります。 コントロールのクライアント領域は、境界線とスクロールバーを除いたコントロール領域です。 によって`GetClientOffset`取得されるオフセットは、コントロールの四角形領域の左上隅とクライアント領域の左上隅の差です。 コントロールに標準の境界線とスクロールバー以外の非クライアント要素がある場合は、このメンバー関数をオーバーライドしてオフセットを指定します。

##  <a name="getclientrect"></a>  COleControl::GetClientRect

コントロールのクライアント領域のサイズを取得します。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
ウィンドウなしの`RECT`コントロールのクライアント領域の大きさを格納している構造体へのポインター。つまり、コントロールのサイズからウィンドウの境界線、フレーム、スクロールバーなどを引いたもの。 *LpRect*パラメーターは、コントロールのクライアント領域の位置ではなく、そのサイズを示します。

##  <a name="getclientsite"></a>  COleControl::GetClientSite

コンテナー内の現在のクライアントサイトへのポインターをオブジェクトに照会します。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>戻り値

コンテナー内のコントロールの現在のクライアントサイトへのポインター。

### <a name="remarks"></a>Remarks

返されたポインターは、の`IOleClientSite`インスタンスを指します。 コンテナーによって実装されるインターフェイスは、オブジェクトのコンテキストのビューです。ここでは、ドキュメント内にアンカーが固定されており、そこでストレージ、ユーザーインターフェイス、その他のリソースを取得します。`IOleClientSite`

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

コントロールフラグの設定を取得します。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>戻り値

ControlFlags 列挙体のフラグの論理和。

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Remarks

既定では`GetControlFlags` 、 `fastBeginPaint | clipPaintDC`はを返します。

|||
|-|-|
|`fastBeginPaint`|設定すると、では、 [beginpaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API (既定では設定) ではなく、OLE コントロール用に調整された開始描画関数を使用します。|
|`clipPaintDC`|設定されていない場合は`IntersectClipRect` 、に`COleControl`よる呼び出しが無効になり、速度が若干向上します。 ウィンドウなしのアクティベーションを使用している場合、フラグは無効です。|
|`pointerInactive`|設定した場合、では、 `COleControl` `IPointerInactive`インターフェイスの実装を有効にすることによってコントロールが非アクティブになっている間、マウス操作が提供されます。これは既定で無効になっています|
|`noFlickerActivate`|設定すると、余分な描画操作や、それに伴う視覚のちらつきを排除します。 コントロールが非アクティブ状態とアクティブな状態で同じように描画する場合は、を使用します。 ウィンドウなしのアクティベーションを使用している場合、フラグは無効です。|
|`windowlessActivate`|設定すると、コントロールがウィンドウなしのアクティベーションを使用することを示します。|
|`canOptimizeDraw`|設定した場合、コントロールが最適化された描画を実行することを示します (コンテナーがサポートしている場合)。|

`GetControlFlags`および OLE コントロールのその他の最適化の詳細につい[ては、「ActiveX コントロール:最適化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

OLE コントロールウィンドウのサイズを取得します。

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>パラメーター

*pcx*<br/>
コントロールの幅をピクセル単位で指定します。

*pcy*<br/>
コントロールの高さをピクセル単位で指定します。

### <a name="remarks"></a>Remarks

コントロールウィンドウのすべての座標は、コントロールの左上隅を基準としています。

##  <a name="getdc"></a>  COleControl::GetDC

ウィンドウなしのオブジェクトを使用して、コンテナーから画面 (または互換性のある) デバイスコンテキストを取得します。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>パラメーター

*lprcRect*<br/>
コントロールのクライアント座標で、ウィンドウなしのコントロールが再描画を必要とする四角形へのポインター。 NULL は、完全なオブジェクトの範囲を意味します。

*dwFlags*<br/>
デバイスコンテキストの属性を描画します。 選択肢は次のとおりです。

- OLEDC_NODRAW は、オブジェクトが描画を実行するためにデバイスコンテキストを使用せず、ディスプレイデバイスに関する情報を取得するだけであることを示します。 コンテナーは、それ以上の処理を行わずにウィンドウの DC を渡すだけです。

- OLEDC_PAINTBKGND は、DC を返す前に、コンテナーが背景を描画するように要求します。 オブジェクトは、透明な背景で領域を再描画するために DC を要求している場合に、このフラグを使用する必要があります。

- OLEDC_OFFSCREEN は、オブジェクトが画面に表示する必要があることを示すために、そのオブジェクトを画面にコピーする必要があることをコンテナーに通知します。 オブジェクトは、実行しようとしている描画操作がちらつきを大量に生成する場合に、このフラグを使用する必要があります。 コンテナーは、この要求に対して自由に受け入れることができます。 ただし、このフラグが設定されていない場合、コンテナーは画面上の DC をハンドバックする必要があります。 これにより、オブジェクトは ( **XOR**演算によって) 選択を表示するなどの直接画面操作を実行できます。

### <a name="return-value"></a>戻り値

成功した場合は、コンテナー `CWnd`クライアント領域の表示デバイスコンテキストへのポインター。それ以外の場合、戻り値は NULL です。 表示デバイスコンテキストは、その後の GDI 関数でコンテナーのウィンドウのクライアント領域に描画するために使用できます。

### <a name="remarks"></a>Remarks

描画後にコンテキストを解放するには、 [ReleaseDC](#releasedc)メンバー関数を呼び出す必要があります。 を呼び`GetDC`出すと、オブジェクトは、描画する四角形を独自のクライアント座標に渡します。 `GetDC`これらをコンテナークライアント領域の座標に変換します。 オブジェクトは、独自のクライアント領域の四角形よりも大きい描画の四角形を要求しないようにする必要があります。このサイズは、 [Getclientrect](#getclientrect)で取得できます。 これにより、意図しない場所にオブジェクトが誤って描画されるのを防ぐことができます。

##  <a name="getenabled"></a>  COleControl::GetEnabled

コントロールの stock Enabled プロパティの Get 関数を実装します。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>戻り値

コントロールが有効な場合は0以外の。それ以外の場合は0です。

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

拡張されたプロパティのセットを持つコントロールを表すコンテナーによって管理されているオブジェクトへのポインターを取得します。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>戻り値

コンテナーの拡張コントロールオブジェクトへのポインター。 使用可能なオブジェクトがない場合、値は NULL になります。

このオブジェクトは、 `IDispatch`インターフェイスを使用して操作できます。 また、を使用`QueryInterface`して、オブジェクトによって提供される他の使用可能なインターフェイスを取得することもできます。 ただし、オブジェクトは、特定のインターフェイスのセットをサポートするためには必要ありません。 コンテナーの拡張コントロールオブジェクトの特定の機能に依存していると、他の任意のコンテナーへのコントロールの移植性が制限されることに注意してください。

### <a name="remarks"></a>Remarks

この関数を呼び出す関数は、オブジェクトの終了時にポインターを解放します。 コンテナーは、このオブジェクトをサポートする必要がないことに注意してください。

##  <a name="getfocus"></a>  COleControl::GetFocus

`COleControl`オブジェクトにフォーカスがあるかどうかを判断します。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>戻り値

コントロールがアクティブ化され、ウィンドウなしの場合、コントロールに現在キーボードフォーカスがある場合 (コントロールのコンテナーによって決定されます)、またはフォーカスがない場合は NULL**を返します**。

それ以外の場合`CWnd`は、フォーカスを持つオブジェクト (と`CWnd::GetFocus`同じ) を返します。

### <a name="remarks"></a>Remarks

アクティブ化されたウィンドウなしコントロールは、 [SetFocus](#setfocus)が呼び出されたときにフォーカスを受け取ります。

##  <a name="getfont"></a>  COleControl::GetFont

ストックフォントプロパティの Get 関数を実装します。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>戻り値

コントロールのストックフォントプロパティのフォントディスパッチインターフェイスへのポインター。

### <a name="remarks"></a>Remarks

終了時には、呼び出し元がオブジェクトを解放する必要があることに注意してください。 コントロールの実装内で、を使用`InternalGetFont`して、コントロールのストックフォントオブジェクトにアクセスします。 コントロールでのフォントの使用の詳細については、 [ActiveX コントロールに関する記事を参照してください。ActiveX コントロール](../../mfc/mfc-activex-controls-using-fonts.md)でのフォントの使用。

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

コントロールが所有するすべて`CFontHolder`のオブジェクトのテキストメトリックを測定します。

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>パラメーター

*lptm*<br/>
[Textmetric](/windows/win32/api/wingdi/ns-wingdi-textmetricw)構造体へのポインター。

*fontHolder*<br/>
[CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクトへの参照です。

### <a name="remarks"></a>Remarks

このようなフォントは、 [COleControl:: select、tobject](#selectfontobject)関数を使用して選択できます。 `GetFontTextMetrics`成功した`TEXTMETRIC`場合は、 *lptm*が指す構造体を、 `fontHolder`のフォントについての有効なメトリック情報と共に初期化します。成功しなかった場合は、構造体にゼロを入力します。 コントロールを描画するときは、 [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)の代わりにこの関数を使用する必要があります。これは、埋め込み OLE オブジェクトと同様に、コントロール自体をメタファイルにレンダリングする必要があるためです。

既定のフォントの構造は、[SelectFontObject](#selectfontobject) 関数が呼び出されたときに更新され`TEXTMETRIC`ます。 によって`GetFontTextMetrics`提供される情報が有効であることを保証するために、ストックフォントプロパティを選択した後にのみを呼び出してください。

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Stock ForeColor プロパティの Get 関数を実装します。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>戻り値

成功した場合、戻り値は、現在の前景色を OLE_COLOR 値として指定します。 この値は、を`TranslateColor`呼び出すことで、 [COLORREF](/windows/win32/gdi/colorref)値に変換できます。

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Stock hWnd プロパティの Get 関数を実装します。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>戻り値

OLE コントロールのウィンドウハンドル (存在する場合)。それ以外の場合は NULL。

##  <a name="getmessagestring"></a>COleControl:: GetMessageString

*NID*によって識別されるメニュー項目の目的を説明する短い文字列を取得するために、フレームワークによって呼び出されます。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>パラメーター

*nID*<br/>
メニュー項目の ID。

*rMessage*<br/>
文字列を返すために使用される[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="remarks"></a>Remarks

メニュー項目が強調表示されているときに、ステータスバーに表示するメッセージを取得するために使用できます。 既定の実装では、 *nID*によって識別される文字列リソースの読み込みが試行されます。

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

ユーザーがコントロールのプロパティ値にアクセスできないようにします。

```
void GetNotSupported();
```

### <a name="remarks"></a>Remarks

コントロールのユーザーによるプロパティの取得がサポートされていないプロパティの Get 関数の代わりに、この関数を呼び出します。 1つの例として、書き込み専用のプロパティがあります。

##  <a name="getreadystate"></a>  COleControl::GetReadyState

コントロールの準備状態を返します。

```
long GetReadyState();
```

### <a name="return-value"></a>戻り値

コントロールの準備状態。次の値のいずれかになります。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールは現在プロパティを読み込んでいます|
|READYSTATE_LOADED|コントロールが初期化されました|
|READYSTATE_INTERACTIVE|コントロールには対話型にするための十分なデータがありますが、一部の非同期データがまだ読み込まれていません|
|READYSTATE_COMPLETE|コントロールにすべてのデータが含まれています|

### <a name="remarks"></a>Remarks

ほとんどの単純なコントロールは、読み込まれたと対話型を区別する必要がありません。 ただし、データパスプロパティをサポートするコントロールは、少なくとも一部のデータが非同期に受信されるまで、対話型の準備ができていない可能性があります。 コントロールは、できるだけ早く対話型になるようにする必要があります。

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

デバイス単位で表される、コンテナーを基準とした、コントロールの四角形の座標を取得します。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
コントロールの座標がコピーされる四角形の構造体へのポインター。

### <a name="return-value"></a>戻り値

コントロールがアクティブな場合は0以外の場合は。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

四角形は、コントロールがアクティブなときにのみ有効です。

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

コントロールのストックフォントプロパティのテキストメトリックを測定します。このプロパティは、 [Selectstockfont](#selectstockfont)関数で選択できます。

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>パラメーター

*lptm*<br/>
[Textmetric](/windows/win32/api/wingdi/ns-wingdi-textmetricw)構造体へのポインター。

### <a name="remarks"></a>Remarks

関数`GetStockTextMetrics`は、 *lptm*が`TEXTMETRIC`指す構造体を、成功した場合は有効なメトリック情報と共に初期化します。成功しなかった場合は、構造体にゼロを入力します。 埋め込み OLE オブジェクトと同様にコントロールをメタファイルにレンダリングする必要があるため、コントロールを描画するときは、 [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)の代わりにこの関数を使用します。

既定のフォントの`SelectStockFont` 構造は、関数が呼び出されたときに更新されます。`TEXTMETRIC` この関数は、提供された情報が有効であることを保証するために、ストックフォントを選択した後にのみ呼び出す必要があります。

##  <a name="gettext"></a>  COleControl::GetText

Stock Text または Caption プロパティの Get 関数を実装します。

```
BSTR GetText();
```

### <a name="return-value"></a>戻り値

コントロールのテキスト文字列の現在の値、または文字列が存在しない場合は長さ0の文字列。

> [!NOTE]
>  BSTR データ型の詳細については、「マクロとグローバル」セクションの「[データ型](../../mfc/reference/data-types-mfc.md)」を参照してください。

### <a name="remarks"></a>Remarks

リソースを解放するために、この関数`SysFreeString`の呼び出し元は返された文字列に対してを呼び出す必要があることに注意してください。 コントロールの実装内で、を使用`InternalGetText`して、コントロールの "ストック Text" プロパティまたは "Caption" プロパティにアクセスします。

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

ウィンドウ`GetWindowlessDropTarget`なしのコントロールを OLE ドラッグアンドドロップ操作の対象にする場合にオーバーライドします。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>戻り値

オブジェクトの`IDropTarget`インターフェイスへのポインター。 ウィンドウがないため、ウィンドウなしのオブジェクトは`IDropTarget`インターフェイスを登録できません。 ただし、ドラッグアンドドロップに参加するために、ウィンドウなしのオブジェクトは引き続きインターフェイスを実装し`GetWindowlessDropTarget`、それをに返すことができます。

### <a name="remarks"></a>Remarks

通常、これを行うには、コントロールのウィンドウがドロップ先として登録されている必要があります。 ただし、コントロールには独自のウィンドウがないため、コンテナーは独自のウィンドウをドロップ先として使用します。 コントロールは、適切なタイミングでコンテナーが呼び出し`IDropTarget`を委任できるインターフェイスの実装を提供するだけです。 例:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

コントロールが使用する Iid がの基底クラスに通知します。

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>パラメーター

*piidPrimary*<br/>
コントロールのプライマリディスパッチインターフェイスのインターフェイス ID へのポインター。

*piidEvents*<br/>
コントロールのイベントインターフェイスのインターフェイス ID へのポインター。

### <a name="remarks"></a>Remarks

コントロールのコンストラクターでこの関数を呼び出して、コントロールが使用するインターフェイス Id の基底クラスを通知します。

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

コントロールのストックフォントプロパティにアクセスします

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>戻り値

ストックフォントオブジェクトを格納する[CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクトへの参照。

##  <a name="internalgettext"></a>  COleControl::InternalGetText

コントロールのストックテキストまたはキャプションプロパティにアクセスします。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>戻り値

コントロールのテキスト文字列への参照。

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

コントロールの準備状態を設定します。

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>パラメーター

*lNewReadyState*<br/>
コントロールに設定する準備状態。次のいずれかの値を指定します。

|||
|-|-|
|READYSTATE_UNINITIALIZED|既定の初期化状態|
|READYSTATE_LOADING|コントロールは現在プロパティを読み込んでいます|
|READYSTATE_LOADED|コントロールが初期化されました|
|READYSTATE_INTERACTIVE|コントロールには対話型にするための十分なデータがありますが、一部の非同期データがまだ読み込まれていません|
|READYSTATE_COMPLETE|コントロールにすべてのデータが含まれています|

### <a name="remarks"></a>Remarks

ほとんどの単純なコントロールは、読み込まれたと対話型を区別する必要がありません。 ただし、データパスプロパティをサポートするコントロールは、少なくとも一部のデータが非同期に受信されるまで、対話型の準備ができていない可能性があります。 コントロールは、できるだけ早く対話型になるようにする必要があります。

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

コントロールを強制的に再描画します。

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
無効にするコントロールの領域へのポインター。

*bErase*<br/>
更新領域が処理されるときに、更新領域内の背景を消去するかどうかを指定します。

### <a name="remarks"></a>Remarks

*LpRect*に NULL 値が含まれている場合、コントロール全体が再描画されます。 *LpRect*が NULL でない場合は、無効にするコントロールの四角形の部分を示します。 コントロールにウィンドウがない場合、または現在アクティブでない場合、四角形は無視され、クライアントサイトの[IAdviseSink:: OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)メンバー関数に対する呼び出しが行われます。 またはの代わりに`CWnd::InvalidateRect` 、 `InvalidateRect`この関数を使用します。

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

指定された領域内のコンテナーウィンドウのクライアント領域を無効にします。

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>パラメーター

*pRgn*<br/>
格納しているウィンドウのクライアント座標で、無効化する OLE オブジェクトの表示領域を識別する[CRgn](../../mfc/reference/crgn-class.md)オブジェクトへのポインター。 このパラメーターが NULL の場合、エクステントはオブジェクト全体です。

*bErase*<br/>
無効化された領域内の背景を消去するかどうかを指定します。 TRUE の場合、背景は消去されます。 FALSE の場合、背景は変更されません。

### <a name="remarks"></a>Remarks

これは、コンテナー内のウィンドウなしのコントロールを再描画するために使用できます。 無効化された領域は、更新領域内の他のすべての領域と共に、次の[WM_PAINT](/windows/win32/gdi/wm-paint)メッセージが送信されるときに描画用にマークされます。

更新領域の任意の部分に対して*bErase*が TRUE の場合、特定の部分だけでなく、領域全体の背景も消去されます。

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

OLE コントロールの特殊な読み込みを可能にします。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>戻り値

コントロールが変換されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

VBX コントロールを使用するフォームを OLE コントロールを使用する形式に変換する場合は、OLE コントロールの特殊な読み込みコードが必要になることがあります。 たとえば、OLE コントロールのインスタンスを読み込む場合、で`DoPropExchange` [PX_Font](persistence-of-ole-controls.md#px_font)を呼び出すことができます。

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

ただし、VBX コントロールには、Font オブジェクトがありません。各フォントプロパティは個別に保存されました。 この場合、を使用`IsConvertingVBX`して、次の2つのケースを区別します。

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

もう1つのケースは、VBX コントロールが専用のバイナリデータ (VBM_SAVEPROPERTY メッセージハンドラー) を保存し、OLE コントロールがそのバイナリデータを別の形式で保存する場合です。 OLE コントロールを vbx コントロールと下位互換性があるようにするには、vbx コントロールまたは ole コントロールが読み込まれて`IsConvertingVBX`いるかどうかを区別して、関数を使用して新旧両方の形式を読み取ることができます。

コントロールの`DoPropExchange`関数で、この条件をチェックし、true の場合は、この変換に固有の読み込みコードを実行します (前の例をご覧ください)。 コントロールが変換されていない場合は、通常の読み込みコードを実行できます。 この機能は、対応する VBX から変換されるコントロールにのみ適用されます。

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

オートメーションメソッドの呼び出しを有効にします。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>戻り値

コントロールが初期化されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

によって`IDispatch::Invoke` `IsInvokeAllowed` 識別される特定の関数を呼び出すことができるかどうかを判断するための呼び出しの`dispid`フレームワークの実装。 OLE コントロールの既定の動作では、コントロールが初期化されている場合にのみ、オートメーションメソッドを呼び出すことができます。ただし、 `IsInvokeAllowed`は仮想関数であり、必要に応じてオーバーライドできます (たとえば、コントロールがオートメーションサーバーとして使用されている場合など)。

##  <a name="ismodified"></a>  COleControl::IsModified

コントロールの状態が変更されたかどうかを判断します。

```
BOOL IsModified();
```

### <a name="return-value"></a>戻り値

コントロールの状態が最後に保存されてから変更されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

プロパティが値を変更すると、コントロールの状態が変更されます。

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

コンテナーが現在の描画操作に対して最適化された描画をサポートするかどうかを判断します。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>戻り値

コンテナーが現在の描画操作用に最適化された描画をサポートする場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

最適化された描画がサポートされている場合は、描画が終了したときにコントロールが古いオブジェクト (ペン、ブラシ、フォントなど) をデバイスコンテキストに選択する必要がありません。

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

コントロールのサブクラスが Windows コントロールかどうかを判断するために、フレームワークによって呼び出されます。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>戻り値

コントロールがサブクラス化されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

OLE コントロールのサブクラスが Windows コントロールである場合は、この関数をオーバーライドして TRUE を返す必要があります。

##  <a name="load"></a>  COleControl::Load

非同期的に読み込まれた以前のデータをリセットし、コントロールの非同期プロパティの新しい読み込みを開始します。

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>パラメーター

*strNewPath*<br/>
非同期コントロールプロパティの絶対位置を参照するパスを格納している文字列へのポインター。

*prop*<br/>
非同期コントロールプロパティを実装する[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)オブジェクト。

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

コンテナーがコントロールを非アクティブにしないようにします。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>パラメーター

*帯*<br/>
コントロールの埋め込み先の状態をロックする場合は TRUE。ロックを解除する場合は FALSE。

### <a name="return-value"></a>戻り値

ロックが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

コントロールのすべてのロックは、終了時にコントロールのロックを解除する必要があることに注意してください。 コントロールをロックするのは、イベントの発生中など、短い期間だけにする必要があります。

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

コンテナーのアンビエントプロパティの値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>パラメーター

*dispID*<br/>
変更されたアンビエントプロパティのディスパッチ ID。複数のプロパティが変更された場合は DISPID_UNKNOWN。

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Stock の外観プロパティの値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Remarks

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。 既定の実装で`InvalidateControl`は、が呼び出されます。

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Stock BackColor プロパティ値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Remarks

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。 既定の実装で`InvalidateControl`は、が呼び出されます。

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Stock BorderStyle プロパティの値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Remarks

既定の実装で`InvalidateControl`は、が呼び出されます。

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。

##  <a name="onclick"></a>COleControl:: OnClick

マウスボタンがクリックされたとき、または DoClick ストックメソッドが呼び出されたときにフレームワークによって呼び出されます。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>パラメーター

*iButton*<br/>
マウスボタンのインデックス。 には、次のいずれかの値を指定できます。

- LEFT_BUTTON マウスの左ボタンがクリックされました。

- MIDDLE_BUTTON は、マウスの中央ボタンがクリックされました。

- RIGHT_BUTTON マウスの右ボタンがクリックされました。

### <a name="remarks"></a>Remarks

既定の実装で`COleControl::FireClick`は、が呼び出されます。

既定の処理を変更または拡張するには、このメンバー関数をオーバーライドします。

##  <a name="onclose"></a>  COleControl::OnClose

コンテナーがコントロールの`IOleControl::Close`関数を呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>パラメーター

*dwSaveOption*<br/>
読み込み前にオブジェクトを保存する必要があるかどうかを示すフラグです。 次の値を指定できます。

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Remarks

既定では`OnClose` 、コントロールオブジェクトが変更されている場合は、 *dwsaveoption*が OLECLOSE_SAVEIFDIRTY または OLECLOSE_PROMPTSAVE のいずれかである場合、によって保存されます。

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

コンテナーがメンバー関数を`IOleObject::DoVerb`呼び出すと、フレームワークによって呼び出されます。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*iVerb*<br/>
呼び出すコントロール動詞のインデックス。

*lpMsg*<br/>
動詞が呼び出される原因となった Windows メッセージへのポインター。

*hWndParent*<br/>
コントロールの親ウィンドウへのハンドル。 動詞の実行によってウィンドウ (または windows) が作成された場合は、 *hWndParent*を親として使用する必要があります。

*lpRect*<br/>
コントロールの座標がコンテナーに対して相対的にコピーされる、RECT 構造体へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、ON_OLEVERB および ON_STDOLEVERB メッセージマップエントリを使用して、呼び出す適切な関数を決定します。

動詞の既定の処理を変更するには、この関数をオーバーライドします。

##  <a name="ondraw"></a>  COleControl::OnDraw

指定されたデバイスコンテキストを使用して、指定された外接する四角形で OLE コントロールを描画するために、フレームワークによって呼び出されます。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
描画が発生するデバイスコンテキスト。

*rcBounds*<br/>
境界を含む、コントロールの四角形の領域。

*rcInvalid*<br/>
コントロールの四角形の領域が無効です。

### <a name="remarks"></a>Remarks

`OnDraw`は、通常、画面表示のために呼び出され、画面デバイスコンテキストを*pDC*として渡します。 *Rcbounds*パラメーターは、ターゲットデバイスコンテキスト内の四角形を識別します (現在のマッピングモードに対する相対)。 *Rcinvalid*パラメーターは、無効な実際の四角形です。 場合によっては、これが*Rcbounds*よりも小さい領域になることがあります。

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

指定されたメタファイルデバイスコンテキストを使用して、指定された外接する四角形で OLE コントロールを描画するために、フレームワークによって呼び出されます。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
描画が発生するデバイスコンテキスト。

*rcBounds*<br/>
境界を含む、コントロールの四角形の領域。

### <a name="remarks"></a>Remarks

既定の実装は、 [OnDraw](#ondraw)関数を呼び出します。

##  <a name="onedit"></a>  COleControl::OnEdit

コントロールを UI でアクティブにします。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpMsg*<br/>
動詞を呼び出した Windows メッセージへのポインター。

*hWndParent*<br/>
コントロールの親ウィンドウへのハンドル。

*lpRect*<br/>
コンテナー内のコントロールによって使用される四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

これは、コントロールの OLEIVERB_UIACTIVATE 動詞を呼び出すのと同じ効果があります。

通常、この関数は、ON_OLEVERB メッセージマップエントリのハンドラー関数として使用されます。 これにより、コントロールの "オブジェクト" メニューで "編集" 動詞を使用できるようになります。 例:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Stock Enabled プロパティ値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Remarks

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。 既定の実装では、 [microsoft.office.core.iribbonui.invalidatecontrol](#invalidatecontrol)が呼び出されます。

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

コンテナーがメンバー関数を`IOleObject::EnumVerbs`呼び出すと、フレームワークによって呼び出されます。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>パラメーター

*ppenumOleVerb*<br/>
コントロールの動詞を`IEnumOLEVERB`列挙するオブジェクトへのポインター。

### <a name="return-value"></a>戻り値

動詞が使用可能な場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、メッセージマップ内の ON_OLEVERB エントリが列挙されます。

この関数をオーバーライドして、動詞を列挙する既定の方法を変更します。

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

イベントハンドラーが OLE コントロールに接続されているか、OLE コントロールから切断されているときに、フレームワークによって呼び出されます。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>パラメーター

*bAdvise*<br/>
TRUE は、イベントハンドラーがコントロールに接続されていることを示します。 FALSE は、イベントハンドラーがコントロールから切断されていることを示します。

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

ストックフォントプロパティの値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Remarks

既定の実装で`COleControl::InvalidateControl`は、が呼び出されます。 コントロールが Windows コントロールのサブクラスになっている場合、既定の実装では、WM_SETFONT メッセージもコントロールのウィンドウに送信されます。

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Stock ForeColor プロパティ値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Remarks

既定の実装で`InvalidateControl`は、が呼び出されます。

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

コンテナーがを呼び出し`IOleControl::FreezeEvents`た後に、フレームワークによって呼び出されます。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>パラメーター

*bFreeze*<br/>
コントロールのイベント処理が固定されている場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

既定の実装では、何も行われません。

イベント処理が固定または凍結解除されている場合に追加の動作が必要な場合は、この関数をオーバーライドします。

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

コンテナーがメンバー関数を`IViewObject::GetColorSet`呼び出すと、フレームワークによって呼び出されます。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>パラメーター

*ptd*<br/>
画像をレンダリングするターゲットデバイスを指します。 この値が NULL の場合、既定のターゲットデバイス (通常はディスプレイデバイス) に対して画像がレンダリングされます。

*hicTargetDev*<br/>
*Ptd*によって示されるターゲットデバイス上の情報コンテキストを指定します。 このパラメーターにはデバイスコンテキストを指定できますが、必ずしも1つであるとは限りません。 *Ptd*が null の場合、 *hicTargetDev*も null にする必要があります。

*ppColorSet*<br/>
使用される色のセットをコピーする場所へのポインター。 関数がカラーセットを返さない場合は、NULL が返されます。

### <a name="return-value"></a>戻り値

有効なカラーセットが返される場合は0以外の値です。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

コンテナーは、OLE コントロールを描画するために必要なすべての色を取得するために、この関数を呼び出します。 コンテナーは、カラーパレット全体を設定するために必要な色と組み合わせて取得したカラーセットを使用できます。 既定の実装では、FALSE が返されます。

この関数をオーバーライドして、この要求の特別な処理を実行します。

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

コントロールのコンテナーがコントロールに関する情報を要求したときに、フレームワークによって呼び出されます。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>パラメーター

*P制御 Linfo*<br/>
入力する制御[Linfo](/windows/win32/api/ocidl/ns-ocidl-controlinfo)構造体へのポインター。

### <a name="remarks"></a>Remarks

この情報は、主にコントロールのニーモニックキーの説明で構成されています。 既定の実装では、*既定の情報が使用*されます。

コントロールでニーモニックキーを処理する必要がある場合は、この関数をオーバーライドします。

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

*Dispid*によって識別されるプロパティの現在の値を表す文字列を取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*strValue*<br/>
文字列を返すために使用される[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="return-value"></a>戻り値

文字列が*strValue*で返された場合は0以外の値。それ以外の場合は0。

### <a name="remarks"></a>Remarks

コントロールに、値を文字列に直接変換できず、プロパティの値をコンテナーによって提供されるプロパティブラウザーに表示する必要があるプロパティがある場合は、この関数をオーバーライドします。

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

コントロールが UI でアクティブになったときにフレームワークによって呼び出され、コンテナーの既存のメニューにマージされるメニューを取得します。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>戻り値

コントロールのメニューのハンドル。コントロールに何もない場合は NULL。 既定の実装では、NULL が返されます。

### <a name="remarks"></a>Remarks

OLE リソースのマージの詳細については、「[メニューとリソース (ole)](../../mfc/menus-and-resources-ole.md)」を参照してください。

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

コンテナーの`IViewObjectEx::GetNaturalExtent`要求への応答としてフレームワークによって呼び出されます。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
オブジェクトがどのように表示されるかを指定します。 表現には、コンテンツ、アイコン、サムネイル、印刷されたドキュメントなどがあります。 有効な値は、列挙[Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*lindex*<br/>
オブジェクトの対象となる部分。 現在、-1 のみが有効です。

*ptd*<br/>
オブジェクトのサイズを返す対象デバイスを定義する[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)構造体を指します。

*hicTargetDev*<br/>
オブジェクトがデバイスメトリックを抽出し、デバイスの機能をテストするための、 *ptd*パラメーターで指定されるターゲットデバイスの情報コンテキストを指定します。 *Ptd*が NULL の場合、オブジェクトは*hicTargetDev*パラメーターの値を無視する必要があります。

*pExtentInfo*<br/>
サイズ変更データ`DVEXTENTINFO`を指定する構造体を指します。 `DVEXTENTINFO`構造は次のとおりです。

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

構造体メンバー `dwExtentMode`は、次の2つの値のいずれかを取ることができます。

- DVEXTENT_CONTENT は、コントロールをコンテンツに正確に合わせる必要があるかどうかを問い合わせます (サイズを合わせる)

- DVEXTENT_INTEGRAL サイズ変更時に、提案されたサイズを制御に渡す

*psizel*<br/>
コントロールによって返されたサイズ変更データをポイントします。 返されたサイズ変更データは、調整されなかったすべてのディメンションに対して-1 に設定されます。

### <a name="return-value"></a>戻り値

サイズを正常に返すか調整する場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

この関数をオーバーライドすると、 `DVEXTENTINFO`構造体の提案されたサイズとエクステントモードに最も近いオブジェクトの表示サイズが返されます。 既定の実装では、FALSE が返され、サイズの調整は行われません。

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

プロパティの有効な値を表す定義済みの文字列のセットを取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*pStringArray*<br/>
戻り値を格納する文字列配列。

*pCookieArray*<br/>
戻り値を格納する DWORD 配列。

### <a name="return-value"></a>戻り値

*Pstringarray*および*pstringarray*に要素が追加されている場合は0以外の。

### <a name="remarks"></a>Remarks

コントロールに、文字列で表現できる一連の値を持つプロパティがある場合は、この関数をオーバーライドします。 *Pstringarray*に追加された要素ごとに、対応する "cookie" 要素を*pstringarray*に追加する必要があります。 これらの "cookie" 値は、 `COleControl::OnGetPredefinedValue`後でフレームワークによって関数に渡される可能性があります。

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

の`COleControl::OnGetPredefinedStrings`オーバーライドによって以前に返された定義済み文字列の1つに対応する値を取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*dwCookie*<br/>
の`COleControl::OnGetPredefinedStrings`オーバーライドによって以前に返されたクッキー値。

*lpvarOut*<br/>
プロパティ値が`VARIANT`返される構造体へのポインター。

### <a name="return-value"></a>戻り値

*Lpvarout*で値が返された場合は0以外の値。それ以外の場合は0です。

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

コンテナーの[IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)要求に応答して、フレームワークによって呼び出されます。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>パラメーター

*dwDrawAspect*<br/>
表示するオブジェクトの形式 (または縦横) を記述する DWORD。 有効な値は、列挙[Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*lindex*<br/>
オブジェクトの対象となる部分。 現在、-1 のみが有効です。

*ptd*<br/>
オブジェクトのサイズを返す対象デバイスを定義する[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)構造体を指します。

*lpsizel*<br/>
オブジェクトのサイズが返される場所を指します。

### <a name="return-value"></a>戻り値

エクステント情報が正常に返された場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

コントロールが2つのパスの描画を使用し、その不透明な部分と透明な部分の次元が異なる場合は、この関数をオーバーライドします。

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

コンテナーの`IViewObjectEx::GetRect`要求への応答としてフレームワークによって呼び出されます。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
表示するオブジェクトの形式 (または縦横) を記述する DWORD。 有効な値は、列挙[Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

- オブジェクト全体の DVASPECT_CONTENT 外接する四角形。 オブジェクトの原点の左上隅、およびによって`GetViewExtent`返される範囲と同じサイズ*です。*

- 四角形の不透明な領域を持つ DVASPECT_OPAQUE オブジェクトは、その四角形を返します。 それ以外の場合は失敗します。

- 透明または不規則な部分をカバーする DVASPECT_TRANSPARENT 四角形。

*pRect*<br/>
オブジェクトを描画する四角形を指定する[RECTL](/previous-versions/dd162907\(v=vs.85\))構造体を指します。 このパラメーターは、オブジェクトの配置と伸縮を制御します。

### <a name="return-value"></a>戻り値

オブジェクトに対してサイズ設定された四角形が正常に返された場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

オブジェクトのサイズは、によっ`OnGetViewRect`て、特定の位置から始まる四角形に変換されます (既定では、画面の左上隅になります)。 コントロールが2つのパスの描画を使用し、その不透明な部分と透明な部分の次元が異なる場合は、この関数をオーバーライドします。

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

コンテナーの`IViewObjectEx::GetViewStatus`要求への応答としてフレームワークによって呼び出されます。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>戻り値

成功した場合は VIEWSTATUS 列挙値のいずれか。それ以外の場合は0です。 指定できる値は、次のとおりです。

|||
|-|-|
|VIEWSTATUS_OPAQUE|オブジェクトは完全に不透明です。 このビットが設定されていない場合、オブジェクトには透明部分が含まれます。 このビットは、DVASPECT_ICON や DVASPECT_DOCPRINT ではなく、コンテンツ関連の側面にのみ適用されます。|
|VIEWSTATUS_SOLIDBKGND|オブジェクトには、塗りつぶされた背景があります (ブラシパターンではなく、純色で構成されています)。 このビットは、VIEWSTATUS_OPAQUE が設定されていて、DVASPECT_ICON または DVASPECT_DOCPRINT ではなくコンテンツ関連の側面にのみ適用される場合にのみ意味を持ちます。|
|VIEWSTATUS_DVASPECTOPAQUE|オブジェクトは DVASPECT_OPAQUE をサポートしています。 描画アスペクトをパラメーターとして使用するすべての IViewObjectEx メソッドは、この側面で呼び出すことができます。|
|VIEWSTATUS_DVASPECTTRANSPARENT|オブジェクトは DVASPECT_TRANSPARENT をサポートしています。 描画`IViewObjectEx`アスペクトをパラメーターとして使用するすべてのメソッドは、この側面で呼び出すことができます。|

### <a name="remarks"></a>Remarks

コントロールで2つのパスの描画を使用する場合は、この関数をオーバーライドします。 既定の実装では、VIEWSTATUS_OPAQUE が返されます。

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

コントロールが UI で非アクティブになったときにフレームワークによって呼び出されます。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Remarks

実装では、によって表示`OnShowToolbars`されるすべてのツールバーを非表示にします。

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

WM_MOUSEMOVE メッセージの受信時に、マウスポインターの下にある非アクティブなオブジェクトのコンテナーによって呼び出されます。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
格納しているウィンドウのクライアント座標での、オブジェクトの外接する四角形。 WM_MOUSEMOVE メッセージの受信時に、オブジェクトに画面上の正確な位置とサイズを通知します。

*x*<br/>
親ウィンドウのクライアント座標でのマウス位置の x 座標。

*y*<br/>
親ウィンドウのクライアント座標でのマウス位置の y 座標。

*dwKeyState*<br/>
キーボードのキーボード修飾子キーの現在の状態を識別します。 有効な値は、MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON、MK_RBUTTON のいずれかのフラグの組み合わせです。

### <a name="remarks"></a>Remarks

ウィンドウクライアントの座標 (ピクセル) は、マウスカーソルの位置を渡すために使用されることに注意してください。 これは、オブジェクトの外接する四角形を同じ座標系に渡すことによって可能になります。

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

WM_SETCURSOR メッセージの受信時に、マウスポインターの下にある非アクティブなオブジェクトのコンテナーによって呼び出されます。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
格納しているウィンドウのクライアント座標での、オブジェクトの外接する四角形。 WM_SETCURSOR メッセージの受信時に、オブジェクトに画面上の正確な位置とサイズを通知します。

*x*<br/>
親ウィンドウのクライアント座標でのマウス位置の x 座標。

*y*<br/>
親ウィンドウのクライアント座標でのマウス位置の y 座標。

*dwMouseMsg*<br/>
WM_SETCURSOR が発生したマウスメッセージの識別子。

*bSetAlways*<br/>
オブジェクトでカーソルを設定する必要があるかどうかを指定します。 TRUE の場合、オブジェクトはカーソルを設定する必要があります。FALSE の場合、カーソルはカーソルを設定する必要がなく、その場合は S_FALSE を返します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ウィンドウクライアントの座標 (ピクセル) は、マウスカーソルの位置を渡すために使用されることに注意してください。 これは、オブジェクトの外接する四角形を同じ座標系に渡すことによって可能になります。

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Stock KeyDown イベントが処理された後にフレームワークによって呼び出されます。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>パラメーター

*nChar*<br/>
押されたキーの仮想キーコード値。 標準の仮想キーコードの一覧については、「Winuser. h」を参照してください。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

### <a name="remarks"></a>Remarks

コントロールがイベントの発生後にキー情報にアクセスする必要がある場合は、この関数をオーバーライドします。

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Stock KeyPress イベントが発生した後に、フレームワークによって呼び出されます。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>パラメーター

*nChar*<br/>
押されたキーの仮想キーコード値を格納します。 標準の仮想キーコードの一覧については、「Winuser. h」を参照してください。

### <a name="remarks"></a>Remarks

*NChar*値がコンテナーによって変更されている可能性があることに注意してください。

このイベントの発生後に通知する場合は、この関数をオーバーライドします。

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Stock KeyDown イベントが処理された後にフレームワークによって呼び出されます。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>パラメーター

*nChar*<br/>
押されたキーの仮想キーコード値。 標準の仮想キーコードの一覧については、「Winuser. h」を参照してください。

*nShiftState*<br/>
には、次のフラグの組み合わせが含まれています。

- SHIFT_MASK 操作中に SHIFT キーが押されました。

- CTRL_MASK アクションの実行中に CTRL キーが押されました。

- ALT_MASK 操作中に ALT キーが押されました。

### <a name="remarks"></a>Remarks

コントロールがイベントの発生後にキー情報にアクセスする必要がある場合は、この関数をオーバーライドします。

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

指定されたプロパティの編集を実装するプロパティページのクラス ID を取得するために、フレームワークによって呼び出されます。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>パラメーター

*dispid*<br/>
コントロールのプロパティのディスパッチ ID。

*lpclsid*<br/>
クラス ID が`CLSID`返される構造体へのポインター。

*pbPageOptional*<br/>
指定されたプロパティページの使用が省略可能かどうかを示すインジケーターを返します。

### <a name="return-value"></a>戻り値

*Lpclsid*でクラス ID が返された場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

この関数をオーバーライドすると、コンテナーのプロパティブラウザーからコントロールのプロパティページを呼び出すことができます。

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

OLE コントロールのニーモニックキーが押されたことがコンテナーによって検出されたときに、フレームワークによって呼び出されます。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>パラメーター

*pMsg*<br/>
ニーモニック キーの押下時に生成された Windows メッセージへのポインター。

##  <a name="onproperties"></a>  COleControl::OnProperties

コントロールのプロパティ動詞がコンテナーによって呼び出されたときに、フレームワークによって呼び出されます。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpMsg*<br/>
動詞を呼び出した Windows メッセージへのポインター。

*hWndParent*<br/>
コントロールの親ウィンドウへのハンドル。

*lpRect*<br/>
コンテナー内のコントロールによって使用される四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、モーダルプロパティダイアログボックスが表示されます。

この関数を使用すると、コントロールのプロパティページを表示することもできます。 HWndParent パラメーターで、コントロール`OnProperties`の親のハンドルを渡して、関数の呼び出しを行います。 この場合、 *Lpmsg*パラメーターと*lpRect*パラメーターの値は無視されます。

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

コンテナーの`IViewObjectEx::QueryHitPoint`要求への応答としてフレームワークによって呼び出されます。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
オブジェクトを表す方法を指定します。 有効な値は、列挙[Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*pRectBounds*<br/>
OLE コントロールクライアント`RECT`領域の外接する四角形を指定する構造体へのポインター。

*ptlLoc*<br/>
ヒットのチェック`POINT`対象となる点を指定する構造体へのポインター。 ポイントは、OLE クライアントの領域座標で指定します。

*lCloseHint*<br/>
ヒットしたことを確認したポイントに対して "閉じる" を定義する距離。

*pHitResult*<br/>
ヒットクエリの結果へのポインター。 次のいずれかの値です。

- HITRESULT_OUTSIDE *ptlLoc*は OLE オブジェクトの外部にあり、閉じていません。

- HITRESULT_TRANSPARENT *ptlLoc*は OLE オブジェクトの境界内にありますが、画像の近くにはありません。 たとえば、透明な円の途中のポイントは、HITRESULT_TRANSPARENT になる可能性があります。

- HITRESULT_CLOSE *ptlLoc*は OLE オブジェクトの内側または外側にありますが、内部で考慮されるように、オブジェクトに対して十分に近いものです。 この値は、Small、thin、または detailed のオブジェクトによって使用される場合があります。 あるポイントがオブジェクトの外接する四角形の外側にあっても、まだ閉じている可能性があります (これは小さいオブジェクトをヒットさせるために必要です)。

- HITRESULT_HIT *ptlLoc*は、オブジェクトのイメージ内にあります。

### <a name="return-value"></a>戻り値

ヒット結果が正常に返された場合は0以外の値。それ以外の場合は0です。 ヒットは、OLE コントロールの表示領域と重複しています。

### <a name="remarks"></a>Remarks

オブジェクトの表示四角形が指定した点に重なっているかどうかを照会します (ポイントにヒットします)。 `QueryHitPoint`は、四角形以外のオブジェクトのヒットをテストするためにオーバーライドできます。

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

コンテナーの`IViewObjectEx::QueryHitRect`要求への応答としてフレームワークによって呼び出されます。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>パラメーター

*dwAspect*<br/>
オブジェクトがどのように表示されるかを指定します。 有効な値は、列挙[Dvaspect](/windows/win32/api/wtypes/ne-wtypes-dvaspect)または DVASPECT2 から取得されます。

*pRectBounds*<br/>
OLE コントロールクライアント`RECT`領域の外接する四角形を指定する構造体へのポインター。

*prcLoc*<br/>
オブジェクトの左上`RECT`隅を基準として、ヒットしたかどうかをチェックする四角形 (オブジェクトの四角形と重なる) を指定する構造体へのポインター。

*lCloseHint*<br/>
使用しません。

*pHitResult*<br/>
ヒットクエリの結果へのポインター。 次のいずれかの値です。

- HITRESULT_OUTSIDE は、四角形内のポイントが OLE オブジェクトによってヒットされることはありません。

- HITRESULT_HIT は、その四角形の少なくとも1つのポイントが、オブジェクトにヒットします。

### <a name="return-value"></a>戻り値

ヒット結果が正常に返された場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

オブジェクトの表示四角形が、指定された四角形内の任意の点に重なっているかどうかをクエリします (四角形にヒットします)。 `QueryHitRect`は、四角形以外のオブジェクトのヒットをテストするためにオーバーライドできます。

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

指定された形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
情報が要求される形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体を指します。

*lpStgMedium*<br/>
データが返される[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)構造体を指します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定された形式は、遅延レンダリングのために[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)または[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)メンバー関数を使用して、以前にコントロールオブジェクトに配置されています。 この関数の既定の実装は`OnRenderFileData` 、 `OnRenderGlobalData`指定されたストレージメディアがファイルまたはメモリのいずれかである場合、それぞれまたはを呼び出します。 要求された形式が CF_METAFILEPICT または永続的なプロパティセット形式の場合、既定の実装は適切なデータをレンダリングし、0以外の値を返します。 それ以外の場合は0を返し、何も実行しません。

*> lpStgMedium tymed*が TYMED_NULL の場合、STGMEDIUM は*lpFormatEtc-> tymed*によって指定されたとおりに割り当てられ、入力される必要があります。 TYMED_NULL がない場合は、データを格納する STGMEDIUM を設定する必要があります。

要求された形式とメディアにデータを提供するには、この関数をオーバーライドします。 データによっては、この関数の他のバージョンの1つをオーバーライドすることが必要になる場合があります。 データが小さく、サイズが固定されている`OnRenderGlobalData`場合は、をオーバーライドします。 データがファイル内にある場合、またはサイズが可変の場合`OnRenderFileData`は、をオーバーライドします。

詳細については、 `FORMATETC` Windows SDK `STGMEDIUM`の「」および「」構造体を参照してください。

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

ストレージメディアがファイルの場合に、指定された形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
情報が要求される形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体を指します。

*pFile*<br/>
データが表示される[CFile](../../mfc/reference/cfile-class.md)オブジェクトを指します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定された形式は、遅延レンダリングのために[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)メンバー関数を使用して、以前にコントロールオブジェクトに配置されています。 この関数の既定の実装では、単に FALSE が返されます。

要求された形式とメディアにデータを提供するには、この関数をオーバーライドします。 データによっては、この関数の他のバージョンの1つをオーバーライドすることが必要になる場合があります。 複数の記憶域メディアを処理する場合は、 `OnRenderData`をオーバーライドします。 データがファイル内にある場合、またはサイズが可変の場合`OnRenderFileData`は、をオーバーライドします。

詳細については、 `FORMATETC` Windows SDK の構造を参照してください。

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

指定されたストレージメディアがグローバルメモリである場合に、指定された形式でデータを取得するためにフレームワークによって呼び出されます。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
情報が要求される形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体を指します。

*phGlobal*<br/>
データが返されるグローバルメモリへのハンドルを指します。 メモリが割り当てられていない場合は、このパラメーターを NULL にすることができます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

指定された形式は、遅延レンダリングのために[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)メンバー関数を使用して、以前にコントロールオブジェクトに配置されています。 この関数の既定の実装では、単に FALSE が返されます。

*Phglobal*が NULL の場合、新しい HGLOBAL が割り当てられ、 *phglobal*で返される必要があります。 それ以外の場合は、 *Phglobal*によって指定された HGLOBAL にデータを格納する必要があります。 HGLOBAL に配置されるデータの量は、メモリブロックの現在のサイズを超えることはできません。 また、ブロックをより大きなサイズに再割り当てすることはできません。

要求された形式とメディアにデータを提供するには、この関数をオーバーライドします。 データによっては、この関数の他のバージョンの1つをオーバーライドすることが必要になる場合があります。 複数の記憶域メディアを処理する場合は、 `OnRenderData`をオーバーライドします。 データがファイル内にある場合、またはサイズが可変の場合`OnRenderFileData`は、をオーバーライドします。

詳細については、 `FORMATETC` Windows SDK の構造を参照してください。

##  <a name="onresetstate"></a>  COleControl::OnResetState

コントロールのプロパティを既定値に設定する必要がある場合に、フレームワークによって呼び出されます。

```
virtual void OnResetState();
```

### <a name="remarks"></a>Remarks

既定の実装は[DoPropExchange](#dopropexchange)を呼び出し、 `CPropExchange`プロパティを既定値に設定するオブジェクトを渡します。

コントロールライターは、このオーバーライド可能なに OLE コントロールの初期化コードを挿入できます。 この関数は、 [IPersistStream:: load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)または[IPersistStorage:: load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)が失敗した場合、または[IPersistStreamInit:: InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)または[IPersistStorage:: InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) `IPersistStream::Load`が呼び出された場合に呼び出されます。最初にまたは`IPersistStorage::Load`を呼び出す必要はありません.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

コンテナーがコントロールの`IOleControl::SetClientSite`関数を呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Remarks

既定では`OnSetClientSite` 、はデータパスプロパティが読み込まれているかどうか`DoDataPathPropExchange`を確認し、存在する場合はを呼び出します。

この通知の特別な処理を実行するには、この関数をオーバーライドします。 特に、この関数のオーバーライドでは、基本クラスを呼び出す必要があります。

##  <a name="onsetdata"></a>  COleControl::OnSetData

コントロールのデータを指定されたデータに置き換えるために、フレームワークによって呼び出されます。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>パラメーター

*lpFormatEtc*<br/>
データの形式を指定する[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。

*lpStgMedium*<br/>
データが存在する[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)構造体へのポインター。

*bRelease*<br/>
コントロールがストレージメディアを解放する必要がある場合は TRUE。コントロールがストレージメディアを解放しない場合は FALSE。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

データが永続的なプロパティセット形式の場合、既定の実装では、それに応じてコントロールの状態が変更されます。 それ以外の場合、既定の実装では何も行われません。 *Brelease*が TRUE の場合、へ`ReleaseStgMedium`の呼び出しが行われます。それ以外の場合は、が呼び出されます。

コントロールのデータを指定したデータに置き換えるには、この関数をオーバーライドします。

詳細については、 `FORMATETC` Windows SDK `STGMEDIUM`の「」および「」構造体を参照してください。

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

[IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)の呼び出しの結果として、コントロールの範囲を変更する必要があるときにフレームワークによって呼び出されます。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>パラメーター

*lpSizeL*<br/>
長整数を使用`SIZEL`してコントロールの幅と高さを表す構造体へのポインター (HIMETRIC 単位)。

### <a name="return-value"></a>戻り値

サイズ変更が受け入れられた場合は0以外の値。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、コントロールの範囲のサイズ変更が処理されます。 コントロールがアクティブになっている場合は、コンテナーの`OnPosRectChanged`呼び出しが行われます。

コントロールの既定のサイズ変更を変更するには、この関数をオーバーライドします。

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

[IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)への呼び出しを実装するために、フレームワークによって呼び出されます。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>パラメーター

*lpRectPos*<br/>
コンテナーを基準と`RECT`した、コントロールの新しい位置とサイズを示す構造体へのポインター。

*lpRectClip*<br/>
コントロールがクリップさ`RECT`れる四角形の領域を示す構造体へのポインター。

### <a name="return-value"></a>戻り値

再配置が受け入れられた場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、コントロールウィンドウの位置変更とサイズ変更が自動的に処理され、TRUE が返されます。

この関数をオーバーライドして、この関数の既定の動作を変更します。

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

コントロールが UI でアクティブにされたときにフレームワークによって呼び出されます。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Remarks

既定の実装では、何も行われません。

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

ストックキャプションまたはテキストプロパティの値が変更されたときにフレームワークによって呼び出されます。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Remarks

既定の実装で`InvalidateControl`は、が呼び出されます。

このプロパティが変更した後に通知を表示する場合は、この関数をオーバーライドします。

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

コンテナーの`IOleInPlaceObjectWindowless::OnWindowMessage`要求への応答としてフレームワークによって呼び出されます。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>パラメーター

*msg*<br/>
Windows によって渡されるメッセージ識別子。

*wParam*<br/>
Windows によって渡されます。 メッセージ固有の追加情報を指定します。 このパラメーターの内容は、 *msg*パラメーターの値によって異なります。

*lParam*<br/>
Windows によって渡されます。 メッセージ固有の追加情報を指定します。 このパラメーターの内容は、 *msg*パラメーターの値によって異なります。

*plResult*<br/>
Windows の結果コード。 メッセージ処理の結果を指定します。送信されたメッセージによって異なります。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ウィンドウなしのコントロールのウィンドウメッセージを処理します。 `COleControl`は、マウスメッセージやキーボードメッセージ以外のウィンドウメッセージに使用する必要があります。`OnWindowlessMessage` `COleControl`ウィンドウなしの OLE オブジェクトに対してマウスキャプチャとキーボードフォーカスを取得するために、 [SetCapture](#setcapture)と[SetFocus](#setfocus)を提供します。

ウィンドウなしのオブジェクトにはウィンドウがないため、コンテナーがメッセージをディスパッチできるようにするためのメカニズムが必要です。 ウィンドウなしの OLE オブジェクトは、 `OnWindowMessage` `IOleInPlaceObjectWindowless`インターフェイスのメソッド (ウィンドウなしのサポートのための[IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)の拡張機能) を使用して、コンテナーからメッセージを取得します。 `OnWindowMessage`はパラメーターを`HWND`受け取りません。

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

*Ppoint*の座標をクライアント座標に変換します。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>パラメーター

*lprcBounds*<br/>
コンテナー内の OLE コントロールの境界へのポインター。 クライアント領域ではなく、境界線とスクロールバーを含むコントロール全体の領域。

*pPoint*<br/>
コントロールのクライアント領域の座標に変換される親 (コンテナー) ポイントへのポインター。

*bHitTest*<br/>
ヒットテストをポイントで実行するかどうかを指定します。

### <a name="return-value"></a>戻り値

*BHitTest*が FALSE の場合、は htnowhere を返しません。 *BHitTest*が TRUE の場合、は親 (コンテナー) ポイントが OLE コントロールのクライアント領域に到着した場所を返します。これは、次のいずれかのマウスヒットテスト値です。

- サイズ変更境界のないウィンドウの境界線の HTBORDER。

- ウィンドウの下の水平方向の境界線にある HTBOTTOM。

- ウィンドウの境界線の左下隅にあります。

- ウィンドウの境界線の右下隅にあります。

- タイトルバー領域の HTCAPTION。

- クライアント領域の HTCLIENT。

- 画面の背景またはウィンドウ間の区切り線で HTERROR ます ( `DefWndProc` windows の関数によってエラーを示すシステムビープ音が発生する点を除いて)。

- サイズボックス内の HTGROWBOX。

- 水平スクロールバーの HTHSCROLL。

- ウィンドウの左境界線の左にある。

- [最大化] ボタンの HTMAXBUTTON。

- メニュー領域の HTMENU。

- [最小化] ボタンの HTMINBUTTON。

- 画面の背景またはウィンドウ間の区切り線ではありません。

- [最小化] ボタンの HTREDUCE。

- ウィンドウの右境界線で右に表示されます。

- サイズボックスに HTSIZE (HTGROWBOX と同じ)。

- コントロールメニューの HTSYSMENU、または子ウィンドウの [閉じる] ボタン。

- ウィンドウの上部の水平方向の境界線にある HTTOP。

- HTTOPLEFT ウィンドウの境界の左上隅に表示されます。

- ウィンドウの境界線の右上隅にある HTTOPRIGHT。

- 別のウィンドウによって現在カバーされているウィンドウ内での、TRANSPARENT transparent。

- 垂直スクロールバーの HTVSCROLL。

- [最大化] ボタンをクリックします。

### <a name="remarks"></a>Remarks

入力時の*Ppoint*は、親 (コンテナーの左上隅) の原点に対する相対値です。 出力の*Ppoint*は、OLE コントロールのクライアント領域の原点 (コントロールのクライアント領域の左上隅) に対する相対値です。

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

モーダルダイアログボックスが閉じられたことをコンテナーに通知します。

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>パラメーター

*hWndParent*<br/>
モーダルダイアログボックスの親ウィンドウへのハンドル。

### <a name="remarks"></a>Remarks

モーダルダイアログボックスを表示した後に、この関数を呼び出します。 コンテナーがによって`PreModalDialog`無効にされたトップレベルのウィンドウを有効にできるようにするには、この関数を呼び出す必要があります。 この関数は、の呼び出し`PreModalDialog`とペアにする必要があります。

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

モーダルダイアログボックスが表示されようとしていることをコンテナーに通知します。

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>パラメーター

*hWndParent*<br/>
モーダルダイアログボックスの親ウィンドウへのハンドル。

### <a name="remarks"></a>Remarks

モーダルダイアログボックスを表示する前に、この関数を呼び出します。 コンテナーが最上位レベルのウィンドウをすべて無効にできるように、この関数を呼び出す必要があります。 モーダルダイアログボックスが表示されたら、を呼び出す`PostModalDialog`必要があります。

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

コントロールのウィンドウを破棄して再作成します。

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Remarks

これは、ウィンドウのスタイルビットを変更する必要がある場合に必要になることがあります。

##  <a name="refresh"></a>  COleControl::Refresh

OLE コントロールを強制的に再描画します。

```
void Refresh();
```

### <a name="remarks"></a>Remarks

この関数は、 `COleControl`基本クラスで更新と呼ばれるストックメソッドとしてサポートされています。 これにより、OLE コントロールのユーザーは、特定の時点でコントロールを再描画できます。 このメソッドの詳細については、ActiveX [コントロールに関する記事を参照してください。メソッド](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

マウスキャプチャを解放します。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

コントロールに現在マウスキャプチャがある場合は、キャプチャが解放されます。 それ以外の場合、この関数による影響はありません。

##  <a name="releasedc"></a>  COleControl::ReleaseDC

ウィンドウなしのコントロールのコンテナーの表示デバイスコンテキストを解放します。これにより、他のアプリケーションで使用するためにデバイスコンテキストが解放されます。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
解放するコンテナーデバイスコンテキストを識別します。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

アプリケーションは、 `ReleaseDC` [GetDC](#getdc)の呼び出しごとにを呼び出す必要があります。

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

コントロールの親を設定します。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>パラメーター

*hWndOuter*<br/>
コントロールウィンドウのハンドル。

*hWndParent*<br/>
新しい親ウィンドウのハンドル。

### <a name="remarks"></a>Remarks

この関数を呼び出して、コントロールウィンドウの親をリセットします。

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

`COleControl`ストックプロパティの状態を既定値に初期化します。

```
void ResetStockProps();
```

### <a name="remarks"></a>Remarks

次のプロパティです。外観、BackColor、BorderStyle、Caption、Enabled、Font、ForeColor、hWnd、および Text。 ストックプロパティの説明については[、「ActiveX コントロール:ストックプロパティ](../../mfc/mfc-activex-controls-adding-stock-properties.md)を追加しています。

`COleControl::OnResetState`および`ResetStockProps` を使用`ResetVersion`してをオーバーライドすることにより、コントロールのバイナリ初期化のパフォーマンスを向上させることができます。 下記の例を参照してください。 初期化の最適化の詳細について[は、「ActiveX コントロール:最適化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

バージョン番号を指定された値に初期化します。

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>パラメーター

*dwVersionDefault*<br/>
コントロールに割り当てられるバージョン番号。

### <a name="remarks"></a>Remarks

`COleControl::OnResetState`および`ResetVersion` を使用`ResetStockProps`してをオーバーライドすることにより、コントロールのバイナリ初期化のパフォーマンスを向上させることができます。 [Resetstockprops](#resetstockprops)の例を参照してください。 初期化の最適化の詳細について[は、「ActiveX コントロール:最適化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

ウィンドウなしの OLE オブジェクトが、画面上の埋め込み先のアクティブなイメージ内の領域をスクロールできるようにします。

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>パラメーター

*xAmount*<br/>
水平スクロールの量をデバイス単位で指定します。 左にスクロールするには、このパラメーターに負の値を指定する必要があります。

*yAmount*<br/>
垂直スクロールの量をデバイス単位で指定します。 上にスクロールするには、このパラメーターに負の値を指定する必要があります。

*lpRect*<br/>
親ウィンドウのクライアント座標で、スクロールする OLE オブジェクトのクライアント領域の部分を指定する、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトまたは RECT 構造体を指します。 *LpRect*が NULL の場合、OLE オブジェクトのクライアント領域全体がスクロールされます。

*lpClipRect*<br/>
クリップする四角形`CRect`を指定`RECT`するオブジェクトまたは構造体を指します。 四角形内のピクセルだけがスクロールされます。 四角形の外側のビットは、 *lpRect*四角形内にある場合でも影響を受けません。 *Lpcliprect*が NULL の場合、スクロール用の四角形でクリッピングは実行されません。

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

デバイスコンテキストに対してフォントを選択します。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
デバイスコンテキストオブジェクトへのポインター。

*fontHolder*<br/>
選択されるフォントを表す[CFontHolder](../../mfc/reference/cfontholder-class.md)オブジェクトへの参照。

### <a name="return-value"></a>戻り値

以前に選択されたフォントへのポインター。 FontHolder を使用するすべての描画操作を呼び出し元が完了したら *、* 前に選択したフォントをパラメーターとして[CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject)に渡すことによって、前に選択したフォントを再選択する必要があります。

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

ストックフォントプロパティをデバイスコンテキストに選択します。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
フォントが選択されるデバイスコンテキスト。

### <a name="return-value"></a>戻り値

以前に選択された`CFont`オブジェクトへのポインター。 完了したら、 [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject)を使用して、このフォントをデバイスコンテキストに戻す必要があります。

##  <a name="serializeextent"></a>COleControl:: SerializeExtent

コントロールに割り当てられた表示領域の状態をシリアル化または初期化します。

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*金*<br/>
シリアル化または逆シリアル化するオブジェクト。`CArchive`

### <a name="remarks"></a>Remarks

、 `SerializeExtent` 、`SerializeStockProps`および`COleControl::Serialize`を使用してをオーバーライドすることにより、コントロールのバイナリ永続化のパフォーマンスを向上させることができます。 `SerializeVersion` 下記の例を参照してください。 初期化の最適化の詳細について[は、「ActiveX コントロール:最適化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

`COleControl`ストックプロパティの状態をシリアル化または初期化します。外観、BackColor、BorderStyle、Caption、Enabled、Font、ForeColor、および Text。

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>パラメーター

*金*<br/>
シリアル化または逆シリアル化するオブジェクト。`CArchive`

### <a name="remarks"></a>Remarks

ストックプロパティの説明については[、「ActiveX コントロール:ストックプロパティ](../../mfc/mfc-activex-controls-adding-stock-properties.md)を追加しています。

、 `SerializeStockProps` 、`SerializeExtent`および`COleControl::Serialize`を使用してをオーバーライドすることにより、コントロールのバイナリ永続化のパフォーマンスを向上させることができます。 `SerializeVersion` 例については、 [SerializeExtent](#serializeextent)のコードを参照してください。 初期化の最適化の詳細について[は、「ActiveX コントロール:最適化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

コントロールのバージョン情報の状態をシリアル化または初期化します。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>パラメーター

*金*<br/>
シリアル化または逆シリアル化するオブジェクト。`CArchive`

*dwVersionDefault*<br/>
コントロールの現在のバージョン番号。

*bConvert*<br/>
永続データを保存時に最新の形式に変換するか、読み込まれたときと同じ形式で保持するかを示します。

### <a name="return-value"></a>戻り値

コントロールのバージョン番号。 指定したアーカイブが読み込ま`SerializeVersion`れている場合は、そのアーカイブから読み込まれたバージョンを返します。 それ以外の場合は、現在読み込まれているバージョンを返します。

### <a name="remarks"></a>Remarks

、 `SerializeVersion` 、`SerializeExtent`および`COleControl::Serialize`を使用してをオーバーライドすることにより、コントロールのバイナリ永続化のパフォーマンスを向上させることができます。 `SerializeStockProps` 例については、 [SerializeExtent](#serializeextent)のコードを参照してください。 初期化の最適化の詳細について[は、「ActiveX コントロール:最適化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="setappearance"></a>COleControl:: SetAppearance

コントロールの stock 外観プロパティの値を設定します。

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>パラメーター

*sAppearance*<br/>
コントロールの外観に使用される**short** (VT_I2) 値。 値を0に設定すると、コントロールの外観がフラットに設定され、値1はコントロールの外観を3D に設定します。

### <a name="remarks"></a>Remarks

ストックプロパティの詳細について[は、「ActiveX コントロール:プロパティ](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

コントロールのストック BackColor プロパティの値を設定します。

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>パラメーター

*dwBackColor*<br/>
コントロールの背景の描画に使用する OLE_COLOR 値。

### <a name="remarks"></a>Remarks

このプロパティおよびその他の関連プロパティの使用の詳細について[は、ActiveX コントロールに関する記事を参照してください。プロパティ](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

コントロールの stock BorderStyle プロパティ値を設定します。

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>パラメーター

*sBorderStyle*<br/>
コントロールの新しい境界線スタイル。0は境界がないことを示し、1は通常の境界線を示します。

### <a name="remarks"></a>Remarks

次に、コントロールウィンドウが再作成`OnBorderStyleChanged`され、呼び出されます。

##  <a name="setcapture"></a>COleControl:: SetCapture

コントロールのコンテナーウィンドウが、コントロールの代わりにマウスキャプチャを受け取るようにします。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>戻り値

以前にマウス入力`CWnd`を受け取ったウィンドウオブジェクトへのポインター。

### <a name="remarks"></a>Remarks

コントロールがアクティブ化され、ウィンドウなしになっている場合、この関数により、コントロールのコンテナーウィンドウは、コントロールの代わりにマウスキャプチャを所有します。 それ以外の場合、この関数は、コントロール自体がマウスキャプチャ (と`CWnd::SetCapture`同じ) を受け取るようにします。

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

OLE コントロールウィンドウのサイズを設定し、コントロールサイトが変更されていることをコンテナーに通知します。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>パラメーター

*cx*<br/>
コントロールの新しい幅をピクセル単位で指定します。

*暦年*<br/>
コントロールの新しい高さをピクセル単位で指定します。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

この関数は、コントロールのコンストラクターでは使用できません。

コントロールウィンドウのすべての座標は、コントロールの左上隅を基準としています。

##  <a name="setenabled"></a>  COleControl::SetEnabled

コントロールのストック Enabled プロパティ値を設定します。

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>パラメーター

*bEnabled*<br/>
コントロールを有効にする場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

このプロパティを設定する`OnEnabledChange`と、が呼び出されます。

##  <a name="setfocus"></a>  COleControl::SetFocus

コントロールのコンテナーウィンドウが、コントロールの代わりに入力フォーカスを受け取るようにします。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>戻り値

以前に入力フォーカス`CWnd`があったウィンドウオブジェクトへのポインター。そのようなウィンドウがない場合は NULL。

### <a name="remarks"></a>Remarks

コントロールがアクティブ化され、ウィンドウなしになっている場合、この関数により、コントロールのコンテナーウィンドウは、コントロールの代わりに入力フォーカスを取得します。 入力フォーカスは、キーボード入力をコンテナーのウィンドウに送信します。コンテナーは、後続のすべてのキーボードメッセージを、 `SetFocus`を呼び出す OLE オブジェクトにディスパッチします。 以前に入力フォーカスがあったすべてのウィンドウが失われます。

コントロールがウィンドウなしでない場合は、この関数によって、コントロール自体が入力フォーカスを取得し`CWnd::SetFocus`ます (と同じ)。

##  <a name="setfont"></a>  COleControl::SetFont

コントロールのストックフォントプロパティを設定します。

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>パラメーター

*pFontDisp*<br/>
フォントディスパッチインターフェイスへのポインター。

##  <a name="setforecolor"></a>  COleControl::SetForeColor

コントロールの stock ForeColor プロパティ値を設定します。

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>パラメーター

*dwForeColor*<br/>
コントロールの前景色を描画するために使用される OLE_COLOR 値。

### <a name="remarks"></a>Remarks

このプロパティおよびその他の関連プロパティの使用の詳細について[は、ActiveX コントロールに関する記事を参照してください。プロパティ](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

コントロールでサポートされているデータ形式の一覧を初期化するために、フレームワークによって呼び出されます。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Remarks

既定の実装では、次の2つの形式を指定します。CF_METAFILEPICT と永続的なプロパティセット。

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

コンテナーに最初に表示されるときの OLE コントロールのサイズを設定します。

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>パラメーター

*cx*<br/>
OLE コントロールの初期の幅 (ピクセル単位)。

*暦年*<br/>
OLE コントロールの初期の高さ (ピクセル単位)。

### <a name="remarks"></a>Remarks

コントロールの初期サイズを設定するには、コンストラクターでこの関数を呼び出します。 初期サイズは、デバイス単位またはピクセル単位で計測されます。 この呼び出しは、コントロールのコンストラクターで行うことをお勧めします。

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

コントロールの変更された状態を変更します。

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>パラメーター

*bModified*<br/>
コントロールの変更後のフラグの新しい値。 TRUE は、コントロールの状態が変更されたことを示します。FALSE は、コントロールの状態が保存されたばかりであることを示します。

### <a name="remarks"></a>Remarks

コントロールの永続的な状態に影響を与える変更が発生するたびに、この関数を呼び出します。 たとえば、永続的なプロパティの値が変更された場合は、 *Bmodified* **TRUE**を指定してこの関数を呼び出します。

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

編集要求が失敗したことを示します。

```
void SetNotPermitted();
```

### <a name="remarks"></a>Remarks

が失敗した`BoundPropertyRequestEdit`場合に、この関数を呼び出します。 この関数は、設定操作が`COleDispScodeException`許可されていないことを示すために、型の例外をスローします。

##  <a name="setnotsupported"></a>COleControl:: SetNotSupported

ユーザーがコントロールのプロパティ値を変更できないようにします。

```
void SetNotSupported();
```

### <a name="remarks"></a>Remarks

コントロールのユーザーによるプロパティ値の変更がサポートされていないプロパティの Set 関数の代わりに、この関数を呼び出します。 1つの例として、読み取り専用のプロパティがあります。

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

デバイス単位で表される、コンテナーを基準とした、コントロールの四角形の座標を設定します。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>パラメーター

*lpRect*<br/>
コンテナーを基準とした、コントロールの新しい座標を格納している四角形へのポインター。

### <a name="return-value"></a>戻り値

呼び出しが成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

コントロールが開いている場合はサイズが変更されます。それ以外の場合`OnPosRectChanged`は、コンテナーの関数が呼び出されます。

##  <a name="settext"></a>  COleControl::SetText

コントロールのストックキャプションまたはテキストプロパティの値を設定します。

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>パラメーター

*pszText*<br/>
文字列へのポインター。

### <a name="remarks"></a>Remarks

Stock Caption プロパティと Text プロパティが両方とも同じ値にマップされていることに注意してください。 つまり、いずれかのプロパティに加えられた変更によって、両方のプロパティが自動的に変更されます。 一般に、コントロールは、ストックキャプションまたはテキストプロパティをサポートする必要がありますが、両方はサポートしません。

##  <a name="throwerror"></a>  COleControl::ThrowError

コントロールでエラーが発生したことを通知します。

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>パラメーター

*sc*<br/>
報告されるステータスコードの値。 使用可能なコードの完全な一覧について[は、ActiveX コントロールに関する記事をご覧ください。高度な](../../mfc/mfc-activex-controls-advanced-topics.md)トピック。

*nDescriptionID*<br/>
報告される例外の文字列リソース ID。

*nHelpID*<br/>
報告されるトピックのヘルプ ID です。

*pszDescription*<br/>
報告される例外の説明を含む文字列。

### <a name="remarks"></a>Remarks

この関数は、OLE プロパティの Get または Set 関数内から、または OLE オートメーションメソッドの実装からのみ呼び出す必要があります。 他の時刻に発生したエラーを通知する必要がある場合は、在庫エラーイベントを発生させる必要があります。

##  <a name="transformcoords"></a>  COleControl::TransformCoords

HIMETRIC 単位とコンテナーのネイティブ単位との間で座標値を変換します。

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>パラメーター

*lpptlHimetric*<br/>
HIMETRIC 単位の`POINTL`座標を格納している構造体へのポインター。

*lpptfContainer*<br/>
コンテナーの単位`POINTF`サイズ内の座標を格納している構造体へのポインター。

*flags*<br/>
次の値の組み合わせ。

- コンテナー内の位置を XFORMCOORDS_POSITION します。

- XFORMCOORDS_SIZE コンテナー内のサイズを変更します。

- XFORMCOORDS_HIMETRICTOCONTAINER をコンテナーの単位に変換します。

- XFORMCOORDS_CONTAINERTOHIMETRIC コンテナーの単位を HIMETRIC 単位に変換します。

### <a name="remarks"></a>Remarks

最初の2つのフラグ XFORMCOORDS_POSITION と XFORMCOORDS_SIZE は、座標を位置またはサイズとして扱う必要があるかどうかを示します。 残りの2つのフラグは、変換の方向を示します。

##  <a name="translatecolor"></a>  COleControl::TranslateColor

色の値を OLE_COLOR データ型から[COLORREF](/windows/win32/gdi/colorref)データ型に変換します。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>パラメーター

*clrColor*<br/>
OLE_COLOR データ型。 詳細については、「Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)関数」を参照してください。

*hpal*<br/>
オプションのパレットを指定するハンドル。NULL を指定できます。

### <a name="return-value"></a>戻り値

デバイスが表すことができる*Clrcolor*値に最も近い純色を定義する、RGB (赤、緑、青) 32 ビットカラー値。

### <a name="remarks"></a>Remarks

この関数は、stock ForeColor プロパティと BackColor プロパティを[CDC](../../mfc/reference/cdc-class.md)メンバー関数で使用される COLORREF 型に変換する場合に便利です。

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

コントロールでアンビエントプロパティの値を既定値として使用する必要があるかどうかを決定します。この値は、その後、永続化状態から読み込まれます。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>戻り値

0以外の場合は、アンビエントプロパティが有効であることを示します。それ以外の場合、アンビエントプロパティは無効になります。

### <a name="remarks"></a>Remarks

一部のコンテナーでは、のオーバーライドへの`COleControl::DoPropExchange`最初の呼び出し時に、コントロールがアンビエントプロパティにアクセスできない場合があります。 これは、 [IOleObject:: SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)を呼び出す前に、コンテナーが[IPersistStreamInit:: Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)または[IPersistStorage:: load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)を呼び出した場合 (つまり、OLEMISC_SETCLIENTSITEFIRST ステータスビットが受け入れられない場合) に発生します。

##  <a name="windowproc"></a>  COleControl::WindowProc

`COleControl`オブジェクトの Windows プロシージャを提供します。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>パラメーター

*message*<br/>
処理する Windows メッセージを指定します。

*wParam*<br/>
メッセージの処理に使用される追加情報を提供します。 パラメーター値は、メッセージによって異なります。

*lParam*<br/>
メッセージの処理に使用される追加情報を提供します。 パラメーター値は、メッセージによって異なります。

### <a name="return-value"></a>戻り値

ディスパッチされたメッセージの戻り値。

### <a name="remarks"></a>Remarks

この関数を呼び出して、コントロールのメッセージマップを通じて特定のメッセージをディスパッチします。

## <a name="see-also"></a>関連項目

[MFC のサンプル CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC のサンプル TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage クラス](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd クラス](../../mfc/reference/cwnd-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder クラス](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder クラス](../../mfc/reference/cpictureholder-class.md)<br/>
