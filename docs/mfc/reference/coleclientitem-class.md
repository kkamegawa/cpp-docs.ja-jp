---
title: COleClientItem クラス
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/06/2019
ms.locfileid: "70740875"
---
# <a name="coleclientitem-class"></a>COleClientItem クラス

OLE アイテムへのコンテナー インターフェイスを定義します。

## <a name="syntax"></a>構文

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>メンバー

### <a name="public-constructors"></a>パブリック コンストラクター

|名前|説明|
|----------|-----------------|
|[COleClientItem:: COleClientItem](#coleclientitem)|`COleClientItem` オブジェクトを構築します。|

### <a name="public-methods"></a>パブリック メソッド

|名前|説明|
|----------|-----------------|
|[COleClientItem:: Activate](#activate)|操作の OLE 項目を開き、指定された動詞を実行します。|
|[COleClientItem:: のアクティブな形式](#activateas)|項目を別の型としてアクティブにします。|
|[COleClientItem::AttachDataObject](#attachdataobject)|OLE オブジェクトのデータにアクセスします。|
|[COleClientItem:: CanCreateFromData](#cancreatefromdata)|コンテナーアプリケーションが埋め込みオブジェクトを作成できるかどうかを示します。|
|[COleClientItem:: CanCreateLinkFromData](#cancreatelinkfromdata)|コンテナーアプリケーションがリンクオブジェクトを作成できるかどうかを示します。|
|[COleClientItem:: CanPaste](#canpaste)|クリップボードに埋め込み OLE 項目または静的 OLE 項目が含まれているかどうかを示します。|
|[COleClientItem:: CanPasteLink](#canpastelink)|クリップボードにリンク可能 OLE 項目が含まれているかどうかを示します。|
|[COleClientItem:: Close](#close)|サーバーへのリンクを閉じますが、OLE 項目は破棄されません。|
|[COleClientItem:: Convertto-html](#convertto)|項目を別の型に変換します。|
|[COleClientItem:: CopyToClipboard](#copytoclipboard)|OLE 項目をクリップボードにコピーします。|
|[COleClientItem:: CreateCloneFrom](#createclonefrom)|既存の項目の複製を作成します。|
|[COleClientItem:: CreateFromClipboard](#createfromclipboard)|クリップボードから埋め込み項目を作成します。|
|[COleClientItem:: CreateFromData](#createfromdata)|データオブジェクトから埋め込みアイテムを作成します。|
|[COleClientItem:: CreateFromFile](#createfromfile)|ファイルから埋め込み項目を作成します。|
|[COleClientItem:: CreateLinkFromClipboard](#createlinkfromclipboard)|クリップボードからリンク項目を作成します。|
|[COleClientItem:: CreateLinkFromData](#createlinkfromdata)|データオブジェクトからリンク項目を作成します。|
|[COleClientItem:: CreateLinkFromFile](#createlinkfromfile)|ファイルからリンク項目を作成します。|
|[COleClientItem:: CreateNewItem](#createnewitem)|サーバーアプリケーションを起動して、新しい埋め込み項目を作成します。|
|[COleClientItem:: CreateStaticFromClipboard](#createstaticfromclipboard)|クリップボードから静的項目を作成します。|
|[COleClientItem:: CreateStaticFromData](#createstaticfromdata)|データオブジェクトから静的項目を作成します。|
|[COleClientItem::D eactivate](#deactivate)|項目を非アクティブにします。|
|[COleClientItem::D e Ui](#deactivateui)|コンテナーアプリケーションのユーザーインターフェイスを元の状態に復元します。|
|[COleClientItem::Delete](#delete)|OLE 項目がリンクされている場合は、その OLE 項目を削除または閉じます。|
|[COleClientItem::D oDragDrop](#dodragdrop)|ドラッグアンドドロップ操作を実行します。|
|[COleClientItem::D oVerb](#doverb)|指定された動詞を実行します。|
|[COleClientItem::D raw](#draw)|OLE 項目を描画します。|
|[COleClientItem:: GetActiveView](#getactiveview)|項目がアクティブになっているビューを取得します。|
|[COleClientItem:: GetCachedExtent](#getcachedextent)|OLE 項目の四角形の境界を返します。|
|[COleClientItem:: GetClassID](#getclassid)|現在の項目のクラス ID を取得します。|
|[COleClientItem:: GetClipboardData](#getclipboarddata)|`CopyToClipboard`メンバー関数を呼び出すことによって、クリップボードに配置されるデータを取得します。|
|[COleClientItem:: GetDocument](#getdocument)|現在の項目を格納しているオブジェクトを返します。`COleDocument`|
|[COleClientItem:: GetDrawAspect](#getdrawaspect)|表示する項目の現在のビューを取得します。|
|[COleClientItem:: GetExtent](#getextent)|OLE 項目の四角形の境界を返します。|
|[COleClientItem:: Geが Onfromregistry](#geticonfromregistry)|特定の CLSID のサーバーに関連付けられているアイコンへのハンドルを取得します。|
|[COleClientItem:: Geが Onicmetafile](#geticonicmetafile)|項目のアイコンを描画するために使用するメタファイルを取得します。|
|[COleClientItem:: Getinplace ウィンドウ](#getinplacewindow)|項目の埋め込み先編集ウィンドウへのポインターを返します。|
|[COleClientItem:: GetItemState](#getitemstate)|項目の現在の状態を取得します。|
|[COleClientItem:: GetLastStatus](#getlaststatus)|最後の OLE 操作の状態を返します。|
|[COleClientItem:: GetLinkUpdateOptions](#getlinkupdateoptions)|リンクされたアイテムの更新モードを返します (高度な機能)。|
|[COleClientItem:: GetType](#gettype)|OLE 項目の型 (埋め込み、リンク、または静的) を返します。|
|[COleClientItem:: GetUserType](#getusertype)|項目の型を説明する文字列を取得します。|
|[COleClientItem:: IsInPlaceActive](#isinplaceactive)|項目がアクティブである場合に TRUE を返します。|
|[COleClientItem:: IsLinkUpToDate](#islinkuptodate)|リンクされた項目がソースドキュメントと共に最新の状態である場合に TRUE を返します。|
|[COleClientItem::IsModified](#ismodified)|項目が最後に保存されてから変更されている場合は TRUE を返します。|
|[COleClientItem::IsOpen](#isopen)|項目が現在サーバーアプリケーションで開かれている場合に TRUE を返します。|
|[COleClientItem:: IsRunning](#isrunning)|項目のサーバーアプリケーションが実行されている場合に TRUE を返します。|
|[COleClientItem::OnActivate](#onactivate)|アクティブになったことを項目に通知するために、フレームワークによって呼び出されます。|
|[COleClientItem:: Onアクティブ Ui](#onactivateui)|アクティブになったことを項目に通知するためにフレームワークによって呼び出され、ユーザーインターフェイスを表示する必要があります。|
|[COleClientItem::OnChange](#onchange)|サーバーが OLE 項目を変更したときに呼び出されます。 実装が必要です。|
|[COleClientItem:: OnDeactivate](#ondeactivate)|項目が非アクティブになると、フレームワークによって呼び出されます。|
|[COleClientItem:: Ondeアクティブ化 Ui](#ondeactivateui)|サーバーがそのインプレースユーザーインターフェイスを削除したときに、フレームワークによって呼び出されます。|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|クリップボードにコピーされるデータを取得するために、フレームワークによって呼び出されます。|
|[COleClientItem:: OnInsertMenus](#oninsertmenus)|複合メニューを作成するためにフレームワークによって呼び出されます。|
|[COleClientItem:: OnRemoveMenus](#onremovemenus)|コンテナーのメニューを複合メニューから削除するために、フレームワークによって呼び出されます。|
|[COleClientItem:: OnSetMenu](#onsetmenu)|複合メニューをインストールおよび削除するために、フレームワークによって呼び出されます。|
|[COleClientItem:: OnShowControlBars](#onshowcontrolbars)|コントロールバーの表示と非表示を切り替えるためにフレームワークによって呼び出されます。|
|[COleClientItem:: Onupdateフレームタイトル](#onupdateframetitle)|フレームウィンドウのタイトルバーを更新するためにフレームワークによって呼び出されます。|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|項目を再アクティブ化し、最後のインプレース編集操作を元に戻します。|
|[COleClientItem::Release](#release)|OLE リンクアイテムへの接続を解放し、開いている場合は閉じます。 は、クライアント項目を破棄しません。|
|[COleClientItem::Reload](#reload)|の呼び出し後に`ActivateAs`項目を再読み込みします。|
|[COleClientItem::Run](#run)|項目に関連付けられているアプリケーションを実行します。|
|[COleClientItem:: SetDrawAspect](#setdrawaspect)|表示する項目の現在のビューを設定します。|
|[COleClientItem:: SetExtent](#setextent)|OLE 項目の外接する四角形を設定します。|
|[COleClientItem:: SetHostNames](#sethostnames)|OLE 項目の編集時にサーバーに表示される名前を設定します。|
|[COleClientItem:: SetIconicMetafile](#seticonicmetafile)|項目のアイコンの描画に使用するメタファイルをキャッシュします。|
|[COleClientItem:: SetItemRects](#setitemrects)|項目の外接する四角形を設定します。|
|[COleClientItem:: SetLinkUpdateOptions](#setlinkupdateoptions)|リンクアイテムの更新モードを設定します (高度な機能)。|
|[COleClientItem:: SetPrintDevice](#setprintdevice)|このクライアント項目の印刷ターゲットデバイスを設定します。|
|[COleClientItem:: UpdateLink](#updatelink)|項目のプレゼンテーションキャッシュを更新します。|

### <a name="protected-methods"></a>プロテクト メソッド

|名前|説明|
|----------|-----------------|
|[COleClientItem:: CanActivate](#canactivate)|インプレースアクティブ化が許可されているかどうかを判断するために、フレームワークによって呼び出されます。|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|項目の位置が変更されたときにフレームワークによって呼び出されます。|
|[COleClientItem:: Onde Andundo](#ondeactivateandundo)|アクティベーション後に元に戻すために、フレームワークによって呼び出されます。|
|[COleClientItem:: OnDiscardUndoState](#ondiscardundostate)|項目の元に戻す状態情報を破棄するために、フレームワークによって呼び出されます。|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|項目のクリッピング四角形の座標を取得するために、フレームワークによって呼び出されます。|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|項目の位置をビューに対して相対的に取得するために、フレームワークによって呼び出されます。|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|項目が適切にアクティブ化されたときにフレームワークによって呼び出されます。|
|[COleClientItem:: OnScrollBy](#onscrollby)|項目をビューにスクロールするために、フレームワークによって呼び出されます。|
|[COleClientItem:: OnShowItem](#onshowitem)|OLE 項目を表示するためにフレームワークによって呼び出されます。|

## <a name="remarks"></a>Remarks

OLE 項目は、サーバーアプリケーションによって作成および管理されるデータを表します。このデータは、ドキュメントに "シームレスに" 組み込むことができます。これにより、ユーザーが1つのドキュメントとして表示されるようになります。 その結果、OLE 項目とそれを含むドキュメントで構成される "複合ドキュメント" になります。

OLE 項目は、埋め込みまたはリンクすることができます。 埋め込まれている場合、そのデータは複合ドキュメントの一部として格納されます。 リンクされている場合、そのデータはサーバーアプリケーションによって作成された別のファイルの一部として格納され、そのファイルへのリンクのみが複合ドキュメントに格納されます。 すべての OLE アイテムには、それらを編集するために呼び出す必要があるサーバーアプリケーションを指定する情報が含まれています。

`COleClientItem`サーバーアプリケーションからの要求に応答して呼び出されるいくつかのオーバーライド可能な関数を定義します。これらの overridables は通常、通知として機能します。 これにより、サーバーアプリケーションは、OLE 項目を編集するときにユーザーが行った変更をコンテナーに通知したり、編集中に必要な情報を取得したりすることができます。

`COleClientItem`は、 [COleDocument](../../mfc/reference/coledocument-class.md)、 [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)、または[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)クラスで使用できます。 を使用`COleClientItem`するには、そのクラスからクラスを派生させ、 [OnChange](#onchange)メンバー関数を実装します。この関数は、コンテナーが項目に対して行われた変更にどのように応答するかを定義します。 インプレースアクティブ化をサポートするには、 [OnGetItemPosition](#ongetitemposition)メンバー関数をオーバーライドします。 この関数は、OLE 項目の表示位置に関する情報を提供します。

コンテナーインターフェイスの使用方法の詳細については、 [次の記事のコンテナーを参照してください。コンテナー](../../mfc/containers-implementing-a-container.md)と[アクティベーション](../../mfc/activation-cpp.md)を実装する。

> [!NOTE]
>  Windows SDK は、埋め込みおよびリンクされたアイテムを "オブジェクト" として参照し、アイテムの種類を "classes" として参照します。 このリファレンスでは、"item" という用語を使用して、 C++対応するオブジェクトから ole エンティティを区別し、"type" とC++いう用語を使用して、ole カテゴリをクラスと区別します。

## <a name="inheritance-hierarchy"></a>継承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>必要条件

**ヘッダー:** afxole

##  <a name="activate"></a>  COleClientItem::Activate

この関数を呼び出して、例外がスローされたときに独自の処理を実行できるように、 [DoVerb](#doverb)ではなく、指定された動詞を実行します。

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>パラメーター

*nVerb*<br/>
実行する動詞を指定します。 次のいずれかを指定できます。

|[値]|説明|シンボル|
|-----------|-------------|------------|
|- 0|主動詞|OLEIVERB_PRIMARY|
|- 1|2番目の動詞|(なし)|
|- 1|編集する項目の表示|OLEIVERB_SHOW|
|- 2|別のウィンドウで項目を編集する|OLEIVERB_OPEN|
|- 3|項目の非表示|OLEIVERB_HIDE|

-1 の値は、通常、別の動詞のエイリアスです。 開いている編集がサポートされていない場合、-2 は-1 と同じ効果があります。 その他の値については、Windows SDK の「 [IOleObject::D oVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 」を参照してください。

*pView*<br/>
OLE 項目を含むコンテナービューウィンドウへのポインター。これは、サーバーアプリケーションがインプレースアクティブ化に使用します。 コンテナーがインプレースアクティベーションをサポートしていない場合、このパラメーターは NULL にする必要があります。

*lpMsg*<br/>
項目がアクティブ化される原因となったメッセージへのポインター。

### <a name="remarks"></a>Remarks

サーバーアプリケーションが Microsoft Foundation Class ライブラリを使用して記述されている場合、この関数によって`COleServerItem` 、対応するオブジェクトの [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) メンバー関数が実行されます。

プライマリ動詞が Edit で、0が*nVerb*パラメーターに指定されている場合は、OLE 項目を編集できるようにサーバーアプリケーションが起動されます。 コンテナーアプリケーションがインプレースアクティブ化をサポートしている場合は、編集を行うことができます。 コンテナーがインプレースアクティブ化をサポートしていない場合 (または Open 動詞が指定されている場合)、サーバーは別のウィンドウで起動され、編集を行うことができます。 通常、コンテナーアプリケーションのユーザーが OLE 項目をダブルクリックすると、 *nVerb*パラメーターのプライマリ動詞の値によって、ユーザーが実行できるアクションが決まります。 ただし、サーバーがサポートしているアクションが1つだけの場合は、 *nVerb*パラメーターで指定した値に関係なく、そのアクションが実行されます。

詳細については、Windows SDK の「 [IOleObject::D oVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 」を参照してください。

##  <a name="activateas"></a>  COleClientItem::ActivateAs

は、OLE のオブジェクト変換機能を使用して、 *Clsidnew*によって指定された型の項目と同じように項目をアクティブ化します。

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>パラメーター

*lpszUserType*<br/>
"Word 文書" など、対象ユーザーの種類を表す文字列へのポインター。

*clsidOld*<br/>
項目の現在のクラス ID への参照。 クラス ID は、リンクでない限り、実際のオブジェクトの型を格納されているものとして表す必要があります。 この場合、リンクが参照する項目の CLSID である必要があります。 [Coleconvertdialog](../../mfc/reference/coleconvertdialog-class.md)は、項目の正しいクラス ID を自動的に提供します。

*clsidNew*<br/>
ターゲットクラス ID への参照。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

これは、Coleconvertdialog によって自動的に呼び出されます[::D oConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)。 通常は直接呼び出されません。

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

OLE 項目のデータにアクセスするための[COleDataObject](../../mfc/reference/coledataobject-class.md)を初期化するには、この関数を呼び出します。

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>パラメーター

*rDataObject*<br/>
OLE 項目内`COleDataObject`のデータへのアクセスを許可するために初期化されるオブジェクトへの参照。

##  <a name="canactivate"></a>COleClientItem:: CanActivate

OLE 項目のインプレースアクティベーションをユーザーが要求したときに、フレームワークによって呼び出されます。この関数の戻り値は、インプレースアクティブ化が許可されているかどうかを判断します。

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>戻り値

インプレースアクティブ化が許可されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、コンテナーに有効なウィンドウがある場合にインプレースアクティブ化が許可されます。 アクティベーション要求を受け入れたり拒否したりするための特別なロジックを実装するには、この関数をオーバーライドします。 たとえば、OLE 項目が小さすぎるか、現在表示されていない場合は、アクティベーション要求を拒否できます。

詳細については、Windows SDK の「 [IOleInPlaceSite:: Caninplace activate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) 」を参照してください。

##  <a name="cancreatefromdata"></a>COleClientItem:: CanCreateFromData

コンテナーアプリケーションが、指定さ`COleDataObject`れたオブジェクトから埋め込みオブジェクトを作成できるかどうかを確認します。

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
OLE 項目が作成される[COleDataObject](../../mfc/reference/coledataobject-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

コンテナーが`COleDataObject`オブジェクトから埋め込みオブジェクトを作成できる場合は0以外。それ以外の場合は0。

### <a name="remarks"></a>Remarks

`COleDataObject`クラスは、クリップボードからさまざまな形式のデータを取得するためのデータ転送、ドラッグアンドドロップ、または埋め込み OLE 項目からデータを取得するために使用されます。

コンテナーでは、この関数を使用して、[貼り付け] および [貼り付けの編集] の特殊なコマンドを有効または無効にすることができます。

詳細については、「[データオブジェクトとデータソース (OLE)](../../mfc/data-objects-and-data-sources-ole.md)」を参照してください。

##  <a name="cancreatelinkfromdata"></a>COleClientItem:: CanCreateLinkFromData

コンテナーアプリケーションが、指定さ`COleDataObject`れたオブジェクトからリンクオブジェクトを作成できるかどうかを確認します。

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
OLE 項目が作成される[COleDataObject](../../mfc/reference/coledataobject-class.md)オブジェクトへのポインター。

### <a name="return-value"></a>戻り値

コンテナーが`COleDataObject`オブジェクトからリンクオブジェクトを作成できる場合は0以外の。

### <a name="remarks"></a>Remarks

`COleDataObject`クラスは、クリップボードからさまざまな形式のデータを取得するためのデータ転送、ドラッグアンドドロップ、または埋め込み OLE 項目からデータを取得するために使用されます。

コンテナーでは、この関数を使用して、[Edit Paste Special] と [Edit Paste Link] の各コマンドを有効または無効にすることができます。

詳細については、「[データオブジェクトとデータソース (OLE)](../../mfc/data-objects-and-data-sources-ole.md)」を参照してください。

##  <a name="canpaste"></a>COleClientItem:: CanPaste

この関数を呼び出して、埋め込み OLE 項目をクリップボードから貼り付けることができるかどうかを確認します。

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>戻り値

埋め込み OLE 項目をクリップボードから貼り付けることができる場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

詳細については、Windows SDK の「 [Olegetclipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard) 」と「 [Olequerycreatefromdata](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) 」を参照してください。

##  <a name="canpastelink"></a>COleClientItem:: CanPasteLink

この関数を呼び出して、リンクされた OLE 項目をクリップボードから貼り付けることができるかどうかを確認します。

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>戻り値

クリップボードからリンクされた OLE 項目を貼り付けることができる場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

詳細については、「Windows SDK の[Olegetclipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard)と[Olequerylinkfromdata](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) 」を参照してください。

##  <a name="close"></a>COleClientItem:: Close

OLE 項目の状態を "実行中" から "読み込み済み" の状態に変更するには、この関数を呼び出します。つまり、メモリにハンドラーを読み込み、サーバーが実行されていない状態にします。

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>パラメーター

*dwCloseOption*<br/>
OLE 項目が読み込まれた状態に戻ったときに、どのような状況で OLE 項目を保存するかを指定するフラグ。 次のいずれかの値を指定できます。

- OLECLOSE_SAVEIFDIRTY OLE 項目を保存します。

- OLECLOSE_NOSAVE OLE 項目を保存しません。

- OLECLOSE_PROMPTSAVE OLE 項目を保存するかどうかをユーザーに確認します。

### <a name="remarks"></a>Remarks

OLE 項目が実行されていない場合、この関数は無効です。

詳細については、Windows SDK の「 [IOleObject:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) 」を参照してください。

##  <a name="coleclientitem"></a>COleClientItem:: COleClientItem

オブジェクトを`COleClientItem`構築し、それをコンテナードキュメントのドキュメント項目のコレクションに追加します。これC++により、オブジェクトだけが構築され、OLE の初期化は実行されません。

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>パラメーター

*pContainerDoc*<br/>
この項目を格納するコンテナードキュメントへのポインター。 これは、任意の[COleDocument](../../mfc/reference/coledocument-class.md)派生にすることができます。

### <a name="remarks"></a>Remarks

NULL ポインターを渡すと、コンテナードキュメントは追加されません。 [COleDocument:: AddItem](../../mfc/reference/coledocument-class.md#additem)を明示的に呼び出す必要があります。

OLE 項目を使用する前に、次の作成メンバー関数のいずれかを呼び出す必要があります。

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>COleClientItem:: Convertto-html

このメンバー関数を呼び出して、項目を*Clsidnew*によって指定された型に変換します。

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>パラメーター

*clsidNew*<br/>
対象の型のクラス ID。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

これは、 [Coleconvertdialog](../../mfc/reference/coleconvertdialog-class.md)によって自動的に呼び出されます。 直接呼び出す必要はありません。

##  <a name="copytoclipboard"></a>COleClientItem:: CopyToClipboard

OLE 項目をクリップボードにコピーするには、この関数を呼び出します。

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>パラメーター

*bIncludeLink*<br/>
リンク情報をクリップボードにコピーして、リンクされた項目を貼り付けることができる場合は TRUE。それ以外の場合は FALSE。

### <a name="remarks"></a>Remarks

通常、[編集] メニューの [コピー] または [切り取り] コマンドのメッセージハンドラーを記述するときに、この関数を呼び出します。 Copy コマンドまたは Cut コマンドを実装する場合は、コンテナーアプリケーションで項目選択を実装する必要があります。

詳細については、Windows SDK の[Olesetclipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard)に関する説明を参照してください。

##  <a name="createclonefrom"></a>COleClientItem:: CreateCloneFrom

指定した OLE 項目のコピーを作成するには、この関数を呼び出します。

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>パラメーター

*pSrcItem*<br/>
複製する OLE 項目へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

コピーは、ソースアイテムと同じです。 この関数を使用すると、元に戻す操作をサポートできます。

##  <a name="createfromclipboard"></a>COleClientItem:: CreateFromClipboard

クリップボードの内容から埋め込み項目を作成するには、この関数を呼び出します。

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

通常は、[編集] メニューの [貼り付け] コマンドのメッセージハンドラーからこの関数を呼び出します。 ( [CanPaste](#canpaste)メンバー関数が0以外の値を返す場合、フレームワークによって貼り付けコマンドが有効になります)。

詳細については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) and [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createfromdata"></a>COleClientItem:: CreateFromData

`COleDataObject`オブジェクトから埋め込みアイテムを作成するには、この関数を呼び出します。

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
OLE 項目が作成される[COleDataObject](../../mfc/reference/coledataobject-class.md)オブジェクトへのポインター。

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

クリップボードからの貼り付け、ドラッグアンドドロップ操作などのデータ転送操作では、 `COleDataObject`サーバーアプリケーションによって提供される情報を格納するオブジェクトが提供されます。 これは通常、 [CView:: OnDrop](../../mfc/reference/cview-class.md#ondrop)のオーバーライドで使用されます。

詳細については、Windows SDK の「 [OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createfromfile"></a>COleClientItem:: CreateFromFile

ファイルから埋め込み OLE 項目を作成するには、この関数を呼び出します。

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*lpszFileName*<br/>
OLE 項目の作成元となるファイルの名前へのポインター。

*clsid*<br/>
将来使用するために予約されています。

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>コメント

フレームワークからこの関数を呼び出します[クリック](../../mfc/reference/coleinsertdialog-class.md#createitem)場合は、ファイルから作成 を選択すると、ユーザーがオブジェクトの挿入 ダイアログ ボックスから [ok] を選択します。

詳細については、Windows SDK の「 [OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createlinkfromclipboard"></a>COleClientItem:: CreateLinkFromClipboard

クリップボードの内容からリンクされた項目を作成するには、この関数を呼び出します。

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

通常は、[編集] メニューの [リンクの貼り付け] コマンドのメッセージハンドラーからこの関数を呼び出します。 (クリップボードにリンク可能な OLE 項目が含まれている場合は、 [COleDocument](../../mfc/reference/coledocument-class.md)の既定の実装で [貼り付けリンク] コマンドが有効になっています)。

詳細については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) and [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createlinkfromdata"></a>COleClientItem:: CreateLinkFromData

`COleDataObject`オブジェクトからリンクされた項目を作成するには、この関数を呼び出します。

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
OLE 項目が作成される[COleDataObject](../../mfc/reference/coledataobject-class.md)オブジェクトへのポインター。

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

ユーザーがリンクを作成する必要がある場合は、drop 操作中にこれを呼び出します。 また、[貼り付けの編集] コマンドを処理するためにも使用できます。 このメソッドは、リンクオプションが`COleClientItem::CreateLinkFromClipboard`選択されている場合に、と[COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)のフレームワークによって呼び出されます。

詳細については、Windows SDK の「 [OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

ファイルからリンクされた OLE 項目を作成するには、この関数を呼び出します。

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*lpszFileName*<br/>
OLE 項目の作成元となるファイルの名前へのポインター。

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

[ファイルから作成] ボタンを選択し、[リンク] チェックボックスをオンにすると、ユーザーが [オブジェクトの挿入] ダイアログボックスから [OK] を選択した場合、フレームワークはこの関数を呼び出します。 [COleInsertDialog:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)から呼び出されます。

詳細については、Windows SDK の「 [OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

埋め込み項目を作成するには、この関数を呼び出します。この関数は、ユーザーが OLE 項目を作成できるようにするサーバーアプリケーションを起動します。

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*clsid*<br/>
作成する OLE 項目の種類を一意に識別する ID。

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

[新規作成] ボタンを選択したときに、ユーザーが [オブジェクトの挿入] ダイアログボックスから [OK] を選択した場合、フレームワークはこの関数を呼び出します。

詳細については、Windows SDK の「 [OleCreate](/windows/win32/api/ole/nf-ole-olecreate)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createstaticfromclipboard"></a>COleClientItem:: CreateStaticFromClipboard

クリップボードの内容から静的項目を作成するには、この関数を呼び出します。

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

静的項目はプレゼンテーションデータを含みますが、ネイティブデータは含まれません。したがって、編集することはできません。 通常、 [Createfromclipboard](#createfromclipboard)メンバー関数が失敗した場合は、この関数を呼び出します。

詳細については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) and [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="createstaticfromdata"></a>COleClientItem:: CreateStaticFromData

`COleDataObject`オブジェクトから静的項目を作成するには、この関数を呼び出します。

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataObject*<br/>
OLE 項目が作成される[COleDataObject](../../mfc/reference/coledataobject-class.md)オブジェクトへのポインター。

*なる*<br/>
サーバーが OLE 項目を表示する方法を指定するフラグ。 使用可能な値については、Windows SDK の「 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 」を参照してください。

*cfFormat*<br/>
OLE 項目の作成時にキャッシュするクリップボードデータ形式を指定します。

*lpFormatEtc*<br/>
*Render*が OLERENDER_FORMAT または OLERENDER_DRAW の場合に使用される[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)構造体へのポインター。 *CfFormat*で指定されたクリップボード形式以外の追加の書式情報を指定する場合にのみ、このパラメーターの値を指定してください。 このパラメーターを省略すると、 `FORMATETC`構造体の他のフィールドに既定値が使用されます。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

静的項目はプレゼンテーションデータを含みますが、ネイティブデータは含まれません。したがって、編集することはできません。 これは、基本的には、クリップボードからではなく任意`COleDataObject`のから静的項目を作成できる点を除いて、 [createstaticfromclipboard](#createstaticfromclipboard)と同じです。

Static が選択されている場合、 [COlePasteSpecialDialog:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)で使用されます。

詳細については、Windows SDK の「 [OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)、および[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 」を参照してください。

##  <a name="deactivate"></a>COleClientItem::D eactivate

OLE 項目を非アクティブ化し、関連付けられているすべてのリソースを解放するには、この関数を呼び出します。

```
void Deactivate();
```

### <a name="remarks"></a>Remarks

通常は、ユーザーがアイテムの境界外のクライアント領域でマウスをクリックしたときに、埋め込み先のアクティブな OLE アイテムを非アクティブ化します。 OLE 項目を非アクティブ化すると、元に戻す状態が破棄され、再アクティブ化[andundo](#reactivateandundo)メンバー関数を呼び出すことができなくなることに注意してください。

アプリケーションで undo がサポートされている`Deactivate`場合は、を呼び出さないでください。代わりに、 [deの ui](#deactivateui)を呼び出してください。

詳細については、Windows SDK の「 [IOleInPlaceObject:: Inplace deactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) 」を参照してください。

##  <a name="deactivateui"></a>COleClientItem::D e Ui

インプレースでアクティブ化された項目をユーザーが非アクティブにしたときに、この関数を呼び出します。

```
void DeactivateUI();
```

### <a name="remarks"></a>Remarks

この関数は、コンテナーアプリケーションのユーザーインターフェイスを元の状態に復元し、埋め込み先アクティベーション用に作成されたメニューやその他のコントロールを非表示にします。

この関数は、項目の元に戻す状態情報をフラッシュしません。 この情報は保持されます。そのため、後で再アクティブ化[Andundo](#reactivateandundo)を使用して、サーバーアプリケーションで元に戻すコマンドを実行できます。これは、項目を非アクティブにした直後にコンテナーの undo コマンドを選択した場合に発生します。

詳細については、Windows SDK の「 [IOleInPlaceObject:: Inplace deactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) 」を参照してください。

##  <a name="delete"></a>  COleClientItem::Delete

この関数を呼び出して、コンテナードキュメントから OLE 項目を削除します。

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>パラメーター

*bAutoDelete*<br/>
項目をドキュメントから削除するかどうかを指定します。

### <a name="remarks"></a>Remarks

この関数は、 [Release](#release)メンバー関数を呼び出します。これにC++より、項目のオブジェクトが削除され、ドキュメントから OLE 項目が完全に削除されます。 OLE 項目が埋め込まれている場合は、項目のネイティブデータが削除されます。 実行中のサーバーを常に閉じます。このため、項目が開いているリンクの場合、この関数は閉じます。

##  <a name="dodragdrop"></a>COleClientItem::D oDragDrop

`DoDragDrop`メンバー関数を呼び出して、ドラッグアンドドロップ操作を実行します。

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>パラメーター

*lpItemRect*<br/>
クライアント座標 (ピクセル) の画面上の項目の四角形。

*ptOffset*<br/>
ドラッグ時のマウス位置の*lpItemRect*からのオフセット。

*bIncludeLink*<br/>
リンクデータをクリップボードにコピーする場合は、TRUE に設定します。 サーバーアプリケーションがリンクをサポートしていない場合は、FALSE に設定します。

*dwEffects*<br/>
ドラッグ元がドラッグ操作で許可する効果を決定します。

*lpRectStartDrag*<br/>
ドラッグが実際に開始される場所を定義する四角形へのポインター。 詳細については、「解説」を参照してください。

### <a name="return-value"></a>戻り値

DROPEFFECT 値。 DROPEFFECT_MOVE の場合は、元のデータを削除する必要があります。

### <a name="remarks"></a>Remarks

ドラッグアンドドロップ操作はすぐには開始されません。 マウスカーソルが、 *lpRectStartDrag*で指定された四角形から離れるか、指定されたミリ秒数が経過するまで待機します。 *LpRectStartDrag*が NULL の場合、四角形のサイズは1ピクセルです。

遅延時間は、レジストリキーの設定によって指定されます。 遅延時間を変更するには、 [cwinapp:: WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)または[Cwinapp:: writeprofilestring](../../mfc/reference/cwinapp-class.md#writeprofileint)を呼び出します。 遅延時間を指定しない場合は、既定値の200ミリ秒が使用されます。 ドラッグの遅延時間は次のように格納されます。

- Windows NT のドラッグ遅延時間は HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay. に格納されます

- Windows 3.x のドラッグ遅延時間は、WIN に格納されます。INI ファイル ([Windows}] セクションの下)。

- Windows 95/98 のドラッグ遅延時間は、WIN のキャッシュされたバージョンに格納されます.INI.

ドラッグ遅延情報をレジストリまたはに格納する方法の詳細については、「」を参照してください。INI ファイルの「Windows SDK の[Writeprofilestring](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) 」を参照してください。

##  <a name="doverb"></a>COleClientItem::D oVerb

を`DoVerb`呼び出して、指定された動詞を実行します。

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>パラメーター

*nVerb*<br/>
実行する動詞を指定します。 次のいずれかを含めることができます。

|[値]|説明|シンボル|
|-----------|-------------|------------|
|- 0|主動詞|OLEIVERB_PRIMARY|
|- 1|2番目の動詞|(なし)|
|- 1|編集する項目の表示|OLEIVERB_SHOW|
|- 2|別のウィンドウで項目を編集する|OLEIVERB_OPEN|
|- 3|項目の非表示|OLEIVERB_HIDE|

-1 の値は、通常、別の動詞のエイリアスです。 開いている編集がサポートされていない場合、-2 は-1 と同じ効果があります。 その他の値については、Windows SDK の「 [IOleObject::D oVerb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 」を参照してください。

*pView*<br/>
ビューウィンドウへのポインター。これは、サーバーがインプレースアクティブ化に使用します。 コンテナーアプリケーションでインプレースアクティベーションが許可されていない場合、このパラメーターは NULL にする必要があります。

*lpMsg*<br/>
項目がアクティブ化される原因となったメッセージへのポインター。

### <a name="return-value"></a>戻り値

動詞が正常に実行された場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

この関数は、[アクティベーション](#activate)メンバー関数を呼び出して動詞を実行します。 また、例外をキャッチし、スローされた場合はメッセージボックスをユーザーに表示します。

プライマリ動詞が Edit で、0が*nVerb*パラメーターに指定されている場合は、OLE 項目を編集できるようにサーバーアプリケーションが起動されます。 コンテナーアプリケーションがインプレースアクティブ化をサポートしている場合は、編集を行うことができます。 コンテナーがインプレースアクティブ化をサポートしていない場合 (または Open 動詞が指定されている場合)、サーバーは別のウィンドウで起動され、編集を行うことができます。 通常、コンテナーアプリケーションのユーザーが OLE 項目をダブルクリックすると、 *nVerb*パラメーターのプライマリ動詞の値によって、ユーザーが実行できるアクションが決まります。 ただし、サーバーがサポートしているアクションが1つだけの場合は、 *nVerb*パラメーターで指定した値に関係なく、そのアクションが実行されます。

##  <a name="draw"></a>COleClientItem::D raw

この関数を呼び出して、指定したデバイスコンテキストを使用して、指定した外接する四角形に OLE 項目を描画します。

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>パラメーター

*pDC*<br/>
OLE 項目の描画に使用される[CDC](../../mfc/reference/cdc-class.md)オブジェクトへのポインター。

*lpBounds*<br/>
OLE 項目の描画に使用`RECT`する外接する四角形を定義する、[CRect](../../atl-mfc-shared/reference/crect-class.md) オブジェクトまたは構造体へのポインター (デバイスコンテキストによって決定される論理単位)。

*nDrawAspect*<br/>
OLE 項目の側面、つまり、どのように表示するかを指定します。 *Ndrawaspect*が-1 の場合は、 [setdrawaspect](#setdrawaspect)を使用して最後に設定したアスペクトが使用されます。 このフラグの有効な値の詳細については、「 [Setdrawaspect](#setdrawaspect)」を参照してください。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

関数は、の`COleServerItem` [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)メンバー関数によって作成された OLE 項目のメタファイル表現を使用する場合があります。

通常は、 `Draw`画面の表示にを使用して、画面のデバイスコンテキストを*pDC*として渡します。 この場合は、最初の2つのパラメーターのみを指定する必要があります。

*LpBounds*パラメーターは、ターゲットデバイスコンテキスト内の四角形を識別します (現在のマッピングモードに対する相対)。 レンダリングでは、画像の拡大縮小が必要になる場合があります。また、コンテナーアプリケーションで使用して、表示されるビューと最終的に印刷される画像の間に拡大縮小するビューを設定することもできます。

詳細については、Windows SDK の「 [Iviewobject::D raw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) 」を参照してください。

##  <a name="getactiveview"></a>COleClientItem:: GetActiveView

項目がアクティブになっているビューを返します。

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>戻り値

ビューへのポインター。それ以外の場合は、項目が埋め込み先でアクティブ化されていない場合は NULL。

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

OLE 項目のサイズを取得するには、この関数を呼び出します。

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>パラメーター

*lpSize*<br/>
サイズ情報を`SIZE`受け取る構造体または[CSize](../../atl-mfc-shared/reference/csize-class.md)オブジェクトへのポインター。

*nDrawAspect*<br/>
範囲を取得する OLE 項目の側面を指定します。 使用可能な値については、「 [Setdrawaspect](#setdrawaspect)」を参照してください。

### <a name="return-value"></a>戻り値

成功した場合は0以外の。OLE 項目が空白の場合は0。

### <a name="remarks"></a>Remarks

この関数は、 [Getextent](#getextent)と同じ情報を提供します。 ただし、を呼び出し`GetCachedExtent`て、他の OLE ハンドラー ( [OnChange](#onchange)など) の処理中にエクステント情報を取得することができます。 ディメンションは MM_HIMETRIC 単位です。

では、 `GetCachedExtent` [IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject)インターフェイスを使用してこの項目の範囲を取得するのではなく、 [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2)インターフェイスを使用するため、これが可能です。 COM `IViewObject2`オブジェクトは、前の[iviewobject](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)への呼び出しで使用されたエクステント情報 (:D raw) をキャッシュします。

詳細については、Windows SDK の「 [IViewObject2:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) 」を参照してください。

##  <a name="getclassid"></a>COleClientItem:: GetClassID

*Pclassid*が指すメモリに項目のクラス ID を返します。

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>パラメーター

*pClassID*<br/>
クラス ID を取得するための、 [CLSID](/windows/win32/com/clsid-key-hklm)型の識別子へのポインター。 CLSID の詳細については、Windows SDK を参照してください。

### <a name="remarks"></a>Remarks

クラス ID は、項目を編集するアプリケーションを一意に識別する128ビットの数値です。

詳細については、Windows SDK の「 [IPersist:: GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) 」を参照してください。

##  <a name="getclipboarddata"></a>COleClientItem:: GetClipboardData

この関数を呼び出して、 `COleDataSource` [copytoclipboard](#copytoclipboard)メンバー関数の呼び出しによってクリップボードに配置されるすべてのデータを含むオブジェクトを取得します。

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>パラメーター

*pDataSource*<br/>
OLE アイテムに格納されているデータを受け取る[COleDataSource](../../mfc/reference/coledatasource-class.md)オブジェクトへのポインター。

*bIncludeLink*<br/>
リンクデータを含める必要がある場合は TRUE。それ以外の場合は FALSE。

*lpOffset*<br/>
オブジェクトの原点からのマウスカーソルのオフセット (ピクセル単位)。

*lpSize*<br/>
オブジェクトのサイズ (ピクセル単位)。

### <a name="remarks"></a>Remarks

`GetClipboardData`は、 [OnGetClipboardData](#ongetclipboarddata)の既定の実装として呼び出されます。 に`OnGetClipboardData`よって`CopyToClipboard`提供されるデータ形式だけでなく、データ形式を提供する場合にのみオーバーライドします。 を呼び出し`COleDataSource` `CopyToClipboard`た前または後に、これらの形式をオブジェクトに配置し、`COleDataSource` オブジェクトを [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) 関数に渡します。 たとえば、コンテナードキュメント内の OLE 項目の位置がクリップボードに付随するようにするには、その情報を渡すための独自の形式を定義し、を呼び出す`COleDataSource` `CopyToClipboard`前にその情報をに配置します。

##  <a name="getdocument"></a>COleClientItem:: GetDocument

OLE 項目が含まれているドキュメントへのポインターを取得するには、この関数を呼び出します。

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>戻り値

OLE 項目を格納しているドキュメントへのポインター。 項目がドキュメントの一部でない場合は NULL。

### <a name="remarks"></a>Remarks

このポインターは、引数と`COleDocument`して`COleClientItem`コンストラクターに渡されたオブジェクトへのアクセスを許可します。

##  <a name="getdrawaspect"></a>COleClientItem:: GetDrawAspect

`GetDrawAspect`メンバー関数を呼び出して、項目の現在の "アスペクト" またはビューを確認します。

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>戻り値

値が[Setdrawaspect](#setdrawaspect)の参照に一覧表示されている dvaspect 列挙子の値。

### <a name="remarks"></a>Remarks

アスペクトは、アイテムをどのように表示するかを指定します。

##  <a name="getextent"></a>COleClientItem:: GetExtent

OLE 項目のサイズを取得するには、この関数を呼び出します。

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>パラメーター

*lpSize*<br/>
サイズ情報を`SIZE`受け取る構造体`CSize`またはオブジェクトへのポインター。

*nDrawAspect*<br/>
範囲を取得する OLE 項目の側面を指定します。 使用可能な値については、「 [Setdrawaspect](#setdrawaspect)」を参照してください。

### <a name="return-value"></a>戻り値

成功した場合は0以外の。OLE 項目が空白の場合は0。

### <a name="remarks"></a>Remarks

サーバーアプリケーションが Microsoft Foundation Class ライブラリを使用して記述されている場合、この関数によって`COleServerItem` 、対応するオブジェクトの [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) メンバー関数が呼び出されます。 取得したサイズは、 [Setextent](#setextent)メンバー関数によって最後に設定されたサイズと異なる場合があることに注意してください。によって`SetExtent`指定されたサイズは、候補として扱われます。 ディメンションは MM_HIMETRIC 単位です。

> [!NOTE]
>  [OnChange](#onchange) などの`GetExtent` OLE ハンドラーの処理中は、を呼び出さないでください。 代わりに[Getcachedextent](#getcachedextent)を呼び出してください。

詳細については、Windows SDK の「 [IOleObject:: GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) 」を参照してください。

##  <a name="geticonfromregistry"></a>COleClientItem:: Geが Onfromregistry

このメンバー関数を呼び出して、特定の CLSID のサーバーに関連付けられているアイコンリソースへのハンドルを取得します。

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>パラメーター

*clsid*<br/>
アイコンに関連付けられているサーバーの CLSID への参照。

### <a name="return-value"></a>戻り値

アイコンリソースへの有効なハンドル。サーバーのアイコンまたは既定のアイコンが見つからない場合は NULL。

### <a name="remarks"></a>Remarks

このメンバー関数は、サーバーが既に実行されている場合でも、サーバーを起動したり、アイコンを動的に取得したりすることはありません。 代わりに、このメンバー関数は、サーバーの実行可能イメージを開き、登録時にサーバーに関連付けられている静的アイコンを取得します。

##  <a name="geticonicmetafile"></a>COleClientItem:: Geが Onicmetafile

項目のアイコンを描画するために使用するメタファイルを取得します。

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>戻り値

成功した場合はメタファイルへのハンドル。それ以外の場合は NULL。

### <a name="remarks"></a>Remarks

現在のアイコンがない場合は、既定のアイコンが返されます。 これは、MFC または OLE ダイアログによって自動的に呼び出され、通常は直接呼び出されません。

また、この関数は[Seticonicmetafile](#seticonicmetafile)を呼び出して、後で使用できるようにメタファイルをキャッシュします。

##  <a name="getinplacewindow"></a>COleClientItem:: Getinplace ウィンドウ

`GetInPlaceWindow`メンバー関数を呼び出して、埋め込み先編集のために項目が開かれているウィンドウへのポインターを取得します。

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>戻り値

項目の埋め込み先編集ウィンドウへのポインター。項目がアクティブでない場合、またはそのサーバーが使用できない場合は NULL。

### <a name="remarks"></a>Remarks

この関数は、埋め込み先のアクティブな項目に対してのみ呼び出す必要があります。

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

OLE 項目の現在の状態を取得するには、この関数を呼び出します。

```
UINT GetItemState() const;
```

### <a name="return-value"></a>戻り値

`emptyState`列挙値`loadedState`。、 、`activeState`、、の`activeUIState`いずれかを指定できます。 `COleClientItem::ItemState` `openState` これらの状態の詳細については[、次の記事のコンテナーを参照してください。クライアントアイテムの状態](../../mfc/containers-client-item-states.md)。

### <a name="remarks"></a>Remarks

OLE 項目の状態が変化したときに通知を受けるには、 [OnChange](#onchange)メンバー関数を使用します。

詳細については、次[の記事を参照してください。クライアントアイテムの状態](../../mfc/containers-client-item-states.md)。

##  <a name="getlaststatus"></a>COleClientItem:: GetLastStatus

最後の OLE 操作のステータスコードを返します。

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>戻り値

SCODE 値。

### <a name="remarks"></a>Remarks

ブール値 FALSE を返すメンバー関数、または NULL を返すその他のメンバー関数の`GetLastStatus`場合は、より詳細なエラー情報が返されます。 多くの OLE メンバー関数は、より重大なエラーに対して例外をスローすることに注意してください。 SCODE の解釈に関する具体的な情報は、最後に SCODE 値を返した基になる OLE 呼び出しによって異なります。

SCODE の詳細については、Windows SDK のドキュメントの「 [COM エラーコードの構造](/windows/win32/com/structure-of-com-error-codes)」を参照してください。

##  <a name="getlinkupdateoptions"></a>COleClientItem:: GetLinkUpdateOptions

OLE 項目のリンク更新オプションの現在の値を取得するには、この関数を呼び出します。

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>戻り値

次のいずれかの値です。

- OLEUPDATE_ALWAYS リンクアイテムを可能な限り更新します。 このオプションは、[リンク] ダイアログボックスの [自動リンク-更新] オプションボタンをサポートしています。

- OLEUPDATE_ONCALL は、コンテナーアプリケーションからの要求に対してのみリンク項目を更新します ( [UpdateLink](#updatelink)メンバー関数が呼び出された場合)。 このオプションでは、[リンク] ダイアログボックスの [手動リンク-更新] オプションボタンがサポートされています。

### <a name="remarks"></a>Remarks

これは高度な操作です。

この関数は、 [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)クラスによって自動的に呼び出されます。

詳細については、Windows SDK の「 [IOleLink:: GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) 」を参照してください。

##  <a name="gettype"></a>COleClientItem:: GetType

OLE 項目が埋め込まれているか、リンクされているか、または静的であるかを確認するには、この関数を呼び出します。

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>戻り値

次のいずれかの値を持つ符号なし整数。

- OT_LINK OLE 項目はリンクです。

- OT_EMBEDDED OLE 項目が埋め込まれていることを示します。

- OT_STATIC OLE 項目は静的であり、ネイティブデータではなくプレゼンテーションデータのみが含まれているため、編集できません。

##  <a name="getusertype"></a>COleClientItem:: GetUserType

この関数を呼び出して、"Word 文書" など、OLE 項目の種類を説明する、ユーザーが参照できる文字列を取得します。

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>パラメーター

*nUserClassType*<br/>
OLE 項目の型を記述する文字列の必要なバリアントを示す値。 次のいずれかの値を指定できます。

- USERCLASSTYPE_FULL は、ユーザーに表示される完全な型名を指定します。

- ポップアップメニューおよび [リンクの編集] ダイアログボックスで使用する短い名前 (最大15文字) を USERCLASSTYPE_SHORT します。

- USERCLASSTYPE_APPNAME クラスにサービスを提供するアプリケーションの名前を指定します。

*rString*<br/>
OLE 項目の型を記述する文字列が返される[CString](../../atl-mfc-shared/reference/cstringt-class.md)オブジェクトへの参照。

### <a name="remarks"></a>Remarks

これは、多くの場合、システム登録データベースのエントリです。

完全な型名が要求されていても使用できない場合は、短い名前が代わりに使用されます。 登録データベースで OLE 項目の種類のエントリが見つからない場合、または OLE 項目の種類に対してユーザー型が登録されていない場合は、OLE 項目に現在格納されているユーザーの種類が使用されます。 そのユーザーの種類名が空の文字列の場合は、"Unknown Object" が使用されます。

詳細については、Windows SDK の「 [IOleObject:: GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) 」を参照してください。

##  <a name="isinplaceactive"></a>COleClientItem:: IsInPlaceActive

OLE 項目がアクティブであるかどうかを確認するには、この関数を呼び出します。

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>戻り値

OLE 項目がアクティブである場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

項目が適切に編集されているかどうかによって、異なるロジックを実行するのが一般的です。 関数は、現在の項目の状態が`activeState`またはの`activeUIState`いずれかと等しいかどうかをチェックします。

##  <a name="islinkuptodate"></a>COleClientItem:: IsLinkUpToDate

OLE 項目が最新であるかどうかを確認するには、この関数を呼び出します。

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が最新の場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

ソースドキュメントが更新されている場合、リンクされた項目は最新ではない可能性があります。 リンクが含まれている埋め込み項目は、同様に古くなる可能性があります。 関数は、OLE 項目の再帰的なチェックを行います。 OLE 項目が古くなっているかどうかを判断することは、実際に更新を実行する場合と比べてコストが高くなる可能性があることに注意してください。

これは、 [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)の実装によって自動的に呼び出されます。

詳細については、Windows SDK の「 [IOleObject:: IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) 」を参照してください。

##  <a name="ismodified"></a>  COleClientItem::IsModified

OLE 項目がダーティである (最後に保存されてから変更された) かどうかを確認するには、この関数を呼び出します。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>戻り値

OLE 項目がダーティの場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

詳細については、Windows SDK の「 [IPersistStorage:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) 」を参照してください。

##  <a name="isopen"></a>  COleClientItem::IsOpen

OLE 項目が開いているかどうかを確認するには、この関数を呼び出します。つまり、別のウィンドウで実行されているサーバーアプリケーションのインスタンスで開かれます。

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が開いている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

これは、陰影パターンを使用してオブジェクトを描画するタイミングを決定するために使用されます。 開いているオブジェクトには、オブジェクトの上にハッチパターンが描画される必要があります。 これを行うには、 [CRectTracker](../../mfc/reference/crecttracker-class.md)オブジェクトを使用します。

##  <a name="isrunning"></a>  COleClientItem::IsRunning

OLE 項目が実行されているかどうかを確認するには、この関数を呼び出します。つまり、アイテムが読み込まれ、サーバーアプリケーションで実行されているかどうかを示します。

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>戻り値

OLE 項目が実行されている場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

詳細については、Windows SDK の「 [OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) 」を参照してください。

##  <a name="onactivate"></a>  COleClientItem::OnActivate

すぐにアクティブ化されたことを項目に通知するために、フレームワークによって呼び出されます。

```
virtual void OnActivate();
```

### <a name="remarks"></a>Remarks

この関数は、サーバーが実行されていることを示すために呼び出され、ユーザーインターフェイスがコンテナーアプリケーションにインストールされていることを示すものではないことに注意してください。 この時点で、オブジェクトにはアクティブなユーザーインターフェイスがありません ( `activeUIState`はではありません)。 メニューまたはツールバーがインストールされていません。 [Onアクティブ ui](#onactivateui)メンバー関数は、発生したときに呼び出されます。

既定の実装は、パラメーターとして OLE_CHANGEDSTATE を使用して[OnChange](#onchange)メンバー関数を呼び出します。 項目がアクティブな状態になったときにカスタム処理を実行するには、この関数をオーバーライドします。

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

フレームワークは、 `OnActivateUI`オブジェクトがアクティブな UI 状態に入ったときにを呼び出します。

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Remarks

これで、オブジェクトのツールバーとメニューがインストールされました。

既定の実装では、後で`GetServerWindow`を呼び出すためにサーバーの HWND が記憶されます。

##  <a name="onchange"></a>  COleClientItem::OnChange

ユーザーが OLE 項目を変更、保存、または閉じるときに、フレームワークによって呼び出されます。

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>パラメーター

*nCode*<br/>
サーバーがこの項目を変更した理由。 次のいずれかの値を指定できます。

- OLE_CHANGED OLE 項目の外観が変更されました。

- OLE_SAVED OLE 項目が保存されました。

- OLE_CLOSED OLE 項目が閉じられています。

- OLE_CHANGED_STATE OLE 項目がある状態から別の状態に変更されました。

*dwParam*<br/>
*NCode*が OLE_SAVED または OLE_CLOSED の場合、このパラメーターは使用されません。 *NCode*が OLE_CHANGED の場合、このパラメーターは、変更された OLE 項目の縦横比を指定します。 使用可能な値については、 [COleClientItem::D raw](#draw)の*dwparam*パラメーターを参照してください。 *NCode*が OLE_CHANGED_STATE の場合、このパラメーターは`COleClientItem::ItemState`列挙値であり、入力されている状態を示します。 `emptyState` 、`loadedState`、 、`activeState`、または`activeUIState`のいずれかの値を指定できます。 `openState`

### <a name="remarks"></a>Remarks

(サーバーアプリケーションが Microsoft Foundation Class ライブラリを使用して記述されている場合、この関数は`Notify`または`COleServerItem`の`COleServerDoc`メンバー関数への応答として呼び出されます)。既定の実装は、 *nCode*が OLE_CHANGED または OLE_SAVED の場合、コンテナードキュメントを変更済みとしてマークします。

OLE_CHANGED_STATE の場合、 [GetItemState](#getitemstate)から返される現在の状態は、以前の状態になります。これは、この状態が変更される前の状態であることを意味します。

OLE 項目の状態の変更に応答するには、この関数をオーバーライドします。 通常、項目が表示される領域を無効にして、項目の外観を更新します。 オーバーライドの先頭で基底クラスの実装を呼び出します。

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

OLE 項目のエクステントがインプレースアクティベーション中に変更されたことをコンテナーに通知するために、フレームワークによって呼び出されます。

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>パラメーター

*rectPos*<br/>
コンテナーアプリケーションのクライアント領域に対して相対的な項目の位置を示します。

### <a name="return-value"></a>戻り値

項目の位置が正常に変更された場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

既定の実装では、OLE 項目の新しい表示される四角形が決定され、新しい値を使用して[SetItemRects](#setitemrects)が呼び出されます。 既定の実装では、項目の表示可能な四角形が計算され、その情報がサーバーに渡されます。

この関数をオーバーライドして、サイズ変更/移動操作に特殊なルールを適用します。 アプリケーションが MFC で記述されている場合、この呼び出しの結果として、 [COleServerDoc:: RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)という名前のサーバーが返されます。

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

OLE 項目が埋め込み先のアクティブ状態 ( `activeState`) から読み込まれた状態に遷移するときに、フレームワークによって呼び出されます。これは、埋め込み先のアクティブ化の後に非アクティブになることを意味します。

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Remarks

OLE 項目が閉じていることを示すために、この関数が呼び出されます。これは、ユーザーインターフェイスがコンテナーアプリケーションから削除されていることを示します。 この場合、 [Ondeアクティブ化 ui](#ondeactivateui)メンバー関数が呼び出されます。

既定の実装は、パラメーターとして OLE_CHANGEDSTATE を使用して[OnChange](#onchange)メンバー関数を呼び出します。 埋め込み先のアクティブな項目が非アクティブになったときにカスタム処理を実行するには、この関数をオーバーライドします。 たとえば、コンテナーアプリケーションで [元に戻す] コマンドをサポートしている場合は、この関数をオーバーライドして元に戻す状態を破棄することができます。これは、アイテムが非アクティブになると、OLE アイテムに対して最後に実行された操作を元に戻すことができないことを示します。

##  <a name="ondeactivateandundo"></a>COleClientItem:: Onde Andundo

OLE 項目をアクティブ化した後に、ユーザーが元に戻すコマンドを呼び出したときに、フレームワークによって呼び出されます。

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Remarks

既定の実装では、サーバーのユーザーインターフェイスを非アクティブ化するために[Deの ui](#deactivateui)が呼び出されます。 コンテナーアプリケーションで undo コマンドを実装する場合は、この関数をオーバーライドします。 オーバーライドで、関数の基本クラスバージョンを呼び出し、アプリケーションで最後に実行されたコマンドを元に戻します。

詳細については、Windows SDK の「 [IOleInPlaceSite::D e Andundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) 」を参照してください。

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

インプレースでアクティブ化された項目をユーザーが非アクティブにしたときに呼び出されます。

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>パラメーター

*bUndoable*<br/>
編集の変更を取り消し可能にするかどうかを指定します。

### <a name="remarks"></a>Remarks

この関数は、コンテナーアプリケーションのユーザーインターフェイスを元の状態に復元し、埋め込み先アクティベーション用に作成されたメニューやその他のコントロールを非表示にします。

*BUndoable*が FALSE の場合、コンテナーは元に戻すコマンドを無効にする必要があります。これは、サーバーによって最後に実行された操作が取り消し可能でないことを示しているためです。

##  <a name="ondiscardundostate"></a>COleClientItem:: OnDiscardUndoState

OLE 項目の編集中に元に戻す状態を破棄するアクションをユーザーが実行したときに、フレームワークによって呼び出されます。

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Remarks

既定の実装では、何も行われません。 コンテナーアプリケーションで undo コマンドを実装する場合は、この関数をオーバーライドします。 オーバーライドで、コンテナーアプリケーションの元に戻す状態を破棄します。

サーバーに Microsoft Foundation Class ライブラリが記述されている場合は、 [COleServerDoc::D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate)を呼び出すことによって、この関数が呼び出される可能性があります。

詳細については、Windows SDK の「 [IOleInPlaceSite::D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) 」を参照してください。

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

[Copytoclipboard](#copytoclipboard)または[system.windows.dragdrop.dodragdrop](#dodragdrop)メンバー `COleDataSource`関数の呼び出しによってクリップボードに配置されるすべてのデータを格納するオブジェクトを取得するために、フレームワークによって呼び出されます。

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>パラメーター

*bIncludeLink*<br/>
リンクデータをクリップボードにコピーする必要がある場合は、TRUE に設定します。 サーバーアプリケーションがリンクをサポートしていない場合は、FALSE に設定します。

*lpOffset*<br/>
オブジェクトの原点からのマウスカーソルのオフセットをピクセル単位で示すポインター。

*lpSize*<br/>
オブジェクトのサイズ (ピクセル単位) へのポインター。

### <a name="return-value"></a>戻り値

クリップボードデータを格納している[COleDataSource](../../mfc/reference/coledatasource-class.md)オブジェクトへのポインター。

### <a name="remarks"></a>Remarks

この関数の既定の実装では、 [GetClipboardData](#getclipboarddata)を呼び出します。

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

フレームワークは、その`OnGetClipRect`場で編集されている項目のクリッピング四角形の座標を取得するために、メンバー関数を呼び出します。

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>パラメーター

*rClipRect*<br/>
項目のクリッピング四角形の座標を保持する、 [CRect](../../atl-mfc-shared/reference/crect-class.md)クラスのオブジェクトへのポインター。

### <a name="remarks"></a>Remarks

座標は、コンテナーアプリケーションウィンドウのクライアント領域に対して相対的にピクセル単位で表されます。

既定の実装では、項目がアクティブになっているビューのクライアントの四角形が単に返されます。

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

フレームワークは、その`OnGetItemPosition`場で編集されている項目の座標を取得するために、メンバー関数を呼び出します。

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>パラメーター

*rPosition*<br/>
項目の位置座標を格納する、 [CRect](../../atl-mfc-shared/reference/crect-class.md)オブジェクトへの参照。

### <a name="remarks"></a>Remarks

座標は、コンテナーアプリケーションウィンドウのクライアント領域に対して相対的にピクセル単位で表されます。

この関数の既定の実装は、何も行いません。 インプレース編集をサポートするアプリケーションには、の実装が必要です。

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

項目が適切にアクティブ化されたときにフレームワークによって呼び出されます。

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>パラメーター

*ppMainFrame フレーム*<br/>
メインフレームウィンドウへのポインターへのポインター。

*ppDocFrame*<br/>
ドキュメントフレームウィンドウへのポインターへのポインター。

*Lpフレーム情報*<br/>
フレームウィンドウ情報を受け取る[Oleinplace フレーム情報](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)構造体へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、OLE 項目の親ウィンドウに関する情報を取得するために使用されます。

コンテナーが MDI アプリケーションの場合、既定の実装は、 *Ppmainframe*フレームの[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)オブジェクトへのポインターと、 *ppdocframe*のアクティブな[CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)オブジェクトへのポインターを返します。 コンテナーが SDI アプリケーションの場合、既定の実装では、 *Ppmainframe*フレーム内の[CFrameWnd](../../mfc/reference/cframewnd-class.md)オブジェクトへのポインターが返され、 *PPDOCFRAME*では NULL が返されます。 既定の実装では、 *Lpフレーム情報*のメンバーも入力します。

既定の実装がアプリケーションに合わない場合にのみ、この関数をオーバーライドします。たとえば、アプリケーションに、SDI または MDI とは異なるユーザーインターフェイスパラダイムがあるとします。 これは高度なオーバーライド可能です。

詳細については、Windows SDK の「 [IOleInPlaceSite:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) 」および「 [Oleinplace フレーム情報](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)構造体」を参照してください。

##  <a name="oninsertmenus"></a>COleClientItem:: OnInsertMenus

コンテナーアプリケーションのメニューを空のメニューに挿入するために、インプレースアクティベーション中にフレームワークによって呼び出されます。

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>パラメーター

*Pmen氏*<br/>
空のメニューを指します。

*lpMenuWidths*<br/>
は、次の各メニューグループに含まれるメニューの数を示す6つの LONG 値の配列を指します。ファイル、編集、コンテナー、オブジェクト、ウィンドウ、ヘルプ。 コンテナーアプリケーションは、この配列の要素0、2、および4に対応する [ファイル]、[コンテナー]、[ウィンドウ] の各メニューグループを担当します。

### <a name="remarks"></a>Remarks

このメニューがサーバーに渡され、独自のメニューが挿入され、複合メニューが作成されます。 この関数を繰り返し呼び出して、複数の複合メニューを作成できます。

既定の実装では *、埋め*込み先コンテナーメニューが追加されています。つまり、[ファイル]、[コンテナー]、[ウィンドウ] の各メニューグループが表示されます。 このメニューリソースを設定するには、 [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo)を使用します。 既定の実装では、menu リソースに応じて、 *Lpmenuwidths*の要素0、2、および4にも適切な値が割り当てられます。 既定の実装がアプリケーションに適していない場合は、この関数をオーバーライドします。たとえば、アプリケーションで、ドキュメントの種類にリソースを関連付けるためのドキュメントテンプレートが使用されていないとします。 この関数をオーバーライドする場合は、 [OnSetMenu](#onsetmenu)と[OnRemoveMenus](#onremovemenus)もオーバーライドする必要があります。 これは高度なオーバーライド可能です。

詳細については、Windows SDK の「 [IOleInPlaceFrame:: InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) 」を参照してください。

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

埋め込み先のアクティベーションが終了したときに、指定された複合メニューからコンテナーのメニューを削除するために、フレームワークによって呼び出されます。

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>パラメーター

*Pmen氏*<br/>
[Oninsertmenus](#oninsertmenus)メンバー関数の呼び出しによって構築された複合メニューを指します。

### <a name="remarks"></a>Remarks

既定の実装では、埋め込み先コンテナーメニュー、つまり、[ファイル]、[コンテナー]、[ウィンドウ] の各メニューグループが削除*されます*。 既定の実装がアプリケーションに適していない場合は、この関数をオーバーライドします。たとえば、アプリケーションで、ドキュメントの種類にリソースを関連付けるためのドキュメントテンプレートが使用されていないとします。 この関数をオーバーライドする場合は、 [Oninsertmenus](#oninsertmenus)と[OnSetMenu](#onsetmenu)もオーバーライドすることをお勧めします。 これは高度なオーバーライド可能です。

サーバーで繰り返し呼び出さ`OnInsertMenus`れた場合は、2つ以上の複合メニューで共有することができます。 そのため、の`OnRemoveMenus`オーバーライドでサブメニューを削除することはできません。デタッチするだけで済みます。

詳細については、Windows SDK の「 [IOleInPlaceFrame:: RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) 」を参照してください。

##  <a name="onscrollby"></a>COleClientItem:: OnScrollBy

サーバーからの要求に応じて OLE 項目をスクロールするために、フレームワークによって呼び出されます。

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>パラメーター

*sizeExtent*<br/>
X 方向および y 方向のスクロール間隔をピクセル単位で指定します。

### <a name="return-value"></a>戻り値

項目がスクロールされた場合は0以外の。項目をスクロールできなかった場合は0。

### <a name="remarks"></a>Remarks

たとえば、OLE 項目が部分的に表示されていて、ユーザーが埋め込み先編集の実行中に、表示されている領域の外に移動した場合、この関数はカーソルを表示したままにします。 既定の実装では、何も行われません。 指定した量だけ項目をスクロールするには、この関数をオーバーライドします。 スクロールの結果として、OLE 項目の表示部分が変化する場合があることに注意してください。 [SetItemRects](#setitemrects)を呼び出して、項目の表示可能な四角形を更新します。

詳細については、Windows SDK の「 [IOleInPlaceSite:: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) 」を参照してください。

##  <a name="onsetmenu"></a>COleClientItem:: OnSetMenu

インプレースアクティベーションの開始時と終了時に2回、フレームワークによって呼び出されます。複合メニューを初めてインストールするときに、2回目 ( *holemenu*が NULL の場合) を使用して削除します。

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>パラメーター

*Pmen氏*<br/>
[Oninsertmenus](#oninsertmenus)メンバー関数と`InsertMenu`関数の呼び出しによって構築された複合メニューへのポインター。

*holemenu*<br/>
`OleCreateMenuDescriptor`関数によって返されたメニュー記述子へのハンドル。ディスパッチコードを削除する場合は NULL。

*hwndActiveObject*<br/>
OLE 項目の編集ウィンドウへのハンドル。 これは、OLE から編集コマンドを受け取るウィンドウです。

### <a name="remarks"></a>Remarks

既定の実装では、複合メニューをインストールまたは削除した後、 [Olesetmenudescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)関数を呼び出してディスパッチコードをインストールまたは削除します。 既定の実装がアプリケーションに適していない場合は、この関数をオーバーライドします。 この関数をオーバーライドする場合は、 [Oninsertmenus](#oninsertmenus)と[OnRemoveMenus](#onremovemenus)もオーバーライドすることをお勧めします。 これは高度なオーバーライド可能です。

詳細については、Windows SDK の「 [OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor)、 [olesetmenudescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)」、および「 [IOleInPlaceFrame:: setmenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) 」を参照してください。

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

コンテナーアプリケーションのコントロールバーを表示および非表示にするために、フレームワークによって呼び出されます。

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>パラメーター

*pFrameWnd*<br/>
コンテナーアプリケーションのフレームウィンドウへのポインター。 これは、メインフレームウィンドウまたは MDI 子ウィンドウのいずれかになります。

*bShow*<br/>
コントロールバーを表示するか非表示にするかを指定します。

### <a name="return-value"></a>戻り値

関数呼び出しによってコントロールバーの状態が変更された場合は0以外の。呼び出しによって変更が行われない場合は0。 *pFrameWnd*がコンテナーのフレームウィンドウを指していない場合は。

### <a name="remarks"></a>Remarks

コントロールバーが既に BShow によって指定された状態にある場合、この関数は0を返し*ます。* これは、たとえば、コントロールバーが非表示になっていて、 *bShow*が FALSE である場合などに発生します。

既定の実装では、最上位レベルのフレームウィンドウからツールバーが削除されます。

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

OLE 項目を表示するためにフレームワークによって呼び出され、編集中に全体が表示されるようにします。

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Remarks

これは、コンテナーアプリケーションが埋め込みアイテムへのリンクをサポートしている場合 (つまり、 [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)からドキュメントクラスを派生した場合) に使用されます。 この関数は、埋め込み先でのアクティブ化時、または OLE 項目がリンクソースであり、ユーザーがそれを編集する必要があるときに呼び出されます。 既定の実装では、コンテナードキュメントの最初のビューがアクティブ化されます。 OLE 項目が表示されるように、この関数をオーバーライドしてドキュメントをスクロールします。

##  <a name="onupdateframetitle"></a>COleClientItem:: Onupdateフレームタイトル

インプレースアクティベーション中にフレームワークによって呼び出され、フレームウィンドウのタイトルバーを更新します。

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>戻り値

この関数がフレームタイトルを正常に更新した場合は0以外の値。それ以外の場合は0。

### <a name="remarks"></a>Remarks

既定の実装では、フレームウィンドウのタイトルは変更されません。 アプリケーションに別のフレームタイトルが必要な場合は、この関数をオーバーライドします。たとえば、" *docname*の*サーバーアプリ* - *項目*" (レポート内の Microsoft Excel-スプレッドシートなど) を指定します。DOC ")。 これは高度なオーバーライド可能です。

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

OLE 項目を再アクティブ化し、インプレース編集中にユーザーが最後に実行した操作を元に戻すには、この関数を呼び出します。

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

コンテナーアプリケーションで undo コマンドがサポートされている場合は、OLE 項目を非アクティブにした直後に undo コマンドをユーザーが選択した場合は、この関数を呼び出します。

サーバーアプリケーションが Microsoft Foundation Class ライブラリを使用して記述されている場合、この関数によって、サーバーは[COleServerDoc:: Onre Andundo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)を呼び出します。

詳細については、Windows SDK の「 [IOleInPlaceObject:: Re Andundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) 」を参照してください。

##  <a name="release"></a>  COleClientItem::Release

OLE 項目によって使用されるリソースをクリーンアップするには、この関数を呼び出します。

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>パラメーター

*dwCloseOption*<br/>
OLE 項目が読み込まれた状態に戻ったときに、どのような状況で OLE 項目を保存するかを指定するフラグ。 使用可能な値の一覧については、「 [COleClientItem:: Close](#close)」を参照してください。

### <a name="remarks"></a>Remarks

`Release`は、 `COleClientItem`デストラクターによって呼び出されます。

詳細については、Windows SDK の「 [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) 」を参照してください。

##  <a name="reload"></a>  COleClientItem::Reload

項目を閉じて再読み込みします。

```
BOOL Reload();
```

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

[ActivateAs](#activateas) の呼び出しによって項目を別の型の項目としてアクティブ化した後に、関数 `Reload` を呼び出します。

##  <a name="run"></a>  COleClientItem::Run

この項目に関連付けられているアプリケーションを実行します。

```
void Run();
```

### <a name="remarks"></a>Remarks

項目をアクティブにする前に、メンバー関数を呼び出して、サーバーアプリケーションを起動します。`Run` これは、 [Activate](#activate)と[DoVerb](#doverb)によって自動的に行われるので、通常、この関数を呼び出す必要はありません。 [DoVerb](#doverb)を実行する前に、 [setextent](#setextent)などの項目属性を設定するためにサーバーを実行する必要がある場合は、この関数を呼び出します。

##  <a name="setdrawaspect"></a>COleClientItem:: SetDrawAspect

`SetDrawAspect`メンバー関数を呼び出して、アイテムの "アスペクト" またはビューを設定します。

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>パラメーター

*nDrawAspect*<br/>
DVASPECT 列挙子の値。 このパラメーターには、次のいずれかの値を指定できます。

- DVASPECT_CONTENT Item は、コンテナー内に埋め込みオブジェクトとして表示できるように表現されます。

- なりますが項目は、参照ツールで表示できるように "サムネイル" 表現で表示されます。

- DVASPECT_ICON Item はアイコンで表されます。

- DVASPECT_DOCPRINT Item は、[ファイル] メニューの [印刷] コマンドを使用して印刷されたかのように表されます。

### <a name="remarks"></a>Remarks

この側面では、その関数の*Ndrawaspect*引数の既定値が使用されている場合に、[描画](#draw)によって項目がどのようにレンダリングされるかを指定します。

この関数は、変更アイコン (および [アイコンの変更] ダイアログボックスを直接呼び出すその他のダイアログ) によって自動的に呼び出され、ユーザーが要求したときに表示されるアイコンの表示を有効にします。

##  <a name="setextent"></a>COleClientItem:: SetExtent

OLE 項目に使用できる領域を指定するには、この関数を呼び出します。

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>パラメーター

*size*<br/>
サイズ情報を格納している[CSize](../../atl-mfc-shared/reference/csize-class.md)オブジェクト。

*nDrawAspect*<br/>
境界を設定する OLE 項目の縦横比を指定します。 使用可能な値については、「 [Setdrawaspect](#setdrawaspect)」を参照してください。

### <a name="remarks"></a>Remarks

サーバーアプリケーションが Microsoft Foundation Class ライブラリを使用して記述されている場合は、対応`COleServerItem`するオブジェクトの [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) メンバー関数が呼び出されます。 OLE 項目は、それに応じて表示を調整できます。 ディメンションは MM_HIMETRIC 単位である必要があります。 ユーザーが OLE 項目のサイズを変更する場合、または何らかの形式のレイアウトネゴシエーションをサポートする場合は、この関数を呼び出します。

詳細については、Windows SDK の「 [IOleObject:: SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) 」を参照してください。

##  <a name="sethostnames"></a>COleClientItem:: SetHostNames

この関数を呼び出して、埋め込み OLE 項目のコンテナーアプリケーションの名前とコンテナーの名前を指定します。

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>パラメーター

*lpszHost*<br/>
コンテナーアプリケーションのユーザーに表示される名前へのポインター。

*lpszHostObj*<br/>
OLE 項目が格納されているコンテナーの識別文字列へのポインター。

### <a name="remarks"></a>Remarks

サーバーアプリケーションが Microsoft Foundation Class ライブラリを使用して記述されている場合、この関数は、OLE 項目を含む`COleServerDoc`ドキュメントの[onsethostnames](../../mfc/reference/coleserverdoc-class.md#onsethostnames)メンバー関数を呼び出します。 この情報は、OLE 項目が編集されているときにウィンドウタイトルで使用されます。 コンテナードキュメントが読み込まれるたびに、フレームワークはドキュメント内のすべての OLE 項目に対してこの関数を呼び出します。 `SetHostNames`は、埋め込みアイテムにのみ適用されます。 埋め込み OLE 項目を編集するためにアクティブ化するたびに、この関数を呼び出す必要はありません。

また、オブジェクトが読み込まれたとき、またはファイルが別の名前で保存されたときに、アプリケーション名とドキュメント名を使用して自動的に呼び出されます。 したがって、通常、この関数を直接呼び出す必要はありません。

詳細については、Windows SDK の「 [IOleObject:: SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) 」を参照してください。

##  <a name="seticonicmetafile"></a>COleClientItem:: SetIconicMetafile

項目のアイコンの描画に使用するメタファイルをキャッシュします。

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>パラメーター

*hMetaPict*<br/>
項目のアイコンを描画するために使用されるメタファイルへのハンドル。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

メタファイルを取得するには、 [geを](#geticonicmetafile)使用します。

*HMetaPict*パラメーターが項目にコピーされます。したがって、 *hMetaPict*は呼び出し元によって解放される必要があります。

##  <a name="setitemrects"></a>COleClientItem:: SetItemRects

この関数を呼び出して、OLE 項目の外接する四角形または表示されている四角形を設定します。

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>パラメーター

*lprcPosRect*<br/>
親ウィンドウを基準とした、OLE 項目の境界をクライアント座標で格納している四角形へのポインター。

*lprcClipRect*<br/>
親ウィンドウを基準とした、OLE 項目の可視部分の境界をクライアント座標で格納している四角形へのポインター。

### <a name="return-value"></a>戻り値

正常終了した場合は 0 以外を返します。それ以外の場合は 0 を返します。

### <a name="remarks"></a>Remarks

この関数は、 [Onchangeitemposition](#onchangeitemposition)メンバー関数の既定の実装によって呼び出されます。 OLE 項目の位置または表示部分が変更されるたびに、この関数を呼び出す必要があります。 通常、これは、ビューの[OnSize](../../mfc/reference/cwnd-class.md#onsize)および[onscrollby](../../mfc/reference/cview-class.md#onscrollby)メンバー関数から呼び出すことを意味します。

詳細については、Windows SDK の「 [IOleInPlaceObject:: SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) 」を参照してください。

##  <a name="setlinkupdateoptions"></a>COleClientItem:: SetLinkUpdateOptions

指定したリンクアイテムのプレゼンテーションのリンク更新オプションを設定するには、この関数を呼び出します。

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>パラメーター

*dwUpdateOpt*<br/>
この項目のリンク更新オプションの値。 この値は、次のいずれかである必要があります。

- OLEUPDATE_ALWAYS リンクアイテムを可能な限り更新します。 このオプションは、[リンク] ダイアログボックスの [自動リンク-更新] オプションボタンをサポートしています。

- OLEUPDATE_ONCALL は、コンテナーアプリケーションからの要求に対してのみリンク項目を更新します ( [UpdateLink](#updatelink)メンバー関数が呼び出された場合)。 このオプションでは、[リンク] ダイアログボックスの [手動リンク-更新] オプションボタンがサポートされています。

### <a name="remarks"></a>Remarks

通常、[リンク] ダイアログボックスでユーザーが選択した更新プログラムのオプションは変更しないでください。

詳細については、Windows SDK の「 [IOleLink:: SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) 」を参照してください。

##  <a name="setprintdevice"></a>COleClientItem:: SetPrintDevice

この項目の印刷ターゲットデバイスを変更するには、この関数を呼び出します。

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>パラメーター

*ptd*<br/>
新しい印刷ターゲットデバイスに関する情報を格納している[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)データ構造体へのポインター。 NULL を指定できます。

*ppd*<br/>
新しい印刷ターゲットデバイスに関する情報を格納している[PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga)データ構造体へのポインター。 NULL を指定できます。

### <a name="return-value"></a>戻り値

関数が成功した場合は0以外の。それ以外の場合は0です。

### <a name="remarks"></a>Remarks

この関数は、項目の印刷ターゲットデバイスを更新しますが、プレゼンテーションキャッシュを更新しません。 項目のプレゼンテーションキャッシュを更新するには、 [UpdateLink](#updatelink)を呼び出します。

この関数の引数には、OLE システムがターゲットデバイスを識別するために使用する情報が含まれています。 この`PRINTDLG`構造体には、コモン印刷ダイアログボックスを初期化するために Windows が使用する情報が含まれています。 ユーザーがダイアログボックスを閉じた後、Windows は、この構造体のユーザーの選択に関する情報を返します。 [CPrintDialog オブジェクト](../../mfc/reference/cprintdialog-class.md)の`PRINTDLG`メンバーは構造体です。 `m_pd`

この構造の詳細については、Windows SDK の「 [PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) 」を参照してください。

詳細については、Windows SDK の「 [DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 」を参照してください。

##  <a name="updatelink"></a>COleClientItem:: UpdateLink

OLE 項目のプレゼンテーションデータを直ちに更新するには、この関数を呼び出します。

```
BOOL UpdateLink();
```

### <a name="return-value"></a>戻り値

正常に完了した場合はゼロ以外、それ以外の場合は 0 です。

### <a name="remarks"></a>Remarks

リンク項目の場合、関数はリンクソースを検索して、OLE 項目の新しいプレゼンテーションを取得します。 このプロセスには、1つまたは複数のサーバーアプリケーションの実行が含まれる場合がありますが、この処理には時間がかかることがあります。 埋め込みアイテムの場合、関数は再帰的に動作し、埋め込みアイテムに古いリンクが含まれているかどうかを確認し、更新します。 ユーザーは、[リンク] ダイアログボックスを使用して個々のリンクを手動で更新することもできます。

詳細については、Windows SDK の「 [IOleLink:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) 」を参照してください。

## <a name="see-also"></a>関連項目

[MFC サンプル MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC サンプル OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem クラス](../../mfc/reference/cdocitem-class.md)<br/>
[階層図](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem クラス](../../mfc/reference/coleserveritem-class.md)
