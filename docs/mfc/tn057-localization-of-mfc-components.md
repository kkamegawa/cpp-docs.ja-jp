---
title: TN057:MFC コンポーネントのローカライズ
ms.date: 06/28/2018
helpviewer_keywords:
- components [MFC], localizing
- TN057
- resources [MFC], localization
- localization [MFC], MFC resources
- localization [MFC], MFC components
- MFC DLLs [MFC], localizing
- DLLs [MFC], localizing MFC
- localization [MFC], resources
ms.assetid: 5376d329-bd45-41bd-97f5-3d895a9a0af5
ms.openlocfilehash: 552b925bae00e8bb171c543a6ed16e801186bf89
ms.sourcegitcommit: 934cb53fa4cb59fea611bfeb9db110d8d6f7d165
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/14/2019
ms.locfileid: "65611928"
---
# <a name="tn057-localization-of-mfc-components"></a>TN057:MFC コンポーネントのローカライズ

> [!NOTE]
> 次のテクニカル ノートは、最初にオンライン ドキュメントの一部とされてから更新されていません。 結果として、一部のプロシージャおよびトピックが最新でないか、不正になります。 最新の情報について、オンライン ドキュメントのキーワードで関係のあるトピックを検索することをお勧めします。

このノートでは、いくつかの設計とアプリケーションまたは OLE と制御が場合、コンポーネントのローカライズに使用できる手順または MFC を使用する DLL について説明します。

## <a name="overview"></a>概要

実際には、2 つの問題を解決する場合に MFC を使用するコンポーネントをローカライズします。 最初に、独自のリソースをローカライズする必要があります: 文字列、ダイアログ、およびその他のコンポーネントに固有のリソース。 MFC を使用して作成されたほとんどのコンポーネントが含まれてし、MFC で定義されているリソースの値。 ローカライズされた MFC リソースとを提供する必要があります。 さいわい、複数の言語は MFC 自体によって既に提供されます。

さらに、そのターゲット環境 (環境がヨーロッパまたは dbcs) で実行するコンポーネントを準備する必要があります。 ほとんどの場合、これは、高ビットが設定された文字を正しく処理し、2 バイト文字を含む文字列を処理するアプリケーションに依存します。 MFC は、既定では、両方を有効に、これらの環境のセットアップ時に接続されている異なるリソースをすべてのプラットフォームで使用されている世界共通のバイナリを含めることは可能にするようです。

## <a name="localizing-your-components-resources"></a>コンポーネントのリソースをローカライズします。

アプリケーションまたは DLL のローカライズでは、対象言語に一致するリソースを単にリソースを置き換えるが含まれる必要があります。 これは比較的単純な独自のリソース: リソース エディターでのリソースを編集し、アプリケーションをビルドします。 コードは行われません文字列またはテキストをローカライズするハード コーディングされた C++ ソース コード - に正しく記述されている場合は、リソースを変更するだけですべてのローカライズを実行できます。 実際には、すべてローカライズされたバージョンを提供することも、元のコードのビルドはも関与しませんようにコンポーネントを実装できます。 これより複雑ながも価値はありは MFC 自体に対して選択メカニズムです。 リソース エディターに EXE または DLL ファイルを読み込むと、リソースを直接編集して、アプリケーションをローカライズすることもできます。 可能であれば、中には、新しいバージョンのアプリケーションをビルドするたびにそれらの変更点を再適用が必要です。

回避するための 1 つの方法では、サテライト DLL とも呼ばれる、別の DLL のすべてのリソースを特定します。 この DLL が実行時に動的に読み込まれる、およびリソースは、すべてのコードをメイン モジュールからの代わりにその DLL から読み込まれます。 MFC は、この方法を直接サポートします。 MYAPP というアプリケーションを検討してください。実行可能ファイルです。すべてのリソース MYRES と呼ばれる DLL 内にある可能性があります。DLL です。 アプリケーションの`InitInstance`はその場所からリソースを読み込む MFC になり、その DLL を読み込むには、次を実行します。

```cpp
CMyApp::InitInstance()
{
    // one of the first things in the init code
    HINSTANCE hInst = LoadLibrary("myres.dll");

    if (hInst != NULL)
        AfxSetResourceHandle(hInst);

    // other initialization code would follow
    // ...
}
```

MFC は myapp.exe からの代わりにその DLL からリソースを読み込みます。 ただし、すべてのリソースがこの DLL に存在する必要があります。MFC では、特定のリソースを探求するため、アプリケーションのインスタンスは検索されます。 この手法は、同様に、十分に正規の MFC Dll と OLE コントロールに適用されます。 セットアップ プログラムでは、適切なバージョンの MYRES をコピーします。DLL リソース ロケールに応じて、ユーザーはたいとします。

リソースを作成するは比較的簡単のみの DLL。 DLL プロジェクトの作成、追加する、します。RC ファイル、および必要なリソースを追加します。 この手法を使用しない既存のプロジェクトがある場合は、そのプロジェクトからリソースをコピーできます。 リソース ファイルをプロジェクトに追加すると、ほぼプロジェクトをビルドする準備が完了したら。 唯一行う必要がありますが、リンカーにオプションの設定 **/NOENTRY**します。 リンカーに指示この DLL にエントリ ポイント - がないため、コードを持たない、エントリ ポイントを持ちません。

> [!NOTE]
> Visual C 4.0 以降、リソース エディターには、ごとの複数の言語がサポートされます。RC ファイルです。 これは、ため、非常に簡単に 1 つのプロジェクトでのローカライズを管理、ことができます。 各言語のリソースは、リソース エディターによって生成されるプリプロセッサ ディレクティブによって制御されます。

## <a name="using-the-provided-mfc-localized-resources"></a>MFC を使用してローカライズされたリソース

MFC アプリケーションをビルドするには、MFC から次の 2 つが再利用されます。 コードとリソース。 つまり、MFC にはさまざまなエラー メッセージ、組み込みダイアログ、および MFC クラスで使用されるその他のリソース。 アプリケーションを完全にローカライズするには、アプリケーションのリソースだけでなく、MFC から直接取得したリソースをローカライズする必要があります。 MFC には別の言語のリソース ファイル、自動的にだけそれらローカライズされたリソースを使用するかどうかを確認する必要がある場合、対象としている言語は、MFC は既にサポートされている言語の 1 つは、ようにします。

、この記事の執筆時点は、MFC は、中国語、ドイツ語、スペイン語、フランス語、イタリア語、日本語、および韓国語をサポートします。 これらのローカライズされたバージョンを含むファイルは、MFC\INCLUDE\L.* ('L' は、ローカライズされたを表します) のディレクトリ。 ドイツ語のファイルは、たとえば MFC\INCLUDE\L.DEU でです。 アプリケーションに定義してあるファイルの代わりにこれらの RC ファイルを使用するには、追加、 `/IC:\PROGRAM FILES\MICROSOFT VISUAL STUDIO .NET 2003\VC7\MFC\INCLUDE\L.DEU` RC のコマンドラインに (これはほんの一例は、Visual C をインストールしたディレクトリと同様に任意のロケールを置き換える必要があります++).

前の手順は、アプリケーションが MFC と静的にリンクする場合は。 ほとんどのアプリケーションは、動的に (があるため、AppWizard 既定) にリンクします。 このシナリオでは、コードだけでなくは動的にリンクされているは、リソース。 その結果、アプリケーションでは、リソースをローカライズすることができますが、MFC 実装のリソースがまだ読み込まれる、MFC7x.DLL (またはそれ以降のバージョン) から、または MFC7xLOC.DLL から存在する場合。 これを 2 つの異なる角度からアプローチすることができます。

複雑な方法では、(MFC7xDEU、ドイツ語、スペイン語などの MFC7xESP.DLL) など、ローカライズされた MFC7xLOC.DLLs のいずれかの出荷または以降のバージョンには、し、ユーザーは、アプリケーションをインストールするとき、システム ディレクトリに適切な MFC7xLOC.DLL をインストールします。 これは、開発者とエンドユーザーの両方の非常に複雑になるし、ようは推奨されません。 参照してください[テクニカル ノート 56:](../mfc/tn056-installation-of-localized-mfc-components.md)この手法とその注意事項の詳細についてはします。

最も簡単で安全な方法は、アプリケーションまたは DLL 自体 (またはそのサテライト DLL のいずれかを使用している場合) にローカライズされた MFC リソースを含めるは。 MFC7xLOC.DLL を正しくインストールの問題を回避できます。 、(設定、ローカライズされたリソースを参照するように正しく RC コマンドライン) 上で指定した静的の場合と同じ手順に従うためには、以外を削除する必要がありますも、`/D_AFXDLL`定義 AppWizard によって追加されました。 ときに`/D_AFXDLL`はコマを定義します。H (およびその他の MFC の RC ファイル) は実際に定義するすべてのリソース (ためそれらからプルされ、MFC Dll 代わりに)。

## <a name="see-also"></a>関連項目

[番号順テクニカル ノート](../mfc/technical-notes-by-number.md)<br/>
[カテゴリ別テクニカル ノート](../mfc/technical-notes-by-category.md)
