---
title: '[ヘルプ] メニューのマージ'
ms.date: 11/04/2016
helpviewer_keywords:
- menus [MFC], merging
- merging Help menus [MFC]
- Help [MFC], for active document containers
ms.assetid: 9d615999-79ba-471a-9288-718f0c903d49
ms.openlocfilehash: e1e8f9af696b6ea4cd485f4215e1c8425098e987
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62396406"
---
# <a name="help-menu-merging"></a>[ヘルプ] メニューのマージ

OLE ドキュメントのプロトコルのマージ メニューからのオブジェクトの完全なコントロールは、オブジェクトがコンテナー内でアクティブなとき、**ヘルプ**メニュー。 その結果、ユーザーには、オブジェクトが非アクティブにしない限り、コンテナーのヘルプ トピックは利用できません。 Active ドキュメント コンテインメントのアーキテクチャは、インプレース メニューのコンテナーと共有、メニューをアクティブになっているアクティブなドキュメントの両方を許可するマージの規則を展開します。 新しいルールとは、どのようなコンポーネントには、メニューのどの部分が所有しているし、[共有] メニューを構築する方法についての単なる規則です。

新しい規則は単純です。 Active ドキュメントで、**ヘルプ**メニューが 2 つのトップレベルのメニュー項目が次のように構成されています。

`Help`

`Container Help >`

`Object Help    >`

Word セクションは、Office バインダーでアクティブなときなど、**ヘルプ**] メニューの [が次のように表示されます。

`Help`

`Binder Help >`

`Word Help   >`

両方のメニュー項目は、ユーザーにあるコンテナーおよびオブジェクトに固有の追加のメニュー項目が提供されているカスケード メニューです。 コンテナーおよびオブジェクトと異なるもの項目がここに表示します。

このマージされたを構築する**ヘルプ**] メニューの [active ドキュメント コンテインメントのアーキテクチャは、標準の OLE ドキュメント プロシージャを変更します。 OLE ドキュメントに従って、マージ後のメニュー バーが 6 つのグループのメニュー、namely**ファイル**、**編集**、**コンテナー**、**オブジェクト**、 **ウィンドウ**、**ヘルプ**点で、注文します。 各グループで、0 個以上のメニューがあります。 グループ**ファイル**、**コンテナー**、および**ウィンドウ**コンテナーのグループに属している**編集**、**オブジェクト、** と**ヘルプ**オブジェクトに属しています。 オブジェクトは、メニューのマージを実行する場合、空のメニュー バーを作成し、コンテナーに渡されます。 コンテナーは、呼び出すことでのメニューを挿入する、`IOleInPlaceFrame::InsertMenus`します。 オブジェクトも長い値が 6 つの配列をある構造体を渡します (**どおり**)。 メニューを挿入した後は、コンテナーは、それぞれのグループとし、返しますで追加したメニューの数をマークします。 オブジェクトは、各コンテナー グループ内のメニューの数に注意を払い、そのメニューを挿入します。 最後に、オブジェクト、マージ後のメニュー バーと配列 (を各グループのメニューの数を含む) に渡します OLE、不透明な「メニュー記述子」が返されたハンドルします。 後で、オブジェクトが渡すそのハンドルと、マージ後のメニュー バー、コンテナーを使用して`IOleInPlaceFrame::SetMenu`します。 この時点で、コンテナーは、マージ後のメニュー バーが表示され、OLE のメニューのメッセージの適切なディスパッチを実行できるようにも ole にハンドルを渡します。

変更のアクティブなドキュメントの手順で、オブジェクトを初期化する必要があります最初、**どおり**要素をコンテナーに渡す前にゼロにします。 コンテナーは、1 つの例外の通常のメニューの挿入を実行します。コンテナーの挿入、**ヘルプ**最後の項目としてのメニューの最後 (6 番目) のエントリに 1 の値を格納し、**どおり**配列 (つまり、幅 [5]、オブジェクトのヘルプのグループに属している)。 これは、**ヘルプ**メニュー、サブメニュー項目が 1 つのみになります、"**コンテナー ヘルプ**>"前述したようにカスケード メニュー。

オブジェクトが挿入する前に点を除いて、通常のメニューの挿入コードを実行し、その**ヘルプ** メニューの 6 番目のエントリを確認しますが、**手順どおり**配列。 場合は、値は 1 と最後のメニューの名前は**ヘルプ**(または、適切なローカライズされた文字列)、オブジェクトを挿入し、その**ヘルプ**メニューのコンテナーのサブメニューとして**ヘルプ**メニュー。

オブジェクトの 6 番目の要素を設定し、**手順どおり**をゼロにし、5 番目の要素を 1 ずつインクリメントします。 OLE を知っています。 これにより、**ヘルプ**メニューは、コンテナーに属していると、そのメニュー (とそのサブメニュー) に対応するメニュー メッセージは、コンテナーにルーティングする必要があります。 転送するように、コンテナーの責任では、**ポインター**、 **WM_SELECT**、 **WM_COMMAND**、およびオブジェクトの属している他のメニューに関連するメッセージ部分、**ヘルプ**メニュー。 これを使用して実現**WM_INITMENU**コンテナー オブジェクトのユーザーが移動するかどうかを指示するフラグをクリアする**ヘルプ**メニュー。 コンテナーを監視し、**オン**エントリまたはの任意の項目からの終了時、**ヘルプ** メニューのコンテナーはそれ自体を追加しませんでした。 エントリにはコンテナーが"でオブジェクトのヘルプ メニュー"フラグを設定し、そのフラグの状態を使用して、いずれかを転送するために、オブジェクト メニューにユーザーが移動を意味**オン**、**ポインター**、および**WM_COMMAND**最低でも、オブジェクトのウィンドウへのメッセージ。 (終了時に、コンテナー、フラグをクリアし、処理これらの同じメッセージ自体します。)コンテナーは、オブジェクトから返されたウィンドウを使用する必要があります`IOleInPlaceActiveObejct::GetWindow`これらのメッセージの送信先として機能します。

オブジェクト検出の 6 番目の要素に 0**どおり**、通常の OLE ドキュメントの規則に従って実行されます。 この手順の説明に参加しているコンテナー**ヘルプ**メニューのマージとそうでないものです。

オブジェクトを呼び出すと`IOleInPlaceFrame::SetMenu`、マージされたメニュー バーで、コンテナーのチェックするかどうかを表示する前に、**ヘルプ**メニューがの挿入コンテナーだけでなく、ほかのサブメニューがあります。 そのため、コンテナーを離れた場合その**ヘルプ**マージ後のメニュー バーでメニュー。 場合、**ヘルプ**メニューが追加のサブメニューを持たない、コンテナーが削除されます、**ヘルプ**マージ後のメニュー バーからメニュー。 この手順に参加しているオブジェクトを取り上げています。**ヘルプ**メニューのマージとそうでないものです。

最後に、メニューを逆アセンブルするときは、ときに、オブジェクトを削除、挿入された**ヘルプ**だけでなく、もう一方を削除するメニューがメニューを挿入します。 により、コンテナーは、そのメニューを削除するとき、**ヘルプ**だけでなく、挿入が、その他のメニューのメニュー。

## <a name="see-also"></a>関連項目

[Active ドキュメント コンテナー](../mfc/active-document-containers.md)
