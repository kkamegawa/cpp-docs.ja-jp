---
title: ダイナセット
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC recordsets, dynasets
- ODBC cursor library [ODBC], dynasets
- keyset-driven cursors in dynasets
- cursors [ODBC], keyset-driven cursors in dynasets
- cursor library [ODBC], dynaset availability
- recordsets [C++], dynasets
- dynasets
ms.assetid: 2867e6be-208e-4fe7-8bbe-b8697cb1045c
ms.openlocfilehash: 21c47546d14d9a121bdd0698fe96eb133dbc44a0
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62395886"
---
# <a name="dynaset"></a>ダイナセット

このトピックでダイナセットを使う場合と説明、[可用性](#_core_availability_of_dynasets)します。

> [!NOTE]
>  このトピックの対象を含む、MFC ODBC クラス[CRecordset](../../mfc/reference/crecordset-class.md)します。 ダイナセットを使う場合、DAO クラスの詳細については、次を参照してください。 [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)します。 DAO では、ダイナセット タイプのレコード セットを開くことができます。

ダイナセットは、動的プロパティを持つレコード セットです。 有効期間、ダイナセットのモード (ダイナセットと通常呼ばれる) のレコード セット オブジェクトでは次のようにデータ ソースとの同期に残ります。 他のユーザーが編集可能性がありますマルチ ユーザー環境には、ダイナセットではレコードを削除またはまたはダイナセットが表すテーブルにレコードを追加します。 ダイナセットでは、レコード、アプリケーションに追加するか、レコード セットから削除が反映されます。 ダイナセットを呼び出すことによって再構築するまで、他のユーザーがテーブルに追加するレコードをダイナセットに反映されませんが、`Requery`メンバー関数。 他のユーザーがレコードを削除すると、MFC コードは、レコード セットの削除をスキップします。 既存のレコードを他のユーザーの編集は、影響を受けるレコードにスクロールするとすぐに、ダイナセットに反映されます。

同様に、編集を行うダイナセットのレコードには、他のユーザーによって使用ダイナセットを使う場合に反映されます。 追加したレコードは、まで、クエリの他のユーザーの (ダイナセットの) は反映されません。 削除したレコードは、他のユーザーのレコード セットの中では、「削除」にマークされます。 同じデータベースに複数の接続がある場合 (複数`CDatabase`オブジェクト)、それらの接続に関連付けられているレコード セットがある他のユーザーのレコード セットと同じ状態です。

ダイナセットを使う場合される最も重要なデータを動的に (たとえば) として、航空券予約システムである必要があります。

> [!NOTE]
> ダイナセットを使うダイナセットを使う場合をサポートするデータ ソースの ODBC ドライバーをいる必要があり、ODBC カーソル ライブラリが読み込まれていない必要があります。 詳細については、次を参照してください。[ダイナセット](#_core_availability_of_dynasets)します。

レコード セットがダイナセットであることを指定するには、渡す`CRecordset::dynaset`最初のパラメーターとして、`Open`レコード セット オブジェクトのメンバー関数。

> [!NOTE]
> 更新可能なダイナセットを使う場合、ODBC ドライバーが位置指定の update ステートメントのいずれかをサポートする必要がありますまたは`::SQLSetPos`ODBC API 関数。 MFC を使用して、両方がサポートされている場合`::SQLSetPos`効率が向上します。

##  <a name="_core_availability_of_dynasets"></a> ダイナセットの可用性

MFC データベース クラスは、次の要件が満たされた場合に、ダイナセットを使う場合をサポートします。

- ODBC カーソル ライブラリ DLL がこのデータ ソースの使用中にできないする必要があります。

   カーソル ライブラリを使用する場合は、ダイナセットのサポートのために必要な基になる ODBC ドライバーの一部の機能をマスクします。 ダイナセットを使う場合に使用する (および、このセクションの残りの部分で説明されていると、ODBC ドライバーがダイナセットを使う場合、必要な機能)、プロファイルを作成するときに、カーソル ライブラリを読み込む MFC が発生することができます、`CDatabase`オブジェクト。 詳細については、次を参照してください。 [ODBC](../../data/odbc/odbc-basics.md)と[OpenEx](../../mfc/reference/cdatabase-class.md#openex)または[オープン](../../mfc/reference/cdatabase-class.md#open)クラスのメンバー関数`CDatabase`します。

   ODBC の用語でダイナセットを使う場合とスナップショットと呼びますカーソル。 カーソルは、レコード セット内の位置を追跡するために使用されるメカニズムです。

- データ ソースの ODBC ドライバーでは、キーセット ドリブン カーソルをサポートする必要があります。

   キーセット ドリブン カーソルを取得して、一連のキーを格納するテーブルからデータを管理します。 ユーザーが特定のレコードをスクロールすると、テーブルから現在のデータを取得するキーが使用されます。 ドライバーが、このサポートを提供するかどうかを確認するのには、呼び出し、`::SQLGetInfo`で ODBC API 関数、 *SQL_SCROLL_OPTIONS*パラメーター。

   キーセットをサポートしていないダイナセットを開こうとすると、表示、 `CDBException` AFX_SQL_ERROR_DYNASET_NOT_SUPPORTED のリターン コード値します。

- データ ソースの ODBC ドライバーでは、拡張のフェッチをサポートする必要があります。

   SQL クエリの結果のレコードを逆方向にスクロールできる機能は、拡張をフェッチしています。 ドライバーはこの機能をサポートするかどうかを確認するのには、呼び出し、`::SQLGetFunctions`で ODBC API 関数、 *SQL_API_SQLEXTENDEDFETCH*パラメーター。

更新可能なダイナセットを使う場合 (またはさらに言えば、スナップショット) する場合に、ODBC ドライバーする必要がありますもいずれもサポート、 `::SQLSetPos` ODBC API 関数または位置指定更新します。 `::SQLSetPos`関数は、SQL ステートメントを送信することがなく、データ ソースを更新する MFC を使用します。 このサポートが利用可能な場合は、MFC は、SQL を使用して更新を行う方が優先的に使用します。 ドライバーがサポートするかどうかを確認する`::SQLSetPos`、呼び出す`::SQLGetInfo`で、 *SQL_POS_OPERATIONS*パラメーター。

位置指定更新は、SQL 構文を使用して (フォームの**WHERE CURRENT OF** \<カーソル名 >) をデータ ソースのテーブルの特定の行を識別します。 ドライバーが位置指定更新をサポートしているかどうかを確認するのには、呼び出す`::SQLGetInfo`で、 *SQL_POSITIONED_STATEMENTS*パラメーター。

一般に、MFC ダイナセットを使う場合 (ただし、前方スクロール専用レコード セット) には、レベル 2 API への準拠の ODBC ドライバーが必要です。 データ ソースのドライバーは、レベル 1 の API セットに準拠している、更新可能なと読み取り専用のスナップショットと順方向専用のレコード セットがダイナセットは引き続き使用できます。 ただし、レベル 1 のドライバーでは、ダイナセット拡張フェッチをサポートしている場合、キーセット ドリブン カーソルをサポートできます。 ODBC 準拠のレベルの詳細については、次を参照してください。 [ODBC](../../data/odbc/odbc-basics.md)します。

> [!NOTE]
> 2 つの異なるで行う必要がありますスナップショットとダイナセットを使う場合の両方を使用する場合は、`CDatabase`オブジェクト (2 つの接続)。

ODBC カーソル ライブラリによって維持中間ストレージを使用するスナップショットとは異なりダイナセットを使う場合はスクロールするとすぐにデータ ソースから直接レコードをフェッチします。 これにより、データ ソースと同期ダイナセットで選択されたレコードが保持されます。

このバージョンの Visual C に含まれる ODBC ドライバーの一覧については、および追加のドライバーの入手方法については、「 [ODBC ドライバーの一覧](../../data/odbc/odbc-driver-list.md)します。

## <a name="see-also"></a>関連項目

[ODBC (Open Database Connectivity)](../../data/odbc/open-database-connectivity-odbc.md)