---
title: トランザクション (MFC データ アクセス)
ms.date: 11/04/2016
helpviewer_keywords:
- transactions [C++], support for
- transactions [C++]
- databases [C++], transactions
ms.assetid: f80afbfe-1517-4fec-8870-9ffc70a58b05
ms.openlocfilehash: e3dc5b9319a8745ddb446ae7dbe895bfcd446c37
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62152658"
---
# <a name="transactions--mfc-data-access"></a>トランザクション (MFC データ アクセス)

トランザクションの概念は、データベースの結果の状態が、一連の操作の全体的な成功に依存するケースを処理するために開発されました。 このような状況は、連続した操作によって前の操作の結果が変更される場合があるために発生します。 このような場合は、いずれかの操作が失敗すると、最終的な状態が不定になることがあります。

この問題を解決するため、トランザクションでは最終的な結果の整合性が確保されるように、一連の操作がグループ化されます。 すべての操作に成功してからコミット (データベースに書き込み) するか、トランザクション全体が失敗するかのどちらかとなります。 トランザクションのキャンセルは、ロールバックと呼ばれます。 ロールバックにより、変更を復元し、データベースをトランザクション前の状態に戻すことができます。

たとえば、自動化された銀行トランザクションで口座 A から口座 B にお金を振り替える場合は、資金を正しく処理するには A からの引き落としと B への預け入れがどちらも成功する必要があります。そうでない場合はトランザクション全体を失敗とします。

トランザクションは、次の性質を意味する ACID プロパティが必要です。

- **原子性**作業はすべて、またはなしのいずれかが; トランザクションは作業のアトミック単位であり、1 回だけ実行します。

- **整合性**トランザクションには、データの一貫性のある別の状態データの 1 つの一貫性のある状態に変換するデータの一貫性が維持されます。 トランザクションにより連結されたデータの意味は保持される必要があります。

- **分離**トランザクションの分離の単位は、および各は、個別に、同時実行トランザクションとは無関係に発生します。 あるトランザクションが、別のトランザクションの中間段階にかかわらないようにする必要があります。

- **持続性**トランザクションは、回復の単位。 トランザクションが成功した場合、システムがクラッシュまたはシャットダウンしてもその更新内容は保持されます。 トランザクションが失敗した場合、システムは、そのトランザクションをコミットする前の状態のままになります。

OLE DB のトランザクションをサポートすることができます (を参照してください[OLE db のトランザクションのサポート](../data/oledb/supporting-transactions-in-ole-db.md)) または ODBC (を参照してください[トランザクション (ODBC)](../data/odbc/transaction-odbc.md))。

分散トランザクションは、分散されたデータ (複数のネットワーク コンピューター システムにあるデータ) を更新するトランザクションです。 分散システムでトランザクションをサポートする場合は、OLE DB のトランザクション サポートではなく、ADO.NET を使用する必要があります。

## <a name="see-also"></a>関連項目

[データ アクセス プログラミング (MFC/ATL)](../data/data-access-programming-mfc-atl.md)