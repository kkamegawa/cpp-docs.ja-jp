---
title: OLE DB オブジェクト モデル
ms.date: 10/22/2018
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
ms.openlocfilehash: 303ad4166f0f1126182956fae9c19f513be7cfb3
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62283843"
---
# <a name="ole-db-object-model"></a>OLE DB オブジェクト モデル

OLE DB オブジェクト モデルは、次のオブジェクトまたはコンポーネントから成ります。 最初の 4 つのオブジェクトまたはコンポーネントを一覧表示 (データ ソース、セッション、コマンド、および行セット) を使用すると、データ ソースに接続し、それを表示できます。 以降、アクセサーでは、残りの部分は、データの操作が表示されたら、それに関連します。

## <a name="data-sources"></a>Data Sources

データ ソース オブジェクトを使用すると、ファイルや DBMS などのデータ ソースに接続できます。 データ ソース オブジェクトは、作成し接続を管理し、アクセス許可と認証情報 (ログイン名とパスワード) などが含まれています。 データ ソース オブジェクトは、1 つまたは複数のセッションを作成できます。

## <a name="sessions"></a>セッション

セッションでは、クエリおよびデータを取得するデータ ソースと特定の相互作用を管理します。 各セッションでは、1 つのトランザクションです。 トランザクションは、ACID テストによって定義された分割できない作業単位です。 ACID の定義では、次を参照してください。[トランザクション](#vcconoledbcomponents_transactions)です。

セッションでは、行セットを開くと、それを作成したデータ ソース オブジェクトを返すなどの重要なタスクを実行します。 セッションでは、メタデータ、またはテーブルの情報) など、データ ソース自体に関する情報を返すこともできます。

セッションでは、1 つまたは複数のコマンドを作成できます。

## <a name="commands"></a>コマンド

コマンドでは、SQL ステートメントなどのテキスト コマンドを実行します。 テキスト コマンドが、SQL など、行セットを指定するかどうか**選択**ステートメントでは、コマンドは、行セットを作成します。

コマンドは、単に、プロバイダーの基になるデータ ストアでの実行をデータ ソース オブジェクトのコンシューマーから渡さ (SQL ステートメント) などの文字列であるテキストのコマンドのコンテナーです。 通常、テキスト コマンドは、SQL**選択**ステートメント (ためにこの例では、SQL**選択**行セットを指定します、コマンドは、行セットを自動的に作成されます)。

## <a name="rowsets"></a>行セット

行セットは、表形式でデータを表示します。 インデックスは、行セットの特殊なケースです。 セッションまたはコマンドからは、行セットを作成できます。

### <a name="schema-rowsets"></a>スキーマ行セット

スキーマでは、データベースに関するメタデータ (構造情報) があります。 スキーマ行セットは、スキーマ情報を持つ行セットです。 DBMS の一部の OLE DB プロバイダーでは、スキーマ行セット オブジェクトをサポートします。 スキーマ行セットの詳細については、次を参照してください。[スキーマ行セットのメタデータの取得](../../data/oledb/obtaining-metadata-with-schema-rowsets.md)と[スキーマ行セット クラスと Typedef クラス](../../data/oledb/schema-rowset-classes-and-typedef-classes.md)します。

### <a name="view-objects"></a>オブジェクトの表示

ビュー オブジェクトは、行と行セットからの列のサブセットを定義します。 独自のデータがありません。 オブジェクトを表示するには、複数の行セットからデータを組み合わせることはできません。

## <a name="accessors"></a>アクセサー

OLE DB だけでは、アクセサーの概念を使用します。 アクセサーは、コンシューマーでデータを格納する方法について説明します。 行セットのフィールド (列) と、コンシューマー内で宣言したデータ メンバーの間、一連のバインド (列のマップと呼ばれます) があります。

##  <a name="vcconoledbcomponents_transactions"></a> トランザクション

トランザクション オブジェクトは、コミットまたは最も低いレベル以外で入れ子になったトランザクションを中止するときに使用されます。 トランザクションは、ACID テストによって定義された分割できない作業単位です。 ACID を略します。

- 原子性、小さな作業単位に分割できません。

- 同時実行性、1 つ以上のトランザクションは、時に発生することができます。

- 分離、1 つのトランザクションが制限されて別によって行われた変更に関する知識

- 耐久性、トランザクションは永続的な変更を加えます

## <a name="enumerators"></a>列挙子

列挙子は、使用できるデータ ソースとその他の列挙子を検索します。 特定のデータ ソース用にカスタマイズはコンシューマーは、使用するデータ ソースを検索する列挙子を使用します。

Microsoft Data Access SDK に付属してルート列挙子は、レジストリを探しているデータ ソースと他の列挙子を走査します。 他の列挙子は、プロバイダー固有の方法で、レジストリや検索を走査します。

## <a name="errors"></a>エラー

任意の OLE DB オブジェクトのインターフェイスには、エラーを生成できます。 エラーでは、省略可能なカスタム エラー オブジェクトを含む、エラーに関する追加情報があります。 この情報は、HRESULT に格納されます。

## <a name="notifications"></a>通知

通知は、(が共有場合、コンシューマーが、同じトランザクション内で動作すると見なされます) の行セットを共有する協調のコンシューマー グループによって使用されます。 通知では、行セットを共有連携をもたらすのコンシューマーに通知する、同業者によって実行される行セットに対して操作を有効にします。

## <a name="see-also"></a>関連項目

[OLE DB プログラミング](../../data/oledb/ole-db-programming.md)<br/>
[OLE DB プログラミングの概要](../../data/oledb/ole-db-programming-overview.md)