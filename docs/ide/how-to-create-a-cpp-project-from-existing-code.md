---
title: '方法: 既存のコードから C++ プロジェクトを作成する'
ms.date: 01/15/2019
helpviewer_keywords:
- C++, creating projects from existing code
- Create New Project From Existing Code Files Wizard, project settings
f1_keywords:
- vc.appwiz.importwiz.location
- vc.appwiz.importwiz.appsettings
- vc.appwiz.importwiz.debugsettings
- vc.appwiz.importwiz.releasesettings
ms.assetid: e328a938-395c-48ea-9e35-dd433de12b31
ms.openlocfilehash: 975d49e216c9aeb3f94ad385ef096794a446289f
ms.sourcegitcommit: 2ebbf8093fadb9a1b78a4381439bcd5c01a89267
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/18/2019
ms.locfileid: "54397343"
---
# <a name="how-to-create-a-c-project-from-existing-code"></a>方法: 既存のコードから C++ プロジェクトを作成する

Visual Studio で、**既存コード ファイルからの新しいプロジェクトの作成**ウィザードを使用すると、既存のコード ファイルを C++ プロジェクトに移植できます。 このウィザードによって、MSBuild システムを利用してソース ファイルとビルド構成を管理するプロジェクト ソリューションが作成されます。 これは複雑なフォルダー階層がない、比較的単純なプロジェクトに最適です。 このウィザードは、Visual Studio の以前の Express Edition では使用できません。 

既存のコード ファイルを C++ プロジェクトに移植することで、IDE に組み込まれているネイティブ MSBuild プロジェクト管理機能を利用できます。 nmake メイクファイル、CMake、代替など、既存のビルド システムを使用する場合、代わりに [フォルダーを開く] または CMake のオプションを利用できます。 詳細については、「[Visual C++ での "フォルダーを開く" プロジェクト](../ide/non-msbuild-projects.md)」および「[CMake projects in Visual Studio](../ide/cmake-tools-for-visual-cpp.md)」(Visual Studio での CMake プロジェクト) を参照してください。 いずれのオプションでも、[IntelliSense](/visualstudio/ide/using-intellisense) や[プロジェクト プロパティ](../ide/working-with-project-properties.md)など、IDE 機能を利用できます。

### <a name="to-create-a-c-project-from-existing-code"></a>既存のコードから C++ プロジェクトを作成するには

1. **[ファイル]** メニューで、**[新規作成]** > **[Project From Existing Code]\(既存のコードのプロジェクト\)** の順に選択します。

1. **既存コード ファイルからの新しいプロジェクトの作成**ウィザードの最初のページで、**[作成するプロジェクトの種類を入力してください]** ボックスの一覧の **[Visual C++]** をクリックします。 **[次へ]** を選択して続行します。

1. プロジェクトの場所、ソース ファイルのディレクトリ、ウィザードが新しいプロジェクトにインポートするファイルの種類を指定します。 **[次へ]** を選択して続行します。

    | 設定 | 説明 |
    | --- | --- |
    | **プロジェクト ファイルの場所** | 新しいプロジェクトのディレクトリ パスを指定します。 これは、ウィザードで新しいプロジェクトのすべてのファイル (およびサブディレクトリ) が格納される場所です。<br/><br/>**[プロジェクト ファイルの場所]** ダイアログを表示するには、**[参照]** を選択します。 適切なフォルダーに移動し、新しいプロジェクトを含むディレクトリを指定します。 |
    | **プロジェクト名** | 新しいプロジェクトの名前を指定します。 .vcxproj などのファイル拡張子が含まれるプロジェクト ファイルではこの名前が採用され、既存のコード ファイルでは元の名前が保持されます。 |
    | **次のフィルダーからプロジェクトにファイルを追加** | オンにすると、既存のコード ファイルが元のディレクトリ (このコントロールの下のリスト ボックスで指定) から新しいプロジェクトにコピーされるようにウィザードが設定されます。<br/><br/>コード ファイルがすべてのサブディレクトリからプロジェクトにコピーされるように指定するには、**[サブフォルダーの追加]** をオンにします。 ディレクトリは **[フォルダー]** に一覧表示されています。<br/>- ウィザードが既存のコード ファイルを検索するディレクトリを指定するには、**[追加]** を選択して **[このフォルダーからプロジェクトにファイルを追加します]** ダイアログ ボックスを表示します。<br/>- リスト ボックスで選択したディレクトリ パスを削除するには、**[削除]** を選択します。<br/><br/>**[File types to add to the project]\(プロジェクトに追加するファイルの種類\)** ボックスで、指定されたファイル拡張子に基づいて、ウィザードで新しいプロジェクトに追加されるファイルの種類を指定します。 ファイル拡張子の前にアスタリスク ワイルドカード文字が付加され、ファイル拡張子のリストではセミコロンで区切られます。 |
    | **すべてのファイルをソリューション エクスプローラーに表示** | **ソリューション エクスプローラー** ウィンドウで、新しいプロジェクト内のすべてのファイルを参照および表示できるように指定します。 既定では、このオプションは有効になっています。 |

    ![プロジェクトの場所](media/location.png)

1. 新しいプロジェクトにビルド環境などを使用するにはプロジェクト設定を指定し、新しいプロジェクトで生成される特定のタイプを一致させるにはビルド設定を指定します。 **[次へ]** を選択して続行します。

    | 設定 | 説明 |
    | --- | --- |
    | **Visual Studio を使用する** | 新しいプロジェクトをビルドするため、Visual Studio に含まれているビルド ツールを使用するように指定します。 既定では、このオプションはオンです。<br/><br/>ウィザードで生成されるプロジェクトのタイプを指定するには、**[プロジェクト タイプ]** を選択します。 **[Windows アプリケーション プロジェクト]**、**[コンソール アプリケーション プロジェクト]**、**[ダイナミック リンク ライブラリ (DLL) プロジェクト]**、または **[スタティック ライブラリ (LIB) プロジェクト]** を選択します。<br/><br/>新しいプロジェクトに ATL サポートを追加するには、**[Add support for ATL]\(ATL サポートの追加\)** をオンにします。<br/><br/>新しいプロジェクトに MFC サポートを追加するには、**[Add support for MFC]\(MFC サポートの追加\)** をオンにします。<br/><br/>プロジェクトに CLR プログラミングのサポートを追加するには、**[Add support for the Common Language Runtime]\(共通言語ランタイムのサポートの追加\)** をオンにします。 Managed Extensions for C++ 構文、Visual C++ 2005 より前の CLR プログラミングと適合させるには、**[Common Language Runtime (old syntax)]\(共通言語ランタイム (古い構文)\)** などのコンプライアンス タイプに **[共通言語ランタイム サポート]** を選択します。 |
    | **外部のビルドシステムを使用する** | 新しいプロジェクトをビルドするため、Visual Studio に含まれていないビルド ツールを使用するように指定します。 このオプションを選択すると、**[デバッグの構成設定の指定]** ページと **[リリースの構成設定の指定]** ページでビルドのコマンド ラインを指定できます。 |

    ![プロジェクト設定](media/settings.png)

    > [!NOTE]
    > **[外部のビルドシステムを使用する]** オプションがオンになっていると、IDE が新しいプロジェクトをビルドしないため、コンパイルに /D、/I、/FI、/AI、または /FU オプションは必要ありません。 ただし、IntelliSense が正常に機能するためには、これらのオプションを正しく設定する必要があります。

1. 使用するデバッグ構成の設定を指定します。 **[次へ]** を選択して続行します。

    | 設定 | 説明 |
    | --- | --- |
    | **ビルド コマンド ライン** | プロジェクトをビルドするコマンド ラインを指定します。 コンパイラの名前 (とスイッチまたは引数) またはプロジェクトのビルドに使用するビルド スクリプトを入力します。 |
    | **リビルド コマンド ライン** | 新しいプロジェクトをリビルドするコマンド ラインを指定します。 |
    | **クリーン コマンド ライン** | プロジェクトのビルド ツールによって生成されたサポート ファイルを削除するコマンドラインを指定します。 |
    | **出力 (デバッグ用)** | プロジェクトのデバッグ構成用出力ファイルのディレクトリ パスを指定します。 |
    | **プリプロセッサの定義 (/D)** | プロジェクトのプリプロセッサ シンボルを定義する場合は、「[/D (プリプロセッサの定義)](../build/reference/d-preprocessor-definitions.md)」を参照してください。 |
    | **インクルードの検索パス (/I)** | プロジェクトのプリプロセッサ ディレクティブに渡されるファイル参照を解決するために、コンパイラによって検索されるディレクトリ パスを指定する場合は、「[/I (追加のインクルード ディレクトリ)](../build/reference/i-additional-include-directories.md)」を参照してください。 |
    | **強制インクルード ファイル (/FI)** | プロジェクトのビルド時に処理するヘッダー ファイルを指定する場合は、「[/FI (強制インクルード ファイルの名前の指定)](../build/reference/fi-name-forced-include-file.md)」を参照してください。 |
    | **.NET アセンブリ検索パス (/AI)** | プロジェクトのプリプロセッサ ディレクティブに渡される .NET アセンブリ参照を解決するために、コンパイラによって検索されるディレクトリ パスを指定する場合は、「[/AI (メタデータ ディレクトリの指定)](../build/reference/ai-specify-metadata-directories.md)」を参照してください。 |
    | **強制 using .NET アセンブリ (/FU)** | プロジェクトのビルド時に処理する .NET アセンブリを指定する場合は、「[/FU (強制 #using ファイルの名前の指定)](../build/reference/fu-name-forced-hash-using-file.md)」を参照してください。 |

    ![プロジェクト構成](media/config.png)

    > [!NOTE]
    > **Build**、**Rebuild**、**Clean** コマンド ラインと**出力 (デバッグ用)** の設定は、**[Use external build system]\(外部ビルド システムの使用\)** オプションが**プロジェクト設定の指定**のページでオンになっている場合にのみ有効です。

1. リリース構成の設定が使用されるように指定します。この設定はデバッグ構成の設定と同じです。 **[完了]** をクリックし、新しいプロジェクトを生成します。

    > [!NOTE]
    > ここでは、**[Same as Debug configuration]\(デバッグ構成と同じ\)** をオンにして、デバッグ構成プロジェクト設定と同じリリース構成プロジェクト設定がウィザードで生成されるように指定することができます。 既定では、このオプションはオンになっています。 このボックスをオフにした場合を除き、このページの他のオプションはすべて非アクティブになります。
