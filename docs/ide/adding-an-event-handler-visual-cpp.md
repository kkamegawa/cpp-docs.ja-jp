---
title: イベント ハンドラーを追加する
ms.date: 11/12/2018
f1_keywords:
- vc.codewiz.eventhandler.overview
- vc.codewiz.eventhandler.overview
helpviewer_keywords:
- event handlers, adding
- properties [Visual Studio], MSBuild
- MSBuild, properties
- event handler wizard [C++]
ms.assetid: 050bebf0-a9e0-474b-905c-796fe5ac8fc3
ms.openlocfilehash: 96e5b8777bb8b0c976277a06e8ad49b3334921fb
ms.sourcegitcommit: c1f646c8b72f330fa8cf5ddb0f8f261ba10d16f0
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/21/2019
ms.locfileid: "58328572"
---
# <a name="add-an-event-handler"></a>イベント ハンドラーを追加する

リソース エディターでは、[イベント ハンドラー ウィザード](#event-handler-wizard)を使用して、ダイアログ ボックス コントロールで新しいイベント ハンドラーを追加したり、既存のイベント ハンドラーを編集したりできます。

[[プロパティ] ウィンドウ](/visualstudio/ide/reference/properties-window)を使用すると、ダイアログ ボックスが実装されているクラスにイベントを追加できます。 ダイアログ ボックス クラス以外のクラスにイベントを追加するには、イベント ハンドラー ウィザードを使用します。

**ダイアログ ボックス コントロールにイベント ハンドラーを追加するには:**

1. [[リソース ビュー]](../windows/how-to-create-a-resource-script-file.md#create-resources) のダイアログ ボックス リソースをダブルクリックして、[ダイアログ エディター](../windows/dialog-editor.md)のコントロールが含まれるダイアログ ボックス リソースを開きます。

1. 通知イベントを処理するコントロールを右クリックします。

1. ショートカット メニューの **[イベント ハンドラーの追加]** を選択して、イベント ハンドラー ウィザードを表示します。

1. **[メッセージの種類]** ボックスでイベントを選択し、**[クラス] リスト** ボックスで選択されたクラスを追加します。

1. **[Function handler name]\(関数ハンドラー名\)** ボックスの既定の名前を受け入れるか、任意の名前を指定します。

1. **[Add and edit]\(追加と編集\)** を選択して、プロジェクトにイベント ハンドラーを追加し、新しい関数に対してテキスト エディターを開いて適切なイベント ハンドラー コードを追加します。

   選択したメッセージの種類に選択したクラスのイベント ハンドラーが既にある場合、**[Add and edit]\(追加と編集\)** は使用できず、**[コードの編集]** を使用する必要があります。 **[コードの編集]** を選択して、既存の関数に対してテキスト エディターを開きます。

または、[[プロパティ] ウィンドウ](/visualstudio/ide/reference/properties-window)からイベント ハンドラーを追加することも可能です。 詳細については、「[ダイアログ ボックス コントロールへのイベント ハンドラーの追加](../windows/adding-event-handlers-for-dialog-box-controls.md)」をご覧ください。

## <a name="in-this-section"></a>このセクションの内容

- [イベント ハンドラー ウィザード](#event-handler-wizard)

## <a name="event-handler-wizard"></a>イベント ハンドラー ウィザード

このウィザードは、ダイアログ ボックス コントロール用のイベント ハンドラーをクラスに追加します。 [プロパティ ウィンドウ](/visualstudio/ide/reference/properties-window)からイベント ハンドラーを追加する場合は、ダイアログ ボックスを実装するクラスに対してのみ追加できます。 詳細については、「[ダイアログ ボックス コントロールへのイベント ハンドラーの追加](../windows/adding-event-handlers-for-dialog-box-controls.md)」をご覧ください。

- **コマンド名**

  選ばれているコントロールを示します。このコントロールにイベント ハンドラーが追加されます。 このボックスは変更できません。

- **メッセージ型**

  選ばれているコントロールで現在使用可能なメッセージ ハンドラーの一覧が表示されます。

- **関数ハンドラー名**

  イベントを処理するために追加される関数の名前が表示されます。 既定の名前は、メッセージ型とコマンドに基づき、先頭に `On` が付加されます。 たとえば、`IDC_BUTTON1` という名前のボタンでメッセージ型が `BN_CLICKED` の場合、関数ハンドラーの名前は `OnBnClickedButton1` になります。

- **クラスの一覧**

  イベント ハンドラーを追加できるクラスが表示されます。 選ばれているダイアログ ボックスのクラスは、赤で表示されます。

- **ハンドラーの説明**

  **[メッセージ型]** ボックスで選ばれている項目の説明が表示されます。 このボックスは変更できません。

- **追加と編集**

  選択したクラスまたはオブジェクトに、メッセージ ハンドラーを追加します。 また、新しい関数に対してテキスト エディターが開かれ、コントロール通知用のハンドラー コードを追加できるようになります。

- **コードの編集**

  選択した既存の関数がテキスト エディターで開き、コントロール通知ハンドラー コードを追加または編集できます。
