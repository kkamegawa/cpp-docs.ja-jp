---
title: メソッドを追加する
ms.date: 11/09/2018
f1_keywords:
- vc.codewiz.method.overview
- vc.codewiz.method.idlattrib
helpviewer_keywords:
- add method wizard [C++]
- methods [C++], adding
- methods [C++], adding using wizards
- IDL attributes, add method wizard
ms.assetid: 4ba4e45f-fa38-4d5e-af44-cbec0a7ab558
ms.openlocfilehash: b0c8ddabc4ed08fd217545bad269f0b2e48dd49e
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69509543"
---
# <a name="add-a-method"></a>メソッドを追加する

[メソッド追加ウィザード](#add-method-wizard)を使用して、プロジェクトのインターフェイスにメソッドを追加できます。 インターフェイスに関連付けられたクラスがプロジェクトに含まれている場合、ウィザードではクラスも変更します。

**オブジェクトにメソッドを追加するには:**

1. **[クラス ビュー]** でプロジェクト ノードを展開し、メソッドを追加するインターフェイスを表示します。

   > [!NOTE]
   > プロジェクトに属性が設定されていない限り、ライブラリ ノード下にあるディスパッチ インターフェイスに、メソッドを追加することもできます。

1. インターフェイス名を右クリックします。

1. ショートカット メニューの **[追加]** を選択し、次に **[メソッドの追加]** を選択します。

1. メソッド追加ウィザードで、メソッドを作成する情報を指定します。

1. ウィザードの [[IDL 属性]](#idl-attributes-add-method-wizard) ページで、このメソッドのインターフェイス定義言語設定を指定します。

1. **[完了]** をクリックしてメソッドを追加します。

## <a name="in-this-section"></a>このセクションの内容

- [メソッド追加ウィザード](#add-method-wizard)
- [IDL 属性、メソッド追加ウィザード](#idl-attributes-add-method-wizard)

## <a name="add-method-wizard"></a>メソッド追加ウィザード

このウィザードを使用して、インターフェイスにメソッドを追加します。 ウィザードには、メソッドの追加先となるプロジェクトの種類やインターフェイスの型に応じて異なるオプションが表示されます。

### <a name="names"></a>名前

- **戻り値の型**

  メソッドによって返されるデータ型。 `HRESULT` は標準的なエラーを返す方法を提供しているため、すべてのインターフェイスの型で使用することをお勧めします。

  |インターフェイスの型|説明|
  |--------------------|-----------------|
  |デュアル インターフェイス|`HRESULT`。 変更できません。|
  |カスタム インターフェイス|`HRESULT`。 変更できません。|
  |ローカル カスタム インターフェイス|独自の戻り値の型を指定するか、リストから選択します。|
  |ディスパッチ インターフェイス|独自の戻り値の型を指定するか、リストから選択します。|
  |MFC ActiveX コントロールのディスパッチ インターフェイス|ストック メソッドを実装する場合、戻り値の型は適切な値に設定され、変更することはできません。 **[メソッド名]** リストからメソッドを選択して、 **[メソッドの型]** の **[カスタム]** を選択した場合は、リストから戻り値の型を選びます。|

- **メソッド名**

  メソッドの名前を設定します。

  |インターフェイスの型|説明|
  |--------------------|-----------------|
  |ATL デュアル インターフェイス、カスタム インターフェイス、およびローカル カスタム インターフェイス|独自のメソッド名を指定します。|
  |MFC ディスパッチ インターフェイス|独自のメソッド名を指定するか、リストから推奨されるメソッド名を選択します。 リストから名前を選択すると、 **[戻り値の型]** ボックスに適切な値が表示されます。これを変更することはできません。|
  |MFC ActiveX コントロールのディスパッチ インターフェイス|独自のメソッド名を指定するか、ストック メソッドである [DoClick](../mfc/reference/colecontrol-class.md#doclick) または [Refresh](../mfc/reference/colecontrol-class.md#refresh) を選択します。 詳細については、次をご覧ください: 「[MFC ActiveX コントロール:ストック メソッドの追加](../mfc/mfc-activex-controls-adding-stock-methods.md)」。|

- **メソッドの型**

  MFC ActiveX コントロールでのみ使用できます。 リストからメソッドを選択するのではなく、 **[メソッド名]** ボックスでメソッド名を指定する場合、このボックスは使用できません。

  **[メソッド名]** リストのメソッドのいずれかを選択する場合は、ストック実装またはカスタム実装を選びます。

  |メソッドの型|説明|
  |-----------------|-----------------|
  |**ストック**|これが既定値です。 **[メソッド名]** リストで選択したメソッドのストック実装を挿入します。 **[ストック]** を選択した場合は、**戻り値の型**を変更することはできません。|
  |**カスタム**|**[メソッド名]** リストで選択したメソッドのスタブ実装を挿入します。 カスタム メソッドの型については、独自の戻り値の型を指定することも、 **[戻り値の型]** リストからいずれかを選択することもできます。|

- **内部名**

  MFC ディスパッチ インターフェイスに追加されたカスタム メソッドのみで使用できます。 ディスパッチ マップ、ヘッダー (.h) ファイル、実装 (.cpp) ファイルで使用される名前を設定します。 既定では、この名前は**メソッド名**と同じになります。 MFC ディスパッチ インターフェイスを使用する場合、または MFC ActiveX コントロールのディスパッチ インターフェイスにカスタム メソッドを追加する場合は、メソッド名を変更することができます。

  |インターフェイスの型|説明|
  |--------------------|-----------------|
  |ATL デュアル インターフェイス、カスタム インターフェイス、およびローカル カスタム インターフェイス|使用できません。|
  |MFC ディスパッチ インターフェイス|既定では、メソッド名に設定します。 内部名を編集することができます。|
  |MFC ActiveX コントロールのディスパッチ インターフェイス|カスタム メソッドでのみ内部名を設定することができます。 ストック メソッドでは内部名を使用しません。|

- **パラメーター属性**

  **[パラメーター名]** で指定されたパラメーターの追加の属性を設定します。

  |パラメーター属性|説明|許可されている組み合わせ|
  |-------------------------|-----------------|--------------------------|
  |**In**|パラメーターが呼び出しプロシージャから呼び出されたプロシージャに渡されることを示します。|`in` のみ<br /><br /> `in` および `out`|
  |**Out**|ポインター パラメーターが呼び出されたプロシージャから呼び出したプロシージャ (サーバーからクライアント) に返されることを示します。|`out` のみ<br /><br /> `in` および `out`<br /><br /> `out` および `retval`|
  |**retval**|メンバーの戻り値を受け取るパラメーターを示します。|`retval` および `out`|

- **パラメーターの型**

  パラメーターのデータ型を設定します。 リストから型を選択します。

- **パラメーター名**

  メソッドを介して渡すパラメーターの名前を設定します。 名前を入力したら、 **[追加]** を選択し、メソッドを介して渡すパラメーターのリストに追加します。 パラメーター名を指定しない場合、ウィザードではパラメーターの属性 (ATL のみ) や **[パラメーターの型]** の選択内容は無視されます。

  **[追加]** を選択すると、パラメーター名が **[パラメーター リスト]** に表示されます。

  > [!NOTE]
  > パラメーター名を指定し、 **[追加]** を選択する前に **[完了]** を選択した場合、パラメーターはメソッドに追加されません。 メソッドを検索し、パラメーターを手動で挿入する必要があります。

- **[追加]**

  **[パラメーター名]** で指定したパラメーターと、その型およびパラメーターの属性を、 **[パラメーター リスト]** に追加します。 **[追加]** を選択して、リストにパラメーターを追加します。

- **削除**

  リストから **[パラメーター リスト]** で選択したパラメーターを削除します。

- **パラメーター リスト**

  メソッドに現在追加されているすべてのパラメーターとその修飾子および型を表示します。 パラメーターを追加すると、ウィザードで **[パラメーター リスト]** が更新され、各パラメーターがその修飾子および型と共に表示されます。

## <a name="idl-attributes-add-method-wizard"></a>IDL 属性、メソッド追加ウィザード

メソッド追加ウィザードのこのページを使用して、メソッドのインターフェイス定義言語 (IDL) 設定を指定します。

- `id`

  メソッドを識別する数値 ID を設定します。 詳細については、*MIDL リファレンス*の [id](/windows/win32/Midl/id) に関するページを参照してください。

  このボックスは、カスタム インターフェイスでは使用不可であり、MFC ディスパッチ インターフェイスで使用することはできません。

- `call_as`

  このローカル メソッドをマップできるリモート メソッドの名前を指定します。 詳細については、*MIDL リファレンス*の [call_as](/windows/win32/Midl/call-as) に関するページを参照してください。

  MFC ディスパッチ インターフェイスでは使用できません。

- `helpcontext`

  コンテキスト ID を指定します。ユーザーはヘルプ ファイルでこのメソッドに関する情報を参照できます。 詳細については、*MIDL リファレンス*の [helpcontext](/windows/win32/Midl/helpcontext) に関するページを参照してください。

  MFC ディスパッチ インターフェイスでは使用できません。

- `helpstring`

  適用先となる要素を記述するために使用される文字列を指定します。 既定では、"メソッド <*メソッド名*>" に設定されます。 詳細については、*MIDL リファレンス*の [helpstring](/windows/win32/Midl/helpstring) に関するページを参照してください。

  MFC ディスパッチ インターフェイスでは使用できません。

- **追加の属性**

  MFC ディスパッチ インターフェイスでは使用できません。

  |属性|説明|
  |---------------|-----------------|
  |`hidden`|メソッドは存在するが、ユーザー指向ブラウザーでは表示されないことを示します。 詳細については、*MIDL リファレンス*の [hidden](/windows/win32/Midl/hidden) に関するページを参照してください。|
  |`source`|メソッドのメンバーがイベントのソースであることを示します。 詳細については、*MIDL リファレンス*の [source](/windows/win32/Midl/source) に関するページを参照してください。|
  |`local`|メソッドがリモートでないことを MIDL コンパイラに対して指定します。 詳細については、*MIDL リファレンス*の [local](/windows/win32/Midl/local) に関するページを参照してください。|
  |`restricted`|メソッドを任意に呼び出せないことを指定します。 詳細については、*MIDL リファレンス*の [restricted](/windows/win32/Midl/restricted) に関するページを参照してください。|
  |`vararg`|メソッドが可変個の引数を取ることを指定します。 そのためには、最後の引数が、残りのすべての引数を含む `VARIANT` 型のセーフ配列である必要があります。 詳細については、*MIDL リファレンス*の [vararg](/windows/win32/Midl/vararg) に関するページを参照してください。|
