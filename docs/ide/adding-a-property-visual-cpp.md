---
title: プロパティを追加する
ms.date: 11/09/2018
f1_keywords:
- vc.codewiz.prop.overview
- vc.codewiz.prop.idlattributes
helpviewer_keywords:
- interfaces, adding properties
- properties [C++], adding to interfaces
- names, add property wizard
- IDL attributes, add property wizard
- stock properties, about stock properties
- stock properties
ms.assetid: 37bd4db7-efd3-4faa-87ad-64902ed16a36
ms.openlocfilehash: 5c472b74fee690c0cf33f78eca9e2e8462930eb8
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69509533"
---
# <a name="add-a-property"></a>プロパティを追加する

[プロパティ追加ウィザード](#names-add-property-wizard)を使用して、ご利用のプロジェクトのインターフェイスにメソッドを追加することができます。

**ご利用のオブジェクトにプロパティを追加するには:**

1. [クラス ビュー](/visualstudio/ide/viewing-the-structure-of-code)で、プロパティを追加するインターフェイスを右クリックします。

   > [!NOTE]
   > プロジェクトに属性が設定されていない限り、ライブラリ ノード内で入れ子にされるディスパッチ インターフェイスに、プロパティを追加することもできます。

1. ショートカット メニューから、 **[追加]** 、 **[プロパティの追加]** の順に選択します。

1. [プロパティ追加ウィザード](#names-add-property-wizard)で、情報を指定してプロパティを作成します。

1. ウィザードの [[IDL 属性]](#idl-attributes-add-property-wizard) ページで、プロパティのインターフェイス定義言語 (IDL) 設定を指定します。

1. **[完了]** を選択してプロパティを追加します。

プロパティの `Get` メソッドと `Put` メソッドは、定義されているインターフェイスの下のクラス ビューに 2 つのアイコンとして表示されます。 いずれかのアイコンをダブルクリックして、.idl ファイルのプロパティ宣言を表示できます。

- ATL インターフェイスの場合は、`Get` 関数と `Put` 関数が .cpp ファイルに追加され、これらの関数への参照が .h ファイルに追加されます。

- MFC ディスパッチ インターフェイスについては、実装型として**メンバー変数**を選択した場合、メソッドと変数が実装するクラスに追加されます。 実装型として **Get/Set メソッド**を選択した場合、2 つのメソッドが実装するクラスに追加されます。

## <a name="in-this-section"></a>このセクションの内容

- [[名前] (プロパティの追加ウィザード)](#names-add-property-wizard)
- [[IDL 属性] (プロパティの追加ウィザード)](#idl-attributes-add-property-wizard)
- [ストック プロパティ](#stock-properties)

## <a name="names-add-property-wizard"></a>[名前] (プロパティの追加ウィザード)

このウィザードを使用して、インターフェイスにプロパティを追加します。

- **プロパティの型**

  追加するプロパティの型を設定します。 MFC ディスパッチ インターフェイスの場合、独自の型を指定するか、定義済みのリストから選択します。 プロパティのストック実装を提供する場合、**プロパティの型**はストック型に設定され、変更には使用できません。

- **プロパティ名**

  プロパティの名前を設定します。 ActiveX コントロールに関連付けられている MFC ディスパッチ インターフェイスの場合、独自の名前を指定するか、定義済みのリストからストック プロパティの名前を選択できます。 独自のプロパティ名を指定すると、**ストック**実装の型は使用できません。 リスト内のプロパティの説明については、「[ストック プロパティ](#stock-properties)」を参照してください。

  |インターフェイスの型|説明|
  |--------------------|-----------------|
  |ATL デュアル インターフェイス、カスタム インターフェイス、およびローカル カスタム インターフェイス|プロパティ名を指定します。|
  |MFC ディスパッチ インターフェイス、MFC ActiveX コントロールのディスパッチ インターフェイス|プロパティ名を指定するか、リストからストック プロパティを選択します。 リストからプロパティを選択すると、 **[プロパティの型]** ボックスに適切な値が表示されます。 この型は、 **[実装型]** での選択に応じて変更できます。|

- **戻り値の型**

  ATL インターフェイスのみ。 プロパティの戻り値の型を設定します。 デュアル インターフェイスの場合、戻り値の型は常に `HRESULT` で、このボックスは使用できません。 カスタム インターフェイスの場合、リストから戻り値の型を選択できます。 それでも、`HRESULT` は標準的なエラーを返す方法を提供しているため、こちらをお勧めします。

- **変数名**

  MFC のディスパッチ インターフェイスのみ。 **[実装型]** で **[メンバー変数]** を指定した場合にのみ使用できます。 プロパティが関連付けられているメンバー変数の名前を設定します。 既定では、変数名は `m_`*PropertyName* に設定されます。 この名前は編集できます。

- **通知関数**

  MFC のディスパッチ インターフェイスのみ。 **[実装型]** で **[メンバー変数]** を指定した場合にのみ使用できます。 プロパティが変更された場合に呼び出される通知関数の名前を設定します。 既定では、通知関数の名前は、`On`*PropertyName*`Changed` に設定されます。 この名前は編集できます。

- **Get 関数**

  MFC ディスパッチ インターフェイス用。 **[実装型]** で **[Get/Set メソッド]** を指定した場合にのみ使用できます。 プロパティを取得する関数の名前を設定します。 既定では、`Get` 関数の名前は `Get`*PropertyName* に設定されます。 この名前は編集できます。 名前を削除すると、関数 [GetNotSupported](../mfc/reference/colecontrol-class.md#getnotsupported) がインターフェイス ディスパッチ マップに挿入されます。 `Get`*PropertyName* 関数により、プロパティが読み取り可能として指定されます。

- **Set 関数**

  MFC のディスパッチ インターフェイスのみ。 **[実装型]** で **[Get/Set メソッド]** を指定した場合にのみ使用できます。 プロパティを設定する関数の名前を設定します。 既定では、`Set` 関数の名前は `Set`*PropertyName* に設定されます。 この名前は編集できます。 名前を削除すると、関数 [SetNotSupported](../mfc/reference/colecontrol-class.md#setnotsupported) がインターフェイス ディスパッチ マップに挿入されます。 `Set`*PropertyName* 関数により、プロパティが書き込み可能であることが指定されます。

- **実装型**

  MFC のディスパッチ インターフェイスのみ。 追加するプロパティを実装する方法を指定します。

  |実装型|説明|
  |-------------------------|-----------------|
  |**ストック**|**プロパティ名**で選択したプロパティのストック実装を指定します。 これが既定値です。 詳細については、「[ストック プロパティ](#stock-properties)」を参照してください。<br /><br /> **[ストック]** を指定すると、 **[プロパティの型]** 、 **[パラメーターの型]** 、および **[パラメーター名]** が淡色表示になります。|
  |**メンバー変数**|メンバー変数として追加されるプロパティを指定します。 カスタム プロパティやほとんどのストック プロパティをメンバー変数として追加することができます。 `Caption` プロパティ、`hWnd` プロパティ、`Text` プロパティの**メンバー変数**を指定することはできません。<br /><br /> **[変数名]** と **[通知関数]** の下に既定の名前を提供します。 この名前は編集できます。|
  |**Get/Set メソッド**|既定で `Get`*PropertyName* 関数および `Set`*PropertyName* 関数として追加されるプロパティを指定します。 これらの名前は、 **[Get 関数]** および **[Set 関数]** の下に表示されます。<br /><br /> Get 関数の値を渡す既定の**プロパティの型**は変更できます。 `Get` 関数および `Set` 関数のパラメーターを指定することができます。|

- **Get 関数**

  ATL インターフェイス用。 プロパティを読み取り可能として設定します。つまり、オブジェクトからこのプロパティを取得するために、`Get` メソッドを作成します。 **Get**、**Put**、またはその両方を選択します。

- **Put 関数**

  ATL インターフェイスのみ。 プロパティを書き込み可能に設定します。つまり、オブジェクトのこのプロパティを設定 ("配置") するための `Put` メソッドを作成します。 **Get**、**Put**、またはその両方を選択します。 このオプションを選択すると、メソッドを実装するため、次の 2 つの方法から選択できます。

  |オプション|説明|
  |------------|-----------------|
  |**PropPut**|[PropPut](../windows/propput.md) 関数は、オブジェクトのコピーを返します。 これが既定で、プロパティを書き込み可能にする最も一般的な方法です。|
  |**PropPutRef**|[PropPutRef](../windows/propputref.md) 関数は、オブジェクト自体のコピーを返すのではなく、オブジェクトへの参照を返します。 このオプションは、初期化のオーバーヘッドが発生する可能性がある、大規模な構造体や配列などのオブジェクトに対して使用することを検討してください。|

- **パラメーター属性**

  ATL インターフェイスのみ。 **パラメーター名**で指定されたパラメーターを `in`、`out`、その両方、またはなしのいずれにするかを設定します。

  |オプション|説明|
  |------------|-----------------|
  |`in`|パラメーターが呼び出しプロシージャから呼び出されたプロシージャに渡されることを示します。|
  |`out`|ポインター パラメーターが呼び出されたプロシージャから呼び出したプロシージャ (サーバーからクライアント) に返されることを示します。|

- **パラメーターの型**

  パラメーターのデータ型を設定します。 リストから型を選択します。

- **パラメーター名**

  プロパティにパラメーターがある場合、プロパティに追加するパラメーターの名前を設定します。 **[追加]** を選択すると、パラメーター名が **[パラメーター リスト]** に表示されます。

- **パラメーター リスト**

  プロパティに追加する属性のリストを表示します。 リスト内の各項目は、パラメーター名、パラメーターの型、および属性で構成されます。 リストを更新するには、 **[追加]** と **[削除]** を使用します。

- **[追加]**

  **[パラメーター名]** と **[パラメーターの型]** で指定したパラメーターを **[パラメーター リスト]** に追加します。 **[追加]** を選択して、リストにパラメーターを追加します。

- **削除**

  **[パラメーター リスト]** で選択したパラメーターを削除します。

- **既定のプロパティ**

  MFC ディスパッチ インターフェイスのみ。 インターフェイスの既定値としてこのプロパティを設定します。 1 つのインターフェイスで持てるのは、既定のプロパティ 1 つだけです。インターフェイスに追加するその他のプロパティに既定のプロパティを指定すると、このボックスは使用できなくなります。

## <a name="idl-attributes-add-property-wizard"></a>[IDL 属性] (プロパティの追加ウィザード)

プロパティの追加ウィザードのこのページでは、プロパティのインターフェイス定義言語 (IDL) の設定を指定します。

- `id`

  プロパティを識別する数値 ID を設定します。 このオプションは、カスタム インターフェイスのプロパティでは使用できません。 *MIDL リファレンス*の [id](/windows/win32/Midl/id) に関するページを参照してください。

- `helpcontext`

  コンテキスト ID を指定します。ユーザーはヘルプ ファイルでこのプロパティに関する情報を参照できます。 *MIDL リファレンス*の [helpcontext](/windows/win32/Midl/helpcontext) に関するページを参照してください。

- `helpstring`

  適用先となる要素を記述するために使用される文字列を指定します。 既定では、`property`&nbsp;*Property&nbsp;name* に設定されます。 *MIDL リファレンス*の [helpstring](/windows/win32/Midl/helpstring) に関するページを参照してください。

### <a name="other-options"></a>その他のオプション

すべてのオプションをすべてのプロパティの種類で使用できるわけではありません。

|オプション|説明|
|------------|-----------------|
|`bindable`|プロパティがデータ バインディングをサポートすることを示します。 *MIDL リファレンス*の [bindable](/windows/win32/Midl/bindable) に関するページを参照してください。 プロパティのストック実装では、このオプションは既定で設定され、変更できません。|
|`defaultbind`|これがオブジェクトを最もよく表す 1 つのバインド可能なプロパティであることを示します。 *MIDL リファレンス*の [defaultbind](/windows/win32/Midl/defaultbind) に関するページを参照してください。|
|`displaybind`|このプロパティをユーザーにバインド可能として表示する必要があることを示します。 *MIDL リファレンス*の [displaybind](/windows/win32/Midl/displaybind) に関するページを参照してください。|
|`immediatebind`|データ バインディング オブジェクトのこのプロパティに対するすべての変更が、すぐにデータベースに通知されることを示します。 *MIDL リファレンス*の [immediatebind](/windows/win32/Midl/immediatebind) に関するページを参照してください。|
|`defaultcollelem`|プロパティが既定コレクションの要素に対するアクセサー関数であることを示します。 *MIDL リファレンス*の [defaultcollelem](/windows/win32/Midl/defaultcollelem) に関するページを参照してください。|
|`nonbrowsable`|プロパティ ブラウザーに表示してはならない interface または dispinterface メンバーにタグを付けます。 *MIDL リファレンス*の [nonbrowsable](/windows/win32/Midl/nonbrowsable) に関するページを参照してください。|
|`requestedit`|`OnRequestEdit` 通知がプロパティでサポートされることを示します。 "*MIDL リファレンス*" の [requestedit](/windows/win32/Midl/requestedit) に関するページを参照してください。 プロパティのストック実装では、このオプションは既定で設定され、変更できません。|
|`source`|プロパティのメンバーがイベントのソースであることを示します。 *MIDL リファレンス* の [source](/windows/win32/Midl/source) に関するページを参照してください。|
|`hidden`|プロパティは存在しますが、ユーザー指向ブラウザーでは表示されないことを示します。 *MIDL リファレンス*の [hidden](/windows/win32/Midl/hidden) に関するページを参照してください。|
|`restricted`|プロパティを任意に呼び出せないことを指定します。 *MIDL リファレンス* の [restricted](/windows/win32/Midl/restricted) に関するページを参照してください。|
|`local`|プロパティがリモートでないことを MIDL コンパイラに対して指定します。 *MIDL リファレンス* の [local](/windows/win32/Midl/local) に関するページを参照してください。|

## <a name="stock-properties"></a>ストック プロパティ

[プロパティ追加ウィザード](#idl-attributes-add-property-wizard)を使用して、MFC ディスパッチ インターフェイスにプロパティを追加する場合、ウィザードの [[名前]](../ide/names-add-property-wizard.md) ページの **[プロパティ名]** 一覧からストック プロパティを選択できます。 選択できるプロパティは次のとおりです。

|プロパティ名|説明|
|-------------------|-----------------|
|`Appearance`|コントロールの外観を決定する値を返すか設定します。 コントロールの `Appearance` プロパティには、3D 表示効果を含めることも省略することもできます。 このプロパティはアンビエント読み取り/書き込みプロパティです。|
|`BackColor`|コントロールのアンビエント `BackColor` プロパティを返すか、パレット (RGB) 色か定義済みのシステム色に設定します。 既定では、その値はコントロールのコンテナーの前景色に一致します。 このプロパティはアンビエント読み取り/書き込みプロパティです。|
|`BorderStyle`|コントロールの境界線スタイルを返すか設定します。 このプロパティは読み取り/書き込みプロパティです。|
|`Caption`|コントロールの `Caption` プロパティを返すか設定します。 このキャプションはウィンドウのタイトルです。 `Caption` には、**メンバー変数**実装型がありません。|
|`Enabled`|コントロールの `Enabled` プロパティを返すか設定します。 有効コントロールは、ユーザー生成イベントに応答できます。|
|`Font`|コントロールのアンビエント フォントを返すか設定します。 コントロールにフォントがない場合、Null になります。|
|`ForeColor`|コントロールのアンビエント `ForeColor` プロパティを返すか設定します。|
|`hWnd`|コントロールの `hWnd` プロパティを返すか設定します。 `hWnd` には、**メンバー変数**実装型がありません。|
|`ReadyState`|コントロールの `ReadyState` プロパティを返すか設定します。 コントロールの状態には、「初期化されていません」、「初期化されています」、「読み込んでいます」、「インタラクティブ」、「完了」があります。 詳細については、*インターネット SDK* の [READYSTATE](/previous-versions//aa768362\(v=vs.85\)) に関するページを参照してください。|
|`Text`|コントロールに格納されているテキストを返すか設定します。 `Text` には、**メンバー変数**実装型がありません。|
