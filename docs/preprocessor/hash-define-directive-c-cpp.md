---
title: '#define ディレクティブ (C/C++)'
ms.date: 08/29/2019
f1_keywords:
- '#define'
helpviewer_keywords:
- define directive (#define), syntax
- preprocessor, directives
- define directive (#define)
- '#define directive, syntax'
- '#define directive'
ms.assetid: 33cf25c6-b24e-40bf-ab30-9008f0391710
ms.openlocfilehash: b72e2468b9e9984237c81f5cdb3c5691fe95cbd0
ms.sourcegitcommit: 6e1c1822e7bcf3d2ef23eb8fac6465f88743facf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/03/2019
ms.locfileid: "70216281"
---
# <a name="define-directive-cc"></a>#define ディレクティブ (C/C++)

**#Define**は、識別子またはパラメーター化された識別子とトークン文字列を関連付けた*マクロ*を作成します。 マクロが定義されると、コンパイラはそれ以降にソース ファイル内に識別子が見つかるたびに、トークン文字列に置き換えることができます。

## <a name="syntax"></a>構文

> **#define** *識別子* *トークン-文字列*<sub>選択</sub>\
> **#define** *識別子* **(** *識別子*<sub></sub>**の**選択... **,** *識別子*<sub>選択</sub> **)** *トークン文字列の*<sub>選択</sub>

## <a name="remarks"></a>Remarks

**#Define**ディレクティブにより、コンパイラは、ソースファイル内の*識別子*が出現するたびに*トークン文字列*を置き換えます。 *識別子*は、トークンを形成するときにのみ置き換えられます。 つまり、識別子がコメント、文字列、または長い識別子の一部として出現する場合、*識別子*は置き換えられません。 詳細については、「[トークン](../cpp/tokens-cpp.md)」を参照してください。

*トークン文字列*引数は、キーワード、定数、完全なステートメントなど、一連のトークンで構成されます。 1つ以上の空白文字*で、識別子からトークン文字列*を区切る必要があります。 この空白は、置き換えられるテキストの一部とは見なされません。最後のトークンのテキストに続く空白も同様です。

`#define` *トークン文字列*のないは、ソースファイルから*識別子*の出現を削除します。 *識別子*は定義されたままであり、 `#if defined` `#ifdef`ディレクティブとディレクティブを使用してテストできます。

2 番目の構文形式は、パラメーターを受け取る関数に似たマクロを定義します。 この形式では、かっこで囲んだパラメーターのリストを使用できます (省略可能)。 マクロを定義すると、それ以降の*識別子*(*識別子*の<sub>opt</sub>、...、*識別子*の<sub>opt</sub> ) が、実際の引数を持つ*トークン文字列*引数のバージョンに置き換えられます。仮パラメーターの代わりに使用します。

実際の値が置換される場所をマークするために、*トークン文字列*に仮パラメーター名が表示されます。 各パラメーター名は、*トークン文字列*で複数回使用できます。また、名前は任意の順序で表示できます。 呼び出しにある引数の数は、マクロ定義にあるパラメーターの数に一致する必要があります。 かっこを多めに使用することで、複雑な実引数が正しく解釈されるようにできます。

リスト内で仮パラメーターはコンマで区切ります。 リストの各名前は一意である必要があり、リストはかっこで囲む必要があります。 *識別子*と始めかっこを区切るスペースは使用できません。 行の連結を使用する—複数`\`のソース行の長いディレクティブの場合は、改行文字の直前に円記号 () を挿入します。 仮パラメーター名のスコープは、*トークン文字列*を終了する新しい行まで拡張されます。

マクロが 2 番目の構文形式で定義されると、それ以降の引数リストまでのテキスト インスタンスがマクロの呼び出しを示します。 ソースファイル内の*識別子*のインスタンスに続く実際の引数は、マクロ定義内の対応する仮パラメーターと照合されます。 *トークン文字列*の各仮パラメーターの`#`前に、文字列化 ()、文字定数化化 (`#@``##`)、またはトークンの貼り付け () 演算子が付いていないか`##` 、その後に演算子が指定されていない場合は、対応する実際の引数。 ディレクティブが仮パラメーターを置き換える前に、実引数内のすべてのマクロが展開されます (演算子については、「[プリプロセッサ演算子](../preprocessor/preprocessor-operators.md)」を参照してください)。

次の引数を持つマクロの例では、 **#define**構文の2番目の形式を示しています。

```C
// Macro to define cursor lines
#define CURSOR(top, bottom) (((top) << 8) | (bottom))

// Macro to get a random integer with a specified range
#define getrandom(min, max) \
    ((rand()%(int)(((max) + 1)-(min)))+ (min))
```

副作用のある引数が原因で、マクロが予期しない結果を生成することがあります。 指定された仮パラメーターは、*トークン文字列*に複数回出現する場合があります。 その仮パラメーターが副作用のある式と置き換えられると、その式は、その副作用と共に、複数回評価される場合があります ([トークン連結演算子 (# #)](../preprocessor/token-pasting-operator-hash-hash.md)の例を参照してください)。

`#undef` ディレクティブは、識別子のプリプロセッサ定義を未定義の状態にします。 詳細について[は、#undef ディレクティブ](../preprocessor/hash-undef-directive-c-cpp.md)を参照してください。

定義されているマクロの名前が (別のマクロの展開の結果としてでも)*トークン文字列*で発生した場合、それは展開されません。

同じ名前のマクロの2番目の **#define**では、2番目のトークンシーケンスが最初のトークンシーケンスと同一でない限り、警告が生成されます。

**Microsoft 固有の仕様**

Microsoft C/C++ では、新しい定義が元の定義と構文的に同一の場合、マクロを再定義できます。 つまり、2 つの定義に異なるパラメーター名を付けることができます。 この動作は ANSI C とは異なり、2つの定義は構文的に同一である必要があります。

たとえば、次の 2 つのマクロは、パラメーター名を除いて同一です。 ANSI C ではこのような再定義は許可されC++ませんが、Microsoft c はエラーなしでコンパイルします。

```C
#define multiply( f1, f2 ) ( f1 * f2 )
#define multiply( a1, a2 ) ( a1 * a2 )
```

一方、次の 2 つのマクロは同一ではなく、Microsoft C/C++ で警告が生成されます。

```C
#define multiply( f1, f2 ) ( f1 * f2 )
#define multiply( a1, a2 ) ( b1 * b2 )
```

**Microsoft 固有の仕様はここまで**

次の例は、 **#define**ディレクティブを示しています。

```C
#define WIDTH       80
#define LENGTH      ( WIDTH + 10 )
```

最初のステートメントは識別子 `WIDTH` を整数定数 80 として定義し、`LENGTH` と整数定数 10 に基づき `WIDTH` を定義します。 `LENGTH` は見つかるたびに (`WIDTH + 10`) に置き換えられます。 次に、`WIDTH + 10` は見つかるたびに式 (`80 + 10`) に置き換えられます。 `WIDTH + 10` を囲むかっこは、次のようなステートメントの解釈を制御するため重要です。

```C
var = LENGTH * 20;
```

プロプロセス段階が終了すると、ステートメントは次のようになります。

```C
var = ( 80 + 10 ) * 20;
```

1800 に評価されます。 かっこがない場合、結果は次のようになります。

```C
var = 80 + 10 * 20;
```

これは280に評価されます。

**Microsoft 固有の仕様**

[/D](../build/reference/d-preprocessor-definitions.md)コンパイラオプションを使用してマクロと定数を定義すると、ファイルの先頭で **#define**前処理ディレクティブを使用する場合と同じ効果があります。 /D オプションを使用して最大 30 個のマクロを定義できます。

**Microsoft 固有の仕様はここまで**

## <a name="see-also"></a>関連項目

[プリプロセッサディレクティブ](../preprocessor/preprocessor-directives.md)
