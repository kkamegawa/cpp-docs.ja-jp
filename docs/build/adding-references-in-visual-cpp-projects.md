---
title: プロジェクト内のライブラリとC++コンポーネントの使用
ms.date: 12/10/2018
f1_keywords:
- VC.Project.References
helpviewer_keywords:
- Add References Dialog Box (C++)
- .NET Framework (C++), Add References Dialog Box
ms.assetid: 12b8f571-0f21-40b3-9404-5318a57e9cb5
ms.openlocfilehash: a65ad69914b14e7b8b37c321fa7d06740af57e3a
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69493383"
---
# <a name="consuming-libraries-and-components"></a>ライブラリとコンポーネントの使用

多くの場合C++ 、プロジェクトは、静的ライブラリ (.lib ファイル)、DLL、Windows ランタイムコンポーネント、COM コンポーネント、.net アセンブリなどのバイナリファイル内の関数を呼び出したり、データにアクセスしたりする必要があります。 このような場合は、ビルド時にそのバイナリを見つけることができるようにプロジェクトを構成する必要があります。 具体的な手順は、プロジェクトの種類、バイナリの種類、およびバイナリがプロジェクトと同じソリューションでビルドされているかどうかによって異なります。 

## <a name="consuming-libraries-downloaded-via-vcpkg"></a>Vcpkg を使用してダウンロードされたライブラリを使用する

**Vcpkg** package manager を使用してダウンロードしたライブラリを使用するには、次の手順を無視します。 「[vcpkg: 詳細C++については、Windows、Linux](vcpkg.md#integrate-with-visual-studio-windows) 、MacOS のパッケージマネージャーを参照してください。

## <a name="consuming-static-libraries"></a>スタティックライブラリの使用

スタティックライブラリプロジェクトが同じソリューション内に構築されている場合は、次のようになります。

1. #<a name="include-the-header-files-for-the-static-library-using-quotation-marks-in-a-typical-solution-the-path-will-start-with-library-project-name-intellisense-will-help-you-find-it"></a>引用符を使用して、スタティックライブラリのヘッダーファイルを含めます。 一般的なソリューションでは、パスはで`../<library project name>`始まります。 IntelliSense を使用して見つけることができます。
2. スタティックライブラリプロジェクトへの参照を追加します。 **ソリューションエクスプローラー**の アプリケーションプロジェクト ノードの下にある **参照** を右クリックし、**参照の追加** を選択します。 

スタティックライブラリがソリューションに含まれていない場合は、次の手順を実行します。

1. **ソリューションエクスプローラー**でアプリケーションプロジェクトノードを右クリックし、 **[プロパティ]** を選択します。 
2. **[VC++ ディレクトリ]** プロパティページで、.lib ファイルがあるディレクトリへのパスを **[ライブラリパス]** に追加し、 **[インクルードディレクトリ]** のライブラリヘッダーファイルへのパスを追加します。  
3. [**リンカー > 入力**プロパティ] ページで、**追加の依存関係**に .lib ファイルの名前を追加します。

## <a name="dynamic-link-libraries"></a>ダイナミックリンクライブラリ

DLL がアプリケーションと同じソリューションの一部としてビルドされている場合は、スタティックライブラリの場合と同じ手順を実行します。

DLL がアプリケーションソリューションに含まれていない場合は、DLL ファイル、エクスポートされた関数とクラスのプロトタイプを含むヘッダー、および必要なリンク情報を提供する .lib ファイルが必要です。

1. DLL をプロジェクトの出力フォルダーにコピーするか、または Dll の標準の Windows 検索パスの別のフォルダーにコピーします。 「[ダイナミックリンクライブラリの検索順序](/windows/win32/dlls/dynamic-link-library-search-order)」を参照してください。
2. 静的ライブラリの手順1-3 に従って、ヘッダーと .lib ファイルへのパスを指定します。

## <a name="com-objects"></a>COM オブジェクト

ネイティブC++アプリケーションが COM オブジェクトを使用する必要があり、そのオブジェクトが*登録*されている場合は、CoCreateInstance を呼び出して、オブジェクトの CLSID を渡すだけで済みます。 システムによって Windows レジストリに検出され、読み込まれます。 /Cli プロジェクトは、同じ方法で COM オブジェクトを使用することも、**参照の追加 > com**リストから参照を追加して、[ランタイム呼び出し可能ラッパー](/dotnet/framework/interop/runtime-callable-wrapper)を介して使用することもできます。 C++ 

## <a name="net-assemblies-and-windows-runtime-components"></a>.NET アセンブリと Windows ランタイムコンポーネント

UWP プロジェクトまたC++は/cli プロジェクトでは、アセンブリまたはコンポーネントへの*参照*を追加することによって、.net アセンブリまたは Windows ランタイムコンポーネントを使用します。 UWP またはC++/Cli プロジェクトの [参照] ノードの下には、一般的に使用されるコンポーネントへの参照が表示されます。 **ソリューションエクスプローラー**の **[参照]** ノードを右クリックして、**参照マネージャー**を表示し、システムで認識されているその他のコンポーネントを参照します。 **[参照]** ボタンをクリックして、カスタムコンポーネントが配置されているフォルダーに移動します。 .NET アセンブリおよび Windows ランタイムコンポーネントには組み込みの型情報が含まれているため、右クリックして **[オブジェクトブラウザーで表示]** を選択すると、メソッドとクラスを表示できます。 

## <a name="reference-properties"></a>参照のプロパティ

参照には種類に従ってそれぞれプロパティがあります。 プロパティを表示するには、ソリューション エクスプローラーで参照を選んで **Alt + Enter**キーを押すか、右クリックして **[プロパティ]** を選びます。 読み取り専用のプロパティと、変更できるプロパティがあります。 ただし、通常はこれらのプロパティを手動で変更する必要はありません。

### <a name="activex-reference-properties"></a>ActiveX 参照のプロパティ

ActiveX 参照のプロパティは、COM コンポーネントへの参照に対してのみ使用できます。 これらのプロパティは、 **[参照]** ウィンドウで COM コンポーネントが選択されている場合にのみ表示されます。 プロパティは修正できません。

- **コントロールの完全なパス**

   参照先のコントロールのディレクトリ パスが表示されます。

- **コントロールの GUID**

   ActiveX コントロールの GUID が表示されます。

- **コントロールのバージョン**

   参照先の ActiveX コントロールのバージョンが表示されます。

- **タイプ ライブラリ名**

   参照されているタイプ ライブラリ名が表示されます。

- **ラッパー ツール**

   参照先の COM ライブラリまたは ActiveX コントロールからの相互運用機能アセンブリをビルドするために使用するツールが表示されます。

### <a name="assembly-reference-properties-ccli"></a>アセンブリ参照プロパティ (C++/cli)

アセンブリ参照プロパティは、/Cli プロジェクトのC++.NET Framework アセンブリへの参照に対してのみ使用できます。 これらのプロパティは、 **[参照]** ペインで .NET Framework アセンブリが選択されている場合にのみ表示されます。 プロパティは修正できません。

- **相対パス**

   プロジェクト ディレクトリから参照するアセンブリへの相対パスが表示されます。

### <a name="build-properties"></a>ビルド プロパティ

次のプロパティは、さまざまな種類の参照で使用できます。 参照付きでビルドする方法をこれらのプロパティにより指定できます。

- **ローカルにコピー**

   ビルド時に、参照するアセンブリをターゲットの場所に自動的にコピーするかどうかを指定します。

- **ローカルサテライトアセンブリをコピーC++する (/cli)**

   ビルド時に、参照するアセンブリのサテライト アセンブリをターゲットの場所に自動的にコピーするかどうかを指定します。 **[ローカルにコピー]** が **true** の場合にのみ使用します。

- **参照アセンブリの出力**

   このアセンブリがビルド処理で使用されることを指定します。 **true** の場合、ビルド時にコンパイラのコマンド ラインでアセンブリが使用されます。

### <a name="project-to-project-reference-properties"></a>プロジェクト間参照プロパティ

次のプロパティは、 **[参照]** ウィンドウで選択されているプロジェクトから、同じソリューション内の別のプロジェクトへの*プロジェクト間参照*を定義します。 詳細については、「[プロジェクト内の参照の管理](/visualstudio/ide/managing-references-in-a-project)」を参照してください。

- **ライブラリ依存関係のリンク**

   このプロパティが **True**の場合、プロジェクト システムは、独立プロジェクトから生成される依存プロジェクトである .lib ファイルにリンクされます。 通常は **True**を指定します。

- **プロジェクト識別子**

   独立したプロジェクトを一意に識別します。 プロパティの値は、変更できない内部システムの GUID です。

- **ライブラリ依存関係の入力の使用**

   このプロパティが **False**の場合、プロジェクト システムは、独立プロジェクトから生成されるライブラリの依存プロジェクトである .lib ファイルにリンクされません。 そのため、この値はインクリメンタル リンクを無効にします。 依存プロジェクトが多い場合、アプリケーションのビルドには時間がかかるため、通常は **False** を指定します。

### <a name="read-only-reference-properties-com--net"></a>読み取り専用の参照プロパティ (COM & .NET)

次のプロパティは COM および .NET のアセンブリ参照のものであり、変更できません。

- **アセンブリ名**

   参照するアセンブリのアセンブリ名が表示されます。

- **カルチャ**

   選択された参照のカルチャが表示されます。

- **説明**

   選択された参照の説明が表示されます。

- **完全パス**

   参照されたアセンブリのディレクトリ パスが表示されます。

- **[ID]**

   .NET Framework アセンブリでは、完全なパスが表示されます。 COM コンポーネントでは、GUID が表示されます。

- **ラベル**

   参照のラベルが表示されます。

- **名前**

   参照名が表示されます。

- **公開キー トークン**

   参照されたアセンブリを識別するための公開キー トークンが表示されます。

- **厳密な名前**

   参照が厳密な名前を持つ場合は`true` です。 厳密な名前を持つアセンブリは、一意にバージョン管理されます。

- **Version**

   参照アセンブリのバージョンが表示されます。

## <a name="see-also"></a>関連項目

[C++プロジェクトプロパティページのリファレンス](reference/property-pages-visual-cpp.md)<br>
[Visual Studio で C++ コンパイラとビルド プロパティを設定する](working-with-project-properties.md)