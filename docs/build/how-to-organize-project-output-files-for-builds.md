---
title: '方法: ビルドのプロジェクト出力ファイルを編成する'
ms.date: 05/06/2019
helpviewer_keywords:
- C++, output files
- output files, organizing
ms.assetid: 521d95ea-2dcc-4da0-b5eb-ac3e57941446
ms.openlocfilehash: 202b2cbf135a5d8371354aac0fb8dd26367896c2
ms.sourcegitcommit: da32511dd5baebe27451c0458a95f345144bd439
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2019
ms.locfileid: "65220666"
---
# <a name="how-to-organize-project-output-files-for-builds"></a>方法: ビルドのプロジェクト出力ファイルを編成する

このトピックでは、プロジェクト出力ファイルの編成に関する推奨手順について説明します。 プロジェクト出力ファイルの設定を誤ると、ビルド エラーが発生する場合があります。 このトピックでは、プロジェクト出力ファイルの編成に対する各代替手段の長所および短所についても説明します。

## <a name="referencing-clr-assemblies"></a>CLR アセンブリの参照

#### <a name="to-reference-assemblies-with-using"></a>#using を使用してアセンブリを参照するには

1. `#using <System.Data.dll>` などの #using ディレクティブを使用し、コードから直接アセンブリを参照できます。 詳細については、「[#using ディレクティブ](../preprocessor/hash-using-directive-cpp.md)」を参照してください。

   指定するファイルは、MSIL にある限り、.exe、.dll、.netmodule、または .obj のいずれでも使用できます。 参照先コンポーネントは、すべての言語でビルドできます。 このオプションを使用すると、メタデータが MSIL から抽出されるため、IntelliSense にアクセスできるようになります。 指定したファイルはプロジェクトのパスに配置する必要があります。配置しないと、プロジェクトはコンパイルされず、IntelliSense も使用できません。 ファイルがプロジェクトのパスに配置されているかどうかを簡単に確認するには、#using 行を右クリックし、 **[ドキュメントを開く]** コマンドを選択します。 ファイルが見つからなかった場合は、そのことが通知されます。

   ファイルへの完全パスを指定しない場合は、 **/AI** コンパイラ オプションを使用し、#using 参照の検索パスを編集できます。 詳細については、「[/AI (メタデータ ディレクトリの指定)](reference/ai-specify-metadata-directories.md)」を参照してください。

#### <a name="to-reference-assemblies-with-fu"></a>/FU を使用してアセンブリを参照するには

1. 既に説明したようにコード ファイルからアセンブリを直接参照するのではなく、 **/FU** コンパイラ オプションを使用できます。 この方法の利点は、特定のアセンブリを参照するすべてのファイルに #using ステートメントを個別に追加する必要がないことです。

   このオプションを設定するには、プロジェクトの **[プロパティ ページ]** を開きます。 **[構成プロパティ]** ノードを展開し、 **[C/C++]** ノードを展開します。次に、 **[詳細]** を選択します。 **[#using の強制]** の横に必要なアセンブリを追加します。 詳細については、「[/FU (強制 #using ファイルの名前の指定)](reference/fu-name-forced-hash-using-file.md)」を参照してください。

#### <a name="to-reference-assemblies-with-add-new-reference"></a>[新しい参照の追加] を使用してアセンブリを参照するには

1. CLR アセンブリを使用するには、これが最も簡単な方法です。 最初に、 **/clr** コンパイラ オプションを使用してプロジェクトがコンパイルされていることを確認します。 次に、**ソリューション エクスプローラー**で、プロジェクトを右クリックし、 **[追加]** 、 **[参照]** の順にクリックします。 これにより、 **[プロパティ ページ]** ダイアログ ボックスが表示されます。

1. **[プロパティ ページ]** ダイアログ ボックスで、 **[新しい参照の追加]** を選択します。 ダイアログには、現在のプロジェクトで使用できるすべての .NET アセンブリ、COM アセンブリ、およびその他のアセンブリの一覧が表示されます。 必要なアセンブリを選択し、 **[OK]** をクリックします。

   プロジェクト参照を設定すると、対応する依存関係が自動的に処理されます。 さらに、メタデータがアセンブリに含まれているため、ヘッダー ファイルを追加したり、マネージド アセンブリから使用されている要素のプロトタイプを作成したりする必要はありません。

## <a name="referencing-native-dlls-or-static-libraries"></a>ネイティブ DLL またはスタティック ライブラリの参照

#### <a name="to-reference-native-dlls-or-static-libraries"></a>ネイティブ DLL またはスタティック ライブラリを参照するには

1. #include ディレクティブを使用し、コード内の適切なヘッダー ファイルを参照します。 このヘッダー ファイルは、インクルード パスにあるか、現在のプロジェクトに含まれている必要があります。 詳細については、「[#include ディレクティブ (C/C++)](../preprocessor/hash-include-directive-c-cpp.md)」を参照してください。

1. プロジェクトの依存関係を設定することもできます。 プロジェクトの依存関係を設定することにより、次の 2 点が保証されます。 1 つ目は、プロジェクトで必要な依存ファイルが常に見つかるように、プロジェクトが正しい順序でビルドされることです。 2 つ目は、ファイルがリンク時に簡単に見つかるように、依存プロジェクトの出力ディレクトリが暗黙的にパスに追加されることです。

1. アプリケーションを配置するには、適切な場所に DLL を置く必要があります。 DLL は、次のいずれかの場所に置くことができます。

   1. 実行可能ファイルと同じパス。

   1. システム パス (**path** 環境変数) 内の任意の場所。

   1. side-by-side アセンブリ内。 詳細については、「[C/C++ side-by-side アセンブリのビルド](building-c-cpp-side-by-side-assemblies.md)」を参照してください。

## <a name="working-with-multiple-projects"></a>複数のプロジェクトの操作

既定では、プロジェクトは、すべての出力ファイルがプロジェクト ディレクトリのサブディレクトリに作成されるようにビルドされます。 このディレクトリの名前は、ビルド構成 (デバッグやリリースなど) に基づいて付けられます。 兄弟プロジェクトが相互に参照するには、それぞれのプロジェクトのプロジェクト出力ディレクトリのパスに、もう一方のプロジェクトで使用されているパスを明示的に追加し、リンクを正しく機能させる必要があります。 プロジェクトの依存関係を設定すると、この操作は自動的に行われます。 ただし、依存関係を使用しない場合は、ビルドの管理が非常に難しくなる可能性があるため、この操作は慎重に行う必要があります。 たとえば、プロジェクトにデバッグ構成とリリース構成があり、兄弟プロジェクトからの外部ライブラリが含まれている場合は、ビルドされている構成によって異なるライブラリ ファイルを使用する必要があります。 したがって、これらのパスのハードコーディングには手間がかかる場合があります。

すべての必要な出力ファイル (実行可能ファイル、インクリメンタル リンカー ファイル、PDB ファイルなど) が共通のソリューション ディレクトリにコピーされます。 したがって、同じ構成の C++ プロジェクトを数多く含むソリューションを使用する場合、すべての出力ファイルが集中管理されるため、リンクおよび配置を簡略化できます。 同じパスにコピーされた出力ファイルをそのまま保持しておけば、アプリケーションおよびライブラリは期待どおりに動作します。

出力ファイルを稼働環境に配置すると、その場所が大きな問題になる場合があります。 IDE 内でプロジェクトを実行している間は、インクルードされるライブラリへのパスが必ずしも稼動環境のパスと一致するわけではありません。 たとえば、コード内に `#using "../../lib/debug/mylib.dll"` と記述しても、mylib.dll を別の相対的な位置に配置すると、アプリケーションでは、実行時エラーが発生します。 この問題を回避するには、コード内の #include ステートメントに相対パスを使用しないようにします。 また、必要なファイルがプロジェクトのビルド パスにあることと、対応する稼動環境のファイルが適切に配置されていることを確認することをお勧めします。

#### <a name="how-to-specify-where-output-files-go"></a>出力ファイルの出力先を指定するには

1. プロジェクトの出力場所の設定は、プロジェクトの **[プロパティ ページ]** で確認できます。 **[構成プロパティ]** の隣のノードを展開し、 **[全般]** を選択します。 出力場所は、 **[出力ディレクトリ]** の隣に指定されます。 詳細については、「[[全般] プロパティ ページ (プロジェクト)](reference/general-property-page-project.md)」を参照してください。

## <a name="see-also"></a>関連項目

[Visual Studio での C++ プロジェクトの種類](reference/visual-cpp-project-types.md)
