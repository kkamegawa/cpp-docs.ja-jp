---
title: インポート ライブラリとエクスポート ファイルの使用
ms.date: 11/04/2016
helpviewer_keywords:
- circular exports
- import libraries, using
- export files
ms.assetid: 2634256a-8aa5-4495-8c9e-6cde10e4ed76
ms.openlocfilehash: 030b792d4bbebecef9d9303238657a564a142ecf
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62317784"
---
# <a name="using-an-import-library-and-export-file"></a>インポート ライブラリとエクスポート ファイルの使用

これらのプログラムをリンクするコマンドが循環エクスポートに対応する必要があります複数の 2 つのプログラムへのエクスポートし、互いからインポートする場合、または (実行可能ファイルまたは DLL) がインポートから、別のプログラムにエクスポート プログラム。

循環エクスポートを行わない場合は、別のプログラムからエクスポートを使用するプログラムをリンクするとき、エクスポート側のプログラム用インポート ライブラリを指定する必要があります。 そのエクスポート側のプログラムをリンクするときに、エクスポート側のプログラム用インポート ライブラリが作成されます。 そのため、プログラムをインポートする前に、エクスポート側のプログラムをリンクする必要があります。 たとえば、TWO.dll ONE.dll からインポートすると場合、する必要があります ONE.dll をリンクし、インポート ライブラリ ONE.lib を取得します。 次に、TWO.dll をリンクするときに、ONE.lib を指定します。 リンカー TWO.dll を作成する場合、そのインポート ライブラリ、TWO.lib も作成されます。 TWO.dll からインポートするプログラムをリンクするときに、TWO.lib を使用します。

ただし、循環エクスポートの場合、その他のプログラムからのインポート ライブラリを使用して相互に依存するプログラムのすべてをリンクすることはできません。 TWO.dll がまた ONE.dll をエクスポートします、TWO.dll 用インポート ライブラリが存在しなければ、まだ ONE.dll がリンクされている場合は、既に説明した例。 循環エクスポートが存在する場合、LIB を使用して、インポート ライブラリを作成し、プログラムのいずれかのファイルをエクスポートする必要があります。

作業を開始するには、LIB を実行するプログラムのいずれかを選択します。 LIB のコマンドですべてのオブジェクトおよびプログラムのライブラリの一覧し、/def オプションを指定します。 プログラムでは、.def ファイルまたは/EXPORT の仕様を使用する場合にも指定します。

インポート ライブラリ (.lib) と、プログラムのエクスポート ファイル (.exp) を作成した後は、他のプログラムやプログラムをリンクするときに、インポート ライブラリを使用します。 リンクは、各エクスポート プログラムをビルドするため、インポート ライブラリを作成します。 たとえば、オブジェクトとエクスポートの ONE.dll の LIB を実行する場合は、ONE.lib と ONE.exp を作成します。TWO.dll; をリンクするときに ONE.lib を使用できるようになりましたこの手順では、インポート ライブラリ TWO.lib も作成します。

最後に、プログラムを開始したときにリンクします。 リンクのコマンドでは、オブジェクトと、プログラム、およびインポート ライブラリの LIB で作成された .exp ファイル、プログラムのライブラリや、プログラムによって使用されるエクスポートのライブラリを指定します。 この例を続行するには、ONE.dll のリンク コマンドには、ONE.exp と TWO.lib、オブジェクトおよび ONE.dll にライブラリが含まれています。 LINK コマンド; で .def ファイルまたは/EXPORT の仕様を指定しません。これらは必要ありません、.exp ファイルにエクスポート定義が含まれているためです。 .Exp ファイルを使用してリンクすると、リンクは、インポート ライブラリは作成されませんが、.exp ファイルが作成されたときに 1 つが作成されました。

## <a name="see-also"></a>関連項目

[インポート ライブラリとエクスポート ファイル](working-with-import-libraries-and-export-files.md)
