---
title: ATL COM+ 1.0 コンポーネント ウィザード
ms.date: 05/08/2019
helpviewer_keywords:
- ATL projects, adding components
ms.assetid: 11670681-8671-4122-96a4-2e52f8dadce0
ms.openlocfilehash: 24b4698ebc8dd4f61dfd88ad14e64d4f70b2ef35
ms.sourcegitcommit: fc1de63a39f7fcbfe2234e3f372b5e1c6a286087
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/15/2019
ms.locfileid: "65707031"
---
# <a name="atl-com-10-component-wizard"></a>ATL COM+ 1.0 コンポーネント ウィザード

::: moniker range="vs-2019"

このウィザードは、Visual Studio 2019 以降では利用できません。

::: moniker-end

::: moniker range="<=vs-2017"

このウィザードを使用して、トランザクションを含む COM+ 1.0 サービスをサポートするプロジェクトにオブジェクトを追加します。

オブジェクトでデュアル インターフェイスと Automation をサポートするかどうかを指定できます。 エラー情報インターフェイス、オブジェクトの拡張コントロール、トランザクション、および非同期メッセージ キューのサポートも指定できます。

## <a name="remarks"></a>解説

Visual Studio 2008 以降、このウィザードによって生成された登録スクリプトでは、その COM コンポーネントが **HKEY_LOCAL_MACHINE** ではなく **HKEY_CURRENT_USER** 下に登録されます。 この動作を変更するには、ATL ウィザードの **[すべてのユーザーについてコンポーネントを登録]** オプションを設定します。

## <a name="names"></a>名前

プロジェクトに追加するオブジェクト、インターフェイス、およびクラスの名前を指定します。 **[短い名前]** 以外のすべてのボックスは、他とは独立して編集できます。 **[短い名前]** のテキストを変更すると、このページ内にある他のすべてのボックスの名前に変更が反映されます。 COM セクションで **[コクラス]** の名前を変更すると、その変更は **[種類]** と **[ProgID]** のボックスに反映されますが、 **[インターフェイス]** の名前は変更されません。 名前付けに関するこの動作は、コントロールを開発するときに、すべての名前を識別しやすくするために設計されています。

- **短い名前**

   オブジェクトの省略名を設定します。 指定する名前によって、`Class` と `Coclass` の名前、 **.cpp ファイル**と **.h ファイル**の名前、**インターフェイス**の名前、**種類**の名前、および **ProgID** が決まります (各フィールドを個別に変更しない限り)。

- **.h ファイル**

   新しいオブジェクトのクラスにヘッダー ファイルの名前を設定します。 既定では、この名前は **[短い名前]** で指定した名前に基づきます。 選択した場所にファイル名を保存するには、あるいはクラス宣言を既存のファイルに追加するには、省略記号ボタンをクリックします。 既存のファイルを選択した場合、ウィザードで **[完了]** をクリックするまで、ファイルは選択した場所に保存されません。

   ウィザードではファイルは上書きされません。 既存のファイルの名前を選択する場合、 **[完了]** をクリックすると、ウィザードからクラス宣言をファイルのコンテンツに追加するかどうかを指定するように求められます。 ファイルを追加するには、 **[はい]** をクリックします。ウィザードに戻り、別のファイル名を指定するには、 **[いいえ]** をクリックします。

- **クラス**

   作成するクラスの名前を設定します。 この名前は **[短い名前]** で指定した名前に基づき、クラス名の一般的なプレフィックスである 'C' が先頭に付きます。

- **.cpp ファイル**

   新しいオブジェクトのクラスに実装ファイルの名前を設定します。 既定では、この名前は **[短い名前]** で指定した名前に基づきます。 ファイル名を選択した場所に保存するには、省略記号ボタンをクリックします。 ファイルは、ウィザードで **[完了]** をクリックするまで選択した場所に保存されません。

   ウィザードではファイルは上書きされません。 既存のファイルの名前を選択する場合、 **[完了]** をクリックすると、ウィザードからクラスの実装をファイルのコンテンツに追加するかどうかを指定するように求められます。 ファイルを追加するには、 **[はい]** をクリックします。ウィザードに戻り、別のファイル名を指定するには、 **[いいえ]** をクリックします。

- **属性付き**

   オブジェクトで属性を使用するかどうかを指示します。 属性付き ATL プロジェクトにオブジェクトを追加する場合はこのオプションが選択され、変更はできません。 つまり、属性のサポートと共に作成されたプロジェクトに追加できるのは、属性付きオブジェクトのみです。

   属性をサポートしていない ATL プロジェクトに対してこのオプションを選択した場合、ウィザードによって、プロジェクトに属性のサポートを追加するかどうかを指定するように求められます。

   このオプションを設定した後に追加するすべてのオブジェクトは、既定で属性付きと指定されます (チェック ボックスがオンになっています)。 このボックスをオフにして、属性を使用しないオブジェクトを追加できます。

   詳細については、「[アプリケーションの設定、ATL プロジェクト ウィザード](../../atl/reference/application-settings-atl-project-wizard.md)」と「[属性の基本的なしくみ](../../windows/basic-mechanics-of-attributes.md)」を参照してください。

### <a name="com"></a>COM

オブジェクトの COM 機能に関する情報を指定します。

- **コクラス**

   オブジェクトでサポートされるインターフェイスの一覧を含むコンポーネント クラスの名前を設定します。

> [!NOTE]
>  属性を使用してプロジェクトを作成するか、COM+ 1.0 コンポーネントで属性を使用することをこのウィザード ページで指定した場合、ATL には `coclass` 属性が含まれないため、このオプションを変更することはできません。

- **Type**

   レジストリに表示されるオブジェクトの説明を設定します。

- **Interface**

   オブジェクト用に作成するインターフェイスを設定します。 このインターフェイスには、カスタム メソッドが含まれます。

- **ProgID**

   オブジェクトの CLSID の代わりにコンテナーで使用できる名前を設定します。
   
::: moniker-end

## <a name="see-also"></a>関連項目

[ATL COM+ 1.0 コンポーネント](../../atl/reference/adding-an-atl-com-plus-1-0-component.md)
