---
title: オプション、ATL シンプル オブジェクト ウィザード
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.simple.options
helpviewer_keywords:
- ATL Simple Object Wizard, options
ms.assetid: 125fe179-942d-4181-8b82-33e92e1fd779
ms.openlocfilehash: e92f4909907645fc317590fbcc3601887346c642
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/15/2019
ms.locfileid: "69495158"
---
# <a name="options-atl-simple-object-wizard"></a>オプション、ATL シンプル オブジェクト ウィザード

ATL シンプルオブジェクトウィザードのこのページを使用すると、オブジェクトの効率とエラーのサポートを向上させるための設計を行うことができます。

ATL プロジェクトや ATL COM クラスの詳細については、「[ATL COM デスクトップ コンポーネント](../../atl/atl-com-desktop-components.md)」を参照してください。

- **スレッド モデル**

   スレッドを管理するためのメソッドを示します。 既定では、プロジェクトは**アパートメント**スレッド処理を使用します。

   詳細については、「[プロジェクトのスレッド モデルの指定 (ATL)](../../atl/specifying-the-threading-model-for-a-project-atl.md)」を参照してください。

   |オプション|説明|
   |------------|-----------------|
   |**Single**|オブジェクトが常にプライマリ COM スレッドで実行されることを指定します。 詳細については、「[シングルスレッドアパートメント](/windows/win32/com/single-threaded-apartments)と[InprocServer32](/windows/win32/com/inprocserver32) 」を参照してください。|
   |**Apartment**|オブジェクトがアパートメントスレッド処理を使用することを指定します。 シングルスレッドアパートメントに相当します。 アパートメントスレッドコンポーネントの各オブジェクトには、オブジェクトの有効期間中、そのスレッドのアパートメントが割り当てられます。ただし、複数のオブジェクトに対して複数のスレッドを使用できます。 各アパートメントは特定のスレッドに関連付けられており、Windows メッセージポンプ (既定値) があります。<br /><br /> 詳細については[、「シングルスレッドアパートメント](/windows/win32/com/single-threaded-apartments)」を参照してください。|
   |**両方とも**|オブジェクトが作成されるスレッドの種類に応じて、アパートメントスレッドまたはフリースレッド処理のいずれかを使用できることを指定します。|
   |**空け**|オブジェクトがフリースレッド処理を使用することを指定します。 フリースレッドは、マルチスレッドアパートメントモデルと同じです。 詳細については、「[マルチスレッドアパートメント](/windows/win32/com/multithreaded-apartments)」を参照してください。|
   |**Neutral**|オブジェクトがマルチスレッドアパートメントのガイドラインに従うことを指定しますが、任意の種類のスレッドで実行できます。|

- **集計**

   オブジェクトが[集計](/windows/win32/com/aggregation)を使用するかどうかを示します。 集約オブジェクトは、クライアントに公開するインターフェイスを選択し、そのインターフェイスは、集計オブジェクトによって実装されているかのように公開されます。 Aggregate オブジェクトのクライアントは、aggregate オブジェクトとのみ通信します。

   |オプション|説明|
   |------------|-----------------|
   |**はい**|オブジェクトを集計できることを指定します。 これが既定値です。|
   |**いいえ**|オブジェクトが集計されないことを指定します。|
   |**Only**|オブジェクトを集計する必要があることを指定します。|

- **Interface**

   オブジェクトでサポートされるインターフェイスの種類を示します。 既定で、オブジェクトではデュアル インターフェイスがサポートされます。

   |オプション|説明|
   |------------|-----------------|
   |**デュアル**|オブジェクトがデュアルインターフェイスをサポートしていることを指定します (vtable にはカスタム`IDispatch`インターフェイス関数と遅延バインディングメソッドがあります)。 COM クライアントと[オートメーションコントローラー](../../mfc/automation-clients.md)の両方がオブジェクトにアクセスできるようにします。 これが既定値です。|
   |**Custom**|オブジェクトでカスタム インターフェイス (その vtable にカスタム インターフェイス関数がある) をサポートするように指定します。 カスタム インターフェイスは、特にプロセスの境界間で、デュアル インターフェイスよりも速い可能性があります。<br /><br /> - **オートメーション**との互換性カスタムインターフェイスをサポートするオブジェクトに、オートメーションコントローラーがアクセスできるようにします。|

- **サポート**

   オブジェクトの追加のサポートを示します。

   |オプション|説明|
   |------------|-----------------|
   |**ISupportErrorInfo**|オブジェクトがクライアントにエラー情報を返すことができるように、[ISupportErrorInfo](../../atl/reference/isupporterrorinfoimpl-class.md) インターフェイスのサポートを作成します。|
   |**接続ポイント**|オブジェクトのクラスを[IConnectionPointContainerImpl](../../atl/reference/iconnectionpointcontainerimpl-class.md)から派生させることによって、オブジェクトの接続ポイントを有効にします。|
   |**フリースレッドマーシャラー**|同じプロセス内のスレッド間でインターフェイスポインターを効率的にマーシャリングするための、フリースレッドのマーシャラーオブジェクトを作成します。 **両方**をスレッドモデルとして指定するオブジェクトで使用できます。|
   |**IObjectWithSite**(IE オブジェクトのサポート)|[IObjectWithSiteImpl](../../atl/reference/iobjectwithsiteimpl-class.md)を実装します。これは、コンテナー内のオブジェクトとそのサイト間の通信をサポートする簡単な方法を提供します。|

## <a name="see-also"></a>関連項目

[ATL シンプル オブジェクト ウィザード](../../atl/reference/atl-simple-object-wizard.md)<br/>
[ATL シンプル オブジェクト](../../atl/reference/adding-an-atl-simple-object.md)<br/>
[インプロセスサーバーのスレッド処理の問題](/windows/win32/com/in-process-server-threading-issues)
