---
title: リンカ ツール エラー LNK1104
description: Microsoft C およびC++ (MSVC) リンカーエラー LNK1104、その原因、および考えられる解決策について説明します。
ms.date: 12/13/2019
f1_keywords:
- LNK1104
helpviewer_keywords:
- LNK1104
ms.assetid: 9ca6f929-0efc-4055-8354-3cf5b4e636dc
ms.openlocfilehash: 8878db1b0829703b22b2f7863eb7955d17ad3096
ms.sourcegitcommit: a5fa9c6f4f0c239ac23be7de116066a978511de7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/20/2019
ms.locfileid: "75301783"
---
# <a name="linker-tools-error-lnk1104"></a>リンカ ツール エラー LNK1104

> ファイル '*filename*' を開くことができません

このエラーは、読み取りまたは書き込みのいずれかで、リンカーがファイルを開くことができなかった場合に報告されます。 この問題の最も一般的な原因は、次の2つです。

- プログラムは既に実行されているか、デバッガーに読み込まれています。

- ライブラリパスが正しくないか、または二重引用符で囲まれていません。

このエラーには他にも多くの原因が考えられます。 これらを絞り込むには、まずファイル*名*の種類を確認します。 その後、次のセクションを参照して、特定の問題を特定し、修正してください。

## <a name="cant-open-your-app-or-its-pdb-file"></a>アプリまたは .pdb ファイルを開くことができません

### <a name="your-app-is-running-or-its-loaded-in-the-debugger"></a>アプリが実行中であるか、デバッガーに読み込まれています

*Filename*が実行可能ファイルの名前、または関連付けられた .pdb ファイルの場合は、アプリケーションが既に実行されているかどうかを確認します。 次に、デバッガーに読み込まれているかどうかを確認します。 この問題を解決するには、プログラムを停止してから、再度ビルドする前にデバッガーからアンロードします。 アプリがリソースエディターなどの別のプログラムで開かれている場合は、アプリケーションを閉じます。 プログラムが応答していない場合は、タスクマネージャーを使用してプロセスを終了する必要があります。 また、Visual Studio を閉じて再起動することが必要になる場合もあります。

### <a name="your-app-is-locked-by-an-antivirus-scan"></a>アプリがウイルス対策スキャンによってロックされています

多くの場合、ウイルス対策プログラムは、新しく作成されたファイル (特に .exe および .dll 実行可能ファイル) へのアクセスを一時的にブロックします。 この問題を解決するには、プロジェクトのビルドディレクトリをウイルス対策スキャナーから除外してみてください。

## <a name="cant-open-a-microsoft-library-file"></a>Microsoft ライブラリファイルを開くことができません

### <a name="windows-libraries-such-as-kernel32lib"></a>Kernel32.dll などの Windows ライブラリ

開くことができないファイルが、 *kernel32.dll*など、Microsoft によって提供される標準ライブラリファイルの1つである場合は、プロジェクト構成エラーまたはインストールエラーが発生している可能性があります。 Windows SDK がインストールされていることを確認します。 プロジェクトに MFC などの他の Microsoft ライブラリが必要な場合は、MFC コンポーネントが Visual Studio インストーラーによってもインストールされていることを確認してください。 インストーラーを再実行すると、いつでもオプションのコンポーネントを追加できます。 詳細については、「 [Visual Studio の変更](/visualstudio/install/modify-visual-studio)」を参照してください。 インストーラーの **[個々のコンポーネント]** タブを使用して、特定のライブラリと sdk を選択します。

### <a name="versioned-vcruntime-libraries"></a>バージョン管理された vcruntime ライブラリ

エラーメッセージにバージョン管理された Microsoft ライブラリ ( *msvcr120.dll*など) が含まれている場合は、そのコンパイラバージョンのプラットフォームツールセットがインストールされていない可能性があります。 この問題を解決するには、次の2つのオプションがあります。現在のプラットフォームツールセットを使用するようにプロジェクトをアップグレードするか、以前のツールセットをインストールし、変更せずにプロジェクトをビルドします。 詳細については、「[以前のバージョンのビジュアルC++からプロジェクトをアップグレード](../../porting/upgrading-projects-from-earlier-versions-of-visual-cpp.md)する」および「 [visual Studio でネイティブマルチターゲットを使用する」を](../../porting/use-native-multi-targeting.md)参照してください。

### <a name="retail-debug-or-platform-specific-libraries"></a>リテール、デバッグ、またはプラットフォーム固有のライブラリ

このエラーは、新しいターゲットプラットフォームまたは構成 (Retail、ARM64 など) のために初めてビルドするときに発生する可能性があります。 IDE で、 [[全般] プロパティページ](../../build/reference/general-property-page-project.md)で指定した**プラットフォームツールセット**と**Windows SDK バージョン**がインストールされていることを確認します。 また、[ [VC + + ディレクトリ] プロパティページ](../../build/reference/vcpp-directories-property-page.md)で指定した**ライブラリディレクトリ**で、必要なライブラリが使用可能であることを確認します。 Debug、Retail、x86、ARM64 など、各構成のプロパティを確認します。 あるビルドが動作し、別のビルドが機能しない場合は、両方の設定を比較します。 不足している必要なツールとライブラリをインストールします。

### <a name="the-vccorliblib-library"></a>Vccorlib ライブラリ

ユニバーサル Windows (UWP) アプリまたはコンポーネント用の Spectre 軽減ライブラリはありません。 エラーメッセージに*vccorlib .lib*が含まれている場合は、UWP プロジェクトで[/Qspectre](../../build/reference/qspectre.md)が有効になっている可能性があります。 この問題を解決するには、 **/Qspectre**コンパイラオプションを無効にしてください。 Visual Studio で、 **Spectre 軽減**プロパティを変更します。 これは、プロジェクトの **[プロパティページ]** ダイアログボックスの [ **CC++ /**  > **コード生成**] ページにあります。

### <a name="libraries-in-projects-from-online-or-other-sources"></a>オンラインまたはその他のソースのプロジェクト内のライブラリ

別のコンピューターからコピーされたプロジェクトをビルドする場合、ライブラリのインストール場所が異なる場合があります。 コマンドラインビルドの場合は、LIB 環境変数とライブラリパスがビルドに対して正しく設定されていることを確認します。 Visual Studio では、プロジェクトのプロパティページで設定されている現在のライブラリパスを表示および編集できます。 **[VC + + ディレクトリ]** ページで、 **[ライブラリディレクトリ]** プロパティのドロップダウンコントロールを選択し、 **[編集]** を選択します。 **[ライブラリディレクトリ]** ダイアログボックスの 評価された **[値]** セクションには、ライブラリファイルを検索する現在のパスが表示されます。 これらのパスは、ローカルライブラリを指すように更新してください。

### <a name="updated-windows-sdk-libraries"></a>更新された Windows SDK ライブラリ

このエラーは、Visual Studio の Windows SDK へのパスが古い場合に発生する可能性があります。 これは、Visual Studio インストーラーとは無関係に新しい Windows SDK をインストールした場合に発生する可能性があります。 IDE でこの問題を解決するには、[ [VC + + ディレクトリ] プロパティページ](../../build/reference/vcpp-directories-property-page.md)で指定したパスを更新します。 パスのバージョンを新しい SDK に一致するように設定します。 開発者コマンドプロンプトを使用する場合は、新しい SDK パスを使用して環境変数を初期化するバッチファイルを更新します。 この問題を回避するには、Visual Studio インストーラーを使用して更新された Sdk をインストールします。

## <a name="cant-open-a-third-party-library-file"></a>サードパーティ製のライブラリファイルを開けません

この問題には、いくつかの一般的な原因があります。

- ライブラリファイルへのパスが正しくないか、または二重引用符で囲まれていない可能性があります。 または、リンカーに指定されていない可能性があります。

- 32ビットバージョンのライブラリがインストールされているものの、64ビット用にビルドしているか、もう一方の方法を使用している可能性があります。

- ライブラリは、インストールされていない他のライブラリに依存している可能性があります。

コマンドラインビルドのパスの問題を修正するには、LIB 環境変数が設定されていることを確認します。 このファイルには、使用するすべてのライブラリのパスと、ビルドするすべての構成が含まれていることを確認してください。 IDE では、ライブラリパスは " **VC + + ディレクトリ** > **ライブラリのディレクトリ**" プロパティによって設定されます。 ビルドするすべての構成について、必要なライブラリが含まれているすべてのディレクトリがここに一覧表示されていることを確認します。

標準ライブラリディレクトリを上書きするライブラリディレクトリを指定することが必要になる場合があります。 コマンドラインで、 [/libpath](../../build/reference/libpath-additional-libpath.md)オプションを使用します。 IDE では、プロジェクトの **[構成プロパティ] > [リンカー > 全般**] プロパティページで **[追加のライブラリディレクトリ]** プロパティを使用します。

ビルドする構成に必要なライブラリのすべてのバージョンをインストールしてください。 多くの一般的なライブラリのインストールとセットアップを自動化するには、 [vcpkg](../../vcpkg.md) package management utility を使用することを検討してください。 可能な場合は、サードパーティ製のライブラリのコピーを作成することをお勧めします。 次に、すべてのライブラリのローカルの依存関係が、プロジェクトと同じ構成用に構築されていることを確認します。

## <a name="cant-open-a-file-built-by-your-project"></a>プロジェクトによってビルドされたファイルを開くことができません

リンカーがこのファイルにアクセスしようとしても、まだ*filename*が存在しない場合は、このエラーが表示されることがあります。 1つのプロジェクトがソリューション内の別のプロジェクトに依存していても、プロジェクトが間違った順序でビルドされている場合に発生する可能性があります。 この問題を解決するには、ファイルを使用するプロジェクトでプロジェクト参照が設定されていることを確認します。 その後、不足しているファイルが必要になる前にビルドされます。 詳細については、「 [Visual C++ Studio プロジェクトへの参照の追加](../../build/adding-references-in-visual-cpp-projects.md)」および「[プロジェクト内の参照の管理](/visualstudio/ide/managing-references-in-a-project)」を参照してください。

## <a name="cannot-open-file-cprogramobj"></a>ファイル ' C:\\.obj ' を開くことができません

エラーメッセージに filename *C:\\.obj*が表示されている場合は、ライブラリのパスを二重引用符で囲みます。 このエラーは、 *C:\\プログラムファイル*で始まるラップされていないパスがリンカーに渡されたときに発生します。 ラップ解除されたパスでは、同様のエラーが発生することもあります。 通常は、予期しない .obj ファイルがドライブのルートに表示されます。

コマンドラインビルドのこの問題を解決するには、 [/libpath](../../build/reference/libpath-additional-libpath.md)オプションのパラメーターを確認します。 また、LIB 環境変数で指定されたパスと、コマンドラインで指定されたパスも確認します。 スペースを含むパスは必ず二重引用符で囲んでください。

IDE でこの問題を解決するには、必要に応じて、プロジェクトの次のプロパティに二重引用符を追加します。

- [[構成プロパティ > VC + + ディレクトリ](../../build/reference/vcpp-directories-property-page.md)] プロパティページの **[ライブラリディレクトリ]** プロパティ

- **[構成プロパティ] > [リンカー > 全般**] プロパティページの **[追加のライブラリディレクトリ]** プロパティ

- **構成プロパティ > リンカー > 入力**プロパティページの **追加の依存関係** プロパティ。

## <a name="other-common-issues"></a>その他の一般的な問題

### <a name="path-or-filename-issues"></a>パスまたはファイル名の問題

このエラーは、リンカーに指定されたライブラリファイル名またはパスが正しくない場合に発生する可能性があります。 または、パスに無効なドライブの指定がある場合。 問題については、コマンドラインまたは任意の[#pragma コメント (lib、"library_name")](../../preprocessor/comment-c-cpp.md)ディレクティブを参照してください。 スペルとファイル拡張子を確認し、指定した場所にファイルが存在することを確認します。

### <a name="parallel-build-synchronization"></a>並行ビルド同期

並行ビルドオプションを使用している場合は、Visual Studio によって別のスレッドでファイルがロックされている可能性があります。 この問題を解決するには、同じコードオブジェクトまたはライブラリが複数のプロジェクトでビルドされていないことを確認します。 ビルドの依存関係またはプロジェクト参照を使用して、プロジェクト内のビルドされたバイナリを取得します。

### <a name="additional-dependencies-specified-in-the-ide"></a>IDE で指定された追加の依存関係

**[追加の依存関係]** プロパティで個別のライブラリを指定する場合は、スペースを使用してライブラリ名を区切ります。 コンマまたはセミコロンは使用しないでください。 **[編集]** メニュー項目を使用して **[追加の依存関係]** ダイアログボックスを開く場合は、コンマ、セミコロン、スペースではなく、改行を使用して名前を区切ります。 **[ライブラリディレクトリ]** ダイアログボックスおよび **[追加のライブラリディレクトリ]** ダイアログボックスでライブラリパスを指定するときにも、改行を使用します。

### <a name="paths-that-are-too-long"></a>パスが長すぎます

*ファイル名*のパスが260文字を超えて拡張された場合に、このエラーが表示されることがあります。 必要に応じて、ディレクトリ構造を再配置するか、フォルダーとファイル名を短くしてパスを短くします。

### <a name="files-that-are-too-large"></a>ファイルが大きすぎます

このエラーは、ファイルが大きすぎることが原因で発生する可能性があります。 ライブラリまたはオブジェクトファイルのサイズが gb を超えると、32ビットのリンカーで問題が発生する可能性があります。 この問題を解決するには、64ビットツールセットを使用します。 コマンドラインで64ビットツールセットを使用する方法の詳細については、「[方法: コマンドラインで64ビットのC++ビジュアルツールセットを有効](../../build/how-to-enable-a-64-bit-visual-cpp-toolset-on-the-command-line.md)にする」を参照してください。 IDE で64ビットツールセットを使用する方法の詳細については、「 [64 ビットコンパイラおよびツールでの MSBuild の使用](../../build/walkthrough-using-msbuild-to-create-a-visual-cpp-project.md#using-msbuild-to-build-your-project)」を参照してください。 また[、Visual Studio でネイティブの amd64 ツールチェーンを使用する方法に](https://stackoverflow.com/questions/19820718/how-to-make-visual-studio-use-the-native-amd64-toolchain/23793055)ついては、Stack Overflow 投稿を参照してください。

### <a name="incorrect-file-permissions"></a>ファイルのアクセス許可が正しくありません

このエラーは、ファイル*名*にアクセスするための十分なファイルアクセス許可がない場合に発生する可能性があります。 通常のユーザーアカウントを使用して、保護されたシステムディレクトリ内のライブラリファイルにアクセスすると、この問題が発生する可能性があります。 または、元のアクセス許可が設定されている他のユーザーからコピーされたファイルを使用する場合。 この問題を解決するには、ファイルを書き込み可能なプロジェクトディレクトリに移動します。 移動したファイルにアクセスできないアクセス許可がある場合は、管理者コマンドウィンドウで msiexec.exe コマンドを実行して、ファイルの所有権を取得します。

### <a name="insufficient-disk-space"></a>ディスク領域が不足しています

このエラーは、十分なディスク領域がない場合に発生する可能性があります。 リンカーが一時ファイルを使用するケースはいくつかあります。 十分なディスク領域がある場合でも、大きなリンクを使用すると、利用可能なディスク領域を使い果たすか、断片化することができます。 [/Opt (最適化)](../../build/reference/opt-optimizations.md)オプションの使用を検討してください。推移的な COMDAT 削除を実行すると、すべてのオブジェクトファイルが複数回読み込まれます。

### <a name="problems-in-the-tmp-environment-variable"></a>TMP 環境変数の問題

*ファイル名*が LNK*nnn*という名前の場合、これは、一時ファイルのリンカーによって生成されるファイル名です。 TMP 環境変数で指定されたディレクトリが存在しない可能性があります。 または、TMP 環境変数に複数のディレクトリを指定することもできます。 TMP 環境変数には、1つのディレクトリパスのみを指定する必要があります。

## <a name="help-my-issue-isnt-listed-here"></a>ご自分の問題がここに記載されていません。

ここに記載されている問題のいずれも当てはまらない場合は、Visual Studio のフィードバックツールを使用してください。 IDE でメニューバーに移動し、**ヘルプ > フィードバックの送信 > 問題の報告** の順に選択します。 または、 **[ヘルプ > のフィードバックの送信]** を使用して提案を送信 >、提案を送信することもできます。 また、Visual Studio C++ [開発者コミュニティ](https://developercommunity.visualstudio.com/spaces/62/index.html)) の web サイトを使用することもできます。 質問への回答を検索して、支援を求めるために使用します。 詳細については、「[ビジュアルC++ツールセットまたはドキュメントで問題を報告する方法](../../overview/how-to-report-a-problem-with-the-visual-cpp-toolset.md)」を参照してください。

この問題を修正するための新しい方法を発見した場合は、お知らせください。 **このページ**の下のボタンを使用してフィードバックを送信できます。 これを使用して、 [ C++ドキュメント GitHub リポジトリ](https://github.com/MicrosoftDocs/cpp-docs/issues)に新しい問題を作成します。 ありがとうございます。
